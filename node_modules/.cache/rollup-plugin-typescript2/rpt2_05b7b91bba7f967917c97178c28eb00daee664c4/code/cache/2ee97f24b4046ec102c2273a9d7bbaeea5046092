{"code":"import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\r\nimport { useEffect, useState } from 'react';\r\nimport { Dialog } from '../../../../components';\r\nimport classes from './Open.module.less';\r\nimport Recognize from '../../process/Recognize/Recognize';\r\nimport { fileOpener } from '../../../../../utils/';\r\nimport { DialogActionButton } from './components/DialogActionButton';\r\nimport { ViewSwitcher } from './components/ViewSwitcher';\r\nconst MODAL_STATES = {\r\n    idle: 'idle',\r\n    textEditor: 'textEditor',\r\n    imageRec: 'imageRec'\r\n};\r\nconst FooterContent = ({ structStr, openHandler, copyHandler, onCancel }) => {\r\n    return (_jsxs(\"div\", { className: classes.footerContent, children: [_jsx(\"button\", { onClick: onCancel, className: classes.cancelButton, children: \"Cancel\" }), _jsxs(\"div\", { className: classes.buttonsContainer, children: [_jsx(DialogActionButton, { disabled: !structStr, clickHandler: openHandler, styles: classes.openButton, label: \"Open as New Project\" }, \"openButton\"), _jsx(DialogActionButton, { disabled: !structStr, clickHandler: copyHandler, styles: classes.copyButton, label: \"Add to Canvas\", title: \"Structure will be loaded as fragment and added to Clipboard\" }, \"copyButton\")] })] }));\r\n};\r\nconst Open = (props) => {\r\n    const { server, onImageUpload, errorHandler, isAnalyzingFile, isRecognizeDisabled, ignoreChiralFlag, ...rest } = props;\r\n    const [structStr, setStructStr] = useState('');\r\n    const [fileName, setFileName] = useState('');\r\n    const [opener, setOpener] = useState();\r\n    const [currentState, setCurrentState] = useState(MODAL_STATES.idle);\r\n    useEffect(() => {\r\n        if (server) {\r\n            fileOpener(server).then((chosenOpener) => {\r\n                setOpener({ chosenOpener });\r\n            });\r\n        }\r\n    }, [server]);\r\n    const onFileLoad = (files) => {\r\n        const onLoad = (fileContent) => {\r\n            setStructStr(fileContent);\r\n            setCurrentState(MODAL_STATES.textEditor);\r\n        };\r\n        const onError = () => errorHandler('Error processing file');\r\n        setFileName(files[0].name);\r\n        opener.chosenOpener(files[0]).then(onLoad, onError);\r\n    };\r\n    const onImageLoad = (files) => {\r\n        onImageUpload(files[0]);\r\n        setCurrentState(MODAL_STATES.imageRec);\r\n    };\r\n    // @TODO after Recognize is refactored this will not be necessary\r\n    // currently not destructuring onOk with other props so we can pass it with ...rest to Recognize below\r\n    const { onOk } = rest;\r\n    const copyHandler = () => {\r\n        onOk({ structStr, fragment: true });\r\n    };\r\n    const openHandler = () => {\r\n        onOk({ structStr, fragment: false });\r\n    };\r\n    const withFooterContent = currentState === MODAL_STATES.textEditor && !isAnalyzingFile;\r\n    // @TODO after refactoring of Recognize modal\r\n    // add Recognize rendering logic into ViewSwitcher component here\r\n    if (currentState === MODAL_STATES.imageRec) {\r\n        return _jsx(Recognize, { ...rest });\r\n    }\r\n    return (_jsx(Dialog, { title: \"Open structure\", className: classes.open, params: rest, result: () => null, footerContent: withFooterContent ? (_jsx(FooterContent, { structStr: structStr, openHandler: openHandler, copyHandler: copyHandler, onCancel: rest.onCancel })) : undefined, buttons: [], withDivider: true, children: _jsx(ViewSwitcher, { isAnalyzingFile: isAnalyzingFile, fileName: fileName, currentState: currentState, states: MODAL_STATES, selectClipboard: () => setCurrentState(MODAL_STATES.textEditor), fileLoadHandler: onFileLoad, imageLoadHandler: onImageLoad, errorHandler: errorHandler, isRecognizeDisabled: isRecognizeDisabled, structStr: structStr, inputHandler: setStructStr, autoFocus: true }) }));\r\n};\r\nexport default Open;\r\n//# sourceMappingURL=Open.js.map","references":["/usr/local/google/home/waich/workspace/ketcher/packages/ketcher-react/src/script/ui/views/modal/modal.types.ts","/usr/local/google/home/waich/workspace/ketcher/node_modules/@types/react/index.d.ts","/usr/local/google/home/waich/workspace/ketcher/packages/ketcher-react/src/script/ui/views/components/index.ts","/usr/local/google/home/waich/workspace/ketcher/packages/ketcher-react/src/script/ui/views/modal/components/process/Recognize/Recognize.jsx","/usr/local/google/home/waich/workspace/ketcher/packages/ketcher-react/src/script/ui/utils/index.ts","/usr/local/google/home/waich/workspace/ketcher/packages/ketcher-react/src/script/ui/views/modal/components/document/Open/components/DialogActionButton.tsx","/usr/local/google/home/waich/workspace/ketcher/packages/ketcher-react/src/script/ui/views/modal/components/document/Open/components/ViewSwitcher.tsx"],"map":"{\"version\":3,\"file\":\"Open.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../../../../../src/script/ui/views/modal/components/document/Open/Open.tsx\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/usr/local/google/home/waich/workspace/ketcher/packages/ketcher-react/node_modules/.cache/rollup-plugin-typescript2/placeholder/script/ui/views/modal/components/document/Open/Open.d.ts","writeByteOrderMark":false,"text":"/****************************************************************************\r\n * Copyright 2021 EPAM Systems\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *    http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n ***************************************************************************/\r\nimport { BaseCallProps, BaseProps } from '../../../modal.types';\r\nimport { FC } from 'react';\r\ninterface OpenProps {\r\n    server: any;\r\n    errorHandler: (err: string) => void;\r\n    isRecognizeDisabled: boolean;\r\n    isAnalyzingFile: boolean;\r\n    ignoreChiralFlag: boolean;\r\n}\r\ndeclare type Props = OpenProps & Pick<BaseProps, 'className'> & BaseCallProps & {\r\n    onImageUpload: (file: File) => void;\r\n};\r\ndeclare const Open: FC<Props>;\r\nexport type { OpenProps };\r\nexport default Open;\r\n"}}
