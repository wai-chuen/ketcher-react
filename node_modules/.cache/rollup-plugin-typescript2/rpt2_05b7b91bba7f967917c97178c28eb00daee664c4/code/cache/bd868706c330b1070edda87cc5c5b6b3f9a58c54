{"code":"/****************************************************************************\r\n * Copyright 2021 EPAM Systems\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *    http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n ***************************************************************************/\r\nimport { OperationType } from 'ketcher-core';\r\nexport function customOnChangeHandler(action, handler) {\r\n    const data = [];\r\n    action.operations.reverse().forEach((operation) => {\r\n        const op = operation._inverted;\r\n        switch (op.type) {\r\n            case OperationType.ATOM_ADD:\r\n            case OperationType.ATOM_DELETE:\r\n                data.push({\r\n                    operation: op.type,\r\n                    id: op.data.aid,\r\n                    label: op.data.atom.label ? op.data.atom.label : '',\r\n                    position: {\r\n                        x: +op.data.pos.x.toFixed(2),\r\n                        y: +op.data.pos.y.toFixed(2)\r\n                    }\r\n                });\r\n                break;\r\n            case OperationType.ATOM_ATTR:\r\n                data.push({\r\n                    operation: operation.type,\r\n                    id: operation.data.aid,\r\n                    attribute: operation.data.attribute,\r\n                    from: operation.data.value,\r\n                    to: operation.data2.value\r\n                });\r\n                break;\r\n            case OperationType.ATOM_MOVE:\r\n                data.push({\r\n                    operation: op.type,\r\n                    id: op.data.aid,\r\n                    position: {\r\n                        x: +op.data.d.x.toFixed(2),\r\n                        y: +op.data.d.y.toFixed(2)\r\n                    }\r\n                });\r\n                break;\r\n            case OperationType.BOND_ADD:\r\n            case OperationType.BOND_DELETE:\r\n                data.push({\r\n                    operation: op.type,\r\n                    id: op.data.bid\r\n                });\r\n                break;\r\n            case OperationType.FRAGMENT_ADD:\r\n            case OperationType.FRAGMENT_DELETE:\r\n                data.push({\r\n                    operation: op.type,\r\n                    id: op.frid\r\n                });\r\n                break;\r\n            case OperationType.FRAGMENT_ADD_STEREO_ATOM:\r\n            case OperationType.FRAGMENT_DELETE_STEREO_ATOM:\r\n                data.push({\r\n                    operation: op.type,\r\n                    atomId: op.data.aid,\r\n                    fragId: op.data.frid\r\n                });\r\n                break;\r\n            case OperationType.S_GROUP_ATOM_ADD:\r\n            case OperationType.S_GROUP_ATOM_REMOVE:\r\n                data.push({\r\n                    operation: op.type,\r\n                    atomId: op.data.aid,\r\n                    sGroupId: op.data.sgid\r\n                });\r\n                break;\r\n            case OperationType.S_GROUP_CREATE:\r\n            case OperationType.S_GROUP_DELETE:\r\n                data.push({\r\n                    operation: op.type,\r\n                    type: op.data.type,\r\n                    sGroupId: op.data.sgid\r\n                });\r\n                break;\r\n            case OperationType.RXN_ARROW_ADD:\r\n            case OperationType.RXN_ARROW_DELETE:\r\n                data.push({\r\n                    operation: op.type,\r\n                    id: op.data.id,\r\n                    mode: op.data.mode,\r\n                    position: op.data.pos.map((pos) => ({\r\n                        x: +pos.x.toFixed(2),\r\n                        y: +pos.y.toFixed(2)\r\n                    }))\r\n                });\r\n                break;\r\n            case OperationType.RXN_ARROW_RESIZE:\r\n                data.push({\r\n                    operation: op.type,\r\n                    id: op.data.id\r\n                });\r\n                break;\r\n            case OperationType.RXN_ARROW_MOVE:\r\n                data.push({\r\n                    operation: op.type,\r\n                    id: op.data.id,\r\n                    position: {\r\n                        x: +op.data.d.x.toFixed(2),\r\n                        y: +op.data.d.y.toFixed(2)\r\n                    }\r\n                });\r\n                break;\r\n            case OperationType.R_GROUP_FRAGMENT:\r\n                data.push({\r\n                    operation: operation.type,\r\n                    id: op.frid\r\n                });\r\n                break;\r\n            case OperationType.SIMPLE_OBJECT_ADD:\r\n            case OperationType.SIMPLE_OBJECT_DELETE:\r\n                data.push({\r\n                    operation: op.type,\r\n                    id: op.data.id,\r\n                    mode: op.data.mode\r\n                });\r\n                break;\r\n            case OperationType.SIMPLE_OBJECT_RESIZE:\r\n                data.push({\r\n                    operation: op.type,\r\n                    id: op.data.id\r\n                });\r\n                break;\r\n            case OperationType.SIMPLE_OBJECT_MOVE:\r\n                data.push({\r\n                    operation: operation.type,\r\n                    id: operation.data.id,\r\n                    position: {\r\n                        x: +operation.data.d.x.toFixed(2),\r\n                        y: +operation.data.d.y.toFixed(2)\r\n                    }\r\n                });\r\n                break;\r\n            default:\r\n                data.push({\r\n                    operation: op.type\r\n                });\r\n        }\r\n    });\r\n    return handler(data);\r\n}\r\n//# sourceMappingURL=customOnChangeHandler.js.map","references":["/usr/local/google/home/waich/workspace/ketcher/packages/ketcher-core/dist/index.d.ts"],"map":"{\"version\":3,\"file\":\"customOnChangeHandler.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../src/script/editor/utils/customOnChangeHandler.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/usr/local/google/home/waich/workspace/ketcher/packages/ketcher-react/node_modules/.cache/rollup-plugin-typescript2/placeholder/script/editor/utils/customOnChangeHandler.d.ts","writeByteOrderMark":false,"text":"/****************************************************************************\r\n * Copyright 2021 EPAM Systems\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *    http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n ***************************************************************************/\r\nexport declare function customOnChangeHandler(action: any, handler: any): any;\r\n"}}
