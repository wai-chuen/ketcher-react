{"version":3,"file":"index.modern.js","sources":["../src/script/api.ts","../src/contexts/appContext.tsx","../src/contexts/errorsContext.tsx","../src/contexts/settingsContext.tsx","../src/contexts/formContext.tsx","../src/script/ui/action/atoms.js","../src/script/ui/action/copyAs.js","../src/script/ui/action/copyImageToClipboard.js","../src/script/ui/action/isHidden.ts","../src/script/ui/action/debug.js","../src/script/ui/component/cliparea/cliparea.jsx","../src/script/ui/data/schema/options-schema.ts","../src/script/ui/storage-ext.js","../src/script/ui/state/options/index.js","../src/script/ui/data/schema/schema-helper.js","../src/script/ui/data/schema/sdata-schema.js","../src/script/ui/state/modal/sdata.js","../src/script/ui/state/modal/form.js","../src/script/ui/state/request/request.types.ts","../src/script/ui/state/request/index.ts","../src/script/ui/state/constants.js","../src/script/ui/data/schema/struct-schema.js","../src/script/ui/data/convert/structconv.js","../src/script/ui/action/flips.ts","../src/script/ui/action/tools.js","../src/constants.ts","../src/script/ui/utils/settingsManager.ts","../src/script/ui/state/shared.ts","../src/script/ui/state/server/index.js","../src/script/ui/action/server.js","../src/script/ui/data/templates.js","../src/script/ui/action/templates.js","../src/script/ui/action/zoom.js","../src/script/ui/action/help.js","../src/script/ui/action/functionalGroups.ts","../src/script/ui/action/fullscreen.ts","../src/script/ui/action/index.js","../src/icons/index.tsx","../src/script/ui/component/view/icon.jsx","../src/script/ui/views/toolbars/shortcutStr.ts","../src/script/ui/views/toolbars/ToolbarGroupItem/ActionButton/ActionButton.tsx","../src/script/ui/Portal/Portal.tsx","../src/script/ui/views/toolbars/ToolbarGroupItem/ToolbarMultiToolItem/variants/DefaultMultiTool/DefaultMultiTool.tsx","../src/script/ui/views/toolbars/ToolbarGroupItem/ToolbarMultiToolItem/variants/GroupedMultiTool/GroupedMultiTool.tsx","../src/script/ui/views/toolbars/ToolbarGroupItem/ToolbarMultiToolItem/variants/chooseMultiTool.ts","../src/script/ui/views/toolbars/ToolbarGroupItem/ToolbarMultiToolItem/usePortalOpening.ts","../src/script/ui/views/toolbars/ToolbarGroupItem/ToolbarMultiToolItem/usePortalStyle.ts","../src/script/ui/views/toolbars/ToolbarGroupItem/ToolbarMultiToolItem/ToolbarMultiToolItem.tsx","../src/script/ui/views/toolbars/ToolbarGroupItem/ToolbarGroupItem.tsx","../src/script/ui/views/toolbars/BottomToolbar/TemplatesList/TemplatesList.tsx","../src/script/ui/views/toolbars/BottomToolbar/BottomToolbar.tsx","../src/script/ui/state/templates/init-lib.js","../src/script/ui/state/modal/index.js","../src/script/ui/state/templates/index.js","../src/script/ui/state/action/index.js","../src/script/ui/utils/renderStruct.ts","../src/script/ui/utils/fileOpener.js","../src/script/ui/utils/index.ts","../src/script/editor/utils/functionalGroupsTooltip.ts","../src/script/ui/state/functionalGroups/index.ts","../src/script/ui/state/saltsAndSolvents/index.ts","../src/script/ui/state/toolbar/index.js","../src/script/ui/state/index.js","../src/script/ui/views/toolbars/BottomToolbar/BottomToolbar.container.ts","../src/script/ui/views/toolbars/ToolbarGroupItem/utils/makeItems.ts","../src/script/ui/views/toolbars/LeftToolbar/Bond/options.ts","../src/script/ui/views/toolbars/LeftToolbar/leftToolbarOptions.ts","../src/hooks/useSettingsContext.ts","../src/hooks/useResizeObserver.ts","../src/hooks/useFormContext.tsx","../src/hooks/useAppContext.ts","../src/hooks/useInterval.ts","../src/hooks/useSubscribtionOnEvents.ts","../src/script/ui/views/toolbars/ArrowScroll/ArrowScroll.tsx","../src/script/ui/views/toolbars/mediaSizes.ts","../src/script/ui/views/toolbars/LeftToolbar/Bond/Bond.tsx","../src/script/ui/views/toolbars/LeftToolbar/RGroup/RGroup.tsx","../src/script/ui/views/toolbars/LeftToolbar/Shape/Shape.tsx","../src/script/ui/views/toolbars/LeftToolbar/Transform/Transform.tsx","../src/script/ui/views/toolbars/LeftToolbar/LeftToolbar.tsx","../src/script/ui/views/toolbars/LeftToolbar/LeftToolbar.container.ts","../src/script/ui/component/view/Atom/Atom.jsx","../../../node_modules/color-name/index.js","../../../node_modules/color-parse/index.mjs","../../../node_modules/color-alpha/index.mjs","../src/script/ui/views/toolbars/RightToolbar/AtomsList/AtomsList.tsx","../src/script/ui/views/toolbars/RightToolbar/RightToolbar.tsx","../src/script/ui/views/toolbars/RightToolbar/RightToolbar.container.ts","../src/script/ui/views/toolbars/TopToolbar/IconButton.tsx","../src/script/ui/views/toolbars/TopToolbar/FileControls.tsx","../src/script/ui/views/toolbars/TopToolbar/ElementWithDropdown.tsx","../src/script/ui/views/toolbars/TopToolbar/ClipboardControls.tsx","../src/script/ui/views/toolbars/TopToolbar/Divider.tsx","../src/script/ui/views/toolbars/TopToolbar/UndoRedo.tsx","../src/script/ui/views/toolbars/TopToolbar/ZoomInput.tsx","../src/script/ui/views/toolbars/TopToolbar/ZoomControls.tsx","../src/script/ui/views/toolbars/TopToolbar/SystemControls.tsx","../src/script/ui/views/toolbars/TopToolbar/ExternalFuncControls.tsx","../src/script/ui/views/toolbars/TopToolbar/TopToolbar.tsx","../src/script/ui/views/toolbars/TopToolbar/TopToolbar.container.ts","../src/script/ui/data/convert/keynorm.js","../src/script/editor/tool/apoint.ts","../src/script/editor/shared/utils.js","../src/script/editor/tool/atom.ts","../src/script/editor/tool/attach.ts","../src/script/editor/tool/bond.ts","../src/script/editor/tool/chain.ts","../src/script/editor/tool/charge.ts","../src/script/editor/tool/enhanced-stereo.ts","../src/script/editor/tool/helper/locate.ts","../src/script/editor/tool/helper/lasso.ts","../src/script/editor/tool/sgroup.ts","../src/script/editor/tool/helper/getGroupIdsFromItems.ts","../src/script/editor/tool/helper/dropAndMerge.ts","../src/script/editor/tool/helper/getMergeItems.ts","../src/script/ui/state/modal/atoms.ts","../src/script/editor/utils/canvasExtension.ts","../src/script/editor/tool/select.ts","../src/script/editor/tool/eraser.ts","../src/script/editor/tool/hand.ts","../src/script/editor/tool/paste.ts","../src/script/editor/tool/rgroupatom.ts","../src/script/editor/tool/rgroupfragment.ts","../src/script/editor/tool/reactionarrow.ts","../src/script/editor/tool/reactionmap.ts","../src/script/editor/tool/reactionplus.ts","../src/script/editor/tool/reactionunmap.ts","../src/script/editor/tool/rotate.ts","../src/script/editor/tool/simpleobject.ts","../src/script/editor/tool/template.ts","../src/script/editor/tool/text.ts","../src/script/editor/tool/index.js","../src/script/ui/state/handleHotkeysOverItem.ts","../src/script/ui/state/hotkeys.ts","../src/script/ui/views/AppClipArea.tsx","../src/script/ui/App/AppHidden/AppHidden.tsx","../src/script/ui/App/AppHidden/AppHidden.container.ts","../src/script/ui/views/modal/mediaSizes.ts","../src/script/ui/views/components/Dialog/Dialog.tsx","../src/script/ui/views/components/Spinner/LoadingCircles.tsx","../src/script/editor/shared/closest.js","../src/script/editor/utils/customOnChangeHandler.ts","../src/script/editor/highlighter.ts","../src/script/editor/Editor.ts","../src/script/ui/views/components/Cursor.jsx","../src/script/ui/views/components/ContextMenu/contextMenu.types.ts","../src/script/ui/views/components/ContextMenu/hooks/useAtomEdit.ts","../src/script/ui/views/components/ContextMenu/utils.ts","../src/script/ui/views/components/ContextMenu/hooks/useAtomStereo.ts","../src/script/ui/views/components/ContextMenu/hooks/useDelete.ts","../src/script/ui/views/components/ContextMenu/menuItems/AtomMenuItems.tsx","../src/script/ui/views/components/ContextMenu/hooks/useBondEdit.ts","../src/script/ui/views/components/ContextMenu/hooks/useBondSGroupAttach.ts","../src/script/ui/views/components/ContextMenu/hooks/useBondSGroupEdit.ts","../src/script/ui/views/components/ContextMenu/hooks/useBondTypeChange.ts","../src/script/ui/views/components/ContextMenu/menuItems/BondMenuItems.tsx","../src/script/ui/views/components/ContextMenu/hooks/useFunctionalGroupEoc.ts","../src/script/ui/views/components/ContextMenu/hooks/useFunctionalGroupRemove.ts","../src/script/ui/views/components/ContextMenu/menuItems/FunctionalGroupMenuItems.tsx","../src/script/ui/views/components/ContextMenu/menuItems/SelectionMenuItems.tsx","../src/script/ui/views/components/ContextMenu/ContextMenu.tsx","../src/script/ui/views/components/ContextMenu/ContextMenuTrigger.tsx","../src/script/ui/component/structrender.tsx","../src/script/ui/views/components/StructEditor/helpers.ts","../src/script/ui/views/components/StructEditor/SGroupDataRender.tsx","../src/script/ui/state/functionalGroups/selectors/index.ts","../src/script/ui/views/components/StructEditor/InfoPanel.tsx","../src/script/ui/views/components/StructEditor/StructEditor.jsx","../src/script/ui/views/modal/components/meta/About/About.jsx","../src/script/ui/component/form/form/errorPopover.jsx","../src/script/ui/component/form/input.tsx","../src/script/ui/component/form/Select/Select.tsx","../src/script/ui/component/form/form/form.jsx","../src/script/ui/component/form/colorPicker/ColorPicker.tsx","../src/script/ui/component/form/MeasureInput/measure-input.jsx","../src/script/ui/component/view/openbutton.jsx","../src/script/ui/component/view/savebutton.tsx","../src/script/ui/views/modal/components/meta/Settings/Accordion/Accordion.tsx","../src/script/ui/component/form/systemfonts.jsx","../src/script/ui/views/modal/components/meta/Settings/fieldGroups.js","../src/script/ui/views/modal/components/meta/Settings/Settings.tsx","../src/script/ui/views/modal/components/process/Check/components/ErrorsCheck.jsx","../src/script/ui/views/modal/components/process/Check/Check.jsx","../src/script/ui/views/modal/components/process/Analyse/components/FormulaInput/FormulaInput.jsx","../src/script/ui/views/modal/components/process/Analyse/components/FrozenInput/FrozenInput.jsx","../src/script/ui/views/modal/components/process/Analyse/Analyse.jsx","../src/script/ui/views/modal/components/document/Open/components/DialogActionButton.tsx","../src/script/ui/views/modal/components/process/Recognize/Recognize.jsx","../src/script/ui/views/modal/components/process/Miew/Miew.tsx","../src/script/ui/views/modal/components/toolbox/Atom/ElementNumber/ElementNumber.tsx","../src/script/ui/views/modal/components/toolbox/Atom/Atom.tsx","../src/script/ui/views/modal/components/toolbox/Atom/Atom.container.ts","../src/script/ui/views/modal/components/toolbox/Attach/Attach.tsx","../src/script/ui/views/modal/components/toolbox/Attach/Attach.container.ts","../src/script/ui/views/modal/components/toolbox/Automap/Automap.tsx","../src/script/ui/views/modal/components/toolbox/Automap/Automap.container.ts","../src/script/ui/views/modal/components/toolbox/Bond/Bond.tsx","../src/script/ui/views/modal/components/toolbox/Bond/Bond.container.ts","../src/script/ui/views/modal/components/toolbox/RgroupLogic/components/IfThenSelect/IfThenSelect.tsx","../src/script/ui/views/modal/components/toolbox/RgroupLogic/RgroupLogic.tsx","../src/script/ui/views/modal/components/toolbox/RgroupLogic/RgroupLogic.container.ts","../src/script/ui/views/modal/components/document/Open/components/AnalyzingFile.tsx","../src/script/ui/views/modal/components/document/Open/components/FileDrop.tsx","../src/script/ui/views/modal/components/document/Open/components/OpenOptions.tsx","../src/script/ui/views/modal/components/document/Open/components/TextEditor.tsx","../src/script/ui/views/modal/components/document/Open/components/ViewSwitcher.tsx","../src/script/ui/views/modal/components/document/Open/Open.tsx","../src/script/ui/views/modal/components/document/Open/Open.container.ts","../src/script/ui/data/convert/structConverter.ts","../src/script/ui/component/view/Tabs/Tabs.jsx","../src/script/ui/views/modal/components/document/Save/Save.jsx","../src/script/ui/dialog/toolbox/enhancedStereo/enhancedStereo.tsx","../src/script/ui/dialog/toolbox/labeledit.jsx","../src/script/ui/views/modal/components/PeriodTable/components/AtomInfo/AtomInfo.jsx","../src/script/ui/views/modal/components/PeriodTable/components/ElementsTable/components/Header.jsx","../src/script/ui/views/modal/components/PeriodTable/components/ElementsTable/components/MainRow.jsx","../src/script/ui/views/modal/components/PeriodTable/components/ElementsTable/components/OutinerRow.jsx","../src/script/ui/views/modal/components/PeriodTable/components/ElementsTable/ElementsTable.jsx","../src/script/ui/views/modal/components/ExtendedTable/components/GenericGroups/BoxWithLines.tsx","../src/script/ui/views/modal/components/ExtendedTable/helpers.js","../src/script/ui/views/modal/components/ExtendedTable/components/GenericGroups/GenSet.tsx","../src/script/ui/views/modal/components/ExtendedTable/components/GenericGroups/GenGroup.tsx","../src/script/ui/views/modal/components/ExtendedTable/components/GenericGroups/GenericGroups.tsx","../src/script/ui/views/modal/components/ExtendedTable/components/GenericGroups/index.ts","../src/script/ui/views/modal/components/PeriodTable/components/TypeChoice/TypeChoice.jsx","../src/script/ui/views/modal/components/PeriodTable/PeriodTable.jsx","../src/script/ui/views/modal/components/ExtendedTable/ExtendedTable.jsx","../src/script/ui/views/modal/components/toolbox/FG/RemoveFG.tsx","../src/script/ui/component/form/buttonlist.jsx","../src/script/ui/dialog/toolbox/rgroup/rgroup.jsx","../src/script/ui/dialog/toolbox/SDataFieldset.jsx","../src/script/ui/dialog/toolbox/SGroupFieldset.jsx","../src/script/ui/dialog/toolbox/sgroup.jsx","../src/script/ui/dialog/template/template-attach.jsx","../src/script/ui/dialog/template/TemplateTable.tsx","../src/script/ui/state/saltsAndSolvents/selectors/index.ts","../src/script/ui/dialog/template/EmptySearchResult.tsx","../src/script/ui/dialog/template/useSaltsAndSolvets.ts","../src/script/ui/dialog/template/TemplateDialog.tsx","../src/hooks/useClickOutside.ts","../src/script/ui/views/modal/components/Text/FontControl/FontControl.tsx","../src/script/ui/views/modal/components/Text/SpecialSymbolsList/SpecialSymbolsList.tsx","../src/script/ui/views/modal/components/Text/SpecialSymbols/SpecialSymbolsButton.tsx","../src/script/ui/views/modal/components/Text/TextButton/TextButton.tsx","../src/script/ui/views/modal/components/Text/Text.tsx","../src/script/ui/views/modal/components/Confirm/Confirm.tsx","../src/script/ui/dialog/index.ts","../src/script/ui/views/modal/Modal.tsx","../src/script/ui/views/modal/Modal.container.ts","../src/script/ui/state/editor/index.js","../src/script/ui/views/Editor.jsx","../src/script/ui/App/App.tsx","../src/script/ui/App/App.container.ts","../src/script/ui/App/initApp.tsx","../src/script/builders/ketcher/KetcherBuilder.ts","../src/script/index.ts","../src/Editor.tsx"],"sourcesContent":["/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  InfoResult,\n  StructService,\n  StructServiceOptions,\n  StructServiceProvider\n} from 'ketcher-core'\n\ntype Api = StructService & Promise<InfoResult>\n\n// todo: remove - ?? should we? it's in use\nfunction createApi(\n  structServiceProvider: StructServiceProvider,\n  defaultOptions: StructServiceOptions\n): Api {\n  const structService =\n    structServiceProvider.createStructService(defaultOptions)\n  const info = structService.info()\n\n  return Object.assign(info, {\n    info: structService.info.bind(structService),\n    convert: structService.convert.bind(structService),\n    layout: structService.layout.bind(structService),\n    clean: structService.clean.bind(structService),\n    aromatize: structService.aromatize.bind(structService),\n    dearomatize: structService.dearomatize.bind(structService),\n    calculateCip: structService.calculateCip.bind(structService),\n    automap: structService.automap.bind(structService),\n    check: structService.check.bind(structService),\n    calculate: structService.calculate.bind(structService),\n    recognize: structService.recognize.bind(structService),\n    generateImageAsBase64:\n      structService.generateImageAsBase64.bind(structService),\n    generateInchIKey: structService.generateInchIKey.bind(structService)\n  })\n}\n\nexport default createApi\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Ketcher } from 'ketcher-core'\nimport React from 'react'\n\nexport interface IAppContext {\n  getKetcherInstance: () => Ketcher\n}\n\nconst appContext = React.createContext<IAppContext>({} as IAppContext)\n\nexport default appContext\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport React from 'react'\n\nexport interface IErrorsContext {\n  errorHandler: (message: string) => void\n}\n\nconst errorsContext = React.createContext<IErrorsContext>({} as IErrorsContext)\n\nexport default errorsContext\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport React from 'react'\n\nexport interface ISettingsContext {\n  staticResourcesUrl: string\n}\n\nconst settingsContext = React.createContext<ISettingsContext>(\n  {} as ISettingsContext\n)\n\nexport default settingsContext\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport React from 'react'\n\nconst formContext = React.createContext(null)\n\nexport default formContext\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nexport const basicAtoms = ['H', 'C', 'N', 'O', 'S', 'P', 'F', 'Cl', 'Br', 'I']\n\nexport const atomCuts = {\n  H: 'h',\n  C: 'c',\n  N: 'n',\n  O: 'o',\n  S: 's',\n  P: 'p',\n  F: 'f',\n  Cl: 'Shift+c',\n  Br: 'b',\n  I: 'i',\n  A: 'a',\n  Q: 'q',\n  R: 'r',\n  K: 'k',\n  M: 'm',\n  Si: 'Shift+s',\n  Na: 'Shift+n',\n  X: 'x',\n  D: 'd',\n  B: 'Shift+b'\n}\n\nexport default Object.keys(atomCuts).reduce((res, label) => {\n  res[`atom-${label.toLowerCase()}`] = {\n    title: `Atom ${label}`,\n    shortcut: atomCuts[label],\n    action: {\n      tool: 'atom',\n      opts: { label }\n    }\n  }\n  return res\n}, {})\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { KetSerializer, MolSerializer, SupportedFormat } from 'ketcher-core'\n\nexport default function copyAs(type) {\n  const state = global.currentState\n  const editor = state.editor\n  const struct = editor.structSelected()\n  const errorHandler = editor.errorHandler\n  let serializer\n  try {\n    switch (type) {\n      case 'mol': {\n        serializer = new MolSerializer()\n        break\n      }\n      case 'ket': {\n        serializer = new KetSerializer()\n        break\n      }\n      default: {\n        serializer = new KetSerializer()\n        break\n      }\n    }\n\n    const simpleObjectOrText = Boolean(\n      struct.simpleObjects.size || struct.texts.size\n    )\n\n    if (simpleObjectOrText && serializer instanceof MolSerializer) {\n      errorHandler(\n        'This feature is not available for Simple objects and Text objects'\n      )\n      return null\n    }\n\n    const structData = serializer.serialize(struct)\n\n    if (window.clipboardData) {\n      window.clipboardData.setData('text', structData)\n    } else {\n      navigator.clipboard.writeText(structData)\n    }\n  } catch {\n    errorHandler('This feature is not available in your browser')\n  }\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { FormatterFactory, Ketcher } from 'ketcher-core'\n\nasync function copyImageToClipboard() {\n  const state = global.currentState\n  const editor = state.editor\n  const server = state.server\n  const options = state.options\n  const struct = editor.structSelected()\n  const errorHandler = editor.errorHandler\n\n  try {\n    const factory = new FormatterFactory(server)\n    const service = factory.create('ket', options)\n    const structStr = await service.getStructureFromStructAsync(struct)\n    const ketcher = new Ketcher(editor, server, {}, factory)\n    const image = await ketcher.generateImage(structStr, {\n      outputFormat: 'png',\n      backgroundColor: '255, 255, 255'\n    })\n    const item = new ClipboardItem({ [image.type]: image }) // eslint-disable-line no-undef\n    await navigator.clipboard.write([item])\n  } catch {\n    errorHandler('This feature is not available in your browser')\n  }\n}\n\nexport default copyImageToClipboard\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nexport default function isHidden(options: any, buttonName: string): boolean {\n  return Boolean(options.buttons?.[buttonName]?.hidden)\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { MolSerializer } from 'ketcher-core'\nimport isHidden from './isHidden'\n\nconst debugObj = {\n  // original: for dev purposes\n  'force-update': {\n    shortcut: 'Ctrl+Shift+r',\n    action: (editor) => {\n      editor.update(true)\n    },\n    hidden: (options) => isHidden(options, 'force-update')\n  },\n  'qs-serialize': {\n    shortcut: 'Alt+Shift+r',\n    action: (editor) => {\n      const molSerializer = new MolSerializer()\n      const molStr = molSerializer.serialize(editor.struct())\n      const molQs = 'mol=' + encodeURIComponent(molStr).replace(/%20/g, '+')\n      const qs = document.location.search\n      document.location.search = !qs\n        ? '?' + molQs // eslint-disable-line\n        : qs.search('mol=') === -1\n        ? qs + '&' + molQs\n        : qs.replace(/mol=[^&$]*/, molQs)\n    }\n  },\n  hidden: (options) => isHidden(options, 'qs-serialize')\n}\n\nexport default debugObj\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Component, createRef } from 'react'\nimport clsx from 'clsx'\nimport classes from './cliparea.module.less'\n\nconst ieCb = window.clipboardData\n\nclass ClipArea extends Component {\n  constructor(props) {\n    super(props)\n    this.textAreaRef = createRef()\n  }\n\n  componentDidMount() {\n    const el = this.textAreaRef.current\n    this.target = this.props.target || el.parentNode\n\n    this.listeners = {\n      mouseup: (event) => {\n        if (\n          el === event.target ||\n          (!isActiveElement(event.target) && this.props.focused())\n        ) {\n          autoselect(el)\n        }\n      },\n      mousedown: (event) => {\n        if (event.shiftKey && !isActiveElement(event.target))\n          event.preventDefault()\n      },\n      copy: (event) => {\n        if (this.props.focused() && this.props.onCopy) {\n          const data = this.props.onCopy()\n\n          if (data) copy(event.clipboardData, data)\n\n          event.preventDefault()\n        }\n      },\n      cut: (event) => {\n        if (this.props.focused() && this.props.onCut) {\n          const data = this.props.onCut()\n\n          if (data) copy(event.clipboardData, data)\n\n          event.preventDefault()\n        }\n      },\n      paste: (event) => {\n        if (this.props.focused() && this.props.onPaste) {\n          const data = paste(event.clipboardData, this.props.formats)\n\n          if (data) this.props.onPaste(data)\n\n          event.preventDefault()\n        }\n      }\n    }\n\n    Object.keys(this.listeners).forEach((en) => {\n      this.target.addEventListener(en, this.listeners[en])\n    })\n  }\n\n  shouldComponentUpdate() {\n    return false\n  }\n\n  componentWillUnmount() {\n    Object.keys(this.listeners).forEach((en) => {\n      this.target.removeEventListener(en, this.listeners[en])\n    })\n  }\n\n  render() {\n    return (\n      <textarea\n        ref={this.textAreaRef}\n        className={clsx('cliparea', classes.cliparea)}\n        contentEditable\n        autoFocus // eslint-disable-line jsx-a11y/no-autofocus\n        suppressContentEditableWarning={true}\n      />\n    )\n  }\n}\n\nfunction isActiveElement(el) {\n  if (el.tagName === 'INPUT' && el.type === 'button') return false\n  return ['INPUT', 'SELECT', 'TEXTAREA', 'OPTION', 'LABEL'].includes(el.tagName)\n}\n\nfunction autoselect(cliparea) {\n  cliparea.value = ' '\n  cliparea.select()\n}\n\nfunction copy(cb, data) {\n  if (!cb && ieCb) {\n    ieCb.setData('text', data['text/plain'])\n  } else {\n    let curFmt = null\n    cb.setData('text/plain', data['text/plain'])\n    try {\n      Object.keys(data).forEach((fmt) => {\n        curFmt = fmt\n        cb.setData(fmt, data[fmt])\n      })\n    } catch (ex) {\n      console.info(`Could not write exact type ${curFmt}`)\n    }\n  }\n}\n\nfunction paste(cb, formats) {\n  let data = {}\n  if (!cb && ieCb) {\n    data['text/plain'] = ieCb.getData('text')\n  } else {\n    data['text/plain'] = cb.getData('text/plain')\n    data = formats.reduce((res, fmt) => {\n      const d = cb.getData(fmt)\n      if (d) res[fmt] = d\n      return res\n    }, data)\n  }\n  return data\n}\n\nexport const actions = ['cut', 'copy', 'paste']\n\nexport function exec(action) {\n  let enabled = document.queryCommandSupported(action)\n  if (enabled) {\n    try {\n      enabled = document.execCommand(action) || window.ClipboardEvent || ieCb\n    } catch (ex) {\n      // FF < 41\n      enabled = false\n    }\n  }\n  return enabled\n}\n\nexport default ClipArea\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { StereLabelStyleType, StereoColoringType } from 'ketcher-core'\nimport Ajv, { SchemaObject } from 'ajv'\n\ntype ExtendedSchema = SchemaObject & {\n  enumNames?: Array<string>\n  default?: any\n}\n\nconst editor: {\n  resetToSelect: ExtendedSchema\n  rotationStep: ExtendedSchema\n} = {\n  resetToSelect: {\n    title: 'Reset to Select Tool',\n    enum: [true, 'paste', false],\n    enumNames: ['on', 'After Paste', 'off'],\n    default: 'paste'\n  },\n  rotationStep: {\n    title: 'Rotation Step, º',\n    type: 'integer',\n    minimum: 1,\n    maximum: 90,\n    default: 15\n  }\n}\n\nconst render: {\n  showValenceWarnings: ExtendedSchema\n  atomColoring: ExtendedSchema\n  showStereoFlags: ExtendedSchema\n  stereoLabelStyle: ExtendedSchema\n  colorOfAbsoluteCenters: ExtendedSchema\n  colorOfAndCenters: ExtendedSchema\n  colorOfOrCenters: ExtendedSchema\n  colorStereogenicCenters: ExtendedSchema\n  autoFadeOfStereoLabels: ExtendedSchema\n  absFlagLabel: ExtendedSchema\n  andFlagLabel: ExtendedSchema\n  mixedFlagLabel: ExtendedSchema\n  ignoreChiralFlag: ExtendedSchema\n  orFlagLabel: ExtendedSchema\n  font: ExtendedSchema\n  fontsz: ExtendedSchema\n  fontszsub: ExtendedSchema\n  carbonExplicitly: ExtendedSchema\n  showCharge: ExtendedSchema\n  showValence: ExtendedSchema\n  showHydrogenLabels: ExtendedSchema\n  aromaticCircle: ExtendedSchema\n  doubleBondWidth: ExtendedSchema\n  bondThickness: ExtendedSchema\n  stereoBondWidth: ExtendedSchema\n} = {\n  showValenceWarnings: {\n    title: 'Show valence warnings',\n    type: 'boolean',\n    description: 'slider',\n    default: true\n  },\n  atomColoring: {\n    title: 'Atom coloring',\n    type: 'boolean',\n    description: 'slider',\n    default: true\n  },\n  showStereoFlags: {\n    title: 'Show the Stereo flags',\n    type: 'boolean',\n    description: 'slider',\n    default: true\n  },\n  stereoLabelStyle: {\n    title: 'Label display at\\u00A0stereogenic\\u00A0centers',\n    enum: [\n      StereLabelStyleType.IUPAC,\n      StereLabelStyleType.Classic,\n      StereLabelStyleType.On,\n      StereLabelStyleType.Off\n    ],\n    enumNames: ['IUPAC style', 'Classic', 'On', 'Off'],\n    default: StereLabelStyleType.IUPAC\n  },\n  colorOfAbsoluteCenters: {\n    title: ' Absolute Center color',\n    type: 'string',\n    default: '#ff0000'\n  },\n  colorOfAndCenters: {\n    title: 'AND Centers color',\n    type: 'string',\n    default: '#0000cd'\n  },\n  colorOfOrCenters: {\n    title: 'OR Centers color',\n    type: 'string',\n    default: '#228b22'\n  },\n  colorStereogenicCenters: {\n    title: 'Color stereogenic centers',\n    enum: [\n      StereoColoringType.LabelsOnly,\n      StereoColoringType.BondsOnly,\n      StereoColoringType.LabelsAndBonds,\n      StereoColoringType.Off\n    ],\n    enumNames: ['Labels Only', 'Bonds Only', 'Labels And Bonds', 'Off'],\n    default: StereoColoringType.LabelsOnly\n  },\n  autoFadeOfStereoLabels: {\n    title: 'Auto fade And/Or center labels',\n    type: 'boolean',\n    description: 'slider',\n    default: true\n  },\n  absFlagLabel: {\n    title: 'Text of Absolute flag',\n    type: 'string',\n    default: 'ABS'\n  },\n  andFlagLabel: {\n    title: 'Text of AND flag',\n    type: 'string',\n    default: 'AND Enantiomer'\n  },\n  mixedFlagLabel: {\n    title: 'Text of Mixed flag',\n    type: 'string',\n    default: 'Mixed'\n  },\n  ignoreChiralFlag: {\n    title: 'Ignore the chiral flag',\n    type: 'boolean',\n    description: 'slider',\n    default: false\n  },\n  orFlagLabel: {\n    title: 'Text of OR flag',\n    type: 'string',\n    default: 'OR Enantiomer'\n  },\n  font: {\n    title: 'Font',\n    type: 'string',\n    default: '30px Arial'\n  },\n  fontsz: {\n    title: 'Font size',\n    type: 'integer',\n    default: 13,\n    minimum: 1,\n    maximum: 96\n  },\n  fontszsub: {\n    title: 'Sub font size',\n    type: 'integer',\n    default: 13,\n    minimum: 1,\n    maximum: 96\n  },\n  // Atom\n  carbonExplicitly: {\n    title: 'Display carbon explicitly',\n    type: 'boolean',\n    description: 'slider',\n    default: false\n  },\n  showCharge: {\n    title: 'Display charge',\n    type: 'boolean',\n    description: 'slider',\n    default: true\n  },\n  showValence: {\n    title: 'Display valence',\n    type: 'boolean',\n    description: 'slider',\n    default: true\n  },\n  showHydrogenLabels: {\n    title: 'Show hydrogen labels',\n    enum: ['off', 'Hetero', 'Terminal', 'Terminal and Hetero', 'on'],\n    default: 'on'\n  },\n  // Bonds\n  aromaticCircle: {\n    title: 'Aromatic Bonds as circle',\n    type: 'boolean',\n    description: 'slider',\n    default: true\n  },\n  doubleBondWidth: {\n    title: 'Double bond width',\n    type: 'integer',\n    default: 6,\n    minimum: 1,\n    maximum: 96\n  },\n  bondThickness: {\n    title: 'Bond thickness',\n    type: 'integer',\n    default: 2,\n    minimum: 1,\n    maximum: 96\n  },\n  stereoBondWidth: {\n    title: 'Stereo (Wedge) bond width',\n    type: 'integer',\n    default: 6,\n    minimum: 1,\n    maximum: 96\n  }\n}\n\nconst server: {\n  'smart-layout': ExtendedSchema\n  'ignore-stereochemistry-errors': ExtendedSchema\n  'mass-skip-error-on-pseudoatoms': ExtendedSchema\n  'gross-formula-add-rsites': ExtendedSchema\n  'gross-formula-add-isotopes': ExtendedSchema\n  'dearomatize-on-load': ExtendedSchema\n} = {\n  'dearomatize-on-load': {\n    title: 'dearomatize-on-load',\n    type: 'boolean',\n    description: 'slider',\n    default: false\n  },\n  'smart-layout': {\n    title: 'Smart-layout',\n    type: 'boolean',\n    description: 'slider',\n    default: true\n  },\n  'ignore-stereochemistry-errors': {\n    title: 'Ignore stereochemistry errors',\n    type: 'boolean',\n    description: 'slider',\n    default: true\n  },\n  'mass-skip-error-on-pseudoatoms': {\n    title: 'Ignore pseudoatoms at mass',\n    type: 'boolean',\n    description: 'slider',\n    default: false\n  },\n  'gross-formula-add-rsites': {\n    title: 'Add Rsites at mass calculation',\n    type: 'boolean',\n    description: 'slider',\n    default: true\n  },\n  'gross-formula-add-isotopes': {\n    title: 'Add Isotopes at\\u00A0mass\\u00A0calculation',\n    type: 'boolean',\n    description: 'slider',\n    default: true\n  }\n}\n\nexport const SERVER_OPTIONS = Object.keys(server)\n\nconst debug: {\n  showAtomIds: ExtendedSchema\n  showBondIds: ExtendedSchema\n  showHalfBondIds: ExtendedSchema\n  showLoopIds: ExtendedSchema\n} = {\n  showAtomIds: {\n    title: 'Show atom Ids',\n    type: 'boolean',\n    description: 'slider',\n    default: false\n  },\n  showBondIds: {\n    title: 'Show bonds Ids',\n    type: 'boolean',\n    description: 'slider',\n    default: false\n  },\n  showHalfBondIds: {\n    title: 'Show half bonds Ids',\n    type: 'boolean',\n    description: 'slider',\n    default: false\n  },\n  showLoopIds: {\n    title: 'Show loop Ids',\n    type: 'boolean',\n    description: 'slider',\n    default: false\n  }\n}\n\nconst miew: {\n  miewMode: ExtendedSchema\n  miewTheme: ExtendedSchema\n  miewAtomLabel: ExtendedSchema\n} = {\n  miewMode: {\n    title: 'Display mode',\n    enum: ['LN', 'BS', 'LC'],\n    enumNames: ['Lines', 'Balls and Sticks', 'Licorice'],\n    default: 'LN'\n  },\n  miewTheme: {\n    title: 'Background color',\n    enum: ['light', 'dark'],\n    enumNames: ['Light', 'Dark'],\n    default: 'light'\n  },\n  miewAtomLabel: {\n    title: 'Label coloring',\n    enum: ['no', 'bright', 'blackAndWhite', 'black'],\n    enumNames: ['No', 'Bright', 'Black and White', 'Black'],\n    default: 'bright'\n  }\n}\n\nexport const MIEW_OPTIONS = Object.keys(miew)\n\nconst optionsSchema: ExtendedSchema = {\n  title: 'Settings',\n  type: 'object',\n  required: [],\n  properties: {\n    ...editor,\n    ...render,\n    ...server,\n    ...debug,\n    ...miew\n  }\n}\n\nexport default optionsSchema\n\nexport function getDefaultOptions(): Record<string, any> {\n  if (!optionsSchema.properties) return {}\n\n  return Object.keys(optionsSchema.properties).reduce((res, prop) => {\n    res[prop] = (optionsSchema.properties[prop] as ExtendedSchema).default\n    return res\n  }, {})\n}\n\nexport function validation(settings): Record<string, string> | null {\n  if (typeof settings !== 'object' || settings === null) return null\n\n  const ajv = new Ajv({\n    allErrors: true,\n    keywords: [{ keyword: 'enumNames', schemaType: 'array' }]\n  })\n\n  const validate = ajv.compile(optionsSchema)\n  validate(settings)\n  const errors = validate.errors || []\n  const errorsProps = errors.map((el) => el.instancePath.slice(1))\n\n  return Object.keys(settings).reduce((res, prop) => {\n    if (!optionsSchema.properties) return res\n\n    if (optionsSchema.properties[prop] && errorsProps.indexOf(prop) === -1)\n      res[prop] = settings[prop]\n\n    return res\n  }, {})\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\n/* local storage */\nexport const storage = {\n  warningMessage:\n    'Your changes will be lost after the tab closing. See Help (Note 2).',\n  isAvailable() {\n    try {\n      const storage = global.localStorage\n      return storage\n    } catch (ex) {\n      return false\n    }\n  },\n  getItem(key) {\n    let item = null\n    try {\n      item = JSON.parse(localStorage.getItem(key))\n    } catch (ex) {\n      console.info('LocalStorage:', ex.name)\n    }\n    return item\n  },\n  setItem(key, data) {\n    let isSet = null\n    try {\n      localStorage.setItem(key, JSON.stringify(data))\n      isSet = true\n    } catch (ex) {\n      console.info('LocalStorage:', ex.name)\n      isSet = false\n    }\n    return isSet\n  }\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  SERVER_OPTIONS,\n  getDefaultOptions,\n  validation\n} from '../../data/schema/options-schema'\n\nimport { pick } from 'lodash/fp'\nimport { storage } from '../../storage-ext'\n\nexport const initOptionsState = {\n  app: {\n    server: false,\n    templates: false,\n    functionalGroups: false,\n    saltsAndSolvents: false\n  },\n  analyse: {\n    values: null,\n    roundWeight: 3,\n    roundMass: 3,\n    roundElAnalysis: 1\n  },\n  check: {\n    checkOptions: [\n      'valence',\n      'radicals',\n      'pseudoatoms',\n      'stereo',\n      'query',\n      'overlapping_atoms',\n      'overlapping_bonds',\n      'rgroups',\n      'chiral',\n      '3d',\n      'chiral_flag'\n    ]\n  },\n  recognize: {\n    file: null,\n    structStr: null,\n    fragment: false,\n    version: null\n  },\n  settings: Object.assign(\n    getDefaultOptions(),\n    validation(storage.getItem('ketcher-opts'))\n  ),\n  getServerSettings() {\n    return pick(SERVER_OPTIONS, this.settings)\n  }\n}\n\nexport function appUpdate(data) {\n  return (dispatch) => {\n    dispatch({ type: 'APP_OPTIONS', data })\n    dispatch({ type: 'UPDATE' })\n  }\n}\n\n/* SETTINGS */\nexport function saveSettings(newSettings) {\n  storage.setItem('ketcher-opts', newSettings)\n  return {\n    type: 'SAVE_SETTINGS',\n    data: newSettings\n  }\n}\n\n/* ANALYZE */\nexport function changeRound(roundName, value) {\n  return {\n    type: 'CHANGE_ANALYSE',\n    data: { [roundName]: value }\n  }\n}\n\n/* RECOGNIZE */\nconst recognizeActions = [\n  'SET_RECOGNIZE_STRUCT',\n  'CHANGE_RECOGNIZE_FILE',\n  'CHANGE_IMAGO_VERSION',\n  'IS_FRAGMENT_RECOGNIZE'\n]\n\nexport function setStruct(str) {\n  return {\n    type: 'SET_RECOGNIZE_STRUCT',\n    data: { structStr: str }\n  }\n}\n\nexport function changeVersion(version) {\n  return {\n    type: 'CHANGE_IMAGO_VERSION',\n    data: { version }\n  }\n}\n\nexport function changeImage(file) {\n  return {\n    type: 'CHANGE_RECOGNIZE_FILE',\n    data: {\n      file,\n      structStr: null\n    }\n  }\n}\n\nexport function shouldFragment(isFrag) {\n  return {\n    type: 'IS_FRAGMENT_RECOGNIZE',\n    data: { fragment: isFrag }\n  }\n}\n\n/* CHECK */\nexport function checkOpts(data) {\n  return {\n    type: 'SAVE_CHECK_OPTS',\n    data\n  }\n}\n\n/* REDUCER */\nfunction optionsReducer(state = {}, action) {\n  const { type, data } = action\n\n  if (type === 'APP_OPTIONS')\n    return { ...state, app: { ...state.app, ...data } }\n\n  if (type === 'SAVE_SETTINGS') return { ...state, settings: data }\n\n  if (type === 'SAVE_CHECK_OPTS') return { ...state, check: data }\n\n  if (type === 'CHANGE_ANALYSE')\n    return { ...state, analyse: { ...state.analyse, ...data, loading: false } }\n\n  if (type === 'ANALYSE_LOADING')\n    return { ...state, analyse: { ...state.analyse, loading: true } }\n\n  if (recognizeActions.includes(type))\n    return { ...state, recognize: { ...state.recognize, ...data } }\n  return state\n}\n\nexport default optionsReducer\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\n/* schema utils */\nfunction constant(schema, prop) {\n  const desc = schema.properties[prop]\n  return desc.constant || desc.enum[0] // see https://git.io/v6hyP\n}\n\nexport function mapOf(schema, prop) {\n  console.assert(schema.oneOf)\n  return schema.oneOf.reduce((res, desc) => {\n    res[constant(desc, prop)] = desc\n    return res\n  }, {})\n}\n\nexport function selectListOf(schema, prop) {\n  const desc = schema.properties && schema.properties[prop]\n  if (desc) {\n    return desc.enum.map((value, i) => {\n      const title = desc.enumNames && desc.enumNames[i]\n      return title ? { title, value } : value\n    })\n  }\n  return schema.oneOf.map((ds) =>\n    !ds.title\n      ? constant(ds, prop)\n      : {\n          title: ds.title,\n          value: constant(ds, prop)\n        }\n  )\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { mapOf } from './schema-helper'\n\nconst radioButtonsSchema = {\n  enum: ['Absolute', 'Relative', 'Attached'],\n  default: 'Absolute'\n}\n\nconst contextSchema = {\n  title: 'Context',\n  enum: ['Fragment', 'Multifragment', 'Bond', 'Atom', 'Group'],\n  default: 'Fragment'\n}\n\nconst sData = {\n  Fragment: {\n    title: 'Fragment',\n    type: 'Object',\n    oneOf: [\n      {\n        key: 'FRG_STR',\n        title: 'MDLBG_FRAGMENT_STEREO',\n        type: 'object',\n        properties: {\n          type: { enum: ['DAT'] },\n          fieldName: {\n            title: 'Field name',\n            enum: ['MDLBG_FRAGMENT_STEREO'],\n            default: 'MDLBG_FRAGMENT_STEREO'\n          },\n          fieldValue: {\n            title: 'Field value',\n            enum: [\n              'abs',\n              '(+)-enantiomer',\n              '(-)-enantiomer',\n              'racemate',\n              'steric',\n              'rel',\n              'R(a)',\n              'S(a)',\n              'R(p)',\n              'S(p)'\n            ],\n            default: 'abs'\n          },\n          radiobuttons: radioButtonsSchema\n        },\n        required: ['fieldName', 'fieldValue', 'radiobuttons']\n      },\n      {\n        key: 'FRG_COEFF',\n        title: 'MDLBG_FRAGMENT_COEFFICIENT',\n        type: 'object',\n        properties: {\n          type: { enum: ['DAT'] },\n          fieldName: {\n            title: 'Field name',\n            enum: ['MDLBG_FRAGMENT_COEFFICIENT'],\n            default: 'MDLBG_FRAGMENT_COEFFICIENT'\n          },\n          fieldValue: {\n            title: 'Field value',\n            type: 'string',\n            default: '',\n            minLength: 1,\n            invalidMessage: 'Please, specify field value'\n          },\n          radiobuttons: radioButtonsSchema\n        },\n        required: ['fieldName', 'fieldValue', 'radiobuttons']\n      },\n      {\n        key: 'FRG_CHRG',\n        title: 'MDLBG_FRAGMENT_CHARGE',\n        type: 'object',\n        properties: {\n          type: { enum: ['DAT'] },\n          fieldName: {\n            title: 'Field name',\n            enum: ['MDLBG_FRAGMENT_CHARGE'],\n            default: 'MDLBG_FRAGMENT_CHARGE'\n          },\n          fieldValue: {\n            title: 'Field value',\n            type: 'string',\n            default: '',\n            minLength: 1,\n            invalidMessage: 'Please, specify field value'\n          },\n          radiobuttons: radioButtonsSchema\n        },\n        required: ['fieldName', 'fieldValue', 'radiobuttons']\n      },\n      {\n        key: 'FRG_RAD',\n        title: 'MDLBG_FRAGMENT_RADICALS',\n        type: 'object',\n        properties: {\n          type: { enum: ['DAT'] },\n          fieldName: {\n            title: 'Field name',\n            enum: ['MDLBG_FRAGMENT_RADICALS'],\n            default: 'MDLBG_FRAGMENT_RADICALS'\n          },\n          fieldValue: {\n            title: 'Field value',\n            type: 'string',\n            default: '',\n            minLength: 1,\n            invalidMessage: 'Please, specify field value'\n          },\n          radiobuttons: radioButtonsSchema\n        },\n        required: ['fieldName', 'fieldValue', 'radiobuttons']\n      }\n    ]\n  },\n  Multifragment: {\n    title: 'Multifragment',\n    type: 'Object',\n    oneOf: [\n      {\n        key: 'MLT_FRG',\n        title: 'KETCHER_MULTIPLE_FRAGMENT',\n        type: 'object',\n        properties: {\n          type: { enum: ['DAT'] },\n          fieldName: {\n            title: 'Field name',\n            enum: ['KETCHER_MULTIPLE_FRAGMENT'],\n            default: 'KETCHER_MULTIPLE_FRAGMENT'\n          },\n          fieldValue: {\n            title: 'Field value',\n            enum: [\n              'aerosol',\n              'alloy',\n              'catenane',\n              'complex',\n              'composite',\n              'co-polymer',\n              'emulsion',\n              'host-guest complex',\n              'mixture',\n              'rotaxane',\n              'suspension'\n            ],\n            default: 'aerosol'\n          },\n          radiobuttons: radioButtonsSchema\n        },\n        required: ['fieldName', 'fieldValue', 'radiobuttons']\n      }\n    ]\n  },\n  Bond: {\n    title: 'Bond',\n    type: 'Object',\n    oneOf: [\n      {\n        key: 'SB_STR',\n        title: 'MDLBG_STEREO_KEY',\n        type: 'object',\n        properties: {\n          type: { enum: ['DAT'] },\n          fieldName: {\n            title: 'Field name',\n            enum: ['MDLBG_STEREO_KEY'],\n            default: 'MDLBG_STEREO_KEY'\n          },\n          fieldValue: {\n            title: 'Field value',\n            enum: [\n              'erythro',\n              'threo',\n              'alpha',\n              'beta',\n              'endo',\n              'exo',\n              'anti',\n              'syn',\n              'ECL',\n              'STG'\n            ],\n            default: 'erythro'\n          },\n          radiobuttons: radioButtonsSchema\n        },\n        required: ['fieldName', 'fieldValue', 'radiobuttons']\n      },\n      {\n        key: 'SB_BND',\n        title: 'MDLBG_BOND_KEY',\n        type: 'object',\n        properties: {\n          type: { enum: ['DAT'] },\n          fieldName: {\n            title: 'Field name',\n            enum: ['MDLBG_BOND_KEY'],\n            default: 'MDLBG_BOND_KEY'\n          },\n          fieldValue: {\n            title: 'Field value',\n            enum: ['Value=4'],\n            default: 'Value=4'\n          },\n          radiobuttons: radioButtonsSchema\n        },\n        required: ['fieldName', 'fieldValue', 'radiobuttons']\n      }\n    ]\n  },\n  Atom: {\n    title: 'Atom',\n    type: 'Object',\n    oneOf: [\n      {\n        key: 'AT_STR',\n        title: 'MDLBG_STEREO_KEY',\n        type: 'object',\n        properties: {\n          type: { enum: ['DAT'] },\n          fieldName: {\n            title: 'Field name',\n            enum: ['MDLBG_STEREO_KEY'],\n            default: 'MDLBG_STEREO_KEY'\n          },\n          fieldValue: {\n            title: 'Field value',\n            enum: [\n              'RS',\n              'SR',\n              'P-3',\n              'P-3-PI',\n              'SP-4',\n              'SP-4-PI',\n              'T-4',\n              'T-4-PI',\n              'SP-5',\n              'SP-5-PI',\n              'TB-5',\n              'TB-5-PI',\n              'OC-6',\n              'TP-6',\n              'PB-7',\n              'CU-8',\n              'SA-8',\n              'DD-8',\n              'HB-9',\n              'TPS-9'\n            ],\n            default: 'RS'\n          },\n          radiobuttons: radioButtonsSchema\n        },\n        required: ['fieldName', 'fieldValue', 'radiobuttons']\n      }\n    ]\n  },\n  Group: {\n    title: 'Group',\n    type: 'Object',\n    oneOf: [\n      {\n        key: 'GRP_STR',\n        title: 'MDLBG_STEREO_KEY',\n        type: 'object',\n        properties: {\n          type: { enum: ['DAT'] },\n          fieldName: {\n            title: 'Field name',\n            enum: ['MDLBG_STEREO_KEY'],\n            default: 'MDLBG_STEREO_KEY'\n          },\n          fieldValue: {\n            title: 'Field value',\n            enum: ['cis', 'trans'],\n            default: 'cis'\n          },\n          radiobuttons: radioButtonsSchema\n        },\n        required: ['fieldName', 'fieldValue', 'radiobuttons']\n      }\n    ]\n  }\n}\n\nexport const sdataCustomSchema = {\n  key: 'Custom',\n  title: 'Data',\n  type: 'object',\n  properties: {\n    type: { enum: ['DAT'] },\n    context: {\n      title: 'Context',\n      enum: ['Atom', 'Bond', 'Fragment', 'Group', 'Multifragment'],\n      default: 'Fragment'\n    },\n    fieldName: {\n      title: 'Field name',\n      type: 'string',\n      default: '',\n      minLength: 1,\n      invalidMessage: 'Please, specify field name'\n    },\n    fieldValue: {\n      title: 'Field value',\n      type: 'string',\n      default: '',\n      minLength: 1,\n      invalidMessage: 'Please, specify field value'\n    },\n    radiobuttons: {\n      enum: ['Absolute', 'Relative', 'Attached'],\n      default: 'Absolute'\n    }\n  },\n  required: ['context', 'fieldName', 'fieldValue', 'radiobuttons']\n}\n\nexport const sdataSchema = Object.keys(sData).reduce((acc, title) => {\n  acc[title] = mapOf(sData[title], 'fieldName')\n  Object.keys(acc[title]).forEach((fieldName) => {\n    acc[title][fieldName].properties.context = contextSchema\n  })\n  return acc\n}, {})\n\n/**\n * Returns first key of passed object\n * @param obj { object }\n */\nfunction firstKeyOf(obj) {\n  return Object.keys(obj)[0]\n}\n\n/**\n * Returns schema default values. Depends on passed arguments:\n * pass schema only -> returns default context\n * pass schema & context -> returns default fieldName\n * pass schema & context & fieldName -> returns default fieldValue\n * @param context? { string }\n * @param fieldName? { string }\n * @returns { string }\n */\nexport function getSdataDefault(schema = sdataSchema, context, fieldName) {\n  if (schema.key === 'Custom') {\n    return schema.properties[context]?.default\n  }\n\n  if (!context && !fieldName) return firstKeyOf(schema)\n\n  if (!fieldName) return firstKeyOf(schema[context])\n\n  return schema[context][fieldName]\n    ? schema[context][fieldName].properties.fieldValue.default\n    : ''\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  getSdataDefault,\n  sdataSchema,\n  sdataCustomSchema\n} from '../../data/schema/sdata-schema'\n\nexport const initSdata = (schema) => {\n  const isCustomShema = schema.key === 'Custom'\n\n  const context = isCustomShema\n    ? getSdataDefault(sdataCustomSchema, 'context')\n    : getSdataDefault(sdataSchema)\n  const fieldName = isCustomShema\n    ? getSdataDefault(sdataCustomSchema, 'fieldName')\n    : getSdataDefault(sdataSchema, context)\n  const fieldValue = isCustomShema\n    ? getSdataDefault(sdataCustomSchema, 'fieldValue')\n    : getSdataDefault(sdataSchema, context, fieldName)\n  const radiobuttons = 'Absolute'\n\n  return {\n    errors: {},\n    valid: true,\n    result: {\n      context,\n      fieldName,\n      fieldValue,\n      radiobuttons,\n      type: 'DAT'\n    }\n  }\n}\n\nexport function sdataReducer(state, action) {\n  if (action.data.result.init) {\n    return correctErrors(\n      {\n        ...state,\n        result: Object.assign({}, state.result, action.data.result)\n      },\n      action.data\n    )\n  }\n\n  const actionContext = action.data.result.context\n  const actionFieldName = action.data.result.fieldName\n\n  let newstate = null\n\n  if (actionContext !== state.result.context)\n    newstate = onContextChange(state, action.data.result)\n  else if (actionFieldName !== state.result.fieldName)\n    newstate = onFieldNameChange(state, action.data.result)\n\n  newstate = newstate || {\n    ...state,\n    result: Object.assign({}, state.result, action.data.result)\n  }\n\n  return correctErrors(newstate, action.data)\n}\n\nconst correctErrors = (state, payload) => {\n  const { valid, errors } = payload\n  const { fieldName, fieldValue } = state.result\n\n  return {\n    result: state.result,\n    valid: valid && !!fieldName && !!fieldValue,\n    errors\n  }\n}\n\nconst onContextChange = (state, payload) => {\n  const { context, fieldValue } = payload\n\n  const fieldName = getSdataDefault(sdataCustomSchema, 'fieldName')\n\n  let fValue = fieldValue\n  if (fValue === state.result.fieldValue)\n    fValue = getSdataDefault(sdataCustomSchema, 'fieldValue')\n\n  return {\n    result: {\n      ...payload,\n      context,\n      fieldName,\n      fieldValue: fValue\n    }\n  }\n}\n\nconst onFieldNameChange = (state, payload) => {\n  const { fieldName } = payload\n\n  const context = state.result.context\n\n  let fieldValue = payload.fieldValue\n\n  if (sdataSchema[context][fieldName])\n    fieldValue = getSdataDefault(sdataSchema, context, fieldName)\n\n  if (\n    fieldValue === state.result.fieldValue &&\n    sdataSchema[context][state.result.fieldName]\n  )\n    fieldValue = ''\n\n  return {\n    result: {\n      ...payload,\n      fieldName,\n      fieldValue\n    }\n  }\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { initSdata, sdataReducer } from './sdata'\n\nimport { getDefaultOptions } from '../../data/schema/options-schema'\nimport { sdataCustomSchema } from '../../data/schema/sdata-schema'\n\nexport const formsState = {\n  // TODO: create from schema.{smth}.defaultValue\n  // TODO: change validation method, no 'valid:true' props as default\n  atomProps: {\n    errors: {},\n    valid: true,\n    result: {\n      label: '',\n      charge: 0,\n      explicitValence: -1,\n      hCount: 0,\n      invRet: 0,\n      isotope: 0,\n      radical: 0,\n      ringBondCount: 0,\n      substitutionCount: 0\n    }\n  },\n  attachmentPoints: {\n    errors: {},\n    valid: true,\n    result: {\n      primary: false,\n      secondary: false\n    }\n  },\n  automap: {\n    errors: {},\n    valid: true,\n    result: {\n      mode: 'discard'\n    }\n  },\n  bondProps: {\n    errors: {},\n    valid: true,\n    result: {\n      type: 'single',\n      topology: 0,\n      center: 0\n    }\n  },\n  check: {\n    errors: {},\n    moleculeErrors: {}\n  },\n  labelEdit: {\n    errors: {},\n    valid: true,\n    result: {\n      label: ''\n    }\n  },\n  rgroup: {\n    errors: {},\n    valid: true,\n    result: {\n      values: []\n    }\n  },\n  rgroupLogic: {\n    errors: {},\n    valid: true,\n    result: {\n      ifthen: 0,\n      range: '>0',\n      resth: false\n    }\n  },\n  save: {\n    errors: {},\n    valid: true,\n    result: {\n      filename: 'ketcher',\n      format: 'mol'\n    }\n  },\n  settings: {\n    errors: {},\n    valid: true,\n    result: getDefaultOptions()\n  },\n  text: {\n    errors: {},\n    valid: true,\n    result: {}\n  },\n  attach: {\n    errors: {},\n    valid: true,\n    result: {}\n  },\n  sgroup: initSdata(sdataCustomSchema)\n}\n\nexport function updateFormState(data) {\n  return {\n    type: 'UPDATE_FORM',\n    data\n  }\n}\n\nexport function checkErrors(errors) {\n  return {\n    type: 'UPDATE_FORM',\n    data: { moleculeErrors: errors }\n  }\n}\n\nexport function setDefaultSettings() {\n  return {\n    type: 'UPDATE_FORM',\n    data: {\n      result: getDefaultOptions(sdataCustomSchema),\n      valid: true,\n      errors: {}\n    }\n  }\n}\n\nexport function formReducer(state, action) {\n  const newType = action.data?.result?.type\n  if (newType === 'DAT') return sdataReducer(state, action)\n\n  return Object.assign({}, state, action.data)\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nexport const INDIGO_VERIFICATION = 'INDIGO_VERIFICATION'\nexport const ANALYZING_FILE = 'ANALYZING_FILE'\n\nexport interface RequestState {\n  indigoVerification: boolean\n  isAnalyzingFile: boolean\n}\n\ninterface IndigoVerificationAction {\n  type: string\n  data: boolean\n}\n\nexport type RequestActionTypes = IndigoVerificationAction\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  INDIGO_VERIFICATION,\n  ANALYZING_FILE,\n  RequestActionTypes,\n  RequestState\n} from './request.types'\n\nexport function indigoVerification(data: boolean): RequestActionTypes {\n  return {\n    type: INDIGO_VERIFICATION,\n    data\n  }\n}\n\nexport function setAnalyzingFile(data: boolean): RequestActionTypes {\n  return {\n    type: ANALYZING_FILE,\n    data\n  }\n}\n\nconst initialState = {\n  indigoVerification: false,\n  isAnalyzingFile: false\n}\n\nexport default function (\n  state = initialState,\n  action: RequestActionTypes\n): RequestState {\n  const { type, data } = action\n\n  switch (type) {\n    case INDIGO_VERIFICATION: {\n      return {\n        ...state,\n        indigoVerification: data\n      }\n    }\n    case ANALYZING_FILE: {\n      return {\n        ...state,\n        isAnalyzingFile: data\n      }\n    }\n    default:\n      return state\n  }\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nexport const supportedSGroupTypes = {\n  MUL: 'MUL',\n  SRU: 'SRU',\n  SUP: 'SUP',\n  DAT: 'DAT'\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { mapOf } from './schema-helper'\nimport { range } from 'lodash/fp'\nimport { sdataCustomSchema } from './sdata-schema'\n\nexport const atom = {\n  title: 'Atom',\n  type: 'object',\n  required: ['label'],\n  properties: {\n    label: {\n      title: 'Label',\n      type: 'string', // TODO:should really be enum of elements\n      maxLength: 3,\n      invalidMessage: 'Wrong label'\n    },\n    alias: {\n      title: 'Alias',\n      type: 'string',\n      invalidMessage: 'Leading and trailing spaces are not allowed'\n    },\n    charge: {\n      title: 'Charge',\n      type: 'string',\n      pattern: '^([+-]?)([0-9]{1,3}|1000)([+-]?)$',\n      maxLength: 5,\n      default: '0',\n      invalidMessage: 'Invalid charge value'\n    },\n    explicitValence: {\n      title: 'Valence',\n      enum: [-1, 0, 1, 2, 3, 4, 5, 6, 7, 8],\n      enumNames: ['', '0', 'I', 'II', 'III', 'IV', 'V', 'VI', 'VII', 'VIII'],\n      default: -1\n    },\n    isotope: {\n      title: 'Isotope',\n      type: 'integer',\n      minimum: 0,\n      default: 0,\n      invalidMessage: 'There must be integer'\n    },\n    radical: {\n      title: 'Radical',\n      enum: [0, 2, 1, 3],\n      enumNames: [\n        '',\n        'Monoradical',\n        'Diradical (singlet)',\n        'Diradical (triplet)'\n      ],\n      default: 0\n    },\n    ringBondCount: {\n      title: 'Ring bond count',\n      enum: [0, -2, -1, 2, 3, 4],\n      enumNames: ['', 'As drawn', '0', '2', '3', '4'],\n      default: 0\n    },\n    hCount: {\n      title: 'H count',\n      enum: [0, 1, 2, 3, 4, 5],\n      enumNames: ['', '0', '1', '2', '3', '4'],\n      default: 0\n    },\n    substitutionCount: {\n      title: 'Substitution count',\n      enum: [0, -2, -1, 1, 2, 3, 4, 5, 6],\n      enumNames: ['', 'As drawn', '0', '1', '2', '3', '4', '5', '6'],\n      default: 0\n    },\n    unsaturatedAtom: {\n      title: 'Unsaturated',\n      type: 'boolean',\n      default: false\n    },\n    invRet: {\n      title: 'Inversion',\n      enum: [0, 1, 2],\n      enumNames: ['', 'Inverts', 'Retains'],\n      default: 0\n    },\n    exactChangeFlag: {\n      title: 'Exact change',\n      type: 'boolean',\n      default: false\n    }\n  }\n}\n\nexport const rgroupSchema = {\n  title: 'R-group',\n  type: 'object',\n  properties: {\n    values: {\n      type: 'array',\n      items: {\n        type: 'string',\n        enum: range(1, 33),\n        enumNames: range(1, 33).map((item) => 'R' + item)\n      }\n    }\n  }\n}\n\nexport const labelEdit = {\n  title: 'Label Edit',\n  type: 'object',\n  required: ['label'],\n  properties: {\n    label: {\n      title: 'Atom',\n      default: '',\n      invalidMessage: 'Wrong atom symbol',\n      type: 'string'\n    }\n  }\n}\n\nexport const attachmentPoints = {\n  title: 'Attachment Points',\n  type: 'object',\n  properties: {\n    primary: {\n      title: 'Primary attachment point',\n      type: 'boolean'\n    },\n    secondary: {\n      title: 'Secondary attachment point',\n      type: 'boolean'\n    }\n  }\n}\n\nexport const bond = {\n  title: 'Bond',\n  type: 'object',\n  required: ['type'],\n  properties: {\n    type: {\n      title: 'Type',\n      enum: [\n        'single',\n        'up',\n        'down',\n        'updown',\n        'double',\n        'crossed',\n        'triple',\n        'aromatic',\n        'any',\n        'hydrogen',\n        'singledouble',\n        'singlearomatic',\n        'doublearomatic',\n        'dative'\n      ],\n      enumNames: [\n        'Single',\n        'Single Up',\n        'Single Down',\n        'Single Up/Down',\n        'Double',\n        'Double Cis/Trans',\n        'Triple',\n        'Aromatic',\n        'Any',\n        'Hydrogen',\n        'Single/Double',\n        'Single/Aromatic',\n        'Double/Aromatic',\n        'Dative'\n      ],\n      default: 'single'\n    },\n    topology: {\n      title: 'Topology',\n      enum: [0, 1, 2],\n      enumNames: ['Either', 'Ring', 'Chain'],\n      default: 0\n    },\n    center: {\n      title: 'Reacting Center',\n      enum: [0, -1, 1, 2, 4, 8, 12], // 5, 9, 13\n      enumNames: [\n        'Unmarked',\n        'Not center',\n        'Center',\n        'No change',\n        'Made/broken',\n        'Order changes',\n        'Made/broken and changes'\n      ], // \"Order changes\" x 3\n      default: 0\n    }\n  }\n}\n\nconst sgroup = {\n  title: 'SGroup',\n  type: 'object',\n  required: ['type'],\n  oneOf: [\n    {\n      ...sdataCustomSchema\n    },\n    {\n      key: 'MUL',\n      title: 'Multiple group',\n      type: 'object',\n      properties: {\n        type: { enum: ['MUL'] },\n        mul: {\n          title: 'Repeat count',\n          type: 'integer',\n          default: 1,\n          minimum: 1\n        }\n      },\n      required: ['mul']\n    },\n    {\n      key: 'SRU',\n      title: 'SRU polymer',\n      type: 'object',\n      properties: {\n        type: { enum: ['SRU'] },\n        subscript: {\n          title: 'Polymer label',\n          type: 'string',\n          default: 'n',\n          pattern: '^[a-zA-Z]$',\n          invalidMessage: 'SRU subscript should consist of a single letter'\n        },\n        connectivity: {\n          title: 'Repeat Pattern',\n          enum: ['ht', 'hh', 'eu'],\n          enumNames: ['Head-to-tail', 'Head-to-head', 'Either unknown'],\n          default: 'ht'\n        }\n      },\n      required: ['subscript', 'connectivity']\n    },\n    {\n      key: 'SUP',\n      title: 'Superatom',\n      type: 'object',\n      properties: {\n        type: { enum: ['SUP'] },\n        name: {\n          title: 'Name',\n          type: 'string',\n          default: '',\n          minLength: 1,\n          invalidMessage: 'Please, provide a name for the superatom'\n        }\n      },\n      required: ['name']\n    }\n  ]\n}\nexport const sgroupMap = mapOf(sgroup, 'type')\n\nexport const rgroupLogic = {\n  title: 'R-Group',\n  type: 'object',\n  properties: {\n    range: {\n      title: 'Occurrence',\n      type: 'string',\n      maxLength: 50,\n      invalidMessage: 'Wrong value'\n    },\n    resth: {\n      title: 'RestH',\n      type: 'boolean'\n    },\n    ifthen: {\n      title: 'Condition',\n      type: 'integer',\n      minium: 0\n    }\n  }\n}\n\nexport const textSchema = {\n  title: 'Text Edit',\n  type: 'object',\n  required: ['label'],\n  properties: {\n    label: {\n      default: '',\n      type: 'string'\n    }\n  }\n}\n\nexport const attachSchema = {\n  title: 'Template edit',\n  type: 'object',\n  required: ['name'],\n  properties: {\n    name: {\n      title: 'Molecule name',\n      type: 'string',\n      minLength: 1,\n      maxLength: 128,\n      invalidMessage:\n        'Template must have a unique name and no more than 128 symbols in length'\n    }\n  }\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { AtomList, Bond, Elements, StereoLabel } from 'ketcher-core'\n\nimport { atom as atomSchema } from '../schema/struct-schema'\nimport { capitalize } from 'lodash/fp'\nimport {\n  sdataSchema,\n  getSdataDefault,\n  sdataCustomSchema\n} from '../schema/sdata-schema'\n\nconst DefaultStereoGroupNumber = 1\n\nexport function fromElement(selem) {\n  if (selem.label === 'R#') {\n    return {\n      type: 'rlabel',\n      values: fromRlabel(selem.rglabel),\n      ...selem\n    }\n  }\n  if (selem.label === 'L#') return fromAtomList(selem)\n\n  if (Elements.get(selem.label)) return fromAtom(selem)\n\n  if (!selem.label && 'attpnt' in selem) return { ap: fromApoint(selem.attpnt) }\n\n  return selem // probably generic\n}\n\nexport function toElement(elem) {\n  if (elem.type === 'rlabel') {\n    return {\n      label: elem.values.length ? 'R#' : 'C',\n      rglabel: elem.values.length === 0 ? null : toRlabel(elem.values)\n    }\n  }\n  if (elem.type === 'list' || elem.type === 'not-list') return toAtomList(elem)\n\n  if (!elem.label && 'ap' in elem) return { attpnt: toApoint(elem.ap) }\n\n  if (Elements.get(capitalize(elem.label))) return toAtom(elem)\n\n  if (\n    elem.label === 'A' ||\n    elem.label === '*' ||\n    elem.label === 'Q' ||\n    elem.label === 'X' ||\n    elem.label === 'R'\n  ) {\n    elem.pseudo = elem.label\n    return toAtom(elem)\n  }\n\n  return elem\n}\n\nexport function fromAtom(satom) {\n  const alias = satom.alias || ''\n  const charge = satom.charge.toString()\n\n  return {\n    alias,\n    label: satom.label,\n    charge,\n    isotope: satom.isotope,\n    explicitValence: satom.explicitValence,\n    radical: satom.radical,\n    invRet: satom.invRet,\n    exactChangeFlag: !!satom.exactChangeFlag,\n    ringBondCount: satom.ringBondCount,\n    substitutionCount: satom.substitutionCount,\n    unsaturatedAtom: !!satom.unsaturatedAtom,\n    hCount: satom.hCount,\n    stereoParity: satom.stereoParity\n  }\n}\n\nexport function toAtom(atom) {\n  // TODO merge this to Atom.attrlist?\n  //      see ratomtool\n  const chargeRegexp = new RegExp(atomSchema.properties.charge.pattern)\n  const pch = chargeRegexp.exec(atom.charge)\n  const charge = pch ? parseInt(pch[1] + pch[3] + pch[2]) : atom.charge\n\n  const conv = Object.assign({}, atom, {\n    label: capitalize(atom.label),\n    alias: atom.alias || null,\n    exactChangeFlag: +(atom.exactChangeFlag ?? false),\n    unsaturatedAtom: +(atom.unsaturatedAtom ?? false)\n  })\n  if (charge !== undefined) conv.charge = charge\n  return conv\n}\n\nfunction fromAtomList(satom) {\n  return {\n    type: satom.atomList.notList ? 'not-list' : 'list',\n    values: satom.atomList.ids.map((i) => Elements.get(i).label)\n  }\n}\n\nfunction toAtomList(atom) {\n  return {\n    pseudo: null,\n    label: 'L#',\n    atomList: new AtomList({\n      notList: atom.type === 'not-list',\n      ids: atom.values.map((el) => Elements.get(el).number)\n    })\n  }\n}\n\nexport function fromStereoLabel(stereoLabel) {\n  if (stereoLabel === null) return { type: null }\n  const type = stereoLabel.match(/\\D+/g)[0]\n  const number = +stereoLabel.replace(type, '')\n\n  if (type === StereoLabel.Abs) {\n    return {\n      type: stereoLabel,\n      orNumber: DefaultStereoGroupNumber,\n      andNumber: DefaultStereoGroupNumber\n    }\n  }\n\n  if (type === StereoLabel.And) {\n    return {\n      type: type,\n      orNumber: DefaultStereoGroupNumber,\n      andNumber: number\n    }\n  }\n\n  if (type === StereoLabel.Or) {\n    return {\n      type: type,\n      orNumber: number,\n      andNumber: DefaultStereoGroupNumber\n    }\n  }\n}\n\nexport function toStereoLabel(stereoLabel) {\n  switch (stereoLabel.type) {\n    case StereoLabel.And:\n      return `${StereoLabel.And}${stereoLabel.andNumber || 1}`\n\n    case StereoLabel.Or:\n      return `${StereoLabel.Or}${stereoLabel.orNumber || 1}`\n\n    default:\n      return stereoLabel.type\n  }\n}\n\nfunction fromApoint(sap) {\n  return {\n    primary: ((sap || 0) & 1) > 0,\n    secondary: ((sap || 0) & 2) > 0\n  }\n}\n\nfunction toApoint(ap) {\n  return (ap.primary && 1) + (ap.secondary && 2)\n}\n\nfunction fromRlabel(rg) {\n  const res = []\n  let rgi\n  let val\n  for (rgi = 0; rgi < 32; rgi++) {\n    if (rg & (1 << rgi)) {\n      val = rgi + 1\n      res.push(val) // push the string\n    }\n  }\n  return res\n}\n\nfunction toRlabel(values) {\n  let res = 0\n  values.forEach((val) => {\n    const rgi = val - 1\n    res |= 1 << rgi\n  })\n  return res\n}\n\nexport function fromBond(sbond) {\n  const type = sbond.type\n  const stereo = sbond.stereo\n  return {\n    type: fromBondType(type, stereo),\n    topology: sbond.topology || 0,\n    center: sbond.reactingCenterStatus || 0\n  }\n}\n\nexport function toBond(bond) {\n  return {\n    topology: bond.topology,\n    reactingCenterStatus: bond.center,\n    ...toBondType(bond.type)\n  }\n}\n\nexport function toBondType(caption) {\n  return Object.assign({}, bondCaptionMap[caption])\n}\n\nfunction fromBondType(type, stereo) {\n  for (const caption in bondCaptionMap) {\n    if (\n      bondCaptionMap[caption].type === type &&\n      bondCaptionMap[caption].stereo === stereo\n    )\n      return caption\n  }\n  throw Error('No such bond caption')\n}\n\nconst bondCaptionMap = {\n  single: {\n    type: Bond.PATTERN.TYPE.SINGLE,\n    stereo: Bond.PATTERN.STEREO.NONE\n  },\n  up: {\n    type: Bond.PATTERN.TYPE.SINGLE,\n    stereo: Bond.PATTERN.STEREO.UP\n  },\n  down: {\n    type: Bond.PATTERN.TYPE.SINGLE,\n    stereo: Bond.PATTERN.STEREO.DOWN\n  },\n  updown: {\n    type: Bond.PATTERN.TYPE.SINGLE,\n    stereo: Bond.PATTERN.STEREO.EITHER\n  },\n  double: {\n    type: Bond.PATTERN.TYPE.DOUBLE,\n    stereo: Bond.PATTERN.STEREO.NONE\n  },\n  crossed: {\n    type: Bond.PATTERN.TYPE.DOUBLE,\n    stereo: Bond.PATTERN.STEREO.CIS_TRANS\n  },\n  triple: {\n    type: Bond.PATTERN.TYPE.TRIPLE,\n    stereo: Bond.PATTERN.STEREO.NONE\n  },\n  aromatic: {\n    type: Bond.PATTERN.TYPE.AROMATIC,\n    stereo: Bond.PATTERN.STEREO.NONE\n  },\n  singledouble: {\n    type: Bond.PATTERN.TYPE.SINGLE_OR_DOUBLE,\n    stereo: Bond.PATTERN.STEREO.NONE\n  },\n  singlearomatic: {\n    type: Bond.PATTERN.TYPE.SINGLE_OR_AROMATIC,\n    stereo: Bond.PATTERN.STEREO.NONE\n  },\n  doublearomatic: {\n    type: Bond.PATTERN.TYPE.DOUBLE_OR_AROMATIC,\n    stereo: Bond.PATTERN.STEREO.NONE\n  },\n  any: {\n    type: Bond.PATTERN.TYPE.ANY,\n    stereo: Bond.PATTERN.STEREO.NONE\n  },\n  hydrogen: {\n    type: Bond.PATTERN.TYPE.HYDROGEN,\n    stereo: Bond.PATTERN.STEREO.NONE\n  },\n  dative: {\n    type: Bond.PATTERN.TYPE.DATIVE,\n    stereo: Bond.PATTERN.STEREO.NONE\n  }\n}\n\nexport function fromSgroup(ssgroup) {\n  const type = ssgroup.type || 'DAT'\n  const { context, fieldName, fieldValue, absolute, attached } = ssgroup.attrs\n\n  if (absolute === false && attached === false)\n    ssgroup.attrs.radiobuttons = 'Relative'\n  else ssgroup.attrs.radiobuttons = attached ? 'Attached' : 'Absolute'\n\n  if (\n    sdataSchema[context][fieldName] &&\n    sdataSchema[context][fieldName].properties.fieldValue.items\n  )\n    ssgroup.attrs.fieldValue = fieldValue.split('\\n')\n\n  const sDataInitValue =\n    type === 'DAT'\n      ? {\n          context: context || getSdataDefault(sdataCustomSchema, 'context'),\n          fieldName:\n            fieldName || getSdataDefault(sdataCustomSchema, 'fieldName'),\n          fieldValue:\n            fieldValue || getSdataDefault(sdataCustomSchema, 'fieldValue')\n        }\n      : {}\n\n  return Object.assign({ type }, ssgroup.attrs, sDataInitValue)\n}\n\nexport function toSgroup(sgroup) {\n  const { type, radiobuttons, ...props } = sgroup\n  const attrs = { ...props }\n\n  const absolute = 'absolute'\n  const attached = 'attached'\n\n  switch (radiobuttons) {\n    case 'Absolute':\n      attrs[absolute] = true\n      attrs[attached] = false\n      break\n    case 'Attached':\n      attrs[absolute] = false\n      attrs[attached] = true\n      break\n    case 'Relative':\n      attrs[absolute] = false\n      attrs[attached] = false\n      break\n    default:\n      break\n  }\n\n  if (attrs.fieldName) attrs.fieldName = attrs.fieldName.trim()\n\n  if (attrs.fieldValue) {\n    attrs.fieldValue =\n      typeof attrs.fieldValue === 'string'\n        ? attrs.fieldValue.trim()\n        : attrs.fieldValue\n  }\n\n  return {\n    type,\n    attrs\n  }\n}\n","import { ReBond, ReStruct, isAttachmentBond } from 'ketcher-core'\n\nexport function isFlipDisabled(editor): boolean {\n  const selection: { atoms: number[]; bonds: number[] } = editor.selection()\n  const restruct: ReStruct = editor.render.ctab\n\n  if (!selection) {\n    return false\n  }\n\n  const { bonds = [], atoms = [] } = selection\n  const getBondIdsForAtom = (atomId: number) => {\n    const result: number[] = []\n    for (const [bondId, bond] of restruct.bonds.entries()) {\n      if (bond.b.begin === atomId || bond.b.end === atomId) {\n        result.push(bondId)\n      }\n    }\n    return result\n  }\n  const getBondIdsForAttachmentAtoms = () => {\n    const result: number[] = []\n    for (const atomId of atoms) {\n      const atomBondIds = getBondIdsForAtom(atomId)\n      for (const atomBondId of atomBondIds) {\n        const bond: ReBond | undefined = restruct.bonds.get(atomBondId)\n        if (bond && isAttachmentBond(bond.b, selection)) {\n          result.push(atomBondId)\n        }\n      }\n    }\n    return result\n  }\n  const getAmountOfAttachmentBonds = (): number => {\n    let amountOfAttachmentBonds = 0\n    const totalBondIds = new Set([...bonds, ...getBondIdsForAttachmentAtoms()])\n    for (const bondId of totalBondIds) {\n      const bond: ReBond | undefined = restruct.bonds.get(bondId)\n      if (bond && isAttachmentBond(bond.b, selection)) {\n        amountOfAttachmentBonds++\n      }\n    }\n\n    return amountOfAttachmentBonds\n  }\n\n  return getAmountOfAttachmentBonds() > 1\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { RxnArrowMode, SimpleObjectMode, findStereoAtoms } from 'ketcher-core'\n\nimport { bond as bondSchema } from '../data/schema/struct-schema'\nimport isHidden from './isHidden'\nimport { toBondType } from '../data/convert/structconv'\nimport { isFlipDisabled } from './flips'\n\nconst toolActions = {\n  hand: {\n    title: 'Hand tool',\n    shortcut: 'Mod+Alt+h',\n    action: { tool: 'hand' },\n    hidden: (options) => isHidden(options, 'hand')\n  },\n  'select-lasso': {\n    title: 'Lasso Selection',\n    shortcut: 'Escape',\n    action: { tool: 'select', opts: 'lasso' }\n  },\n  'select-rectangle': {\n    title: 'Rectangle Selection',\n    shortcut: 'Escape',\n    action: { tool: 'select', opts: 'rectangle' },\n    hidden: (options) => isHidden(options, 'select-rectangle')\n  },\n  'select-fragment': {\n    title: 'Fragment Selection',\n    shortcut: 'Escape',\n    action: { tool: 'select', opts: 'fragment' },\n    hidden: (options) => isHidden(options, 'select-fragment')\n  },\n  erase: {\n    title: 'Erase',\n    shortcut: ['Delete', 'Backspace'],\n    action: { tool: 'eraser', opts: 1 }, // TODO last selector mode is better\n    hidden: (options) => isHidden(options, 'erase')\n  },\n  chain: {\n    title: 'Chain',\n    action: { tool: 'chain' },\n    hidden: (options) => isHidden(options, 'chain')\n  },\n  'enhanced-stereo': {\n    shortcut: 'Alt+e',\n    title: 'Stereochemistry',\n    action: { tool: 'enhancedStereo' },\n    disabled: (editor) =>\n      findStereoAtoms(\n        editor?.struct(),\n        Array.from(editor?.struct().atoms.keys())\n      ).length === 0,\n    hidden: (options) => isHidden(options, 'enhanced-stereo')\n  },\n  'charge-plus': {\n    shortcut: '+',\n    title: 'Charge Plus',\n    action: { tool: 'charge', opts: 1 },\n    hidden: (options) => isHidden(options, 'charge-plus')\n  },\n  'charge-minus': {\n    shortcut: '-',\n    title: 'Charge Minus',\n    action: { tool: 'charge', opts: -1 },\n    hidden: (options) => isHidden(options, 'charge-minus')\n  },\n  transforms: {\n    hidden: (options) => isHidden(options, 'transforms')\n  },\n  'transform-rotate': {\n    shortcut: 'Alt+r',\n    title: 'Rotate Tool',\n    action: { tool: 'rotate' },\n    hidden: (options) => isHidden(options, 'transform-rotate')\n  },\n  'transform-flip-h': {\n    shortcut: 'Alt+h',\n    title: 'Horizontal Flip',\n    action: { tool: 'rotate', opts: 'horizontal' },\n    disabled: isFlipDisabled,\n    hidden: (options) => isHidden(options, 'transform-flip-h')\n  },\n  'transform-flip-v': {\n    shortcut: 'Alt+v',\n    title: 'Vertical Flip',\n    action: { tool: 'rotate', opts: 'vertical' },\n    disabled: isFlipDisabled,\n    hidden: (options) => isHidden(options, 'transform-flip-v')\n  },\n  sgroup: {\n    shortcut: 'Mod+g',\n    title: 'S-Group',\n    action: { tool: 'sgroup' },\n    hidden: (options) => isHidden(options, 'sgroup')\n  },\n  arrows: {\n    hidden: (options) => isHidden(options, 'arrows')\n  },\n  'reaction-arrow-open-angle': {\n    title: 'Arrow Open Angle Tool',\n    action: { tool: 'reactionarrow', opts: RxnArrowMode.OpenAngle },\n    hidden: (options) => isHidden(options, 'reaction-arrow-open-angle')\n  },\n  'reaction-arrow-filled-triangle': {\n    title: 'Arrow Filled Triangle',\n    action: { tool: 'reactionarrow', opts: RxnArrowMode.FilledTriangle },\n    hidden: (options) => isHidden(options, 'reaction-arrow-filled-triangle')\n  },\n  'reaction-arrow-filled-bow': {\n    title: 'Arrow Filled Bow Tool',\n    action: { tool: 'reactionarrow', opts: RxnArrowMode.FilledBow },\n    hidden: (options) => isHidden(options, 'reaction-arrow-filled-bow')\n  },\n  'reaction-arrow-dashed-open-angle': {\n    title: 'Arrow Dashed Open Angle Tool',\n    action: { tool: 'reactionarrow', opts: RxnArrowMode.DashedOpenAngle },\n    hidden: (options) => isHidden(options, 'reaction-arrow-dashed-open-angle')\n  },\n  'reaction-arrow-failed': {\n    title: 'Failed Arrow Tool',\n    action: { tool: 'reactionarrow', opts: RxnArrowMode.Failed },\n    hidden: (options) => isHidden(options, 'reaction-arrow-failed')\n  },\n  'reaction-arrow-both-ends-filled-triangle': {\n    title: 'Arrow Both Ends Filled Triangle Tool',\n    action: {\n      tool: 'reactionarrow',\n      opts: RxnArrowMode.BothEndsFilledTriangle\n    },\n    hidden: (options) =>\n      isHidden(options, 'reaction-arrow-both-ends-filled-triangle')\n  },\n  'reaction-arrow-equilibrium-filled-half-bow': {\n    title: 'Arrow Equilibrium Filled Half Bow Tool',\n    action: {\n      tool: 'reactionarrow',\n      opts: RxnArrowMode.EquilibriumFilledHalfBow\n    },\n    hidden: (options) =>\n      isHidden(options, 'reaction-arrow-equilibrium-filled-half-bow')\n  },\n  'reaction-arrow-equilibrium-filled-triangle': {\n    title: 'Arrow Equilibrium Filled Triangle Tool',\n    action: {\n      tool: 'reactionarrow',\n      opts: RxnArrowMode.EquilibriumFilledTriangle\n    },\n    hidden: (options) =>\n      isHidden(options, 'reaction-arrow-equilibrium-filled-triangle')\n  },\n  'reaction-arrow-equilibrium-open-angle': {\n    title: 'Arrow Equilibrium Open Angle Tool',\n    action: { tool: 'reactionarrow', opts: RxnArrowMode.EquilibriumOpenAngle },\n    hidden: (options) =>\n      isHidden(options, 'reaction-arrow-equilibrium-open-angle')\n  },\n  'reaction-arrow-unbalanced-equilibrium-filled-half-bow': {\n    title: 'Arrow Unbalanced Equilibrium Filled Half Bow Tool',\n    action: {\n      tool: 'reactionarrow',\n      opts: RxnArrowMode.UnbalancedEquilibriumFilledHalfBow\n    },\n    hidden: (options) =>\n      isHidden(options, 'reaction-arrow-unbalanced-equilibrium-filled-half-bow')\n  },\n  'reaction-arrow-unbalanced-equilibrium-open-half-angle': {\n    title: 'Arrow Unbalanced Equilibrium Open Half Angle Tool',\n    action: {\n      tool: 'reactionarrow',\n      opts: RxnArrowMode.UnbalancedEquilibriumOpenHalfAngle\n    },\n    hidden: (options) =>\n      isHidden(options, 'reaction-arrow-unbalanced-equilibrium-open-half-angle')\n  },\n  'reaction-arrow-unbalanced-equilibrium-large-filled-half-bow': {\n    title: 'Arrow Unbalanced Equilibrium Large Filled Half Bow Tool',\n    action: {\n      tool: 'reactionarrow',\n      opts: RxnArrowMode.UnbalancedEquilibriumLargeFilledHalfBow\n    },\n    hidden: (options) =>\n      isHidden(\n        options,\n        'reaction-arrow-unbalanced-equilibrium-large-filled-half-bow'\n      )\n  },\n  'reaction-arrow-unbalanced-equilibrium-filled-half-triangle': {\n    title: 'Arrow Unbalanced Equilibrium Filled Half Triangle Tool',\n    action: {\n      tool: 'reactionarrow',\n      opts: RxnArrowMode.UnbalancedEquilibriumFilledHalfTriangle\n    },\n    hidden: (options) =>\n      isHidden(\n        options,\n        'reaction-arrow-unbalanced-equilibrium-filled-half-triangle'\n      )\n  },\n  'reaction-arrow-elliptical-arc-arrow-filled-bow': {\n    title: 'Arrow Elliptical Arc Filled Bow Tool',\n    action: {\n      tool: 'reactionarrow',\n      opts: RxnArrowMode.EllipticalArcFilledBow\n    },\n    hidden: (options) =>\n      isHidden(options, 'reaction-arrow-elliptical-arc-arrow-filled-bow')\n  },\n  'reaction-arrow-elliptical-arc-arrow-filled-triangle': {\n    title: 'Arrow Elliptical Arc Filled Triangle Tool',\n    action: {\n      tool: 'reactionarrow',\n      opts: RxnArrowMode.EllipticalArcFilledTriangle\n    },\n    hidden: (options) =>\n      isHidden(options, 'reaction-arrow-elliptical-arc-arrow-filled-triangle')\n  },\n  'reaction-arrow-elliptical-arc-arrow-open-angle': {\n    title: 'Arrow Elliptical Arc Open Angle Tool',\n    action: {\n      tool: 'reactionarrow',\n      opts: RxnArrowMode.EllipticalArcOpenAngle\n    },\n    hidden: (options) =>\n      isHidden(options, 'reaction-arrow-elliptical-arc-arrow-open-angle')\n  },\n  'reaction-arrow-elliptical-arc-arrow-open-half-angle': {\n    title: 'Arrow Elliptical Arc Open Half Angle Tool',\n    action: {\n      tool: 'reactionarrow',\n      opts: RxnArrowMode.EllipticalArcOpenHalfAngle\n    },\n    hidden: (options) =>\n      isHidden(options, 'reaction-arrow-elliptical-arc-arrow-open-half-angle')\n  },\n  'reaction-plus': {\n    title: 'Reaction Plus Tool',\n    action: { tool: 'reactionplus' },\n    hidden: (options) => isHidden(options, 'reaction-plus')\n  },\n  'reaction-mapping-tools': {\n    hidden: (options) => isHidden(options, 'reaction-mapping-tools')\n  },\n  'reaction-map': {\n    title: 'Reaction Mapping Tool',\n    action: { tool: 'reactionmap' },\n    hidden: (options) => isHidden(options, 'reaction-map')\n  },\n  'reaction-unmap': {\n    title: 'Reaction Unmapping Tool',\n    action: { tool: 'reactionunmap' },\n    hidden: (options) => isHidden(options, 'reaction-unmap')\n  },\n  rgroup: {\n    hidden: (options) => isHidden(options, 'rgroup')\n  },\n  'rgroup-label': {\n    shortcut: 'Mod+r',\n    title: 'R-Group Label Tool',\n    action: { tool: 'rgroupatom' },\n    hidden: (options) => isHidden(options, 'rgroup-label')\n  },\n  'rgroup-fragment': {\n    shortcut: ['Mod+Shift+r', 'Mod+r'],\n    title: 'R-Group Fragment Tool',\n    action: { tool: 'rgroupfragment' },\n    hidden: (options) => isHidden(options, 'rgroup-fragment')\n  },\n  'rgroup-attpoints': {\n    shortcut: 'Mod+r',\n    title: 'Attachment Point Tool',\n    action: { tool: 'apoint' },\n    hidden: (options) => isHidden(options, 'rgroup-attpoints')\n  },\n  shapes: {\n    hidden: (options) => isHidden(options, 'shapes')\n  },\n  'shape-ellipse': {\n    title: 'Shape Ellipse',\n    action: { tool: 'simpleobject', opts: SimpleObjectMode.ellipse },\n    hidden: (options) => isHidden(options, 'shape-ellipse')\n  },\n  'shape-rectangle': {\n    title: 'Shape Rectangle',\n    action: { tool: 'simpleobject', opts: SimpleObjectMode.rectangle },\n    hidden: (options) => isHidden(options, 'shape-rectangle')\n  },\n  'shape-line': {\n    title: 'Shape Line',\n    action: { tool: 'simpleobject', opts: SimpleObjectMode.line },\n    hidden: (options) => isHidden(options, 'shape-line')\n  },\n  text: {\n    shortcut: 'Alt+t',\n    title: 'Add text',\n    action: { tool: 'text' },\n    hidden: (options) => isHidden(options, 'text')\n  },\n  bonds: {\n    hidden: (options) => isHidden(options, 'bonds')\n  }\n}\n\nconst bondCuts = {\n  single: '1',\n  double: '2',\n  triple: '3',\n  up: '1',\n  down: '1',\n  updown: '1',\n  crossed: '2',\n  any: '0',\n  aromatic: '4'\n}\n\nconst typeSchema = bondSchema.properties.type\n\nexport default typeSchema.enum.reduce((res, type, i) => {\n  res[`bond-${type}`] = {\n    title: `${typeSchema.enumNames[i]} Bond`,\n    shortcut: bondCuts[type],\n    action: {\n      tool: 'bond',\n      opts: toBondType(type)\n    },\n    hidden: (options) => isHidden(options, `bond-${type}`)\n  }\n  return res\n}, toolActions)\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nexport const KETCHER_INIT_EVENT_NAME = 'ketcher-init'\n\nexport const KETCHER_SAVED_SETTINGS_KEY = 'ketcher_editor_saved_settings'\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { KETCHER_SAVED_SETTINGS_KEY } from '../../../constants'\n\ninterface SavedSettings {\n  selectionTool?: any\n}\n\nexport class SettingsManager {\n  static getSettings(): SavedSettings {\n    try {\n      return JSON.parse(\n        localStorage.getItem(KETCHER_SAVED_SETTINGS_KEY) || '{}'\n      )\n    } catch (e) {\n      return {} as SavedSettings\n    }\n  }\n\n  static saveSettings(settings: SavedSettings) {\n    if (!settings) {\n      return\n    }\n    localStorage.setItem(KETCHER_SAVED_SETTINGS_KEY, JSON.stringify(settings))\n  }\n\n  static get selectionTool() {\n    const { selectionTool } = this.getSettings()\n\n    return selectionTool\n  }\n\n  static set selectionTool(selectionTool) {\n    const settings = this.getSettings()\n\n    this.saveSettings({\n      ...settings,\n      selectionTool\n    })\n  }\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  FormatterFactory,\n  Pile,\n  SGroup,\n  getStereoAtomsMap,\n  identifyStructFormat,\n  Struct,\n  SupportedFormat\n} from 'ketcher-core'\n\nimport { supportedSGroupTypes } from './constants'\nimport { setAnalyzingFile } from './request'\nimport tools from '../action/tools'\nimport { SettingsManager } from '../utils/settingsManager'\n\nexport function onAction(action) {\n  if (action && action.dialog) {\n    return {\n      type: 'MODAL_OPEN',\n      data: { name: action.dialog, prop: action.prop }\n    }\n  }\n  if (action && action.thunk) {\n    return action.thunk\n  }\n\n  return {\n    type: 'ACTION',\n    action\n  }\n}\n\nexport function loadStruct(struct) {\n  return (_dispatch, getState) => {\n    const editor = getState().editor\n    editor.struct(struct)\n  }\n}\n\nfunction parseStruct(\n  struct: string | Struct,\n  server,\n  options?\n): Promise<Struct> {\n  if (typeof struct === 'string') {\n    options = options || {}\n    const { rescale, fragment, ...formatterOptions } = options\n\n    const format = identifyStructFormat(struct)\n    if (format === SupportedFormat.cdx) {\n      struct = `base64::${struct.replace(/\\s/g, '')}`\n    }\n    const factory = new FormatterFactory(server)\n\n    const service = factory.create(format, formatterOptions)\n    return service.getStructureFromStringAsync(struct)\n  } else {\n    return Promise.resolve(struct)\n  }\n}\n\nexport function load(struct: Struct, options?) {\n  return async (dispatch, getState) => {\n    const state = getState()\n    const editor = state.editor\n    const server = state.server\n    const errorHandler = editor.errorHandler\n\n    options = options || {}\n    options = {\n      ...options,\n      'dearomatize-on-load': editor.options()['dearomatize-on-load'],\n      ignoreChiralFlag: editor.options().ignoreChiralFlag\n    }\n\n    dispatch(setAnalyzingFile(true))\n\n    try {\n      const parsedStruct = await parseStruct(struct, server, options)\n      const { fragment } = options\n      const hasUnsupportedGroups = parsedStruct.sgroups.some(\n        (sGroup) => !supportedSGroupTypes[sGroup.type]\n      )\n\n      if (hasUnsupportedGroups) {\n        await editor.event.confirm.dispatch()\n        parsedStruct.sgroups = parsedStruct.sgroups.filter(\n          (_key, sGroup) => supportedSGroupTypes[sGroup.type]\n        )\n      }\n\n      parsedStruct.rescale() // TODO: move out parsing?\n\n      if (editor.struct().atoms.size) {\n        // NB: reset id\n        const oldStruct = editor.struct().clone()\n        parsedStruct.sgroups.forEach((sg, sgId) => {\n          const offset = SGroup.getOffset(oldStruct.sgroups.get(sgId))\n          const atomSet = new Pile(sg.atoms)\n          const crossBonds = SGroup.getCrossBonds(parsedStruct, atomSet)\n          SGroup.bracketPos(sg, parsedStruct, crossBonds)\n          if (offset) sg.updateOffset(offset)\n        })\n      }\n\n      parsedStruct.findConnectedComponents()\n      parsedStruct.setImplicitHydrogen()\n\n      const stereAtomsMap = getStereoAtomsMap(\n        parsedStruct,\n        Array.from(parsedStruct.bonds.values())\n      )\n\n      parsedStruct.atoms.forEach((atom, id) => {\n        if (parsedStruct?.atomGetNeighbors(id)?.length === 0) {\n          atom.stereoLabel = null\n          atom.stereoParity = 0\n        } else {\n          const stereoProp = stereAtomsMap.get(id)\n          if (stereoProp) {\n            atom.stereoLabel = stereoProp.stereoLabel\n            atom.stereoParity = stereoProp.stereoParity\n          }\n        }\n      })\n\n      parsedStruct.markFragments()\n\n      if (fragment) {\n        if (parsedStruct.isBlank()) {\n          const savedSelectedTool = SettingsManager.selectionTool\n          dispatch({\n            type: 'ACTION',\n            action: savedSelectedTool || tools['select-rectangle'].action\n          })\n        } else {\n          dispatch(onAction({ tool: 'paste', opts: parsedStruct }))\n        }\n      } else {\n        editor.struct(parsedStruct)\n      }\n      dispatch(setAnalyzingFile(false))\n      dispatch({ type: 'MODAL_CLOSE' })\n    } catch (err: any) {\n      dispatch(setAnalyzingFile(false))\n      err && errorHandler(err.message)\n    }\n  }\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { ChemicalMimeType, KetSerializer } from 'ketcher-core'\nimport { appUpdate, setStruct } from '../options'\nimport { omit, without } from 'lodash/fp'\n\nimport { checkErrors } from '../modal/form'\nimport { indigoVerification } from '../request'\nimport { load } from '../shared'\n\nexport function checkServer() {\n  return (dispatch, getState) => {\n    const { editor, server } = getState()\n\n    server.then(\n      (res) =>\n        dispatch(\n          appUpdate({\n            indigoVersion: res?.indigoVersion,\n            imagoVersions: res?.imagoVersions,\n            server: res?.isAvailable\n          })\n        ),\n      (e) => editor.errorHandler(e)\n    )\n  }\n}\n\nexport function recognize(file, version) {\n  return (dispatch, getState) => {\n    const rec = getState().server.recognize\n    const editor = getState().editor\n\n    const process = rec(file, version).then(\n      (res) => {\n        dispatch(setStruct(res.struct))\n      },\n      (e) => {\n        dispatch(setStruct(null))\n        editor.errorHandler(e)\n      }\n    )\n    dispatch(setStruct(process))\n  }\n}\n\nfunction ketcherCheck(struct, checkParams) {\n  const errors = {}\n\n  if (checkParams.includes('chiral_flag')) {\n    const isAbs = Array.from(struct.frags.values()).some((fr) =>\n      fr ? fr.enhancedStereoFlag === 'abs' : false\n    )\n    if (isAbs) errors.chiral_flag = 'Chiral flag is present on the canvas'\n  }\n\n  if (checkParams.includes('valence')) {\n    let badVal = 0\n    struct.atoms.forEach((atom) => atom.badConn && badVal++)\n    if (badVal > 0)\n      errors.valence = `Structure contains ${badVal} atom${\n        badVal !== 1 ? 's' : ''\n      } with bad valence`\n  }\n\n  return errors\n}\n\nexport function check(optsTypes) {\n  return (dispatch, getState) => {\n    const { editor, server } = getState()\n    const ketcherErrors = ketcherCheck(editor.struct(), optsTypes)\n\n    const options = getState().options.getServerSettings()\n    options.data = { types: without(['valence', 'chiral_flag'], optsTypes) }\n\n    return serverCall(editor, server, 'check', options)\n      .then((res) => {\n        res = Object.assign(res, ketcherErrors) // merge Indigo check with Ketcher check\n        dispatch(checkErrors(res))\n      })\n      .catch((e) => {\n        editor.errorHandler(e)\n      })\n  }\n}\n\nexport function automap(res) {\n  return serverTransform('automap', res)\n}\n\nexport function analyse() {\n  return (dispatch, getState) => {\n    // reset values to initial state\n    dispatch({\n      type: 'ANALYSE_LOADING'\n    })\n    const { editor, server, options } = getState()\n    const serverSettings = options.getServerSettings()\n    serverSettings.data = {\n      properties: [\n        'molecular-weight',\n        'most-abundant-mass',\n        'monoisotopic-mass',\n        'gross',\n        'mass-composition'\n      ]\n    }\n\n    return serverCall(editor, server, 'calculate', serverSettings)\n      .then((values) =>\n        dispatch({\n          type: 'CHANGE_ANALYSE',\n          data: { values }\n        })\n      )\n      .catch((e) => {\n        editor.errorHandler(e)\n      })\n  }\n}\n\nexport function serverTransform(method, data, struct) {\n  return (dispatch, getState) => {\n    const state = getState()\n    const opts = state.options.getServerSettings()\n\n    opts.data = data\n    dispatch(indigoVerification(true))\n\n    serverCall(state.editor, state.server, method, opts, struct)\n      .then((res) => {\n        const loadedStruct = new KetSerializer().deserialize(res.struct)\n\n        return dispatch(\n          load(loadedStruct, {\n            rescale: method === 'layout',\n            reactionRelayout: method === 'clean'\n          })\n        )\n      })\n      .catch((e) => {\n        state.editor.errorHandler(e)\n      })\n      .finally(() => {\n        dispatch(indigoVerification(false))\n      })\n    // TODO: notification\n  }\n}\n\n// TODO: serverCall function should not be exported\nexport function serverCall(editor, server, method, options, struct) {\n  const selection = editor.selection()\n  let selectedAtoms = []\n  const aidMap = new Map()\n  const currentStruct = (struct || editor.struct()).clone(\n    null,\n    null,\n    false,\n    aidMap\n  )\n  if (selection) {\n    selectedAtoms = (\n      selection.atoms ? selection.atoms : editor.explicitSelected().atoms\n    ).map((aid) => aidMap.get(aid))\n  }\n  const ketSerializer = new KetSerializer()\n  return server.then(() =>\n    server[method](\n      Object.assign(\n        {\n          struct: ketSerializer.serialize(currentStruct)\n        },\n        method !== 'calculate' && method !== 'check'\n          ? {\n              output_format: ChemicalMimeType.KET\n            }\n          : null,\n        selectedAtoms && selectedAtoms.length > 0\n          ? {\n              selected: selectedAtoms\n            }\n          : null,\n        options.data\n      ),\n      omit('data', options)\n    )\n  )\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport isHidden from './isHidden'\nimport { serverTransform } from '../state/server'\n\nconst config = {\n  layout: {\n    shortcut: 'Mod+l',\n    title: 'Layout',\n    action: {\n      thunk: serverTransform('layout')\n    },\n    disabled: (editor, server, options) => !options.app.server,\n    hidden: (options) => isHidden(options, 'layout')\n  },\n  clean: {\n    shortcut: 'Mod+Shift+l',\n    title: 'Clean Up',\n    action: {\n      thunk: serverTransform('clean')\n    },\n    disabled: (editor, server, options) => !options.app.server,\n    hidden: (options) => isHidden(options, 'clean')\n  },\n  arom: {\n    shortcut: 'Alt+a',\n    title: 'Aromatize',\n    action: {\n      thunk: serverTransform('aromatize')\n    },\n    disabled: (editor, server, options) => !options.app.server,\n    hidden: (options) => isHidden(options, 'arom')\n  },\n  dearom: {\n    shortcut: 'Ctrl+Alt+a',\n    title: 'Dearomatize',\n    action: {\n      thunk: serverTransform('dearomatize')\n    },\n    disabled: (editor, server, options) => !options.app.server,\n    hidden: (options) => isHidden(options, 'dearom')\n  },\n  cip: {\n    shortcut: 'Mod+p',\n    title: 'Calculate CIP',\n    action: {\n      thunk: serverTransform('calculateCip')\n    },\n    disabled: (editor, server, options) => !options.app.server,\n    hidden: (options) => isHidden(options, 'cip')\n  },\n  check: {\n    shortcut: 'Alt+s',\n    title: 'Check Structure',\n    action: { dialog: 'check' },\n    disabled: (editor, server, options) => !options.app.server,\n    hidden: (options) => isHidden(options, 'check')\n  },\n  analyse: {\n    shortcut: 'Alt+c',\n    title: 'Calculated Values',\n    action: { dialog: 'analyse' },\n    disabled: (editor, server, options) => !options.app.server,\n    hidden: (options) => isHidden(options, 'analyse')\n  },\n  recognize: {\n    title: 'Recognize Molecule',\n    action: { dialog: 'recognize' },\n    disabled: (editor, server, options) =>\n      // TODO: provide the list of disabled functions as array\n      !options.app.server || !options.app.imagoVersions?.length > 0,\n    hidden: (options) => isHidden(options, 'recognize')\n  },\n  miew: {\n    title: '3D Viewer',\n    action: { dialog: 'miew' },\n    hidden: (options) => isHidden(options, 'miew')\n  }\n}\n\nexport default config\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { MolSerializer } from 'ketcher-core'\n\nconst molSerializer = new MolSerializer()\n\nexport default [\n  `Benzene\n  Ketcher  5112215552D 1   1.00000     0.00000     0\n\n  6  6  0  0  0  0            999 V2000\n    0.6548    2.2452    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.0813    2.2456    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.3694    2.6575    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.0813    1.4204    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.6548    1.4167    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.3712    1.0086    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n  3  1  2  0     0  0\n  4  2  2  0     0  0\n  1  5  1  0     0  0\n  2  3  1  0     0  0\n  5  6  2  0     0  0\n  6  4  1  0     0  0\nM  END`,\n\n  `Cyclopentadiene\n  Ketcher  5112215552D 1   1.00000     0.00000     0\n\n  5  5  0  0  0  0            999 V2000\n    3.8091    8.2444    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.3091    6.7055    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.6181    7.6510    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.3091    6.7055    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0000    7.6510    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n  1  5  1  0     0  0\n  2  3  2  0     0  0\n  3  1  1  0     0  0\n  4  2  1  0     0  0\n  5  4  2  0     0  0\nM  END`,\n\n  `Cyclohexane\n  Ketcher  5112215552D 1   1.00000     0.00000     0\n\n  6  6  0  0  0  0            999 V2000\n    2.5500    3.6722    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.5500    2.6722    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.4160    2.1722    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.2820    2.6722    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.2820    3.6722    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.4160    4.1722    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n  1  6  1  0     0  0\n  1  2  1  0     0  0\n  2  3  1  0     0  0\n  3  4  1  0     0  0\n  4  5  1  0     0  0\n  5  6  1  0     0  0\nM  END`,\n\n  `Cyclopentane\n  Ketcher 11161218352D 1   1.00000     0.00000     0\n\n  5  5  0     0  0            999 V2000\n    0.8090    1.5389    0.0000 C   0  0  0  0  0  0        0  0  0\n    1.6180    0.9511    0.0000 C   0  0  0  0  0  0        0  0  0\n    1.3090    0.0000    0.0000 C   0  0  0  0  0  0        0  0  0\n    0.3090    0.0000    0.0000 C   0  0  0  0  0  0        0  0  0\n    0.0000    0.9511    0.0000 C   0  0  0  0  0  0        0  0  0\n  1  2  1  0     0  0\n  2  3  1  0     0  0\n  3  4  1  0     0  0\n  4  5  1  0     0  0\n  5  1  1  0     0  0\nM  END`,\n\n  `Cyclopropane\n  Ketcher  5112215552D 1   1.00000     0.00000     0\n\n  3  3  0  0  0  0            999 V2000\n    2.6123    1.5663    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.6098    1.5663    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.1111    2.4280    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0     0  0\n  1  3  1  0     0  0\n  2  3  1  0     0  0\nM  END`,\n\n  `Cyclobutane\n  Ketcher  5112215552D 1   1.00000     0.00000     0\n\n  4  4  0  0  0  0            999 V2000\n    3.4956    1.8862    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.4919    2.8804    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.4846    1.8991    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.4821    2.8804    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0     0  0\n  1  3  1  0     0  0\n  2  4  1  0     0  0\n  3  4  1  0     0  0\nM  END`,\n\n  `Cycloheptane\n  Ketcher  5112215552D 1   1.00000     0.00000     0\n\n  7  7  0  0  0  0            999 V2000\n   21.4111    6.3389    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   22.1938    6.9555    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   23.1653    6.7333    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   23.5987    5.8389    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   21.4166    5.3333    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   23.1660    4.9333    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n   22.1938    4.7111    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0     0  0\n  2  3  1  0     0  0\n  3  4  1  0     0  0\n  4  6  1  0     0  0\n  1  5  1  0     0  0\n  5  7  1  0     0  0\n  6  7  1  0     0  0\nM  END`,\n\n  `Cyclooctane\n  Ketcher  5112215552D 1   1.00000     0.00000     0\n\n  8  8  0  0  0  0            999 V2000\n    2.9268    2.2122    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.9270    3.2099    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.6288    3.9118    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.6290    1.5102    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.6266    1.5102    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    5.3286    2.2122    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    5.3285    3.2099    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.6266    3.9119    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0     0  0\n  2  3  1  0     0  0\n  1  4  1  0     0  0\n  4  5  1  0     0  0\n  5  6  1  0     0  0\n  6  7  1  0     0  0\n  7  8  1  0     0  0\n  8  3  1  0     0  0\nM  END`\n].map((structStr) => molSerializer.deserialize(structStr))\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport templates from '../data/templates'\nimport isHidden from './isHidden'\n\nconst templateLib = {\n  'template-lib': {\n    shortcut: 'Shift+t',\n    title: 'Custom Templates',\n    action: { dialog: 'templates', prop: { tab: null } },\n    selected: (editor) => editor._tool.mode === 'classic',\n    disabled: (editor, server, options) => !options.app.templates,\n    hidden: (options) => isHidden(options, 'template-lib')\n  }\n}\n\nexport default templates.reduce((res, struct, i) => {\n  res[`template-${i}`] = {\n    title: `${struct.name}`,\n    shortcut: 't',\n    action: {\n      tool: 'template',\n      opts: { struct }\n    }\n  }\n  return res\n}, templateLib)\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { findIndex, findLastIndex } from 'lodash/fp'\nimport isHidden from './isHidden'\n\nexport const zoomList = [\n  0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1, 1.1, 1.2, 1.3, 1.4, 1.5, 1.7, 2,\n  2.5, 3, 3.5, 4\n]\n\nexport default {\n  zoom: {\n    shortcut: ['Ctrl+Shift+0'],\n    selected: (editor) => editor.zoom(),\n    action: (editor) => editor.zoom(1),\n    hidden: (options) => isHidden(options, 'zoom')\n  },\n  'zoom-out': {\n    shortcut: ['Ctrl+_', 'Ctrl+-'],\n    title: 'Zoom Out',\n    disabled: (editor) => editor.zoom() <= zoomList[0], // unsave\n    action: (editor) => {\n      const zoom = editor.zoom()\n      const i = findLastIndex((z) => z <= zoom, zoomList)\n      editor.zoom(zoomList[zoomList[i] === zoom && i > 0 ? i - 1 : i])\n    },\n    hidden: (options) => isHidden(options, 'zoom-out')\n  },\n  'zoom-in': {\n    shortcut: ['Ctrl+=', 'Ctrl++'],\n    title: 'Zoom In',\n    disabled: (editor) => zoomList[zoomList.length - 1] <= editor.zoom(),\n    action: (editor) => {\n      const zoom = editor.zoom()\n      const i = findIndex((z) => z >= zoom, zoomList)\n      editor.zoom(\n        zoomList[zoomList[i] === zoom && i < zoomList.length - 1 ? i + 1 : i]\n      )\n    },\n    hidden: (options) => isHidden(options, 'zoom-in')\n  },\n  'zoom-list': {\n    hidden: (options) => isHidden(options, 'zoom-list')\n  }\n}\n","/****************************************************************************\n * Copyright 2022 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport isHidden from './isHidden'\n\nconst openHelpLink = () =>\n  window\n    .open(\n      `https://github.com/epam/ketcher/blob/${process.env.HELP_LINK}/documentation/help.md#ketcher-overview`\n    )\n    ?.focus()\n\nexport default {\n  help: {\n    shortcut: ['?', '&', 'Shift+/'],\n    action: () => openHelpLink(),\n    hidden: (options) => isHidden(options, 'help')\n  }\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport isHidden from './isHidden'\n\nconst functionalGroupsLib = {\n  'functional-groups': {\n    shortcut: 'Shift+f',\n    // TODO Update HELP about current tools\n    title: 'Functional Groups',\n    action: { dialog: 'templates', prop: { tab: 1 } },\n    selected: (editor) => editor._tool.mode === 'fg',\n    disabled: (_, __, options) => {\n      return !options.app.functionalGroups\n    },\n    hidden: (options) => isHidden(options, 'functional-groups')\n  }\n}\n\nexport default functionalGroupsLib\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport isHidden from './isHidden'\n\nconst requestFullscreen = (element: HTMLElement) => {\n  ;(element.requestFullscreen && element.requestFullscreen()) ||\n    (element.msRequestFullscreen && element.msRequestFullscreen()) ||\n    (element.mozRequestFullScreen && element.mozRequestFullScreen()) ||\n    (element.webkitRequestFullscreen && element.webkitRequestFullscreen())\n}\n\nconst exitFullscreen = () => {\n  ;(document.exitFullscreen && document.exitFullscreen()) ||\n    (document.msExitFullscreen && document.msExitFullscreen()) ||\n    (document.mozCancelFullScreen && document.mozCancelFullScreen()) ||\n    (document.webkitExitFullscreen && document.webkitExitFullscreen())\n}\n\nconst getIfFullScreen = () => {\n  return !!(\n    document.fullscreenElement ||\n    document.mozFullScreenElement ||\n    document.webkitFullscreenElement ||\n    document.msFullscreenElement\n  )\n}\n\nconst toggleFullscreen = () => {\n  const fullscreenElement: HTMLElement =\n    document.querySelector('.Ketcher-root') || document.documentElement\n  getIfFullScreen() ? exitFullscreen() : requestFullscreen(fullscreenElement)\n}\n\nexport default {\n  fullscreen: {\n    title: 'Fullscreen mode',\n    action: () => toggleFullscreen(),\n    hidden: (options) => isHidden(options, 'fullscreen')\n  }\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport atoms from './atoms'\nimport copyAs from './copyAs'\nimport copyImageToClipboard from './copyImageToClipboard'\nimport debug from './debug'\nimport { exec } from '../component/cliparea/cliparea'\nimport isHidden from './isHidden'\nimport server from './server'\nimport templates from './templates'\nimport tools from './tools'\nimport zoom from './zoom'\nimport help from './help'\nimport functionalGroups from './functionalGroups'\nimport fullscreen from './fullscreen'\nimport { SettingsManager } from '../utils/settingsManager'\n\nexport * from './action.types'\n\nconst config = {\n  clear: {\n    shortcut: 'Mod+Delete',\n    title: 'Clear Canvas',\n    action: {\n      thunk: (dispatch, getState) => {\n        const editor = getState().editor\n        if (!editor.struct().isBlank()) editor.struct(null)\n        const savedSelectedTool = SettingsManager.selectionTool\n        dispatch({\n          type: 'ACTION',\n          action: savedSelectedTool || tools['select-rectangle'].action\n        })\n      }\n    },\n    hidden: (options) => isHidden(options, 'clear')\n  },\n  open: {\n    shortcut: 'Mod+o',\n    title: 'Open…',\n    action: { dialog: 'open' },\n    hidden: (options) => isHidden(options, 'open')\n  },\n  save: {\n    shortcut: 'Mod+s',\n    title: 'Save As…',\n    action: { dialog: 'save' },\n    hidden: (options) => isHidden(options, 'save')\n  },\n  'atom-props': {\n    title: 'Atom Properties',\n    action: { dialog: 'atomProps' },\n    hidden: (options) => isHidden(options, 'atom-props')\n  },\n  'bond-props': {\n    title: 'Bond Properties',\n    action: { dialog: 'bondProps' },\n    hidden: (options) => isHidden(options, 'bond-props')\n  },\n  undo: {\n    shortcut: 'Mod+z',\n    title: 'Undo',\n    action: (editor) => {\n      editor.undo()\n    },\n    disabled: (editor) => editor.historySize().undo === 0,\n    hidden: (options) => isHidden(options, 'undo')\n  },\n  redo: {\n    shortcut: ['Mod+Shift+z', 'Mod+y'],\n    title: 'Redo',\n    action: (editor) => {\n      editor.redo()\n    },\n    disabled: (editor) => editor.historySize().redo === 0,\n    hidden: (options) => isHidden(options, 'redo')\n  },\n  cut: {\n    shortcut: 'Mod+x',\n    title: 'Cut',\n    action: (editor) => {\n      exec('cut') || dontClipMessage('Cut', editor.errorHandler) // eslint-disable-line no-unused-expressions\n    },\n    disabled: (editor) => !hasSelection(editor),\n    hidden: (options) => isHidden(options, 'cut')\n  },\n  copies: {\n    disabled: (editor) => !hasSelection(editor),\n    hidden: (options) => isHidden(options, 'copies')\n  },\n  copy: {\n    shortcut: 'Mod+c',\n    title: 'Copy',\n    action: (editor) => {\n      exec('copy') || dontClipMessage('Copy', editor.errorHandler) // eslint-disable-line no-unused-expressions\n    },\n    disabled: (editor) => !hasSelection(editor),\n    hidden: (options) => isHidden(options, 'copy')\n  },\n  'copy-image': {\n    shortcut: 'Mod+Shift+f',\n    title: 'Copy Image',\n    action: () => {\n      copyImageToClipboard()\n    },\n    disabled: (editor) => !hasSelection(editor),\n    hidden: (options) => isHidden(options, 'copy-image')\n  },\n  'copy-mol': {\n    shortcut: 'Mod+m',\n    title: 'Copy as MOL',\n    action: () => {\n      copyAs('mol')\n    },\n    disabled: (editor) => !hasSelection(editor),\n    hidden: (options) => isHidden(options, 'copy-mol')\n  },\n  'copy-ket': {\n    shortcut: 'Mod+Shift+k',\n    title: 'Copy as KET',\n    action: () => {\n      copyAs('ket')\n    },\n    disabled: (editor) => !hasSelection(editor),\n    hidden: (options) => isHidden(options, 'copy-ket')\n  },\n  paste: {\n    shortcut: 'Mod+v',\n    title: 'Paste',\n    action: (editor) => {\n      exec('paste') || dontClipMessage('Paste', editor.errorHandler) // eslint-disable-line no-unused-expressions\n    },\n    selected: ({ actions }) =>\n      actions && // TMP\n      actions.active &&\n      actions.active.tool === 'paste',\n    hidden: (options) => isHidden(options, 'paste')\n  },\n  settings: {\n    title: 'Settings',\n    action: { dialog: 'settings' },\n    hidden: (options) => isHidden(options, 'settings')\n  },\n  about: {\n    title: 'About',\n    action: { dialog: 'about' },\n    hidden: (options) => isHidden(options, 'about')\n  },\n  'reaction-automap': {\n    title: 'Reaction Auto-Mapping Tool',\n    action: { dialog: 'automap' },\n    hidden: (options) => isHidden(options, 'reaction-automap'),\n    disabled: (editor, server, options) =>\n      !options.app.server || !editor.struct().hasRxnArrow()\n  },\n  'period-table': {\n    title: 'Periodic Table',\n    action: { dialog: 'period-table' },\n    hidden: (options) => isHidden(options, 'period-table')\n  },\n  'extended-table': {\n    title: 'Extended Table',\n    action: { dialog: 'extended-table' },\n    hidden: (options) => isHidden(options, 'extended-table')\n  },\n  'select-all': {\n    title: 'Select All',\n    shortcut: 'Mod+a',\n    action: {\n      thunk: (dispatch, getState) => {\n        getState().editor.selection('all')\n        const selectionTool = getState().toolbar.visibleTools.select\n        dispatch({ type: 'ACTION', action: tools[selectionTool].action })\n      }\n    },\n    hidden: (options) => isHidden(options, 'select-all')\n  },\n  'deselect-all': {\n    title: 'Deselect All',\n    shortcut: 'Mod+Shift+a',\n    action: (editor) => {\n      editor.selection(null)\n    },\n    hidden: (options) => isHidden(options, 'deselect-all')\n  },\n  'select-descriptors': {\n    title: 'Select descriptors',\n    shortcut: 'Mod+d',\n    action: {\n      thunk: (dispatch, getState) => {\n        const selectionTool = getState().toolbar.visibleTools.select\n        const editor = getState().editor\n        editor.alignDescriptors()\n        editor.selection('descriptors')\n        dispatch({ type: 'ACTION', action: tools[selectionTool].action })\n      }\n    },\n    hidden: (options) => isHidden(options, 'select-descriptors')\n  },\n  'any-atom': {\n    title: 'Any atom',\n    action: {\n      tool: 'atom',\n      opts: {\n        label: 'A',\n        pseudo: 'A',\n        type: 'gen'\n      }\n    },\n    hidden: (options) => isHidden(options, 'any-atom')\n  },\n  ...server,\n  ...debug,\n  ...tools,\n  ...atoms,\n  ...zoom,\n  ...templates,\n  ...functionalGroups,\n  ...fullscreen,\n  ...help\n}\n\nfunction hasSelection(editor) {\n  const selection = editor.selection()\n  return (\n    selection && // if not only sgroupData selected\n    Object.keys(selection).filter((key) => !['sgroupData'].includes(key))\n      .length > 0\n  )\n}\n\nfunction dontClipMessage(title, errorHandler) {\n  errorHandler(\n    'This action is unavailable via menu.\\n' + // eslint-disable-line no-undef\n      'Instead, use shortcut to ' +\n      title +\n      '.'\n  )\n}\n\nexport default config\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport AboutIcon from './files/about.svg'\nimport AnalyseIcon from './files/analyse.svg'\nimport AromIcon from './files/arom.svg'\nimport ArrowUpwardIcon from './files/arrow-upward.svg'\nimport BondAnyIcon from './files/bond-any.svg'\nimport BondAromaticIcon from './files/bond-aromatic.svg'\nimport BondCrossedIcon from './files/bond-crossed.svg'\nimport BondDative from './files/bond-dative.svg'\nimport BondDoubleAromaticIcon from './files/bond-doublearomatic.svg'\nimport BondDoubleIcon from './files/bond-double.svg'\nimport BondDownIcon from './files/bond-down.svg'\nimport BondHydrogenIcon from './files/bond-hydrogen.svg'\nimport BondSingleAromaticIcon from './files/bond-singlearomatic.svg'\nimport BondSingleDoubleIcon from './files/bond-singledouble.svg'\nimport BondSingleIcon from './files/bond-single.svg'\nimport BondTripleIcon from './files/bond-triple.svg'\nimport BondUpIcon from './files/bond-up.svg'\nimport BondUpdownIcon from './files/bond-updown.svg'\nimport CapitalTIcon from './files/capital-t.svg'\nimport ChainIcon from './files/chain.svg'\nimport ChargeMinusIcon from './files/charge-minus.svg'\nimport ChargePlusIcon from './files/charge-plus.svg'\nimport CheckIcon from './files/check.svg'\nimport ChiralFlagIcon from './files/chiral-flag.svg'\nimport CipIcon from './files/cip.svg'\nimport CleanIcon from './files/clean.svg'\nimport CopyIcon from './files/copy.svg'\nimport CopyImageIcon from './files/copy-image.svg'\nimport CopyKetIcon from './files/copy-ket.svg'\nimport CopyMolIcon from './files/copy-mol.svg'\nimport CutIcon from './files/cut.svg'\nimport DearomIcon from './files/dearom.svg'\nimport DeleteIcon from './files/delete.svg'\nimport DropdownIcon from './files/dropdown.svg'\nimport EnhancedStereoIcon from './files/enhanced-stereo.svg'\nimport EditIcon from './files/edit.svg'\nimport ElementsGroupIcon from './files/elements-group.svg'\nimport EraseIcon from './files/erase.svg'\nimport ExtendedTableIcon from './files/extended-table.svg'\nimport FileThumbnailIcon from './files/file-thumbnail.svg'\nimport GenericGroupsIcon from './files/generic-groups.svg'\nimport HandIcon from './files/hand.svg'\nimport CompressedHandIcon from './files/compressed-hand.svg'\nimport HelpIcon from './files/help.svg'\nimport HistoryIcon from './files/history.svg'\nimport ImageFrameIcon from './files/image-frame.svg'\nimport LayoutIcon from './files/layout.svg'\nimport LogoIcon from './files/logo.svg'\nimport MiewIcon from './files/miew.svg'\nimport ClearIcon from './files/clear.svg'\nimport NotFoundIcon from './files/not-found.svg'\nimport OpenIcon from './files/open.svg'\nimport PasteIcon from './files/paste.svg'\nimport OpenWindowPasteIcon from './files/open-window-paste-icon.svg'\nimport OpenWindowUploadIcon from './files/open-window-upload-icon.svg'\nimport PeriodTableIcon from './files/period-table.svg'\nimport ReactionArrowBothEndsFilledTriangle from './files/reaction-arrow-both-ends-filled-triangle.svg'\nimport ReactionArrowDashedOpenAngle from './files/reaction-arrow-dashed-open-angle.svg'\nimport ReactionArrowEllipticalArcArrowFilledBow from './files/reaction-arrow-elliptical-arc-arrow-filled-bow.svg'\nimport ReactionArrowEllipticalArcArrowFilledTriangle from './files/reaction-arrow-elliptical-arc-arrow-filled-triangle.svg'\nimport ReactionArrowEllipticalArcArrowOpenAngle from './files/reaction-arrow-elliptical-arc-arrow-open-angle.svg'\nimport ReactionArrowEllipticalArcArrowOpenHalfAngle from './files/reaction-arrow-elliptical-arc-arrow-open-half-angle.svg'\nimport ReactionArrowEquilibriumFilledHalfBow from './files/reaction-arrow-equilibrium-filled-half-bow.svg'\nimport ReactionArrowEquilibriumFilledTriangle from './files/reaction-arrow-equilibrium-filled-triangle.svg'\nimport ReactionArrowEquilibriumOpenAngle from './files/reaction-arrow-equilibrium-open-angle.svg'\nimport ReactionArrowFailed from './files/reaction-arrow-failed.svg'\nimport ReactionArrowFilledBow from './files/reaction-arrow-filled-bow.svg'\nimport ReactionArrowFilledTriangle from './files/reaction-arrow-filled-triangle.svg'\nimport ReactionArrowOpenAngleIcon from './files/reaction-arrow-open-angle.svg'\nimport ReactionArrowUnbalancedEquilibriumFilledHalfBow from './files/reaction-arrow-unbalanced-equilibrium-filled-half-bow.svg'\nimport ReactionArrowUnbalancedEquilibriumFilledHalfTriangle from './files/reaction-arrow-unbalanced-equilibrium-filled-half-triangle.svg'\nimport ReactionArrowUnbalancedEquilibriumLargeFilledHalfBow from './files/reaction-arrow-unbalanced-equilibrium-large-filled-half-bow.svg'\nimport ReactionArrowUnbalancedEquilibriumOpenHalfAngle from './files/reaction-arrow-unbalanced-equilibrium-open-half-angle.svg'\nimport ReactionAutomapIcon from './files/reaction-automap.svg'\nimport ReactionMapIcon from './files/reaction-map.svg'\nimport ReactionPlusIcon from './files/reaction-plus.svg'\nimport ReactionUnmapIcon from './files/reaction-unmap.svg'\nimport RecognizeIcon from './files/recognize.svg'\nimport RedoIcon from './files/redo.svg'\nimport RgroupAttpointsIcon from './files/rgroup-attpoints.svg'\nimport RgroupFragmentIcon from './files/rgroup-fragment.svg'\nimport RgroupLabelIcon from './files/rgroup-label.svg'\nimport SaveIcon from './files/save.svg'\nimport SearchIcon from './files/search.svg'\nimport SelectFragmentIcon from './files/select-fragment.svg'\nimport SelectLassoIcon from './files/select-lasso.svg'\nimport SelectRectangleIcon from './files/select-rectangle.svg'\nimport SettingsIcon from './files/settings.svg'\nimport SgroupIcon from './files/sgroup.svg'\nimport ShapeEllipseIcon from './files/shape-ellipse.svg'\nimport ShapeLineIcon from './files/shape-line.svg'\nimport ShapePolylineIcon from './files/shape-polyline.svg'\nimport ShapeRectangleIcon from './files/shape-rectangle.svg'\nimport Template0Icon from './files/template-0.svg'\nimport Template1Icon from './files/template-1.svg'\nimport Template2Icon from './files/template-2.svg'\nimport Template3Icon from './files/template-3.svg'\nimport Template4Icon from './files/template-4.svg'\nimport Template5Icon from './files/template-5.svg'\nimport Template6Icon from './files/template-6.svg'\nimport Template7Icon from './files/template-7.svg'\nimport TemplateDialogIcon from './files/template-dialog.svg'\nimport TemplateLibIcon from './files/template-lib.svg'\nimport TextBold from './files/text-bold.svg'\nimport TextIcon from './files/text.svg'\nimport TextItalic from './files/text-italic.svg'\nimport TextSubscript from './files/text-subscript.svg'\nimport TextSuperscript from './files/text-superscript.svg'\nimport TransformRotateIcon from './files/transform-rotate.svg'\nimport TransformFlipHIcon from './files/transform-flip-h.svg'\nimport TransformFlipVIcon from './files/transform-flip-v.svg'\nimport UndoIcon from './files/undo.svg'\nimport ZoomInIcon from './files/zoom-in.svg'\nimport ZoomOutIcon from './files/zoom-out.svg'\nimport TextSpecialSymbolsIcon from './files/text-special-symbols.svg'\nimport Save1Icon from './files/save-1.svg'\nimport Open1Icon from './files/open-1.svg'\nimport ResetIcon from './files/reset.svg'\nimport CloseIcon from './files/close.svg'\nimport GeneralIcon from './files/general.svg'\nimport GeneralWhiteIcon from './files/general-white.svg'\nimport StereoIcon from './files/stereo.svg'\nimport StereoWhiteIcon from './files/stereo-white.svg'\nimport AtomsIcon from './files/atoms.svg'\nimport AtomsWhiteIcon from './files/atoms-white.svg'\nimport BondsIcon from './files/bonds.svg'\nimport BondsWhiteIcon from './files/bonds-white.svg'\nimport ServerIcon from './files/server.svg'\nimport ServerWhiteIcon from './files/server-white.svg'\nimport ThreeDViewerIcon from './files/3d.svg'\nimport ThreeDViewerWhiteIcon from './files/3d-white.svg'\nimport DebuggingIcon from './files/debugging.svg'\nimport DebuggingWhiteIcon from './files/debugging-white.svg'\nimport DropdownIndicatorIcon from './files/dropdown-indicator.svg'\nimport ChevronIcon from './files/chevron.svg'\nimport FullscreenEnterIcon from './files/fullscreen-enter.svg'\nimport FullscreenExitIcon from './files/fullscreen-exit.svg'\nimport α from './files/α.svg'\nimport β from './files/β.svg'\nimport γ from './files/γ.svg'\nimport δ from './files/δ.svg'\nimport ε from './files/ε.svg'\nimport ζ from './files/ζ.svg'\nimport η from './files/η.svg'\nimport θ from './files/θ.svg'\nimport ι from './files/ι.svg'\nimport κ from './files/κ.svg'\nimport λ from './files/λ.svg'\nimport μ from './files/μ.svg'\nimport ν from './files/ν.svg'\nimport ξ from './files/ξ.svg'\nimport ο from './files/ο.svg'\nimport π from './files/π.svg'\nimport ρ from './files/ρ.svg'\nimport σ from './files/σ.svg'\nimport τ from './files/τ.svg'\nimport υ from './files/υ.svg'\nimport φ from './files/φ.svg'\nimport χ from './files/χ.svg'\nimport ψ from './files/ψ.svg'\nimport ω from './files/ω.svg'\nimport DegreeCelseusIcon from './files/degree-celseus.svg'\nimport DegreeFahreinheitIcon from './files/degree-fahreinheit.svg'\nimport AngstromIcon from './files/angstrom.svg'\nimport DegreeIcon from './files/degree-symbol.svg'\nimport PlanckDiracConstantIcon from './files/planck-dirac-constant.svg'\nimport PlusMinusIcon from './files/plus-minus.svg'\nimport PromilleIcon from './files/promille.svg'\nimport RootIcon from './files/root-symbol.svg'\nimport LeftArrowIcon from './files/left-arrow.svg'\nimport RightArrowIcon from './files/right-arrow.svg'\nimport LeftArrowCrossedOutIcon from './files/left-arrow-crossed-out.svg'\nimport RightArrowCrossedOutIcon from './files/right-arrow-crossed-out.svg'\nimport LeftAndRightArrowIcon from './files/left-and-right-arrow.svg'\nimport CapitalPiIcon from './files/capital-pi.svg'\nimport SumIcon from './files/sum-symbol.svg'\nimport InfinityIcon from './files/infinity-sign.svg'\nimport PartialDerivativeIcon from './files/partial-derivative.svg'\nimport DeltaIcon from './files/delta-sign.svg'\nimport IntegralIcon from './files/integral.svg'\nimport ApproximatelyEqualIcon from './files/approximately-equal.svg'\nimport NotEqualIcon from './files/not-equal.svg'\nimport LessOrEqualIcon from './files/less-or-equal.svg'\nimport MoreOrEqualIcon from './files/more-or-equal.svg'\nimport AnyAtomIcon from './files/any-atom.svg'\n\nconst icons = {\n  α: α,\n  β: β,\n  γ: γ,\n  δ: δ,\n  ε: ε,\n  ζ: ζ,\n  η: η,\n  θ: θ,\n  ι: ι,\n  κ: κ,\n  λ: λ,\n  μ: μ,\n  ν: ν,\n  ξ: ξ,\n  ο: ο,\n  π: π,\n  ρ: ρ,\n  σ: σ,\n  τ: τ,\n  υ: υ,\n  φ: φ,\n  χ: χ,\n  ψ: ψ,\n  ω: ω,\n  Å: AngstromIcon,\n  '°': DegreeIcon,\n  ħ: PlanckDiracConstantIcon,\n  '±': PlusMinusIcon,\n  '‰': PromilleIcon,\n  '√': RootIcon,\n  '←': LeftArrowIcon,\n  '→': RightArrowIcon,\n  '←/': LeftArrowCrossedOutIcon,\n  '/→': RightArrowCrossedOutIcon,\n  '↔': LeftAndRightArrowIcon,\n  '∏': CapitalPiIcon,\n  '∑': SumIcon,\n  '∞': InfinityIcon,\n  '∂': PartialDerivativeIcon,\n  '∆': DeltaIcon,\n  '∫': IntegralIcon,\n  '≈': ApproximatelyEqualIcon,\n  '=/': NotEqualIcon,\n  '≤': LessOrEqualIcon,\n  '≥': MoreOrEqualIcon,\n  '℉': DegreeFahreinheitIcon,\n  '℃': DegreeCelseusIcon,\n  about: AboutIcon,\n  analyse: AnalyseIcon,\n  'any-atom': AnyAtomIcon,\n  arom: AromIcon,\n  'arrow-upward': ArrowUpwardIcon,\n  'bond-any': BondAnyIcon,\n  'bond-aromatic': BondAromaticIcon,\n  'bond-crossed': BondCrossedIcon,\n  'bond-hydrogen': BondHydrogenIcon,\n  'bond-dative': BondDative,\n  'bond-double': BondDoubleIcon,\n  'bond-doublearomatic': BondDoubleAromaticIcon,\n  'bond-down': BondDownIcon,\n  'bond-single': BondSingleIcon,\n  'bond-singlearomatic': BondSingleAromaticIcon,\n  'bond-singledouble': BondSingleDoubleIcon,\n  'bond-triple': BondTripleIcon,\n  'bond-up': BondUpIcon,\n  'bond-updown': BondUpdownIcon,\n  'capital-t': CapitalTIcon,\n  chain: ChainIcon,\n  'charge-minus': ChargeMinusIcon,\n  'charge-plus': ChargePlusIcon,\n  check: CheckIcon,\n  'chiral-flag': ChiralFlagIcon,\n  cip: CipIcon,\n  clean: CleanIcon,\n  copies: CopyIcon,\n  copy: CopyIcon,\n  'copy-image': CopyImageIcon,\n  'copy-mol': CopyMolIcon,\n  'copy-ket': CopyKetIcon,\n  cut: CutIcon,\n  dearom: DearomIcon,\n  delete: DeleteIcon,\n  dropdown: DropdownIcon,\n  'enhanced-stereo': EnhancedStereoIcon,\n  edit: EditIcon,\n  'elements-group': ElementsGroupIcon,\n  'extended-table': ExtendedTableIcon,\n  erase: EraseIcon,\n  'file-thumbnail': FileThumbnailIcon,\n  'fullscreen-enter': FullscreenEnterIcon,\n  'fullscreen-exit': FullscreenExitIcon,\n  'generic-groups': GenericGroupsIcon,\n  hand: HandIcon,\n  compressedhand: CompressedHandIcon,\n  help: HelpIcon,\n  history: HistoryIcon,\n  'image-frame': ImageFrameIcon,\n  layout: LayoutIcon,\n  logo: LogoIcon,\n  miew: MiewIcon,\n  clear: ClearIcon,\n  open: OpenIcon,\n  paste: PasteIcon,\n  'period-table': PeriodTableIcon,\n  'reaction-arrow-elliptical-arc-arrow-filled-bow':\n    ReactionArrowEllipticalArcArrowFilledBow,\n  'reaction-arrow-elliptical-arc-arrow-filled-triangle':\n    ReactionArrowEllipticalArcArrowFilledTriangle,\n  'reaction-arrow-elliptical-arc-arrow-open-angle':\n    ReactionArrowEllipticalArcArrowOpenAngle,\n  'reaction-arrow-elliptical-arc-arrow-open-half-angle':\n    ReactionArrowEllipticalArcArrowOpenHalfAngle,\n  'reaction-arrow-open-angle': ReactionArrowOpenAngleIcon,\n  'reaction-arrow-filled-triangle': ReactionArrowFilledTriangle,\n  'reaction-arrow-filled-bow': ReactionArrowFilledBow,\n  'reaction-arrow-dashed-open-angle': ReactionArrowDashedOpenAngle,\n  'reaction-arrow-failed': ReactionArrowFailed,\n  'reaction-arrow-both-ends-filled-triangle':\n    ReactionArrowBothEndsFilledTriangle,\n  'reaction-arrow-equilibrium-filled-half-bow':\n    ReactionArrowEquilibriumFilledHalfBow,\n  'reaction-arrow-equilibrium-filled-triangle':\n    ReactionArrowEquilibriumFilledTriangle,\n  'reaction-arrow-equilibrium-open-angle': ReactionArrowEquilibriumOpenAngle,\n  'reaction-arrow-unbalanced-equilibrium-filled-half-bow':\n    ReactionArrowUnbalancedEquilibriumFilledHalfBow,\n  'reaction-arrow-unbalanced-equilibrium-open-half-angle':\n    ReactionArrowUnbalancedEquilibriumOpenHalfAngle,\n  'reaction-arrow-unbalanced-equilibrium-large-filled-half-bow':\n    ReactionArrowUnbalancedEquilibriumLargeFilledHalfBow,\n  'reaction-arrow-unbalanced-equilibrium-filled-half-triangle':\n    ReactionArrowUnbalancedEquilibriumFilledHalfTriangle,\n  'reaction-automap': ReactionAutomapIcon,\n  'reaction-map': ReactionMapIcon,\n  'reaction-plus': ReactionPlusIcon,\n  'reaction-unmap': ReactionUnmapIcon,\n  recognize: RecognizeIcon,\n  redo: RedoIcon,\n  'rgroup-attpoints': RgroupAttpointsIcon,\n  'rgroup-fragment': RgroupFragmentIcon,\n  'rgroup-label': RgroupLabelIcon,\n  save: SaveIcon,\n  search: SearchIcon,\n  'select-fragment': SelectFragmentIcon,\n  'select-lasso': SelectLassoIcon,\n  'select-rectangle': SelectRectangleIcon,\n  settings: SettingsIcon,\n  sgroup: SgroupIcon,\n  'template-0': Template0Icon,\n  'template-1': Template1Icon,\n  'template-2': Template2Icon,\n  'template-3': Template3Icon,\n  'template-4': Template4Icon,\n  'template-5': Template5Icon,\n  'template-6': Template6Icon,\n  'template-7': Template7Icon,\n  'template-dialog': TemplateDialogIcon,\n  'template-lib': TemplateLibIcon,\n  text: TextIcon,\n  'text-bold': TextBold,\n  'text-italic': TextItalic,\n  'text-subscript': TextSubscript,\n  'text-superscript': TextSuperscript,\n  'transform-flip-h': TransformFlipHIcon,\n  'transform-flip-v': TransformFlipVIcon,\n  'transform-rotate': TransformRotateIcon,\n  undo: UndoIcon,\n  'zoom-in': ZoomInIcon,\n  'zoom-out': ZoomOutIcon,\n  'shape-ellipse': ShapeEllipseIcon,\n  'shape-rectangle': ShapeRectangleIcon,\n  'shape-polyline': ShapePolylineIcon,\n  'shape-line': ShapeLineIcon,\n  'not-found': NotFoundIcon,\n  'save-1': Save1Icon,\n  'open-1': Open1Icon,\n  reset: ResetIcon,\n  close: CloseIcon,\n  general: GeneralIcon,\n  'general-white': GeneralWhiteIcon,\n  stereo: StereoIcon,\n  'stereo-white': StereoWhiteIcon,\n  atoms: AtomsIcon,\n  'atoms-white': AtomsWhiteIcon,\n  bonds: BondsIcon,\n  'bonds-white': BondsWhiteIcon,\n  server: ServerIcon,\n  'server-white': ServerWhiteIcon,\n  '3dviewer': ThreeDViewerIcon,\n  '3dviewer-white': ThreeDViewerWhiteIcon,\n  debugging: DebuggingIcon,\n  'debugging-white': DebuggingWhiteIcon,\n  'dropdown-indicator': DropdownIndicatorIcon,\n  'text-special-symbols': TextSpecialSymbolsIcon,\n  chevron: ChevronIcon,\n  'open-window-paste-icon': OpenWindowPasteIcon,\n  'open-window-upload-icon': OpenWindowUploadIcon\n}\n\nfunction emptyIcon() {\n  return null\n}\n\nexport default function findIconByName(name) {\n  if (name && icons.hasOwnProperty(name)) {\n    const component = icons[name]\n    return component\n  } else {\n    return emptyIcon\n  }\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport findIconByName from './../../../../icons'\n\nfunction Icon({ name, ...props }) {\n  const Component = findIconByName(name)\n  return <Component {...props} />\n}\nexport default Icon\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\nimport { isMacOs } from 'react-device-detect'\n\nconst shortcutAliasMap = {\n  Escape: 'Esc',\n  Delete: 'Del',\n  Mod: isMacOs ? '⌘' : 'Ctrl'\n}\n\nexport function shortcutStr(shortcut?: string | string[]) {\n  if (!shortcut) {\n    return ''\n  }\n\n  const shortcutKey = Array.isArray(shortcut) ? shortcut[0] : shortcut\n  return shortcutKey.replace(\n    /(\\b[a-z]\\b$|Mod|Escape|Delete)/g,\n    (key) => shortcutAliasMap[key] || key.toUpperCase()\n  )\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { UiAction, UiActionAction } from '../../../../action'\n\nimport Icon from '../../../../component/view/icon'\nimport classes from './ActionButton.module.less'\nimport clsx from 'clsx'\nimport { shortcutStr } from '../../shortcutStr'\n\ninterface ActionButtonProps {\n  name: string\n  action?: UiAction\n  status?: {\n    disabled?: boolean\n    hidden?: boolean\n  }\n  selected?: boolean\n  disableableButtons: string[]\n  indigoVerification: boolean\n  className?: string\n}\n\ninterface ActionButtonCallProps {\n  onAction: (action: UiActionAction) => void\n}\n\ntype Props = ActionButtonProps & ActionButtonCallProps\n\nconst ActionButton = (props: Props) => {\n  const {\n    name,\n    action,\n    status = {},\n    selected = false,\n    disableableButtons,\n    indigoVerification,\n    className,\n    onAction\n  } = props\n\n  if (status.hidden) {\n    return null\n  }\n\n  const shortcut = shortcutStr(action?.shortcut)\n  const disabled =\n    status.disabled || (indigoVerification && disableableButtons.includes(name))\n\n  const handleClick = () => {\n    if (action?.action) {\n      onAction(action.action)\n    }\n  }\n\n  return (\n    <button\n      disabled={disabled}\n      onClick={handleClick}\n      title={shortcut ? `${action?.title} (${shortcut})` : action?.title}\n      className={clsx(\n        classes.button,\n        {\n          [classes.selected]: selected\n        },\n        className\n      )}\n    >\n      <Icon name={name} />\n      <kbd>{shortcut}</kbd>\n    </button>\n  )\n}\n\nexport type { ActionButtonProps, ActionButtonCallProps }\nexport { ActionButton }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { CSSProperties, Component, ReactNode } from 'react'\n\nimport ReactDOM from 'react-dom'\n\nconst CLASSNAME_SEPARATOR = ' '\n\ninterface PortalProps {\n  isOpen: boolean\n  className?: string\n  style?: CSSProperties\n  children: ReactNode\n}\n\ntype Props = PortalProps\n\nclass Portal extends Component<Props> {\n  private readonly element: HTMLDivElement\n  private isElementInDom: boolean\n\n  constructor(props) {\n    super(props)\n    this.element = document.createElement('div')\n    this.isElementInDom = false\n  }\n\n  componentDidMount() {\n    if (!this.isElementInDom && this.props.isOpen) {\n      this.addElementInDOM()\n    }\n\n    const { className, style } = this.props\n    if (className) {\n      this.addClassName(className)\n    }\n    if (style) {\n      this.updateStyle(style)\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.isElementInDom) {\n      this.removeElementFromDOM()\n    }\n  }\n\n  componentDidUpdate(prevProps: Readonly<Props>) {\n    const { isOpen, className, style } = this.props\n    if (className !== prevProps.className) {\n      this.removeClassNames(prevProps.className)\n      this.addClassName(className)\n    }\n\n    if (style !== prevProps.style) {\n      this.updateStyle(style, prevProps.style)\n    }\n\n    if (isOpen === prevProps.isOpen) {\n      return\n    }\n\n    if (isOpen && !this.isElementInDom) {\n      this.addElementInDOM()\n    } else if (this.isElementInDom) {\n      this.removeElementFromDOM()\n    }\n  }\n\n  private addElementInDOM() {\n    document.querySelector('.Ketcher-root')?.appendChild(this.element)\n    this.isElementInDom = true\n  }\n\n  private removeElementFromDOM() {\n    document.querySelector('.Ketcher-root')?.removeChild(this.element)\n    this.isElementInDom = false\n  }\n\n  private removeClassNames(classNames?: string) {\n    if (!classNames) {\n      return\n    }\n\n    classNames.split(CLASSNAME_SEPARATOR).forEach((className) => {\n      this.element.classList.remove(className)\n    })\n  }\n\n  private addClassName(classNames?: string) {\n    if (!classNames) {\n      return\n    }\n\n    classNames.split(CLASSNAME_SEPARATOR).forEach((className) => {\n      this.element.classList.add(className)\n    })\n  }\n\n  private updateStyle(style?: CSSProperties, prevStyle?: CSSProperties) {\n    if (prevStyle) {\n      Object.keys(prevStyle).forEach((property) => {\n        this.element.style[property] = ''\n      }, this)\n    }\n\n    if (!style) {\n      return\n    }\n\n    Object.keys(style).forEach((property) => {\n      this.element.style[property] = style[property]\n    }, this)\n  }\n\n  render() {\n    const { children } = this.props\n    const component = ReactDOM.createPortal(children, this.element)\n    return component as any\n  }\n}\n\nexport { Portal }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { MultiToolCallProps, MultiToolProps } from '../variants.types'\n\nimport { ActionButton, ActionButtonProps } from '../../../ActionButton'\nimport action from '../../../../../../action'\n\ntype DefaultMultiToolProps = MultiToolProps\ntype DefaultMultiToolCallProps = MultiToolCallProps\n\ntype Props = DefaultMultiToolProps & DefaultMultiToolCallProps\n\nconst DefaultMultiTool = (props: Props) => {\n  const { options, status, disableableButtons, indigoVerification, onAction } =\n    props\n\n  return (\n    <>\n      {options.map((toolbarItem) => {\n        const currentStatus = status[toolbarItem.id]\n        return (\n          <ActionButton\n            key={toolbarItem.id}\n            name={toolbarItem.id}\n            action={action[toolbarItem.id]}\n            status={currentStatus as ActionButtonProps['status']}\n            selected={!!currentStatus?.selected}\n            disableableButtons={disableableButtons}\n            indigoVerification={indigoVerification}\n            onAction={onAction}\n          />\n        )\n      })}\n    </>\n  )\n}\n\nexport type { DefaultMultiToolProps, DefaultMultiToolCallProps }\nexport { DefaultMultiTool }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { MultiToolCallProps, MultiToolProps } from '../variants.types'\n\nimport { ActionButton, ActionButtonProps } from '../../../ActionButton'\nimport action from '../../../../../../action'\nimport classes from './GroupedMultiTool.module.less'\n\ntype GroupedMultiToolProps = MultiToolProps\ntype GroupedMultiToolCallProps = MultiToolCallProps\n\ntype Props = GroupedMultiToolProps & GroupedMultiToolCallProps\n\nconst GroupedMultiTool = (props: Props) => {\n  const {\n    groups,\n    options,\n    status,\n    disableableButtons,\n    indigoVerification,\n    onAction\n  } = props\n\n  if (!groups) {\n    return null\n  }\n\n  return (\n    <>\n      {groups.map((descriptor) => (\n        <div className={classes.group} key={descriptor.start}>\n          {options\n            .slice(descriptor.start, descriptor.end)\n            .map((toolbarItem) => {\n              const currentStatus = status[toolbarItem.id]\n              return (\n                <ActionButton\n                  key={toolbarItem.id}\n                  name={toolbarItem.id}\n                  action={action[toolbarItem.id]}\n                  status={currentStatus as ActionButtonProps['status']}\n                  selected={!!currentStatus?.selected}\n                  disableableButtons={disableableButtons}\n                  indigoVerification={indigoVerification}\n                  onAction={onAction}\n                />\n              )\n            })}\n        </div>\n      ))}\n    </>\n  )\n}\n\nexport type { GroupedMultiToolProps, GroupedMultiToolCallProps }\nexport { GroupedMultiTool }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { DefaultMultiTool, classes as defaultClasses } from './DefaultMultiTool'\nimport {\n  MultiToolCallProps,\n  MultiToolProps,\n  MultiToolVariant\n} from './variants.types'\n\nimport { ComponentType } from 'react'\nimport { GroupedMultiTool } from './GroupedMultiTool'\n\nexport function chooseMultiTool(\n  variant: MultiToolVariant = 'default'\n): [ComponentType<MultiToolProps & MultiToolCallProps>, string?] {\n  switch (variant) {\n    case 'default':\n      return [DefaultMultiTool, defaultClasses.default]\n\n    case 'grouped':\n      return [GroupedMultiTool]\n\n    default:\n      throw new Error(`Unsupported variant ${variant}`)\n  }\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { useEffect, useState } from 'react'\n\nimport { ToolbarItem } from '../../toolbar.types'\n\ntype HookParams = [string, string | null, ToolbarItem[]]\n\nfunction usePortalOpening([id, opened, options]: HookParams): [boolean] {\n  const [isOpen, setIsOpen] = useState<boolean>(false)\n\n  useEffect(() => {\n    const currentId = (options.length && options![0].id) || ''\n    const newState = opened === id || opened === currentId\n    setIsOpen(newState)\n  }, [opened, options])\n\n  return [isOpen]\n}\n\nexport { usePortalOpening }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { CSSProperties, RefObject, useEffect, useState } from 'react'\n\ntype HookParams = [RefObject<HTMLDivElement>, boolean]\n\nfunction usePortalStyle([ref, isOpen]: HookParams): [CSSProperties] {\n  const [portalStyle, setPortalStyle] = useState<CSSProperties>({})\n\n  useEffect(() => {\n    if (!ref.current) {\n      return\n    }\n\n    const editorRect = document\n      .querySelector('.Ketcher-root')\n      ?.getBoundingClientRect() || { top: 0, left: 0 }\n    const menuItemRect = ref.current.getBoundingClientRect()\n\n    const top = menuItemRect.top - editorRect.top\n    const spaceBetween = 4\n    const left =\n      menuItemRect.left - editorRect.left + menuItemRect.width + spaceBetween\n\n    setPortalStyle({ top: `${top}px`, left: `${left}px` })\n  }, [ref, isOpen])\n\n  return [portalStyle]\n}\n\nexport { usePortalStyle }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  ActionButton,\n  ActionButtonCallProps,\n  ActionButtonProps\n} from '../ActionButton'\nimport { GroupDescriptor, MultiToolVariant } from './variants/variants.types'\nimport { ToolbarItem, ToolbarItemVariant } from '../../toolbar.types'\nimport action, { UiAction, UiActionAction } from '../../../../action'\n\nimport { useRef } from 'react'\nimport clsx from 'clsx'\nimport Icon from '../../../../component/view/icon'\nimport { Portal } from '../../../../Portal'\nimport { chooseMultiTool } from './variants/chooseMultiTool'\nimport classes from './ToolbarMultiToolItem.module.less'\nimport { usePortalOpening } from './usePortalOpening'\nimport { usePortalStyle } from './usePortalStyle'\nimport { SettingsManager } from '../../../../utils/settingsManager'\n\ninterface ToolbarMultiToolItemProps {\n  id: ToolbarItemVariant\n  options: ToolbarItem[]\n  groups?: GroupDescriptor[]\n  variant?: MultiToolVariant\n  status: {\n    [key in string]?: UiAction\n  }\n  opened: string | null\n  disableableButtons: string[]\n  indigoVerification: boolean\n  className?: string\n  vertical?: boolean\n}\n\ninterface ToolbarMultiToolItemCallProps {\n  onAction: (action: UiActionAction) => void\n  onOpen: (menuName: string, isSelected: boolean) => void\n}\n\ntype Props = ToolbarMultiToolItemProps & ToolbarMultiToolItemCallProps\n\nconst ToolbarMultiToolItem = (props: Props) => {\n  const {\n    id,\n    options,\n    groups,\n    variant,\n    status,\n    opened,\n    indigoVerification,\n    disableableButtons,\n    className,\n    vertical,\n    onAction,\n    onOpen\n  } = props\n\n  const ref = useRef<HTMLDivElement>(null)\n  const [isOpen] = usePortalOpening([id, opened, options])\n  const [portalStyle] = usePortalStyle([ref, isOpen])\n\n  let selected = false\n  let currentId = id\n\n  const selectedTool = options.find(\n    (toolbarItem) => status[toolbarItem.id]?.selected\n  )\n  if (selectedTool) {\n    currentId = selectedTool.id\n    selected = true\n  }\n\n  const currentStatus = status[currentId]\n  // todo: #type find out real type, possible GetActionState is no acceptable here\n  // and check this type convert is redundant\n  selected = selected || Boolean(currentStatus?.selected)\n\n  const allInnerItemsHidden: boolean = options.every(\n    (option) => status[option.id]?.hidden\n  )\n\n  const displayMultiToolItem = !(allInnerItemsHidden || currentStatus?.hidden)\n\n  if (!currentStatus && options.length) {\n    const savedSelectionTool = SettingsManager.selectionTool\n    const savedSelectionToolId =\n      savedSelectionTool &&\n      `${savedSelectionTool.tool}-${savedSelectionTool.opts}`\n    currentId =\n      savedSelectionTool &&\n      savedSelectionToolId &&\n      options.filter(\n        (option) =>\n          !status[option.id]?.hidden && option.id === savedSelectionToolId\n      )[0]?.id\n\n    if (!currentId) {\n      currentId =\n        options.filter((option) => !status[option.id]?.hidden)[0]?.id ||\n        options[0].id\n    }\n  }\n\n  const actionButtonProps: Omit<\n    ActionButtonProps & ActionButtonCallProps,\n    'name' | 'status' | 'action'\n  > = {\n    disableableButtons,\n    indigoVerification,\n    onAction: selected ? () => onOpenOptions() : onAction\n  }\n\n  const onOpenOptions = () => {\n    // todo: same as #type above\n    onOpen(id, Boolean(currentStatus?.selected))\n  }\n\n  const [Component, portalClassName] = chooseMultiTool(variant)\n\n  return displayMultiToolItem ? (\n    <div ref={ref} className={classes.root}>\n      <ActionButton\n        {...actionButtonProps}\n        className={className}\n        name={currentId}\n        action={action[currentId]}\n        status={currentStatus as ActionButtonProps['status']}\n        selected={selected}\n      />\n      {!isOpen && (\n        <Icon\n          className={`${classes.icon} ${\n            currentStatus?.selected && classes.iconSelected\n          }`}\n          name=\"dropdown\"\n          onClick={onOpenOptions}\n        />\n      )}\n\n      {isOpen ? (\n        <Portal\n          isOpen={isOpen}\n          className={clsx(\n            classes.portal,\n            vertical && classes['portal-vertical'],\n            portalClassName\n          )}\n          style={portalStyle}\n        >\n          <Component\n            options={options}\n            groups={groups}\n            status={status}\n            disableableButtons={disableableButtons}\n            indigoVerification={indigoVerification}\n            onAction={onAction}\n          />\n        </Portal>\n      ) : null}\n    </div>\n  ) : null\n}\n\nexport type { ToolbarMultiToolItemProps, ToolbarMultiToolItemCallProps }\nexport { ToolbarMultiToolItem }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport action, { UiAction, UiActionAction } from '../../../action'\n\nimport { ActionButton, ActionButtonProps } from './ActionButton'\nimport { ToolbarItem } from '../toolbar.types'\nimport { ToolbarMultiToolItem } from './ToolbarMultiToolItem'\n\ninterface ToolbarGroupItemProps extends ToolbarItem {\n  status: {\n    [key in string]?: UiAction\n  }\n  opened: string | null\n  disableableButtons: string[]\n  indigoVerification: boolean\n  className?: string\n  vertical?: boolean\n}\n\ninterface ToolbarGroupItemCallProps {\n  onAction: (action: UiActionAction) => void\n  onOpen: (menuName: string, isSelected: boolean) => void\n}\n\ntype Props = ToolbarGroupItemProps & ToolbarGroupItemCallProps\n\nconst ToolbarGroupItem = (props: Props) => {\n  const {\n    id,\n    options,\n    status,\n    className,\n    opened,\n    indigoVerification,\n    disableableButtons,\n    vertical,\n    onAction,\n    onOpen\n  } = props\n\n  if (!options?.length) {\n    return (\n      <ActionButton\n        className={className}\n        name={id}\n        action={action[id]}\n        status={status[id] as ActionButtonProps['status']}\n        selected={!!status[id]?.selected}\n        indigoVerification={indigoVerification}\n        disableableButtons={disableableButtons}\n        onAction={onAction}\n      />\n    )\n  }\n\n  return (\n    <ToolbarMultiToolItem\n      className={className}\n      id={id}\n      options={options}\n      status={status}\n      opened={opened}\n      disableableButtons={disableableButtons}\n      indigoVerification={indigoVerification}\n      onAction={onAction}\n      onOpen={onOpen}\n      vertical={vertical}\n    />\n  )\n}\n\nexport type { ToolbarGroupItemProps, ToolbarGroupItemCallProps }\nexport { ToolbarGroupItem }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport action, { UiAction, UiActionAction } from '../../../../action'\n\nimport { ActionButton } from '../../ToolbarGroupItem/ActionButton'\nimport templates from '../../../../data/templates'\n\ninterface TemplatesListProps {\n  active?: {\n    tool?: string\n    opts: {\n      struct: any\n    }\n  }\n  disableableButtons: string[]\n  indigoVerification: boolean\n}\n\ninterface TemplatesListCallProps {\n  onAction: (action: UiActionAction) => void\n}\n\ntype Props = TemplatesListProps & TemplatesListCallProps\n\nconst TemplatesList = (props: Props) => {\n  const { active, disableableButtons, indigoVerification, onAction } = props\n\n  const isTemplate = active && active.tool === 'template'\n\n  const makeAction = (struct, index): UiAction => ({\n    shortcut: action[`template-${index}`].shortcut,\n    action: { tool: 'template', opts: { struct } },\n    title: struct.name\n  })\n\n  return (\n    <>\n      {templates.map((struct, index) => (\n        <ActionButton\n          key={`template-${index}`}\n          name={`template-${index}`}\n          action={makeAction(struct, index)}\n          onAction={onAction}\n          selected={isTemplate && active && active.opts.struct === struct}\n          status={action[`template-${index}`]}\n          disableableButtons={disableableButtons}\n          indigoVerification={indigoVerification}\n        />\n      ))}\n    </>\n  )\n}\n\nexport type { TemplatesListProps, TemplatesListCallProps }\nexport { TemplatesList }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { FC, PropsWithChildren } from 'react'\nimport {\n  ToolbarGroupItem,\n  ToolbarGroupItemCallProps,\n  ToolbarGroupItemProps\n} from '../ToolbarGroupItem'\n\nimport { TemplatesList } from './TemplatesList'\nimport classes from './BottomToolbar.module.less'\nimport clsx from 'clsx'\n\nconst Group: FC<{ className?: string } & PropsWithChildren> = ({\n  children,\n  className\n}) => <div className={clsx(classes.group, className)}>{children}</div>\n\ninterface BottomToolbarProps\n  extends Omit<ToolbarGroupItemProps, 'id' | 'options'> {\n  className?: string\n  active?: {\n    opts: any\n    tool: string\n  }\n}\n\ntype BottomToolbarCallProps = ToolbarGroupItemCallProps\n\ntype Props = BottomToolbarProps & BottomToolbarCallProps\n\nconst BottomToolbar = (props: Props) => {\n  const { className, ...rest } = props\n  const { active, disableableButtons, indigoVerification, onAction } = rest\n\n  return (\n    <div className={clsx(classes.root, className)}>\n      <Group>\n        <TemplatesList\n          active={active}\n          indigoVerification={indigoVerification}\n          disableableButtons={disableableButtons}\n          onAction={onAction}\n        />\n      </Group>\n\n      <Group>\n        <ToolbarGroupItem id=\"template-lib\" {...rest} />\n      </Group>\n    </div>\n  )\n}\n\nexport type { BottomToolbarProps, BottomToolbarCallProps }\nexport { BottomToolbar }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { KetSerializer, SdfSerializer } from 'ketcher-core'\n\nimport { appUpdate } from '../options'\nimport { storage } from '../../storage-ext'\nimport templatesRawData from '../../../../templates/library.sdf'\n\nexport function initLib(lib) {\n  return {\n    type: 'TMPL_INIT',\n    data: { lib }\n  }\n}\n\nexport default function initTmplLib(dispatch, baseUrl, cacheEl) {\n  const fileName = 'library.sdf'\n  return deserializeSdfTemplates(baseUrl, cacheEl, fileName).then((res) => {\n    const lib = res.concat(userTmpls())\n    dispatch(initLib(lib))\n    dispatch(appUpdate({ templates: true }))\n  })\n}\n\nconst deserializeSdfTemplates = (baseUrl, cacheEl, fileName) => {\n  const sdfSerializer = new SdfSerializer()\n  const tmpls = sdfSerializer.deserialize(templatesRawData)\n  const prefetch = prefetchRender(tmpls, baseUrl + '/templates/', cacheEl)\n\n  return prefetch.then((cachedFiles) =>\n    tmpls.map((tmpl) => {\n      const pr = prefetchSplit(tmpl)\n      if (pr.file)\n        tmpl.props.prerender =\n          cachedFiles.indexOf(pr.file) !== -1 ? `#${pr.id}` : ''\n\n      return tmpl\n    })\n  )\n}\n\nfunction userTmpls() {\n  const userLib = storage.getItem('ketcher-tmpls')\n  if (!Array.isArray(userLib) || userLib.length === 0) return []\n  const ketSerializer = new KetSerializer()\n  return userLib\n    .map((tmpl) => {\n      try {\n        if (tmpl.props === '') tmpl.props = {}\n        tmpl.props.group = 'User Templates'\n\n        return {\n          struct: ketSerializer.deserialize(tmpl.struct),\n          props: tmpl.props\n        }\n      } catch (ex) {\n        return null\n      }\n    })\n    .filter((tmpl) => tmpl !== null)\n}\n\nexport function prefetchStatic(url) {\n  return fetch(url, { credentials: 'same-origin' }).then((resp) => {\n    if (resp.ok) return resp.text()\n    throw Error('Could not fetch ' + url)\n  })\n}\n\nfunction prefetchSplit(tmpl) {\n  const pr = tmpl.props.prerender\n  const res = pr && pr.split('#', 2)\n\n  return {\n    file: pr && res[0],\n    id: pr && res[1]\n  }\n}\n\nfunction prefetchRender(tmpls, baseUrl, cacheEl) {\n  const files = tmpls.reduce((res, tmpl) => {\n    const file = prefetchSplit(tmpl).file\n\n    if (file && res.indexOf(file) === -1) res.push(file)\n\n    return res\n  }, [])\n  const fetch = Promise.all(\n    files.map((fn) => prefetchStatic(baseUrl + fn).catch(() => null))\n  )\n\n  return fetch.then((svgs) => {\n    svgs.forEach((svgContent) => {\n      if (svgContent) cacheEl.innerHTML += svgContent\n    })\n\n    return files.filter((file, i) => !!svgs[i])\n  })\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { formReducer, formsState } from './form'\n\nexport function openDialog(dispatch, dialogName, props) {\n  return new Promise((resolve, reject) => {\n    dispatch({\n      type: 'MODAL_OPEN',\n      data: {\n        name: dialogName,\n        prop: {\n          ...props,\n          onResult: resolve,\n          onCancel: reject\n        }\n      }\n    })\n  })\n}\n\nfunction modalReducer(state = null, action) {\n  const { type, data } = action\n\n  if (type === 'UPDATE_FORM') {\n    // Don't update if modal has already been closed\n    // TODO: refactor actions and server functions in /src/script/ui/state/server/index.js to\n    // not send 'UPDATE_FORM' action to a closed modal in the first place\n    if (!state) {\n      return null\n    }\n\n    const formState = formReducer(state.form, action)\n    return { ...state, form: formState }\n  }\n\n  switch (type) {\n    case 'MODAL_CLOSE':\n      return null\n    case 'MODAL_OPEN':\n      return {\n        name: data.name,\n        form: formsState[data.name] || null,\n        prop: data.prop || null\n      }\n    default:\n      return state\n  }\n}\n\nexport default modalReducer\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport initTmplLib, { initLib } from './init-lib'\n\nimport { KetSerializer } from 'ketcher-core'\nimport { omit } from 'lodash/fp'\nimport { openDialog } from '../modal'\nimport { storage } from '../../storage-ext'\n\nexport { initTmplLib }\n\n/* TEMPLATES */\nexport function selectTmpl(tmpl) {\n  return {\n    type: 'TMPL_SELECT',\n    data: { selected: tmpl }\n  }\n}\n\nexport function changeGroup(group) {\n  return {\n    type: 'TMPL_CHANGE_GROUP',\n    data: { group, selected: null }\n  }\n}\n\nexport function changeFilter(filter) {\n  return {\n    type: 'TMPL_CHANGE_FILTER',\n    data: { filter, selected: null }\n  }\n}\n\nexport function changeTab(tab) {\n  return {\n    type: 'TMPL_CHANGE_TAB',\n    data: { tab }\n  }\n}\n\n/* TEMPLATE-ATTACH-EDIT */\nexport function initAttach(name, attach) {\n  return {\n    type: 'INIT_ATTACH',\n    data: {\n      name,\n      atomid: attach.atomid,\n      bondid: attach.bondid\n    }\n  }\n}\n\nexport function setAttachPoints(attach) {\n  return {\n    type: 'SET_ATTACH_POINTS',\n    data: {\n      atomid: attach.atomid,\n      bondid: attach.bondid\n    }\n  }\n}\n\nexport function setTmplName(name) {\n  return {\n    type: 'SET_TMPL_NAME',\n    data: { name }\n  }\n}\n\nexport function editTmpl(tmpl) {\n  return (dispatch, getState) => {\n    openDialog(dispatch, 'attach', { tmpl })\n      .then(\n        (formData) => {\n          tmpl.struct.name = formData ? formData.name.trim() : tmpl.struct.name\n          tmpl.props = formData\n            ? Object.assign({}, tmpl.props, formData.attach)\n            : tmpl.props\n\n          if (tmpl.props.group === 'User Templates')\n            updateLocalStore(getState().templates.lib)\n        },\n        () => null\n      )\n      .then(() => openDialog(dispatch, 'templates').catch(() => null))\n  }\n}\n\nexport function deleteUserTmpl(tmpl) {\n  return {\n    type: 'TMPL_DELETE',\n    data: {\n      tmpl: tmpl\n    }\n  }\n}\n\nexport function deleteTmpl(tmpl) {\n  return (dispatch, getState) => {\n    const lib = getState().templates.lib.filter((value) => value !== tmpl)\n    dispatch(deleteUserTmpl(tmpl))\n    updateLocalStore(lib)\n  }\n}\n\n/* SAVE */\nexport function saveUserTmpl(struct) {\n  // TODO: structStr can be not in mol format => structformat.toString ...\n  const tmpl = { struct: struct.clone(), props: {} }\n\n  return (dispatch, getState) => {\n    openDialog(dispatch, 'attach', { tmpl })\n      .then(({ name, attach }) => {\n        tmpl.struct.name = name.trim()\n        tmpl.props = { ...attach, group: 'User Templates' }\n\n        const lib = getState().templates.lib.concat(tmpl)\n        dispatch(initLib(lib))\n        updateLocalStore(lib)\n      })\n      .catch(() => null)\n  }\n}\n\nfunction updateLocalStore(lib) {\n  const ketSerializer = new KetSerializer()\n  const userLib = lib\n    .filter((item) => item.props.group === 'User Templates')\n    .map((item) => ({\n      struct: ketSerializer.serialize(item.struct),\n      props: Object.assign({}, omit(['group'], item.props))\n    }))\n\n  storage.setItem('ketcher-tmpls', userLib)\n}\n\n/* REDUCER */\nexport const initTmplsState = {\n  lib: [],\n  selected: null,\n  filter: '',\n  group: null,\n  attach: {},\n  mode: 'classic',\n  tab: 0\n}\n\nconst tmplActions = [\n  'TMPL_INIT',\n  'TMPL_SELECT',\n  'TMPL_CHANGE_GROUP',\n  'TMPL_CHANGE_FILTER',\n  'TMPL_CHANGE_TAB'\n]\n\nconst attachActions = ['INIT_ATTACH', 'SET_ATTACH_POINTS', 'SET_TMPL_NAME']\n\nfunction templatesReducer(state = initTmplsState, action) {\n  if (tmplActions.includes(action.type))\n    return Object.assign({}, state, action.data)\n\n  if (attachActions.includes(action.type)) {\n    const attach = Object.assign({}, state.attach, action.data)\n    return { ...state, attach }\n  }\n\n  if (action.type === 'TMPL_DELETE') {\n    const currentState = Object.assign({}, state)\n    const lib = currentState.lib.filter((value) => value !== action.data.tmpl)\n    return { ...currentState, lib: lib }\n  }\n\n  return state\n}\n\nexport default templatesReducer\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { isEmpty, isEqual, pickBy } from 'lodash/fp'\n\nimport { SettingsManager } from '../../utils/settingsManager'\nimport actions from '../../action'\n\nfunction execute(activeTool, { action, editor, server, options }) {\n  if (action.tool) {\n    if (editor.tool(action.tool, action.opts)) {\n      return action\n    }\n  } else if (typeof action === 'function') {\n    action(editor, server, options)\n  } else {\n    console.info('no action')\n  }\n  return activeTool\n}\n\nfunction selected(actObj, activeTool, { editor, server }) {\n  if (typeof actObj.selected === 'function')\n    return actObj.selected(editor, server)\n  else if (actObj.action && actObj.action.tool)\n    return isEqual(activeTool, actObj.action)\n  return false\n}\n\nfunction disabled(actObj, { editor, server, options }) {\n  if (typeof actObj.disabled === 'function')\n    return actObj.disabled(editor, server, options)\n  return false\n}\n\nfunction hidden(actObj, { options }) {\n  if (typeof actObj.hidden === 'function') return actObj.hidden(options)\n  return false\n}\n\nfunction status(actionName, activeTool, params) {\n  const actObj = actions[actionName]\n  return pickBy((x) => x, {\n    selected: selected(actObj, activeTool, params),\n    disabled: disabled(actObj, params),\n    hidden: hidden(actObj, params)\n  })\n}\n\nexport default function (state = null, { type, action, ...params }) {\n  let activeTool\n  switch (type) {\n    case 'INIT': {\n      const savedSelectedTool = SettingsManager.selectionTool\n      action = savedSelectedTool || actions['select-rectangle'].action\n    }\n    case 'ACTION':\n      activeTool = execute(state && state.activeTool, {\n        ...params,\n        action\n      })\n      if (activeTool.tool === 'select') {\n        SettingsManager.selectionTool = activeTool\n      }\n    case 'UPDATE':\n      return Object.keys(actions).reduce(\n        (res, actionName) => {\n          const value = status(actionName, res.activeTool, params)\n          if (!isEmpty(value)) res[actionName] = value\n          return res\n        },\n        { activeTool: activeTool || state.activeTool }\n      )\n    default:\n      return state\n  }\n}\n","import { Render, Struct } from 'ketcher-core'\n\n/**\n * Is used to improve search and opening tab performance in Template Dialog\n * Rendering a lot of structures causes great delay\n */\nconst renderCache = new Map()\n\nexport class RenderStruct {\n  /**\n   * for S-Groups we want to show expanded structure\n   * without brackets\n   */\n  static prepareStruct(struct: Struct) {\n    if (struct.sgroups.size > 0) {\n      const newStruct = struct.clone()\n      newStruct.sgroups.delete(0)\n      return newStruct\n    }\n    return struct\n  }\n\n  static render(\n    el: HTMLElement | null,\n    struct: Struct | null,\n    options: any = {}\n  ) {\n    if (el && struct) {\n      const { cachePrefix = '' } = options\n      const cacheKey = `${cachePrefix}${struct.name}`\n      if (renderCache.has(cacheKey)) {\n        el.innerHTML = renderCache.get(cacheKey)\n        return\n      }\n      const preparedStruct = this.prepareStruct(struct)\n      preparedStruct.initHalfBonds()\n      preparedStruct.initNeighbors()\n      preparedStruct.setImplicitHydrogen()\n      preparedStruct.markFragments()\n      const rnd = new Render(el, {\n        autoScale: true,\n        ...options\n      })\n      rnd.setMolecule(preparedStruct)\n      rnd.update(true, options.viewSz)\n      renderCache.set(cacheKey, rnd.clientArea.innerHTML)\n    }\n  }\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nexport function fileOpener(server) {\n  return new Promise((resolve, reject) => {\n    // TODO: refactor return\n    if (global.FileReader) {\n      resolve(throughFileReader)\n    } else if (global.ActiveXObject) {\n      try {\n        const fso = new ActiveXObject('Scripting.FileSystemObject') // eslint-disable-line no-undef\n        resolve((file) => Promise.resolve(throughFileSystemObject(fso, file)))\n      } catch (e) {\n        reject(e)\n      }\n    } else if (server) {\n      resolve(\n        server.then(() => {\n          throw Error(\"Server doesn't still support echo method\")\n          // return resolve(throughForm2IframePosting);\n        })\n      )\n    } else {\n      reject(new Error('Your browser does not support opening files locally'))\n    }\n  })\n}\n\nfunction throughFileReader(file) {\n  const isCDX = file.name.endsWith('cdx') && !file.name.endsWith('b64cdx')\n  return new Promise((resolve, reject) => {\n    const rd = new FileReader() // eslint-disable-line no-undef\n\n    rd.onload = () => {\n      const content = isCDX ? rd.result.slice(37) : rd.result\n      if (file.msClose) file.msClose()\n      resolve(content)\n    }\n\n    rd.onerror = (event) => {\n      reject(event)\n    }\n    isCDX ? rd.readAsDataURL(file) : rd.readAsText(file, 'UTF-8')\n  })\n}\n\nfunction throughFileSystemObject(fso, file) {\n  // IE9 and below\n  const fd = fso.OpenTextFile(file.name, 1)\n  const content = fd.ReadAll()\n  fd.Close()\n  return content\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\nimport _ from 'lodash'\nimport { escapeRegExp, filter as _filter, flow, reduce } from 'lodash/fp'\nimport { Option } from '../component/form/Select'\n\nconst GREEK_SIMBOLS = {\n  Alpha: 'A',\n  alpha: 'α',\n  Beta: 'B',\n  beta: 'β',\n  Gamma: 'Г',\n  gamma: 'γ'\n}\n\nconst greekRe = new RegExp(\n  '\\\\b' + Object.keys(GREEK_SIMBOLS).join('\\\\b|\\\\b') + '\\\\b',\n  'g'\n)\n\nexport function greekify(str: string): string {\n  return str.replace(greekRe, (sym) => GREEK_SIMBOLS[sym])\n}\n\nexport function filterLib(lib, filter: string) {\n  const trimmedFilter = filter.trim()\n  const re = new RegExp(escapeRegExp(greekify(trimmedFilter)), 'i')\n  return flow(\n    _filter(\n      (item: any) =>\n        !trimmedFilter ||\n        re.test(greekify(item.struct.name)) ||\n        re.test(greekify(item.props.group))\n    ),\n    reduce((res, item) => {\n      if (!res[item.props.group]) res[item.props.group] = [item]\n      else res[item.props.group].push(item)\n      return res\n    }, {})\n  )(lib)\n}\n\nexport function filterFGLib(lib, filter) {\n  const trimmedFilter = filter.trim()\n  const re = new RegExp(escapeRegExp(greekify(trimmedFilter)), 'i')\n  const searchFunction = (item) => {\n    const fields = [\n      item.struct.name,\n      item.props.abbreviation,\n      item.props.name\n    ].filter(Boolean)\n    return fields.some((field) => re.test(greekify(field)))\n  }\n  return flow(\n    _filter((item: any) => !trimmedFilter || searchFunction(item)),\n    reduce((res, item) => {\n      if (!res[item.props.group]) res[item.props.group] = [item]\n      else res[item.props.group].push(item)\n      return res\n    }, {})\n  )(lib)\n}\n\nexport const getSelectOptionsFromSchema = (schema): Array<Option> => {\n  return schema.enum.reduce((options, value, index) => {\n    options.push({\n      value,\n      label: schema?.enumNames?.[index] ?? value\n    })\n\n    return options\n  }, [])\n}\n\n/**\n * Creates a function, which is not called if the current argument is the same as the last one\n * @param func function to be debounced\n * @param delay delay in ms\n * @param skipArguments indexes in arguments array to skip for comparison\n * @returns debounced function, which is not called with previous argument\n */\nexport function memoizedDebounce(\n  func,\n  delay = 0,\n  skipArguments: number[] = []\n) {\n  let lastArgs\n  const debouncedFunction = _.debounce(func, delay)\n  const getArgumentsToCompare = (args) =>\n    args?.filter((_, index: number) => !skipArguments.includes(index)) || []\n  return function (...args) {\n    const lastArgsToCompare = getArgumentsToCompare(lastArgs)\n    const argsToCompare = getArgumentsToCompare(args)\n    if (lastArgs && _.isEqual(argsToCompare, lastArgsToCompare)) {\n      return\n    }\n    lastArgs = args\n    debouncedFunction(...args)\n  }\n}\n\nexport { RenderStruct } from './renderStruct'\nexport { fileOpener } from './fileOpener'\n","import { FunctionalGroup } from 'ketcher-core'\n\nlet showTooltipTimer: ReturnType<typeof setTimeout> | null = null\n\nexport const TOOLTIP_DELAY = 300\n\nexport function showTooltip(editor, infoPanelData) {\n  editor.event.showInfo.dispatch(null)\n\n  if (showTooltipTimer) {\n    clearTimeout(showTooltipTimer)\n  }\n  if (infoPanelData) {\n    showTooltipTimer = setTimeout(() => {\n      editor.event.showInfo.dispatch(infoPanelData)\n    }, TOOLTIP_DELAY)\n  }\n}\n\nexport function showFunctionalGroupsTooltip(editor) {\n  let infoPanelData: any = null\n  const checkFunctionGroupTypes = ['sgroups', 'functionalGroups']\n  const closestCollapsibleStructures = editor.findItem(\n    event,\n    checkFunctionGroupTypes\n  )\n  if (closestCollapsibleStructures) {\n    const sGroup = editor.struct()?.sgroups.get(closestCollapsibleStructures.id)\n    if (sGroup && !sGroup.data.expanded) {\n      const groupName = sGroup.data.name\n      const groupStruct = FunctionalGroup.getFunctionalGroupByName(groupName)\n      infoPanelData = {\n        groupStruct,\n        event,\n        sGroup\n      }\n    }\n  }\n  showTooltip(editor, infoPanelData)\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { AnyAction } from 'redux'\nimport { appUpdate } from '../options'\nimport {\n  FunctionalGroupsProvider,\n  SdfItem,\n  SdfSerializer,\n  Struct\n} from 'ketcher-core'\nimport templatesRawData from '../../../../templates/fg.sdf'\nimport { memoizedDebounce } from '../../utils'\nimport { TOOLTIP_DELAY } from '../../../editor/utils/functionalGroupsTooltip'\n\ninterface FGState {\n  lib: []\n  functionalGroupInfo: any\n  mode: string\n}\n\nconst initialState: FGState = {\n  lib: [],\n  functionalGroupInfo: null,\n  mode: 'fg'\n}\n\nconst functionalGroupsReducer = (\n  state = initialState,\n  { type, payload }: AnyAction\n) => {\n  switch (type) {\n    case 'FG_INIT':\n      return { ...state, ...payload }\n\n    case 'FG_HIGHLIGHT':\n      return { ...state, functionalGroupInfo: payload }\n\n    default:\n      return state\n  }\n}\n\nconst initFGroups = (lib: SdfItem[]) => ({ type: 'FG_INIT', payload: { lib } })\nconst highlightFGroup = (group: any) => ({\n  type: 'FG_HIGHLIGHT',\n  payload: group\n})\n\nfunction notDebouncedHighlightFG(dispatch, group: any) {\n  dispatch(highlightFGroup(group))\n}\n\nexport const highlightFG = memoizedDebounce(\n  notDebouncedHighlightFG,\n  TOOLTIP_DELAY / 3,\n  [0]\n)\n\nexport function initFGTemplates() {\n  return async (dispatch) => {\n    const provider = FunctionalGroupsProvider.getInstance()\n    const sdfSerializer = new SdfSerializer()\n    const templates = sdfSerializer.deserialize(templatesRawData)\n    const functionalGroups = templates.reduce(\n      (acc: Struct[], { struct }) => [...acc, struct],\n      []\n    )\n    provider.setFunctionalGroupsList(functionalGroups)\n    dispatch(initFGroups(templates))\n    dispatch(appUpdate({ functionalGroups: true }))\n  }\n}\n\nexport default functionalGroupsReducer\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { AnyAction } from 'redux'\nimport { appUpdate } from '../options'\nimport {\n  SaltsAndSolventsProvider,\n  FunctionalGroupsProvider,\n  SdfItem,\n  SdfSerializer,\n  Struct\n} from 'ketcher-core'\nimport { RenderStruct } from '../../utils'\nimport templatesRawData from '../../../../templates/salts-and-solvents.sdf'\n\ninterface SaltsAndSolventsState {\n  lib: []\n  mode: string\n}\n\nconst initialState: SaltsAndSolventsState = {\n  lib: [],\n  mode: 'fg'\n}\n\nconst saltsAndSolventsReducer = (\n  state = initialState,\n  { type, payload }: AnyAction\n) => {\n  switch (type) {\n    case 'SALTS_AND_SOLVENTS_INIT':\n      return { ...state, ...payload }\n\n    default:\n      return state\n  }\n}\n\nconst initSaltsAndSolvents = (lib: SdfItem[]) => ({\n  type: 'SALTS_AND_SOLVENTS_INIT',\n  payload: { lib }\n})\n\n// This prerender adds part of structures to cache to speed up loading of Salts and Solvents tab\nconst prerenderPartOfStructures = (saltsAndSolvents: Struct[], settings) => {\n  const part = saltsAndSolvents.slice(0, 50)\n  part.forEach((struct) => {\n    const div = document.createElement('div')\n    div.style.width = '100px'\n    div.style.height = '100px'\n    div.style.display = 'none'\n    document.body.appendChild(div)\n    RenderStruct.render(div, struct, {\n      ...settings,\n      autoScaleMargin: 10,\n      cachePrefix: 'saltsAndSolvents',\n      downScale: true\n    })\n    div.remove()\n  })\n}\n\nexport function initSaltsAndSolventsTemplates() {\n  return async (dispatch, getState) => {\n    const { settings } = getState().options\n    const saltsAndSolventsProvider = SaltsAndSolventsProvider.getInstance()\n    const functionalGroupsProvider = FunctionalGroupsProvider.getInstance()\n    const sdfSerializer = new SdfSerializer()\n    const templates = sdfSerializer.deserialize(templatesRawData)\n    const saltsAndSolvents = templates.reduce(\n      (acc: Struct[], { struct, props }) => {\n        struct.abbreviation = String(props.abbreviation)\n        acc.push(struct)\n        return acc\n      },\n      []\n    )\n    prerenderPartOfStructures(saltsAndSolvents, settings)\n    saltsAndSolventsProvider.setSaltsAndSolventsList(saltsAndSolvents)\n    functionalGroupsProvider.addToFunctionalGroupsList(saltsAndSolvents)\n    dispatch(initSaltsAndSolvents(templates))\n    dispatch(appUpdate({ saltsAndSolvents: true }))\n  }\n}\n\nexport default saltsAndSolventsReducer\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { capitalize, isEqual, throttle } from 'lodash/fp'\n\nimport { basicAtoms } from '../../action/atoms'\nimport tools from '../../action/tools'\n\nconst initial = {\n  freqAtoms: [],\n  currentAtom: 0,\n  opened: null,\n  visibleTools: {\n    select: 'select-rectangle'\n  }\n}\nconst MAX_ATOMS = 7\n\nfunction updateVisibleTools(visibleTool, activeTool) {\n  const regExp = /(bond)(-)(common|stereo|query)/\n  const menuHeight = window.innerHeight\n\n  return Object.keys(visibleTool).reduce(\n    (res, key) => {\n      if (key === 'bond' && menuHeight > 700) return res // TODO remove me after update styles\n      if (key === 'transform' && menuHeight > 800) return res\n      if (key === 'rgroup' && menuHeight > 850) return res\n      if (key === 'shape' && menuHeight > 900) return res\n      if (!key.match(regExp) || menuHeight > 700) res[key] = visibleTool[key]\n      return res\n    },\n    { ...activeTool }\n  )\n}\n\nexport function initResize() {\n  return function (dispatch, getState) {\n    const onResize = throttle(250, () => {\n      const state = getState()\n      state.editor.render.update()\n      dispatch({ type: 'CLEAR_VISIBLE', data: state.actionState.activeTool })\n    })\n    addEventListener('resize', onResize) // eslint-disable-line\n  }\n}\n\n/* REDUCER */\nexport default function (state = initial, action) {\n  const { type, data } = action\n\n  switch (type) {\n    case 'ACTION': {\n      const visibleTool = toolInMenu(action.action)\n      return visibleTool\n        ? {\n            ...state,\n            opened: null,\n            visibleTools: { ...state.visibleTools, ...visibleTool }\n          }\n        : { ...state, opened: null }\n    }\n    case 'ADD_ATOMS': {\n      const newState = addFreqAtom(data, state.freqAtoms, state.currentAtom)\n      return { ...state, ...newState }\n    }\n    case 'CLEAR_VISIBLE': {\n      const activeTool = toolInMenu(action.data)\n      const correctTools = updateVisibleTools(state.visibleTools, activeTool)\n      return { ...state, opened: null, visibleTools: { ...correctTools } }\n    }\n    case 'OPENED': {\n      return data.isSelected && state.opened\n        ? { ...state, opened: null }\n        : { ...state, opened: data.menuName }\n    }\n    case 'UPDATE':\n      return { ...state, opened: null }\n    case 'MODAL_OPEN':\n      return { ...state, opened: null }\n    default:\n      return state\n  }\n}\n/* ------- */\n\nfunction addFreqAtom(label, freqAtoms, index) {\n  label = capitalize(label)\n  if (basicAtoms.indexOf(label) > -1 || freqAtoms.indexOf(label) !== -1)\n    return { freqAtoms }\n\n  freqAtoms[index] = label\n  index = (index + 1) % MAX_ATOMS\n\n  return { freqAtoms, currentAtom: index }\n}\n\nexport function addAtoms(atomLabel) {\n  return {\n    type: 'ADD_ATOMS',\n    data: atomLabel\n  }\n}\n\nfunction toolInMenu(action) {\n  const tool = Object.keys(tools).find((toolName) =>\n    isEqual(action, tools[toolName].action)\n  )\n\n  const sel = document.getElementById(tool)\n  const dropdown = sel && hiddenAncestor(sel)\n\n  return dropdown && dropdown.id !== '' ? { [dropdown.id]: sel.id } : null\n}\n\nexport function hiddenAncestor(el, base) {\n  base = base || document.body\n  let findEl = el\n\n  while (\n    findEl &&\n    window.getComputedStyle(findEl).overflow !== 'hidden' &&\n    !findEl.classList.contains('opened')\n  ) {\n    if (findEl === base) return null\n    findEl = findEl.parentNode\n  }\n\n  return findEl\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { applyMiddleware, combineReducers, createStore } from 'redux'\nimport { load, onAction } from './shared'\nimport optionsReducer, { initOptionsState } from './options'\nimport templatesReducer, { initTmplsState } from './templates'\n\nimport actionStateReducer from './action'\nimport functionalGroupsReducer from './functionalGroups'\nimport saltsAndSolventsReducer from './saltsAndSolvents'\nimport { logger } from 'redux-logger'\nimport modalReducer from './modal'\nimport { pick } from 'lodash/fp'\nimport requestReducer from './request'\nimport thunk from 'redux-thunk'\nimport toolbarReducer from './toolbar'\n\nexport { onAction, load }\n\nconst shared = combineReducers({\n  actionState: actionStateReducer,\n  toolbar: toolbarReducer,\n  modal: modalReducer,\n  server: (store = null) => store,\n  editor: (store = null) => store,\n  options: optionsReducer,\n  templates: templatesReducer,\n  functionalGroups: functionalGroupsReducer,\n  saltsAndSolvents: saltsAndSolventsReducer,\n  requestsStatuses: requestReducer\n})\n\nfunction getRootReducer(setEditor) {\n  return function root(state, action) {\n    switch (action.type) {\n      case 'INIT':\n        setEditor(action.editor)\n\n      case 'UPDATE':\n        const { type, ...data } = action\n        if (data) state = { ...state, ...data }\n    }\n\n    const sh = shared(state, {\n      ...action,\n      ...pick(['editor', 'server', 'options'], state)\n    })\n\n    const finalState =\n      sh === state.shared\n        ? state\n        : {\n            ...state,\n            ...sh\n          }\n\n    // TODO: temporary solution. Need to review work with redux store\n    global.currentState = finalState\n    return finalState\n  }\n}\n\nexport default function (options, server, setEditor) {\n  const { buttons = {}, ...restOptions } = options\n\n  // TODO: redux localStorage here\n  const initState = {\n    actionState: null,\n    editor: null,\n    modal: null,\n    options: Object.assign(initOptionsState, { app: restOptions, buttons }),\n    server: server || Promise.reject(new Error('Standalone mode!')),\n    templates: initTmplsState\n  }\n\n  const middleware = [thunk]\n  if (\n    process.env.NODE_ENV !== 'production' &&\n    process.env.KETCHER_ENABLE_REDUX_LOGGER === 'true'\n  ) {\n    middleware.push(logger)\n  }\n\n  const rootReducer = getRootReducer(setEditor)\n  return createStore(rootReducer, initState, applyMiddleware(...middleware))\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  BottomToolbar,\n  BottomToolbarCallProps,\n  BottomToolbarProps\n} from './BottomToolbar'\n\nimport { ComponentType } from 'react'\nimport { Dispatch } from 'redux'\nimport { connect } from 'react-redux'\nimport { onAction } from '../../../state'\n\ntype StateProps = Omit<BottomToolbarProps, 'className'>\ntype OwnProps = Pick<BottomToolbarProps, 'className'>\n\nconst mapStateToProps = (state): StateProps => ({\n  active: state.actionState && state.actionState.activeTool,\n  status: state.actionState || {},\n  opened: state.toolbar.opened,\n  indigoVerification: state.requestsStatuses.indigoVerification,\n  disableableButtons: []\n})\n\nconst mapDispatchToProps = (dispatch: Dispatch): BottomToolbarCallProps => ({\n  onAction: (action) => dispatch(onAction(action)),\n  onOpen: (menuName, isSelected) =>\n    dispatch({\n      type: 'OPENED',\n      data: { menuName, isSelected }\n    })\n})\n\nconst BottomToolbarContainer: ComponentType<OwnProps> = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(BottomToolbar)\n\nexport { BottomToolbarContainer }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { ToolbarItem, ToolbarItemVariant } from '../../toolbar.types'\n\nfunction makeItems(ids: ToolbarItemVariant[]): ToolbarItem[] {\n  return ids.map((id) => ({ id }))\n}\n\nexport { makeItems }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { GroupDescriptor } from '../../ToolbarGroupItem/ToolbarMultiToolItem/variants/variants.types'\nimport { ToolbarItem } from '../../toolbar.types'\nimport { makeItems } from '../../ToolbarGroupItem/utils'\n\nconst bondCommon: ToolbarItem[] = makeItems([\n  'bond-single',\n  'bond-double',\n  'bond-triple'\n])\nconst bondStereo: ToolbarItem[] = makeItems([\n  'bond-up',\n  'bond-down',\n  'bond-updown',\n  'bond-crossed'\n])\nconst bondQuery: ToolbarItem[] = makeItems([\n  'bond-any',\n  'bond-aromatic',\n  'bond-singledouble',\n  'bond-singlearomatic',\n  'bond-doublearomatic'\n])\nconst bondSpecial: ToolbarItem[] = makeItems(['bond-dative', 'bond-hydrogen'])\n\nconst groups = [bondCommon, bondStereo, bondQuery, bondSpecial]\nconst groupOptions = groups.flat()\nconst groupDescriptors = groups.reduce((accum, group, index) => {\n  const start = accum[index - 1]?.end || 0\n\n  accum.push({\n    start: start,\n    end: start + group.length\n  })\n\n  return accum\n}, [] as GroupDescriptor[])\n\nexport {\n  bondCommon,\n  bondStereo,\n  bondQuery,\n  bondSpecial,\n  groupOptions,\n  groupDescriptors\n}\n","import { bondCommon, bondQuery, bondSpecial, bondStereo } from './Bond/options'\nimport { makeItems } from '../ToolbarGroupItem/utils'\nimport { ToolbarItem } from '../toolbar.types'\n\nconst rGroupOptions: ToolbarItem[] = makeItems([\n  'rgroup-label',\n  'rgroup-fragment',\n  'rgroup-attpoints'\n])\n\nconst shapeOptions: ToolbarItem[] = makeItems([\n  'shape-ellipse',\n  'shape-rectangle',\n  'shape-line'\n])\n\nconst transformOptions: ToolbarItem[] = makeItems([\n  'transform-rotate',\n  'transform-flip-h',\n  'transform-flip-v'\n])\n\nconst selectOptions: ToolbarItem[] = makeItems([\n  'select-rectangle',\n  'select-lasso',\n  'select-fragment'\n])\n\nconst arrowsOptions: ToolbarItem[] = makeItems([\n  'reaction-arrow-open-angle',\n  'reaction-arrow-filled-triangle',\n  'reaction-arrow-filled-bow',\n  'reaction-arrow-dashed-open-angle',\n  'reaction-arrow-failed',\n  'reaction-arrow-both-ends-filled-triangle',\n  'reaction-arrow-equilibrium-filled-half-bow',\n  'reaction-arrow-equilibrium-filled-triangle',\n  'reaction-arrow-equilibrium-open-angle',\n  'reaction-arrow-unbalanced-equilibrium-filled-half-bow',\n  'reaction-arrow-unbalanced-equilibrium-open-half-angle',\n  'reaction-arrow-unbalanced-equilibrium-large-filled-half-bow',\n  'reaction-arrow-unbalanced-equilibrium-filled-half-triangle',\n  'reaction-arrow-elliptical-arc-arrow-filled-bow',\n  'reaction-arrow-elliptical-arc-arrow-filled-triangle',\n  'reaction-arrow-elliptical-arc-arrow-open-angle',\n  'reaction-arrow-elliptical-arc-arrow-open-half-angle'\n])\n\nconst mappingOptions: ToolbarItem[] = makeItems([\n  'reaction-map',\n  'reaction-unmap',\n  'reaction-automap'\n])\n\nexport {\n  rGroupOptions,\n  bondCommon,\n  bondQuery,\n  bondSpecial,\n  bondStereo,\n  shapeOptions,\n  transformOptions,\n  selectOptions,\n  arrowsOptions,\n  mappingOptions\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport React from 'react'\nimport SettingsContext from './../contexts/settingsContext'\n\nexport function useSettingsContext() {\n  return React.useContext(SettingsContext)\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { RefCallback, RefObject, useMemo, useState } from 'react'\n\nimport { throttle } from 'lodash'\nimport useResizeObserver from 'use-resize-observer/polyfilled'\n\nconst throttleMilliseconds = 100\n\ntype Size = {\n  width: number | undefined\n  height: number | undefined\n}\n\ntype Options<THTMLElement extends HTMLElement> = {\n  ref?: RefObject<THTMLElement> | THTMLElement | null | undefined\n}\n\ntype HookResponse<THTMLElement extends HTMLElement> = {\n  ref: RefCallback<THTMLElement>\n  width: number | undefined\n  height: number | undefined\n}\n\nfunction useThrottleResizeObserver<THTMLElement extends HTMLElement>(\n  options: Options<THTMLElement> = {}\n): HookResponse<THTMLElement> {\n  const [size, setSize] = useState<Size>({\n    height: undefined,\n    width: undefined\n  })\n\n  const onResize = useMemo(() => throttle(setSize, throttleMilliseconds), [])\n\n  const { ref } = useResizeObserver<THTMLElement>({ onResize, ...options })\n  return { ref, ...size }\n}\n\nexport { useThrottleResizeObserver as useResizeObserver }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport FormContext from './../contexts/formContext'\nimport React from 'react'\n\nexport function useFormContext() {\n  return React.useContext(FormContext)\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport AppContext from '../contexts/appContext'\nimport React from 'react'\n\nexport const useAppContext = () => React.useContext(AppContext)\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { useEffect, useRef } from 'react'\n\nexport const useInterval = (callback: () => void, delay: number | null) => {\n  const savedCallback = useRef(callback)\n\n  // Remember the latest callback if it changes.\n  useEffect(() => {\n    savedCallback.current = callback\n  }, [callback])\n\n  // Set up the interval.\n  useEffect(() => {\n    // Don't schedule if no delay is specified.\n    if (delay === null) {\n      return\n    }\n\n    const id = setInterval(() => savedCallback.current(), delay)\n\n    return () => clearInterval(id)\n  }, [delay])\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { useDispatch } from 'react-redux'\nimport { indigoVerification } from '../script/ui/state/request'\nimport { Ketcher, KetcherAsyncEvents } from 'ketcher-core'\nimport { useEffect } from 'react'\nimport { useAppContext } from './useAppContext'\nimport { KETCHER_INIT_EVENT_NAME } from '../constants'\n\nexport const useSubscriptionOnEvents = () => {\n  const dispatch = useDispatch()\n\n  const { getKetcherInstance } = useAppContext()\n\n  const loadingHandler = () => {\n    dispatch(indigoVerification(true))\n  }\n  const actionResultHandler = () => {\n    dispatch(indigoVerification(false))\n  }\n\n  const subscribe = (ketcher: Ketcher) => {\n    ketcher.eventBus.addListener(KetcherAsyncEvents.LOADING, loadingHandler)\n    ketcher.eventBus.addListener(\n      KetcherAsyncEvents.SUCCESS,\n      actionResultHandler\n    )\n    ketcher.eventBus.addListener(\n      KetcherAsyncEvents.FAILURE,\n      actionResultHandler\n    )\n  }\n\n  const unsubscribe = (ketcher: Ketcher) => {\n    ketcher.eventBus.removeListener(KetcherAsyncEvents.LOADING, loadingHandler)\n    ketcher.eventBus.removeListener(\n      KetcherAsyncEvents.SUCCESS,\n      actionResultHandler\n    )\n    ketcher.eventBus.removeListener(\n      KetcherAsyncEvents.FAILURE,\n      actionResultHandler\n    )\n  }\n\n  useEffect(() => {\n    const subscribeOnInit = () => {\n      subscribe(getKetcherInstance())\n    }\n\n    const unsubscribeOnUnMount = () => {\n      unsubscribe(getKetcherInstance())\n    }\n\n    window.addEventListener(KETCHER_INIT_EVENT_NAME, () => {\n      subscribeOnInit()\n    })\n    return () => {\n      unsubscribeOnUnMount()\n      window.removeEventListener(KETCHER_INIT_EVENT_NAME, subscribeOnInit)\n    }\n  }, [])\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport classes from './ArrowScroll.module.less'\nimport clsx from 'clsx'\nimport { useEffect, useState } from 'react'\nimport { useInterval } from '../../../../../hooks'\n\ninterface ArrowScrollProps {\n  startInView: boolean\n  endInView: boolean\n  scrollUp: any\n  scrollDown: any\n}\n\nconst ArrowScroll = ({\n  startInView,\n  endInView,\n  scrollUp,\n  scrollDown\n}: ArrowScrollProps) => {\n  const [isScrollDown, setScrollDown] = useState(false)\n  const [isScrollUp, setScrollUp] = useState(false)\n  useInterval(scrollDown, isScrollDown ? 100 : null)\n  useInterval(scrollUp, isScrollUp ? 100 : null)\n\n  useEffect(() => {\n    return () => {\n      setScrollUp(false)\n    }\n  }, [startInView])\n\n  useEffect(() => {\n    return () => {\n      setScrollDown(false)\n    }\n  }, [endInView])\n\n  return (\n    <div className={classes.scroll}>\n      {endInView ? (\n        <></>\n      ) : (\n        <button\n          onClick={() => scrollDown()}\n          onMouseUp={() => setScrollDown(false)}\n          onMouseDown={() => setScrollDown(true)}\n          className={clsx(classes.button, classes.down)}\n        >\n          ▼\n        </button>\n      )}\n      {startInView ? (\n        <></>\n      ) : (\n        <button\n          onClick={() => scrollUp()}\n          onMouseUp={() => setScrollUp(false)}\n          onMouseDown={() => setScrollUp(true)}\n          className={clsx(classes.button, classes.up)}\n        >\n          ▲\n        </button>\n      )}\n    </div>\n  )\n}\n\nexport { ArrowScroll }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nconst mediaSizes = {\n  topSeparatorsShowingWidth: 1080,\n  bondCollapsableHeight: 770,\n  rGroupCollapsableHeight: 1000,\n  shapeCollapsableHeight: 1000,\n  transformCollapsableHeight: 870\n}\n\nexport { mediaSizes }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  ToolbarGroupItemCallProps,\n  ToolbarGroupItemProps\n} from '../../ToolbarGroupItem'\nimport {\n  bondCommon,\n  bondQuery,\n  bondSpecial,\n  bondStereo,\n  groupDescriptors,\n  groupOptions\n} from './options'\n\nimport { ToolbarMultiToolItem } from '../../ToolbarGroupItem/ToolbarMultiToolItem'\nimport { mediaSizes } from '../../mediaSizes'\n\ninterface BondProps extends Omit<ToolbarGroupItemProps, 'id' | 'options'> {\n  height?: number\n}\ntype BondCallProps = ToolbarGroupItemCallProps\n\ntype Props = BondProps & BondCallProps\n\nconst Bond = (props: Props) => {\n  const { height, ...rest } = props\n\n  if (height && height <= mediaSizes.bondCollapsableHeight) {\n    return (\n      <ToolbarMultiToolItem\n        id=\"bonds\"\n        options={groupOptions}\n        variant=\"grouped\"\n        groups={groupDescriptors}\n        {...rest}\n      />\n    )\n  }\n\n  return (\n    <>\n      <ToolbarMultiToolItem id=\"bond-common\" options={bondCommon} {...rest} />\n      <ToolbarMultiToolItem id=\"bond-stereo\" options={bondStereo} {...rest} />\n      <ToolbarMultiToolItem id=\"bond-query\" options={bondQuery} {...rest} />\n      <ToolbarMultiToolItem id=\"bond-special\" options={bondSpecial} {...rest} />\n    </>\n  )\n}\n\nexport type { BondProps, BondCallProps }\nexport { Bond }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  ToolbarGroupItem,\n  ToolbarGroupItemCallProps,\n  ToolbarGroupItemProps\n} from '../../ToolbarGroupItem'\n\nimport { rGroupOptions } from '../leftToolbarOptions'\n\ninterface RGroupProps extends Omit<ToolbarGroupItemProps, 'id' | 'options'> {\n  height?: number\n}\ntype RGroupCallProps = ToolbarGroupItemCallProps\n\ntype Props = RGroupProps & RGroupCallProps\n\nconst RGroup = (props: Props) => {\n  return <ToolbarGroupItem id=\"rgroup\" options={rGroupOptions} {...props} />\n}\n\nexport type { RGroupProps, RGroupCallProps }\nexport { RGroup }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  ToolbarGroupItem,\n  ToolbarGroupItemCallProps,\n  ToolbarGroupItemProps\n} from '../../ToolbarGroupItem'\n\nimport { shapeOptions } from '../leftToolbarOptions'\n\ninterface ShapeProps extends Omit<ToolbarGroupItemProps, 'id' | 'options'> {\n  height?: number\n}\ntype ShapeCallProps = ToolbarGroupItemCallProps\n\ntype Props = ShapeProps & ShapeCallProps\n\nconst Shape = (props: Props) => {\n  return <ToolbarGroupItem id=\"shapes\" options={shapeOptions} {...props} />\n}\n\nexport type { ShapeProps, ShapeCallProps }\nexport { Shape }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  ToolbarGroupItem,\n  ToolbarGroupItemCallProps,\n  ToolbarGroupItemProps\n} from '../../ToolbarGroupItem'\n\nimport { transformOptions } from '../leftToolbarOptions'\nimport { mediaSizes } from '../../mediaSizes'\n\ninterface TransformProps extends Omit<ToolbarGroupItemProps, 'id' | 'options'> {\n  height?: number\n}\ntype TransformCallProps = ToolbarGroupItemCallProps\n\ntype Props = TransformProps & TransformCallProps\n\nconst Transform = (props: Props) => {\n  const { height, ...rest } = props\n\n  if (height && height <= mediaSizes.transformCollapsableHeight) {\n    return (\n      <ToolbarGroupItem id=\"transforms\" options={transformOptions} {...rest} />\n    )\n  }\n\n  return (\n    <>\n      <ToolbarGroupItem id=\"transform-rotate\" {...rest} />\n      <ToolbarGroupItem id=\"transform-flip-h\" {...rest} />\n      <ToolbarGroupItem id=\"transform-flip-v\" {...rest} />\n    </>\n  )\n}\n\nexport type { TransformProps, TransformCallProps }\nexport { Transform }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { FC, MutableRefObject, useRef } from 'react'\nimport {\n  ToolbarGroupItem,\n  ToolbarGroupItemCallProps,\n  ToolbarGroupItemProps\n} from '../ToolbarGroupItem'\nimport { ToolbarItem, ToolbarItemVariant } from '../toolbar.types'\nimport {\n  arrowsOptions,\n  bondCommon,\n  bondQuery,\n  bondSpecial,\n  bondStereo,\n  mappingOptions,\n  rGroupOptions,\n  selectOptions,\n  shapeOptions,\n  transformOptions\n} from './leftToolbarOptions'\n\nimport { ArrowScroll } from '../ArrowScroll'\nimport { Bond } from './Bond'\nimport { RGroup } from './RGroup'\nimport { Shape } from './Shape'\nimport { Transform } from './Transform'\nimport classes from './LeftToolbar.module.less'\nimport clsx from 'clsx'\nimport { useInView } from 'react-intersection-observer'\nimport { useResizeObserver } from '../../../../../hooks'\n\ninterface LeftToolbarProps\n  extends Omit<ToolbarGroupItemProps, 'id' | 'options'> {\n  className?: string\n}\n\ntype LeftToolbarCallProps = ToolbarGroupItemCallProps\n\ntype Props = LeftToolbarProps & LeftToolbarCallProps\n\nconst LeftToolbar = (props: Props) => {\n  const { className, ...rest } = props\n  const { ref, height } = useResizeObserver<HTMLDivElement>()\n  const scrollRef = useRef() as MutableRefObject<HTMLDivElement>\n  const [startRef, startInView] = useInView({ threshold: 0.8 })\n  const [endRef, endInView] = useInView({ threshold: 0.8 })\n  const sizeRef = useRef() as MutableRefObject<HTMLDivElement>\n\n  type ItemProps = {\n    id: ToolbarItemVariant\n    options?: ToolbarItem[]\n  }\n  const Item = ({ id, options }: ItemProps) =>\n    ToolbarGroupItem({ id, options, ...rest })\n\n  const scrollUp = () => {\n    scrollRef.current.scrollTop -= sizeRef.current.offsetHeight\n  }\n\n  const scrollDown = () => {\n    scrollRef.current.scrollTop += sizeRef.current.offsetHeight\n  }\n\n  const status = rest.status\n\n  type GroupItem = ItemProps\n\n  const Group: FC<{ items?: GroupItem[]; className?: string }> = ({\n    items,\n    className\n  }) => {\n    const visibleItems: GroupItem[] = []\n    if (items) {\n      items.forEach((item) => {\n        let visible = true\n        if (status[item.id]?.hidden) {\n          visible = false\n        } else if (item.options?.every((option) => status[option.id]?.hidden)) {\n          visible = false\n        }\n        if (visible) visibleItems.push(item)\n      })\n    }\n    return visibleItems.length ? (\n      <div className={clsx(classes.group, className)}>\n        {visibleItems.map((item) => {\n          switch (item.id) {\n            case 'bond-common':\n              return <Bond {...rest} height={height} key={item.id} />\n            case 'transform-rotate':\n              return <Transform {...rest} height={height} key={item.id} />\n            case 'rgroup':\n              return <RGroup {...rest} key={item.id} />\n            case 'shapes':\n              return <Shape {...rest} key={item.id} />\n            default:\n              return <Item id={item.id} options={item.options} key={item.id} />\n          }\n        })}\n      </div>\n    ) : null\n  }\n\n  return (\n    <div className={clsx(classes.root, className)} ref={ref}>\n      <div className={classes.buttons} ref={scrollRef}>\n        <div className={classes.listener} ref={startRef}>\n          <Group\n            className={classes.groupItem}\n            items={[\n              { id: 'hand' },\n              { id: 'select', options: selectOptions },\n              { id: 'erase' }\n            ]}\n          />\n        </div>\n\n        <Group\n          className={classes.groupItem}\n          items={[\n            {\n              id: 'bonds',\n              options: [\n                ...bondCommon,\n                ...bondQuery,\n                ...bondSpecial,\n                ...bondStereo\n              ]\n            },\n            { id: 'chain' }\n          ]}\n        />\n\n        <Group\n          className={classes.groupItem}\n          items={[{ id: 'enhanced-stereo' }]}\n        />\n\n        <Group\n          className={classes.groupItem}\n          items={[{ id: 'charge-plus' }, { id: 'charge-minus' }]}\n        />\n\n        <Group\n          className={classes.groupItem}\n          items={[\n            {\n              id: 'transforms',\n              options: transformOptions\n            }\n          ]}\n        />\n\n        <Group className={classes.groupItem} items={[{ id: 'sgroup' }]} />\n\n        <Group\n          className={classes.groupItem}\n          items={[\n            { id: 'reaction-plus' },\n            { id: 'arrows', options: arrowsOptions },\n            {\n              id: 'reaction-mapping-tools',\n              options: mappingOptions\n            }\n          ]}\n        />\n        <div className={classes.listener} ref={sizeRef}>\n          <Group\n            className={classes.groupItem}\n            items={[{ id: 'rgroup', options: rGroupOptions }]}\n          />\n        </div>\n\n        <Group\n          className={classes.groupItem}\n          items={[{ id: 'shapes', options: shapeOptions }]}\n        />\n\n        <div ref={endRef}>\n          <Group className={classes.groupItem} items={[{ id: 'text' }]} />\n        </div>\n      </div>\n      <ArrowScroll\n        startInView={startInView}\n        endInView={endInView}\n        scrollUp={scrollUp}\n        scrollDown={scrollDown}\n      />\n    </div>\n  )\n}\n\nexport type { LeftToolbarProps, LeftToolbarCallProps }\nexport { LeftToolbar }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  LeftToolbar,\n  LeftToolbarCallProps,\n  LeftToolbarProps\n} from './LeftToolbar'\n\nimport { Dispatch } from 'redux'\nimport { connect } from 'react-redux'\nimport { onAction } from '../../../state'\n\ntype StateProps = Omit<LeftToolbarProps, 'className'>\n\nconst mapStateToProps = (state: any): StateProps => ({\n  status: state.actionState || {},\n  opened: state.toolbar.opened,\n  indigoVerification: state.requestsStatuses.indigoVerification,\n  disableableButtons: []\n})\n\nconst mapDispatchToProps = (dispatch: Dispatch): LeftToolbarCallProps => ({\n  onAction: (action) => dispatch(onAction(action)),\n  onOpen: (menuName, isSelected) =>\n    dispatch({\n      type: 'OPENED',\n      data: { menuName, isSelected }\n    })\n})\n\nconst LeftToolbarContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(LeftToolbar)\n\nexport { LeftToolbarContainer }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport classes from './Atom.module.less'\nimport clsx from 'clsx'\n\nfunction Atom({ el, shortcut, selected, ...props }) {\n  return (\n    <button\n      title={shortcut ? `${el.title} (${shortcut})` : el.title}\n      className={clsx(classes.atom, {\n        selected: selected\n      })}\n      value={el.number}\n      {...props}\n    >\n      <span>{el.label}</span>\n    </button>\n  )\n}\n\nexport default Atom\n","'use strict'\r\n\r\nmodule.exports = {\r\n\t\"aliceblue\": [240, 248, 255],\r\n\t\"antiquewhite\": [250, 235, 215],\r\n\t\"aqua\": [0, 255, 255],\r\n\t\"aquamarine\": [127, 255, 212],\r\n\t\"azure\": [240, 255, 255],\r\n\t\"beige\": [245, 245, 220],\r\n\t\"bisque\": [255, 228, 196],\r\n\t\"black\": [0, 0, 0],\r\n\t\"blanchedalmond\": [255, 235, 205],\r\n\t\"blue\": [0, 0, 255],\r\n\t\"blueviolet\": [138, 43, 226],\r\n\t\"brown\": [165, 42, 42],\r\n\t\"burlywood\": [222, 184, 135],\r\n\t\"cadetblue\": [95, 158, 160],\r\n\t\"chartreuse\": [127, 255, 0],\r\n\t\"chocolate\": [210, 105, 30],\r\n\t\"coral\": [255, 127, 80],\r\n\t\"cornflowerblue\": [100, 149, 237],\r\n\t\"cornsilk\": [255, 248, 220],\r\n\t\"crimson\": [220, 20, 60],\r\n\t\"cyan\": [0, 255, 255],\r\n\t\"darkblue\": [0, 0, 139],\r\n\t\"darkcyan\": [0, 139, 139],\r\n\t\"darkgoldenrod\": [184, 134, 11],\r\n\t\"darkgray\": [169, 169, 169],\r\n\t\"darkgreen\": [0, 100, 0],\r\n\t\"darkgrey\": [169, 169, 169],\r\n\t\"darkkhaki\": [189, 183, 107],\r\n\t\"darkmagenta\": [139, 0, 139],\r\n\t\"darkolivegreen\": [85, 107, 47],\r\n\t\"darkorange\": [255, 140, 0],\r\n\t\"darkorchid\": [153, 50, 204],\r\n\t\"darkred\": [139, 0, 0],\r\n\t\"darksalmon\": [233, 150, 122],\r\n\t\"darkseagreen\": [143, 188, 143],\r\n\t\"darkslateblue\": [72, 61, 139],\r\n\t\"darkslategray\": [47, 79, 79],\r\n\t\"darkslategrey\": [47, 79, 79],\r\n\t\"darkturquoise\": [0, 206, 209],\r\n\t\"darkviolet\": [148, 0, 211],\r\n\t\"deeppink\": [255, 20, 147],\r\n\t\"deepskyblue\": [0, 191, 255],\r\n\t\"dimgray\": [105, 105, 105],\r\n\t\"dimgrey\": [105, 105, 105],\r\n\t\"dodgerblue\": [30, 144, 255],\r\n\t\"firebrick\": [178, 34, 34],\r\n\t\"floralwhite\": [255, 250, 240],\r\n\t\"forestgreen\": [34, 139, 34],\r\n\t\"fuchsia\": [255, 0, 255],\r\n\t\"gainsboro\": [220, 220, 220],\r\n\t\"ghostwhite\": [248, 248, 255],\r\n\t\"gold\": [255, 215, 0],\r\n\t\"goldenrod\": [218, 165, 32],\r\n\t\"gray\": [128, 128, 128],\r\n\t\"green\": [0, 128, 0],\r\n\t\"greenyellow\": [173, 255, 47],\r\n\t\"grey\": [128, 128, 128],\r\n\t\"honeydew\": [240, 255, 240],\r\n\t\"hotpink\": [255, 105, 180],\r\n\t\"indianred\": [205, 92, 92],\r\n\t\"indigo\": [75, 0, 130],\r\n\t\"ivory\": [255, 255, 240],\r\n\t\"khaki\": [240, 230, 140],\r\n\t\"lavender\": [230, 230, 250],\r\n\t\"lavenderblush\": [255, 240, 245],\r\n\t\"lawngreen\": [124, 252, 0],\r\n\t\"lemonchiffon\": [255, 250, 205],\r\n\t\"lightblue\": [173, 216, 230],\r\n\t\"lightcoral\": [240, 128, 128],\r\n\t\"lightcyan\": [224, 255, 255],\r\n\t\"lightgoldenrodyellow\": [250, 250, 210],\r\n\t\"lightgray\": [211, 211, 211],\r\n\t\"lightgreen\": [144, 238, 144],\r\n\t\"lightgrey\": [211, 211, 211],\r\n\t\"lightpink\": [255, 182, 193],\r\n\t\"lightsalmon\": [255, 160, 122],\r\n\t\"lightseagreen\": [32, 178, 170],\r\n\t\"lightskyblue\": [135, 206, 250],\r\n\t\"lightslategray\": [119, 136, 153],\r\n\t\"lightslategrey\": [119, 136, 153],\r\n\t\"lightsteelblue\": [176, 196, 222],\r\n\t\"lightyellow\": [255, 255, 224],\r\n\t\"lime\": [0, 255, 0],\r\n\t\"limegreen\": [50, 205, 50],\r\n\t\"linen\": [250, 240, 230],\r\n\t\"magenta\": [255, 0, 255],\r\n\t\"maroon\": [128, 0, 0],\r\n\t\"mediumaquamarine\": [102, 205, 170],\r\n\t\"mediumblue\": [0, 0, 205],\r\n\t\"mediumorchid\": [186, 85, 211],\r\n\t\"mediumpurple\": [147, 112, 219],\r\n\t\"mediumseagreen\": [60, 179, 113],\r\n\t\"mediumslateblue\": [123, 104, 238],\r\n\t\"mediumspringgreen\": [0, 250, 154],\r\n\t\"mediumturquoise\": [72, 209, 204],\r\n\t\"mediumvioletred\": [199, 21, 133],\r\n\t\"midnightblue\": [25, 25, 112],\r\n\t\"mintcream\": [245, 255, 250],\r\n\t\"mistyrose\": [255, 228, 225],\r\n\t\"moccasin\": [255, 228, 181],\r\n\t\"navajowhite\": [255, 222, 173],\r\n\t\"navy\": [0, 0, 128],\r\n\t\"oldlace\": [253, 245, 230],\r\n\t\"olive\": [128, 128, 0],\r\n\t\"olivedrab\": [107, 142, 35],\r\n\t\"orange\": [255, 165, 0],\r\n\t\"orangered\": [255, 69, 0],\r\n\t\"orchid\": [218, 112, 214],\r\n\t\"palegoldenrod\": [238, 232, 170],\r\n\t\"palegreen\": [152, 251, 152],\r\n\t\"paleturquoise\": [175, 238, 238],\r\n\t\"palevioletred\": [219, 112, 147],\r\n\t\"papayawhip\": [255, 239, 213],\r\n\t\"peachpuff\": [255, 218, 185],\r\n\t\"peru\": [205, 133, 63],\r\n\t\"pink\": [255, 192, 203],\r\n\t\"plum\": [221, 160, 221],\r\n\t\"powderblue\": [176, 224, 230],\r\n\t\"purple\": [128, 0, 128],\r\n\t\"rebeccapurple\": [102, 51, 153],\r\n\t\"red\": [255, 0, 0],\r\n\t\"rosybrown\": [188, 143, 143],\r\n\t\"royalblue\": [65, 105, 225],\r\n\t\"saddlebrown\": [139, 69, 19],\r\n\t\"salmon\": [250, 128, 114],\r\n\t\"sandybrown\": [244, 164, 96],\r\n\t\"seagreen\": [46, 139, 87],\r\n\t\"seashell\": [255, 245, 238],\r\n\t\"sienna\": [160, 82, 45],\r\n\t\"silver\": [192, 192, 192],\r\n\t\"skyblue\": [135, 206, 235],\r\n\t\"slateblue\": [106, 90, 205],\r\n\t\"slategray\": [112, 128, 144],\r\n\t\"slategrey\": [112, 128, 144],\r\n\t\"snow\": [255, 250, 250],\r\n\t\"springgreen\": [0, 255, 127],\r\n\t\"steelblue\": [70, 130, 180],\r\n\t\"tan\": [210, 180, 140],\r\n\t\"teal\": [0, 128, 128],\r\n\t\"thistle\": [216, 191, 216],\r\n\t\"tomato\": [255, 99, 71],\r\n\t\"turquoise\": [64, 224, 208],\r\n\t\"violet\": [238, 130, 238],\r\n\t\"wheat\": [245, 222, 179],\r\n\t\"white\": [255, 255, 255],\r\n\t\"whitesmoke\": [245, 245, 245],\r\n\t\"yellow\": [255, 255, 0],\r\n\t\"yellowgreen\": [154, 205, 50]\r\n};\r\n","/**\r\n * @module color-parse\r\n */\r\nimport names from 'color-name'\r\n\r\nexport default parse\r\n\r\n/**\r\n * Base hues\r\n * http://dev.w3.org/csswg/css-color/#typedef-named-hue\r\n */\r\n//FIXME: use external hue detector\r\nvar baseHues = {\r\n\tred: 0,\r\n\torange: 60,\r\n\tyellow: 120,\r\n\tgreen: 180,\r\n\tblue: 240,\r\n\tpurple: 300\r\n}\r\n\r\n/**\r\n * Parse color from the string passed\r\n *\r\n * @return {Object} A space indicator `space`, an array `values` and `alpha`\r\n */\r\nfunction parse (cstr) {\r\n\tvar m, parts = [], alpha = 1, space\r\n\r\n\tif (typeof cstr === 'string') {\r\n\t\t//keyword\r\n\t\tif (names[cstr]) {\r\n\t\t\tparts = names[cstr].slice()\r\n\t\t\tspace = 'rgb'\r\n\t\t}\r\n\r\n\t\t//reserved words\r\n\t\telse if (cstr === 'transparent') {\r\n\t\t\talpha = 0\r\n\t\t\tspace = 'rgb'\r\n\t\t\tparts = [0,0,0]\r\n\t\t}\r\n\r\n\t\t//hex\r\n\t\telse if (/^#[A-Fa-f0-9]+$/.test(cstr)) {\r\n\t\t\tvar base = cstr.slice(1)\r\n\t\t\tvar size = base.length\r\n\t\t\tvar isShort = size <= 4\r\n\t\t\talpha = 1\r\n\r\n\t\t\tif (isShort) {\r\n\t\t\t\tparts = [\r\n\t\t\t\t\tparseInt(base[0] + base[0], 16),\r\n\t\t\t\t\tparseInt(base[1] + base[1], 16),\r\n\t\t\t\t\tparseInt(base[2] + base[2], 16)\r\n\t\t\t\t]\r\n\t\t\t\tif (size === 4) {\r\n\t\t\t\t\talpha = parseInt(base[3] + base[3], 16) / 255\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tparts = [\r\n\t\t\t\t\tparseInt(base[0] + base[1], 16),\r\n\t\t\t\t\tparseInt(base[2] + base[3], 16),\r\n\t\t\t\t\tparseInt(base[4] + base[5], 16)\r\n\t\t\t\t]\r\n\t\t\t\tif (size === 8) {\r\n\t\t\t\t\talpha = parseInt(base[6] + base[7], 16) / 255\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!parts[0]) parts[0] = 0\r\n\t\t\tif (!parts[1]) parts[1] = 0\r\n\t\t\tif (!parts[2]) parts[2] = 0\r\n\r\n\t\t\tspace = 'rgb'\r\n\t\t}\r\n\r\n\t\t//color space\r\n\t\telse if (m = /^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\\s*\\(([^\\)]*)\\)/.exec(cstr)) {\r\n\t\t\tvar name = m[1]\r\n\t\t\tvar isRGB = name === 'rgb'\r\n\t\t\tvar base = name.replace(/a$/, '')\r\n\t\t\tspace = base\r\n\t\t\tvar size = base === 'cmyk' ? 4 : base === 'gray' ? 1 : 3\r\n\t\t\tparts = m[2].trim()\r\n\t\t\t\t.split(/\\s*[,\\/]\\s*|\\s+/)\r\n\t\t\t\t.map(function (x, i) {\r\n\t\t\t\t\t//<percentage>\r\n\t\t\t\t\tif (/%$/.test(x)) {\r\n\t\t\t\t\t\t//alpha\r\n\t\t\t\t\t\tif (i === size)\treturn parseFloat(x) / 100\r\n\t\t\t\t\t\t//rgb\r\n\t\t\t\t\t\tif (base === 'rgb') return parseFloat(x) * 255 / 100\r\n\t\t\t\t\t\treturn parseFloat(x)\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//hue\r\n\t\t\t\t\telse if (base[i] === 'h') {\r\n\t\t\t\t\t\t//<deg>\r\n\t\t\t\t\t\tif (/deg$/.test(x)) {\r\n\t\t\t\t\t\t\treturn parseFloat(x)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//<base-hue>\r\n\t\t\t\t\t\telse if (baseHues[x] !== undefined) {\r\n\t\t\t\t\t\t\treturn baseHues[x]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn parseFloat(x)\r\n\t\t\t\t})\r\n\r\n\t\t\tif (name === base) parts.push(1)\r\n\t\t\talpha = (isRGB) ? 1 : (parts[size] === undefined) ? 1 : parts[size]\r\n\t\t\tparts = parts.slice(0, size)\r\n\t\t}\r\n\r\n\t\t//named channels case\r\n\t\telse if (cstr.length > 10 && /[0-9](?:\\s|\\/)/.test(cstr)) {\r\n\t\t\tparts = cstr.match(/([0-9]+)/g).map(function (value) {\r\n\t\t\t\treturn parseFloat(value)\r\n\t\t\t})\r\n\r\n\t\t\tspace = cstr.match(/([a-z])/ig).join('').toLowerCase()\r\n\t\t}\r\n\t}\r\n\r\n\t//numeric case\r\n\telse if (!isNaN(cstr)) {\r\n\t\tspace = 'rgb'\r\n\t\tparts = [cstr >>> 16, (cstr & 0x00ff00) >>> 8, cstr & 0x0000ff]\r\n\t}\r\n\r\n\t//array-like\r\n\telse if (Array.isArray(cstr) || cstr.length) {\r\n\t\tparts = [cstr[0], cstr[1], cstr[2]]\r\n\t\tspace = 'rgb'\r\n\t\talpha = cstr.length === 4 ? cstr[3] : 1\r\n\t}\r\n\r\n\t//object case - detects css cases of rgb and hsl\r\n\telse if (cstr instanceof Object) {\r\n\t\tif (cstr.r != null || cstr.red != null || cstr.R != null) {\r\n\t\t\tspace = 'rgb'\r\n\t\t\tparts = [\r\n\t\t\t\tcstr.r || cstr.red || cstr.R || 0,\r\n\t\t\t\tcstr.g || cstr.green || cstr.G || 0,\r\n\t\t\t\tcstr.b || cstr.blue || cstr.B || 0\r\n\t\t\t]\r\n\t\t}\r\n\t\telse {\r\n\t\t\tspace = 'hsl'\r\n\t\t\tparts = [\r\n\t\t\t\tcstr.h || cstr.hue || cstr.H || 0,\r\n\t\t\t\tcstr.s || cstr.saturation || cstr.S || 0,\r\n\t\t\t\tcstr.l || cstr.lightness || cstr.L || cstr.b || cstr.brightness\r\n\t\t\t]\r\n\t\t}\r\n\r\n\t\talpha = cstr.a || cstr.alpha || cstr.opacity || 1\r\n\r\n\t\tif (cstr.opacity != null) alpha /= 100\r\n\t}\r\n\r\n\treturn {\r\n\t\tspace: space,\r\n\t\tvalues: parts,\r\n\t\talpha: alpha\r\n\t}\r\n}\r\n","/**\r\n * @module  color-alpha\r\n */\r\nimport parse from 'color-parse';\r\n\r\nexport default function alpha (color, value) {\r\n\tvar obj = parse(color);\r\n\r\n\tif (value == null) value = obj.alpha;\r\n\r\n\t//catch percent\r\n\tif (obj.space[0] === 'h') {\r\n\t\treturn obj.space + ['a(', obj.values[0], ',', obj.values[1], '%,', obj.values[2], '%,', value, ')'].join('');\r\n\t}\r\n\r\n\treturn obj.space + ['a(', obj.values, ',', value, ')'].join('');\r\n}\r\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { ElementColor, Elements } from 'ketcher-core'\nimport { atomCuts } from '../../../../action/atoms'\n\nimport Atom from '../../../../component/view/Atom'\nimport { UiActionAction } from '../../../../action'\nimport { forwardRef } from 'react'\nimport { shortcutStr } from '../../shortcutStr'\nimport styled from '@emotion/styled'\nimport α from 'color-alpha'\n\ninterface AtomsListProps {\n  atoms: string[]\n  active?: {\n    tool?: string\n    opts: {\n      label: string\n    }\n  }\n}\n\ninterface AtomsListCallProps {\n  onAction: (action: UiActionAction) => void\n}\n\ntype Props = AtomsListProps & AtomsListCallProps\n\nconst StyledAtom = styled(Atom)((props: any) => {\n  const atomColor = props?.el?.label ? ElementColor[props.el.label] : '#000'\n  return `\n       color: ${atomColor};\n       border: 1px solid ${atomColor};\n       background-color: transparent;\n       cursor: pointer;\n       &:hover {\n         background-color: ${α(atomColor, 0.2)};\n       }\n       &:active {\n         color: #fff;\n         background-color: ${α(atomColor, 0.8)};\n       }\n       &.selected {\n         color: #fff;\n         background-color: ${α(atomColor, 0.8)};\n         &:hover {\n           background-color: ${atomColor};\n         }\n       }\n   `\n})\n\nconst AtomsList = forwardRef<HTMLDivElement, Props>((props: Props, ref) => {\n  const { atoms, active, onAction } = props\n  const isAtom = active && active.tool === 'atom'\n\n  return (\n    <div ref={ref}>\n      {atoms.map((label) => {\n        const element = Elements.get(label)\n        const shortcut =\n          atoms.indexOf(label) > -1 ? shortcutStr(atomCuts[label]) : null\n        const isSelected = isAtom && active && active.opts.label === label\n        return (\n          <StyledAtom\n            key={label}\n            el={element}\n            shortcut={shortcut}\n            className={isSelected ? 'selected' : ''}\n            selected={isSelected}\n            onClick={() => onAction({ tool: 'atom', opts: { label } })}\n          />\n        )\n      })}\n    </div>\n  )\n})\n\nexport type { AtomsListProps, AtomsListCallProps }\nexport { AtomsList }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { FC, MutableRefObject, PropsWithChildren, useRef } from 'react'\nimport {\n  ToolbarGroupItem,\n  ToolbarGroupItemCallProps,\n  ToolbarGroupItemProps\n} from '../ToolbarGroupItem'\n\nimport { ArrowScroll } from '../ArrowScroll'\nimport { AtomsList } from './AtomsList'\nimport { basicAtoms } from '../../../action/atoms'\nimport classes from './RightToolbar.module.less'\nimport clsx from 'clsx'\nimport { useInView } from 'react-intersection-observer'\n\nconst Group: FC<{ className?: string } & PropsWithChildren> = ({\n  children,\n  className\n}) => <div className={clsx(classes.group, className)}>{children}</div>\n\ninterface RightToolbarProps\n  extends Omit<ToolbarGroupItemProps, 'id' | 'options'> {\n  className?: string\n  active?: {\n    opts: any\n    tool: string\n  }\n  freqAtoms: any[]\n}\n\ntype RightToolbarCallProps = ToolbarGroupItemCallProps\n\ntype Props = RightToolbarProps & RightToolbarCallProps\n\nconst RightToolbar = (props: Props) => {\n  const { className, ...rest } = props\n  const { active, onAction, freqAtoms } = rest\n  const [startRef, startInView] = useInView({ threshold: 0.95 })\n  const [endRef, endInView] = useInView({ threshold: 0.8 })\n  const sizeRef = useRef() as MutableRefObject<HTMLDivElement>\n  const scrollRef = useRef() as MutableRefObject<HTMLDivElement>\n\n  const scrollUp = () => {\n    scrollRef.current.scrollTop -= sizeRef.current.offsetHeight\n  }\n\n  const scrollDown = () => {\n    scrollRef.current.scrollTop += sizeRef.current.offsetHeight\n  }\n\n  return (\n    <div className={clsx(classes.root, className)}>\n      <div className={classes.buttons} ref={scrollRef}>\n        <Group className={classes.atomsList}>\n          <AtomsList\n            ref={startRef}\n            atoms={basicAtoms}\n            active={active}\n            onAction={onAction}\n          />\n          <AtomsList atoms={freqAtoms} active={active} onAction={onAction} />\n          <ToolbarGroupItem id=\"period-table\" {...rest} />\n        </Group>\n\n        <Group>\n          <div ref={sizeRef}>\n            <ToolbarGroupItem id=\"any-atom\" {...rest} />\n            <ToolbarGroupItem id=\"extended-table\" {...rest} />\n          </div>\n        </Group>\n        <div ref={endRef}></div>\n      </div>\n      <ArrowScroll\n        startInView={startInView}\n        endInView={endInView}\n        scrollUp={scrollUp}\n        scrollDown={scrollDown}\n      />\n    </div>\n  )\n}\n\nexport type { RightToolbarProps, RightToolbarCallProps }\nexport { RightToolbar }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  RightToolbar,\n  RightToolbarCallProps,\n  RightToolbarProps\n} from './RightToolbar'\n\nimport { ComponentType } from 'react'\nimport { Dispatch } from 'redux'\nimport { connect } from 'react-redux'\nimport { onAction } from '../../../state'\n\ntype StateProps = Omit<RightToolbarProps, 'className'>\ntype OwnProps = Pick<RightToolbarProps, 'className'>\n\nconst mapStateToProps = (state): StateProps => ({\n  active: state.actionState && state.actionState.activeTool,\n  status: state.actionState || {},\n  freqAtoms: state.toolbar.freqAtoms,\n  opened: state.toolbar.opened,\n  indigoVerification: state.requestsStatuses.indigoVerification,\n  disableableButtons: []\n})\n\nconst mapDispatchToProps = (dispatch: Dispatch): RightToolbarCallProps => ({\n  onAction: (action) => dispatch(onAction(action)),\n  onOpen: (menuName, isSelected) =>\n    dispatch({\n      type: 'OPENED',\n      data: { menuName, isSelected }\n    })\n})\n\nconst RightToolbarContainer: ComponentType<OwnProps> = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(RightToolbar)\n\nexport { RightToolbarContainer }\nexport default RightToolbarContainer\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { IconButton as MuiButton } from '@mui/material'\nimport styled from '@emotion/styled'\n\nimport Icon from 'src/script/ui/component/view/icon'\n\nconst Button = styled(MuiButton)`\n  display: block;\n  color: #333;\n  border: 0;\n  position: relative;\n  background: inherit;\n\n  flex-shrink: 0;\n\n  border-radius: 4px;\n  margin: 0px;\n  padding: 2px;\n  height: 28px;\n  width: 28px;\n\n  &:hover {\n    color: #006775;\n    transform: none;\n    box-shadow: none;\n    transition: none;\n    background: none;\n  }\n\n  &:active {\n    background-color: #006775;\n    color: white;\n    &:hover {\n      background-color: #188794;\n    }\n  }\n\n  & svg {\n    width: 100%;\n    height: 100%;\n  }\n\n  &.Mui-disabled {\n    cursor: not-allowed;\n    opacity: 0.5;\n    background-color: initial;\n    color: #333;\n    pointer-events: auto;\n  }\n\n  @media only screen and (min-width: 1024px) {\n    height: 32px;\n    width: 32px;\n    padding: 4px;\n  }\n\n  @media only screen and (min-width: 1920px) {\n    height: 40px;\n    width: 40px;\n    padding: 5px;\n  }\n`\n\ninterface ButtonProps {\n  iconName: string\n  onClick: () => void\n  title: string\n  isHidden?: boolean\n  disabled?: boolean\n  shortcut?: string\n}\n\nexport const IconButton = ({\n  onClick,\n  iconName,\n  title,\n  shortcut,\n  isHidden = false,\n  disabled = false\n}: ButtonProps) => {\n  const combinedTitle = shortcut ? `${title} (${shortcut})` : title\n\n  if (isHidden) {\n    return null\n  }\n\n  return (\n    <Button title={combinedTitle} onClick={onClick} disabled={disabled}>\n      <Icon name={iconName} />\n    </Button>\n  )\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { IconButton } from './IconButton'\n\ninterface FileControlsProps {\n  onFileOpen: () => void\n  onSave: () => void\n  shortcuts: { [key in string]: string }\n  hiddenButtons: string[]\n}\n\nexport const FileControls = ({\n  onFileOpen,\n  onSave,\n  shortcuts,\n  hiddenButtons\n}: FileControlsProps) => {\n  return (\n    <>\n      <IconButton\n        title=\"Open...\"\n        onClick={onFileOpen}\n        iconName=\"open\"\n        shortcut={shortcuts.open}\n        isHidden={hiddenButtons.includes('open')}\n      />\n      <IconButton\n        title=\"Save as...\"\n        onClick={onSave}\n        iconName=\"save\"\n        shortcut={shortcuts.save}\n        isHidden={hiddenButtons.includes('save')}\n      />\n    </>\n  )\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { useState } from 'react'\nimport { connect } from 'react-redux'\nimport { ClickAwayListener, Collapse, IconButton } from '@mui/material'\nimport styled from '@emotion/styled'\n\nimport Icon from 'src/script/ui/component/view/icon'\n\nconst ElementAndDropdown = styled('div')`\n  position: relative;\n`\n\nconst DropDownContent = styled('div')`\n  display: flex;\n  position: absolute;\n  left: 5px;\n  border-radius: 2px;\n  flex-direction: column;\n  z-index: 20;\n  white-space: nowrap;\n  word-break: keep-all;\n  padding: 2px;\n  background: white; // TODO use variable\n  border: 1px solid #cad3dd; // TODO use variable\n  border-radius: 5px;\n  box-shadow: 0 6px 12px rgb(0 0 0 / 18%);\n`\n\nconst DropDownButton = styled(IconButton)`\n  position: absolute;\n  padding: 0;\n  right: 0;\n  bottom: 0;\n\n  &.disabled {\n    cursor: not-allowed;\n    opacity: 0.5;\n    background-color: initial;\n    color: #333;\n    pointer-events: auto;\n  }\n`\n\nconst DropDownArrow = styled(Icon)`\n  display: block;\n  width: 7px;\n  height: 7px;\n  margin: 1px;\n\n  &:hover {\n    fill: #005662;\n    transform: none;\n    box-shadow: none;\n    transition: none;\n    background: none;\n  }\n\n  &svg {\n    width: 100%;\n    height: 100%;\n  }\n\n  &svg path {\n    fill: inherit;\n  }\n`\n\ninterface ElementWithDropdownProps {\n  topElement?: JSX.Element\n  dropDownElements: JSX.Element[]\n  onToolOpen: () => void\n}\n\nconst MenuItemWithDropdown = ({\n  topElement,\n  dropDownElements,\n  onToolOpen\n}: ElementWithDropdownProps) => {\n  const [isExpanded, setIsExpanded] = useState<boolean>(false)\n\n  const collapse = () => {\n    setIsExpanded(false)\n  }\n\n  const expand = () => {\n    onToolOpen()\n    setIsExpanded(true)\n  }\n\n  return (\n    <ElementAndDropdown>\n      {topElement && topElement}\n      {dropDownElements.filter((element) => !element.props.isHidden).length !==\n        0 && (\n        <DropDownButton\n          onClick={expand}\n          className={`expanded ${topElement?.props.disabled ? 'disabled' : ''}`}\n        >\n          {!isExpanded && <DropDownArrow name=\"dropdown\" />}\n        </DropDownButton>\n      )}\n      <Collapse in={isExpanded} timeout=\"auto\" onClick={collapse} unmountOnExit>\n        <ClickAwayListener onClickAway={collapse}>\n          <DropDownContent>{dropDownElements}</DropDownContent>\n        </ClickAwayListener>\n      </Collapse>\n    </ElementAndDropdown>\n  )\n}\n\n// TODO: refactor, workaround to fix top toolbar dropdowns and left toolbar dropdowns overlapping\nconst mapDispatchToProps = (dispatch) => ({\n  onToolOpen: () =>\n    dispatch({\n      type: 'OPENED',\n      data: { menuName: null, isSelected: null }\n    })\n})\n\nexport const ElementWithDropdown = connect(\n  null,\n  mapDispatchToProps\n)(MenuItemWithDropdown)\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { IconButton } from './IconButton'\nimport { ElementWithDropdown } from './ElementWithDropdown'\n\ninterface ClipboardControlsProps {\n  onCopy: () => void\n  onCopyMol: () => void\n  onCopyKet: () => void\n  onCopyImage: () => void\n  onPaste: () => void\n  onCut: () => void\n  disabledButtons: string[]\n  hiddenButtons: string[]\n  shortcuts: { [key in string]: string }\n}\n\nexport const ClipboardControls = ({\n  onCopy,\n  onCopyMol,\n  onCopyKet,\n  onCopyImage,\n  onPaste,\n  onCut,\n  shortcuts,\n  disabledButtons,\n  hiddenButtons\n}: ClipboardControlsProps) => {\n  const copyButtons = [\n    {\n      name: 'copy',\n      title: 'Copy',\n      handler: onCopy\n    },\n    {\n      name: 'copy-mol',\n      title: 'Copy as MOL',\n      handler: onCopyMol\n    },\n    {\n      name: 'copy-ket',\n      title: 'Copy as KET',\n      handler: onCopyKet\n    },\n    {\n      name: 'copy-image',\n      title: 'Copy Image',\n      handler: onCopyImage\n    }\n  ]\n\n  const getButtonElement = (button) => (\n    <IconButton\n      title={button.title}\n      onClick={button.handler}\n      iconName={button.name}\n      shortcut={shortcuts[button.name]}\n      disabled={disabledButtons.includes(button.name)}\n      isHidden={hiddenButtons.includes(button.name)}\n      key={button.name}\n    />\n  )\n\n  const firstButtonObj = copyButtons.find(\n    (button) => !hiddenButtons.includes(button.name)\n  )\n  const collapsibleElements = copyButtons\n    .filter((button) => button !== firstButtonObj)\n    .map((button) => getButtonElement(button))\n\n  return (\n    <>\n      {!hiddenButtons.includes('copies') && (\n        <ElementWithDropdown\n          topElement={getButtonElement(firstButtonObj)}\n          dropDownElements={collapsibleElements}\n        />\n      )}\n      <IconButton\n        title=\"Paste\"\n        onClick={onPaste}\n        iconName=\"paste\"\n        shortcut={shortcuts.paste}\n        disabled={disabledButtons.includes('paste')}\n        isHidden={hiddenButtons.includes('paste')}\n      />\n      <IconButton\n        title=\"Cut\"\n        onClick={onCut}\n        iconName=\"cut\"\n        shortcut={shortcuts.cut}\n        disabled={disabledButtons.includes('cut')}\n        isHidden={hiddenButtons.includes('cut')}\n      />\n    </>\n  )\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport styled from '@emotion/styled'\n\nconst VerticalDivider = styled('hr')`\n  margin: 0px 3px;\n  flex-shrink: 0;\n  height: 45%;\n  align-self: center;\n  border-width: 0px thin 0px 0px;\n  border-style: solid;\n  border-color: #b4b9d6; // TODO: use variable\n`\n\nexport const Divider = () => <VerticalDivider />\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Divider } from './Divider'\nimport { IconButton } from './IconButton'\n\ninterface UndoRedoProps {\n  disabledButtons: string[]\n  hiddenButtons: string[]\n  shortcuts: { [key in string]: string }\n  onUndo: () => void\n  onRedo: () => void\n}\n\nexport const UndoRedo = ({\n  onUndo,\n  onRedo,\n  disabledButtons,\n  hiddenButtons,\n  shortcuts\n}: UndoRedoProps) => {\n  return (\n    <>\n      <Divider />\n      <IconButton\n        title=\"Undo\"\n        onClick={onUndo}\n        iconName=\"undo\"\n        disabled={disabledButtons.includes('undo')}\n        isHidden={hiddenButtons.includes('undo')}\n        shortcut={shortcuts.undo}\n      />\n      <IconButton\n        title=\"Redo\"\n        onClick={onRedo}\n        iconName=\"redo\"\n        disabled={disabledButtons.includes('redo')}\n        isHidden={hiddenButtons.includes('redo')}\n        shortcut={shortcuts.redo}\n      />\n      <Divider />\n    </>\n  )\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  FocusEvent,\n  KeyboardEvent,\n  useEffect,\n  useCallback,\n  RefObject\n} from 'react'\nimport styled from '@emotion/styled'\n\nconst StyledInput = styled('input')`\n  border: 1px solid #cad3dd;\n  border-radius: 4px;\n  padding: 3px 8px;\n  color: #585858;\n  font-size: 14px;\n  line-height: 16px;\n  caret-color: #43b5c0;\n  margin-bottom: 8px;\n\n  &:hover {\n    border-color: #43b5c0;\n  }\n\n  &:active,\n  &:focus {\n    border-color: #167782;\n    outline: none;\n  }\n\n  &::after,\n  &::before {\n    display: none;\n  }\n`\n\nconst onFocusHandler = (event: FocusEvent<HTMLInputElement>) => {\n  const el = event.target\n  el.select()\n}\n\nexport const updateInputString = (\n  zoom: number,\n  inputElement: HTMLInputElement | null\n) => {\n  if (!inputElement) return\n  inputElement.value = `${zoom}%`\n}\n\nexport interface ZoomInputProps {\n  onZoomSubmit: () => void\n  currentZoom: number\n  inputRef: RefObject<HTMLInputElement>\n  shortcuts: { [key in string]: string }\n}\n\nexport const ZoomInput = ({\n  onZoomSubmit,\n  currentZoom,\n  inputRef,\n  shortcuts\n}: ZoomInputProps) => {\n  useEffect(() => {\n    const inputEl = inputRef.current\n    updateInputString(currentZoom, inputEl)\n    if (document.activeElement === inputEl) {\n      inputEl?.select()\n    }\n  }, [currentZoom, inputRef])\n\n  const onKeyDown = useCallback(\n    (event: KeyboardEvent<HTMLInputElement>) => {\n      const inputEl = inputRef.current\n      if (!inputEl) {\n        return\n      }\n\n      // Prevent bubbling of keyDown events to capture input and Enter, allow bubbling of shortcuts\n      const zoomShortcuts = [shortcuts['zoom-out'], shortcuts['zoom-in']]\n      if (!zoomShortcuts.includes(event.key)) {\n        event.nativeEvent.stopImmediatePropagation()\n      }\n\n      if (event.key === 'Enter') {\n        onZoomSubmit()\n        inputEl.select()\n      }\n    },\n    [onZoomSubmit, inputRef, shortcuts]\n  )\n\n  // Focus on input field upon mounting\n  useEffect(() => {\n    const inputEl = inputRef.current\n    inputEl?.focus()\n    inputEl?.select()\n  }, [inputRef])\n\n  return (\n    <StyledInput\n      ref={inputRef}\n      onFocus={onFocusHandler}\n      onKeyDown={onKeyDown}\n    />\n  )\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { useState, useRef, useCallback } from 'react'\nimport styled from '@emotion/styled'\nimport { Button, Popover } from '@mui/material'\n\nimport Icon from 'src/script/ui/component/view/icon'\nimport { zoomList } from 'src/script/ui/action/zoom'\nimport { ZoomInput, updateInputString } from './ZoomInput'\n\nconst ElementAndDropdown = styled('div')`\n  position: relative;\n`\n\nconst DropDownButton = styled(Button)`\n  display: flex;\n  color: #000000;\n  padding-right: 0;\n  padding-left: 0;\n\n  & svg {\n    margin-left: 2px;\n    width: 16px;\n    height: 16px;\n  }\n`\n\nconst ZoomLabel = styled('span')`\n  width: 35px;\n`\n\nconst Dropdown = styled(Popover)`\n  & .MuiPopover-paper {\n    padding: 8px;\n    width: 175px;\n    border: none;\n    border-radius: 0px 0px 4px 4px;\n    box-shadow: 0px 30px 48px -17px rgba(160, 165, 174, 0.3);\n    box-sizing: border-box;\n  }\n`\n\nconst DropDownContent = styled('div')`\n  display: flex;\n  flex-direction: column;\n  white-space: nowrap;\n  word-break: keep-all;\n  background: white;\n`\n\nconst ZoomControlButton = styled(Button)`\n  display: flex;\n  justify-content: space-between;\n  font-weight: 400;\n  font-size: 12px;\n  line-height: 14px;\n  padding: 7px 8px;\n  text-transform: none;\n  color: #333333;\n`\n\nconst ShortcutLabel = styled('span')`\n  color: #cad3dd;\n`\n\nconst getIntegerFromString = (zoomInput: string | undefined): number => {\n  const zoomNumber = parseInt(zoomInput || '')\n  if (isNaN(zoomNumber)) {\n    return 0\n  }\n  return zoomNumber\n}\n\nconst getValidZoom = (zoom: number, currentZoom: number): number => {\n  if (zoom === 0) {\n    return currentZoom\n  }\n\n  const minAllowed = Math.min(...zoomList) * 100\n  const maxAllowed = Math.max(...zoomList) * 100\n\n  if (zoom < minAllowed) {\n    return minAllowed\n  }\n  if (zoom > maxAllowed) {\n    return maxAllowed\n  }\n  return zoom\n}\n\ninterface ZoomProps {\n  currentZoom: number\n  onZoom: (arg: number) => void\n  onZoomIn: VoidFunction\n  onZoomOut: VoidFunction\n  disabledButtons: string[]\n  hiddenButtons: string[]\n  shortcuts: { [key in string]: string }\n}\n\nexport const ZoomControls = ({\n  currentZoom,\n  onZoom,\n  onZoomIn,\n  onZoomOut,\n  disabledButtons,\n  hiddenButtons,\n  shortcuts\n}: ZoomProps) => {\n  const [isExpanded, setIsExpanded] = useState<boolean>(false)\n  const containerRef = useRef<HTMLDivElement>(null)\n  const inputRef = useRef<HTMLInputElement>(null)\n\n  const onZoomSubmit = useCallback(() => {\n    const inputEl = inputRef.current\n    if (!inputEl) {\n      return\n    }\n    const userInput = getIntegerFromString(inputEl.value)\n    if (userInput && userInput !== currentZoom) {\n      const zoomToSet = getValidZoom(userInput, currentZoom)\n      updateInputString(zoomToSet, inputEl)\n      onZoom(zoomToSet)\n    } else {\n      updateInputString(currentZoom, inputEl)\n    }\n  }, [onZoom, currentZoom])\n\n  const onClose = (_, reason) => {\n    if (reason === 'backdropClick') {\n      onZoomSubmit()\n    }\n    setIsExpanded(false)\n  }\n\n  const onExpand = () => {\n    setIsExpanded(true)\n  }\n\n  const resetZoom = () => {\n    onZoom(100)\n  }\n\n  return (\n    <ElementAndDropdown ref={containerRef}>\n      <DropDownButton onClick={onExpand}>\n        <ZoomLabel>{Math.round(currentZoom)}%</ZoomLabel>\n        <Icon name=\"chevron\" />\n      </DropDownButton>\n\n      <Dropdown\n        open={isExpanded}\n        onClose={onClose}\n        anchorEl={containerRef.current}\n        container={containerRef.current}\n        anchorOrigin={{\n          vertical: 'bottom',\n          horizontal: 'left'\n        }}\n      >\n        <DropDownContent>\n          <ZoomInput\n            onZoomSubmit={onZoomSubmit}\n            inputRef={inputRef}\n            currentZoom={currentZoom}\n            shortcuts={shortcuts}\n          />\n          {!hiddenButtons.includes('zoom-out') && (\n            <ZoomControlButton\n              title=\"Zoom Out\"\n              onClick={onZoomOut}\n              disabled={disabledButtons.includes('zoom-out')}\n            >\n              <span>Zoom out</span>\n              <ShortcutLabel>{shortcuts['zoom-out']}</ShortcutLabel>\n            </ZoomControlButton>\n          )}\n          {!hiddenButtons.includes('zoom-in') && (\n            <ZoomControlButton\n              title=\"Zoom In\"\n              onClick={onZoomIn}\n              disabled={disabledButtons.includes('zoom-in')}\n            >\n              <span>Zoom in</span>\n              <ShortcutLabel>{shortcuts['zoom-in']}</ShortcutLabel>\n            </ZoomControlButton>\n          )}\n          <ZoomControlButton title=\"Zoom 100%\" onClick={resetZoom}>\n            <span>Zoom 100%</span>\n            <ShortcutLabel>{shortcuts.zoom}</ShortcutLabel>\n          </ZoomControlButton>\n        </DropDownContent>\n      </Dropdown>\n    </ElementAndDropdown>\n  )\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport styled from '@emotion/styled'\nimport { shortcutStr } from '../shortcutStr'\nimport { IconButton } from './IconButton'\n\ninterface SystemControlsProps {\n  disabledButtons: string[]\n  hiddenButtons: string[]\n  className?: string\n  onSettingsOpen: () => void\n  onAboutOpen: () => void\n  onHistoryClick: () => void\n  onFullscreen: () => void\n  onHelp: () => void\n}\n\nconst getIfFullScreen = () => {\n  return !!(\n    document.fullscreenElement ||\n    document.mozFullScreenElement ||\n    document.webkitFullscreenElement ||\n    document.msFullscreenElement\n  )\n}\n\nconst ControlsPanel = styled('div')`\n  display: flex;\n  align-items: center;\n  flex-grow: 1;\n  justify-content: flex-end;\n`\n\nexport const SystemControls = ({\n  disabledButtons,\n  hiddenButtons,\n  onSettingsOpen,\n  // onHistoryClick,\n  onFullscreen,\n  onHelp,\n  onAboutOpen,\n  className\n}: SystemControlsProps) => {\n  return (\n    <ControlsPanel className={className}>\n      {/* Uncomment upon History log implementation */}\n      {/* <IconButton\n        title=\"History\"\n        onClick={onHistoryClick}\n        iconName=\"history\"\n        disabled={disabledButtons.includes('history')}\n        isHidden={hiddenButtons.includes('history')}\n      /> */}\n      <IconButton\n        title=\"Settings\"\n        onClick={onSettingsOpen}\n        iconName=\"settings\"\n        disabled={disabledButtons.includes('settings')}\n        isHidden={hiddenButtons.includes('settings')}\n      />\n      <IconButton\n        title={`Help (${shortcutStr(['?', '&', 'Shift+/'])})`}\n        onClick={onHelp}\n        iconName=\"help\"\n        disabled={disabledButtons.includes('help')}\n        isHidden={hiddenButtons.includes('help')}\n      />\n      {/* @TODO Temporary About button, when design is ready, reimplement */}\n      <IconButton\n        title=\"About\"\n        onClick={onAboutOpen}\n        iconName=\"about\"\n        disabled={disabledButtons.includes('about')}\n        isHidden={hiddenButtons.includes('about')}\n      />\n      <IconButton\n        title=\"Fullscreen mode\"\n        onClick={onFullscreen}\n        iconName={getIfFullScreen() ? 'fullscreen-exit' : 'fullscreen-enter'}\n        disabled={disabledButtons.includes('fullscreen')}\n        isHidden={hiddenButtons.includes('fullscreen')}\n      />\n    </ControlsPanel>\n  )\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { ElementWithDropdown } from './ElementWithDropdown'\nimport { IconButton } from './IconButton'\n\ninterface ExternalFuncProps {\n  isCollapsed: boolean\n  onLayout: () => void\n  onClean: () => void\n  onAromatize: () => void\n  onDearomatize: () => void\n  onCalculate: () => void\n  onCheck: () => void\n  onAnalyse: () => void\n  onMiew: () => void\n  disabledButtons: string[]\n  hiddenButtons: string[]\n  indigoVerification: boolean\n  shortcuts: { [key in string]: string }\n}\n\nexport const ExternalFuncControls = ({\n  isCollapsed,\n  onLayout,\n  onClean,\n  onAromatize,\n  onDearomatize,\n  onCalculate,\n  onCheck,\n  onAnalyse,\n  onMiew,\n  disabledButtons,\n  indigoVerification,\n  hiddenButtons,\n  shortcuts\n}: ExternalFuncProps) => {\n  const externalFuncButtons = [\n    {\n      name: 'arom',\n      title: 'Aromatize',\n      handler: onAromatize\n    },\n    {\n      name: 'dearom',\n      title: 'Dearomatize',\n      handler: onDearomatize\n    },\n    {\n      name: 'layout',\n      title: 'Layout',\n      handler: onLayout\n    },\n    {\n      name: 'clean',\n      title: 'Clean Up',\n      handler: onClean\n    },\n    {\n      name: 'cip',\n      title: 'Calculate CIP',\n      handler: onCalculate\n    },\n    {\n      name: 'check',\n      title: 'Check Structure',\n      handler: onCheck\n    },\n    {\n      name: 'analyse',\n      title: 'Calculated Values',\n      handler: onAnalyse\n    },\n    {\n      name: 'miew',\n      title: '3D Viewer',\n      handler: onMiew\n    }\n  ]\n\n  const getButtonElement = (button) => (\n    <IconButton\n      title={button.title}\n      onClick={button.handler}\n      iconName={button.name}\n      shortcut={shortcuts[button.name]}\n      disabled={indigoVerification || disabledButtons.includes(button.name)}\n      isHidden={hiddenButtons.includes(button.name)}\n      key={button.name}\n    />\n  )\n\n  const firstButtonObj = externalFuncButtons.find(\n    (button) => !hiddenButtons.includes(button.name)\n  )\n\n  const collapsibleElements = externalFuncButtons\n    .filter((button) => button !== firstButtonObj)\n    .map((button) => getButtonElement(button))\n\n  if (isCollapsed) {\n    return (\n      <ElementWithDropdown\n        topElement={getButtonElement(firstButtonObj)}\n        dropDownElements={collapsibleElements}\n      />\n    )\n  }\n\n  return (\n    <>\n      {firstButtonObj && getButtonElement(firstButtonObj)}\n      {<>{collapsibleElements}</>}\n    </>\n  )\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport styled from '@emotion/styled'\n\nimport { useResizeObserver } from 'src/hooks'\nimport { FileControls } from './FileControls'\nimport { ClipboardControls } from './ClipboardControls'\nimport { UndoRedo } from './UndoRedo'\nimport { ZoomControls } from './ZoomControls'\n\nimport { SystemControls } from './SystemControls'\nimport { IconButton } from './IconButton'\nimport { ExternalFuncControls } from './ExternalFuncControls'\nimport { Divider } from './Divider'\n\ntype VoidFunction = () => void\n\nexport interface PanelProps {\n  className: string\n  disabledButtons: string[]\n  indigoVerification: boolean\n  hiddenButtons: string[]\n  shortcuts: { [key in string]: string }\n  onClear: VoidFunction\n  onFileOpen: VoidFunction\n  onSave: VoidFunction\n  onUndo: VoidFunction\n  onRedo: VoidFunction\n  onCopy: VoidFunction\n  onCopyMol: VoidFunction\n  onCopyKet: VoidFunction\n  onCopyImage: VoidFunction\n  onCut: VoidFunction\n  onPaste: VoidFunction\n  currentZoom: number | undefined\n  onZoom: (zoom: number) => void\n  onZoomIn: VoidFunction\n  onZoomOut: VoidFunction\n  onSettingsOpen: VoidFunction\n  onLayout: VoidFunction\n  onClean: VoidFunction\n  onAromatize: VoidFunction\n  onDearomatize: VoidFunction\n  onCalculate: VoidFunction\n  onCheck: VoidFunction\n  onAnalyse: VoidFunction\n  onMiew: VoidFunction\n  onFullscreen: VoidFunction\n  onAbout: VoidFunction\n  onHelp: VoidFunction\n}\n\nconst collapseLimit = 650\n\nconst ControlsPanel = styled('div')`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  gap: 0px;\n  height: 36px;\n  padding: 0px 8px;\n\n  .group {\n    display: flex;\n    flex-direction: row;\n    gap: 0px;\n  }\n\n  & * {\n    box-sizing: border-box;\n  }\n\n  @media only screen and (min-width: 1024px) {\n    height: 40px;\n    gap: 4px;\n\n    .group {\n      gap: 4px;\n    }\n  }\n\n  @media only screen and (min-width: 1920px) {\n    height: 64px;\n    gap: 12px;\n  }\n`\n\nexport const TopToolbar = ({\n  className,\n  disabledButtons,\n  indigoVerification,\n  hiddenButtons,\n  shortcuts,\n  onClear,\n  onFileOpen,\n  onSave,\n  onUndo,\n  onRedo,\n  onCopy,\n  onCopyMol,\n  onCopyKet,\n  onCopyImage,\n  onCut,\n  onPaste,\n  currentZoom,\n  onZoom,\n  onZoomIn,\n  onZoomOut,\n  onSettingsOpen,\n  onLayout,\n  onClean,\n  onAromatize,\n  onDearomatize,\n  onCalculate,\n  onCheck,\n  onAnalyse,\n  onMiew,\n  onFullscreen,\n  onAbout,\n  onHelp\n}: PanelProps) => {\n  const { ref: resizeRef, width = 50 } = useResizeObserver<HTMLDivElement>()\n\n  return (\n    <ControlsPanel className={className} ref={resizeRef}>\n      <IconButton\n        title=\"Clear Canvas\"\n        onClick={onClear}\n        iconName=\"clear\"\n        shortcut={shortcuts.clear}\n        isHidden={hiddenButtons.includes('clear')}\n      />\n      <FileControls\n        onFileOpen={onFileOpen}\n        onSave={onSave}\n        shortcuts={shortcuts}\n        hiddenButtons={hiddenButtons}\n      />\n      <ClipboardControls\n        onCopy={onCopy}\n        onCopyMol={onCopyMol}\n        onCopyKet={onCopyKet}\n        onCopyImage={onCopyImage}\n        onPaste={onPaste}\n        onCut={onCut}\n        shortcuts={shortcuts}\n        disabledButtons={disabledButtons}\n        hiddenButtons={hiddenButtons}\n      />\n      <UndoRedo\n        onUndo={onUndo}\n        onRedo={onRedo}\n        disabledButtons={disabledButtons}\n        hiddenButtons={hiddenButtons}\n        shortcuts={shortcuts}\n      />\n      <ExternalFuncControls\n        onLayout={onLayout}\n        onClean={onClean}\n        onAromatize={onAromatize}\n        onDearomatize={onDearomatize}\n        onCalculate={onCalculate}\n        onCheck={onCheck}\n        onAnalyse={onAnalyse}\n        onMiew={onMiew}\n        disabledButtons={disabledButtons}\n        hiddenButtons={hiddenButtons}\n        shortcuts={shortcuts}\n        indigoVerification={indigoVerification}\n        isCollapsed={width < collapseLimit}\n      />\n      <SystemControls\n        onHistoryClick={() => {\n          console.log('History button clicked') // @TODO Implement handler when History log is ready\n        }}\n        onSettingsOpen={onSettingsOpen}\n        onFullscreen={onFullscreen}\n        onHelp={onHelp}\n        onAboutOpen={onAbout}\n        disabledButtons={disabledButtons}\n        hiddenButtons={hiddenButtons}\n      />\n      <Divider />\n      {!hiddenButtons.includes('zoom-list') && (\n        <ZoomControls\n          currentZoom={currentZoom || 1}\n          onZoomIn={onZoomIn}\n          onZoomOut={onZoomOut}\n          onZoom={onZoom}\n          shortcuts={shortcuts}\n          disabledButtons={disabledButtons}\n          hiddenButtons={hiddenButtons}\n        />\n      )}\n    </ControlsPanel>\n  )\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { TopToolbar } from './TopToolbar'\n\nimport { Dispatch } from 'redux'\nimport { connect } from 'react-redux'\nimport { onAction } from '../../../state'\nimport action from 'src/script/ui/action/index.js'\nimport { shortcutStr } from '../shortcutStr'\n\nconst shortcuts = Object.keys(action).reduce((acc, key) => {\n  if (action[key]?.shortcut) {\n    const shortcut = action[key].shortcut\n    const processedShortcut = shortcutStr(shortcut)\n    acc[key] = processedShortcut\n  }\n  return acc\n}, {})\n\nconst mapStateToProps = (state: any) => {\n  const actionState = state.actionState || {}\n\n  const disabledButtons = Object.keys(actionState).reduce(\n    (acc: string[], item) => {\n      if (actionState[item]?.disabled) {\n        acc.push(item)\n      }\n      return acc\n    },\n    []\n  )\n\n  const hiddenButtons = Object.keys(actionState).reduce(\n    (acc: string[], item) => {\n      if (actionState[item]?.hidden) {\n        acc.push(item)\n      }\n      return acc\n    },\n    []\n  )\n\n  return {\n    currentZoom: Math.round(state.actionState?.zoom?.selected * 100),\n    disabledButtons,\n    hiddenButtons,\n    shortcuts,\n    status: state.actionState || {},\n    opened: state.toolbar.opened,\n    indigoVerification: state.requestsStatuses.indigoVerification,\n    disableableButtons: [\n      'layout',\n      'clean',\n      'arom',\n      'dearom',\n      'cip',\n      'enhanced-stereo'\n    ]\n  }\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch) => {\n  const dispatchAction = (actionName) => {\n    dispatch(onAction(action[actionName].action))\n  }\n\n  return {\n    onClear: () => dispatchAction('clear'),\n    onFileOpen: () => dispatchAction('open'),\n    onSave: () => dispatchAction('save'),\n    onUndo: () => dispatchAction('undo'),\n    onRedo: () => dispatchAction('redo'),\n    onCopy: () => dispatchAction('copy'),\n    onCopyMol: () => dispatchAction('copy-mol'),\n    onCopyKet: () => dispatchAction('copy-ket'),\n    onCopyImage: () => dispatchAction('copy-image'),\n    onCut: () => dispatchAction('cut'),\n    onPaste: () => dispatchAction('paste'),\n    onZoomIn: () => dispatchAction('zoom-in'),\n    onZoomOut: () => dispatchAction('zoom-out'),\n    onZoom: (zoomValue: number) =>\n      dispatch(onAction((editor) => editor.zoom(zoomValue / 100))),\n    onSettingsOpen: () => dispatchAction('settings'),\n    onLayout: () => dispatchAction('layout'),\n    onClean: () => dispatchAction('clean'),\n    onAromatize: () => dispatchAction('arom'),\n    onDearomatize: () => dispatchAction('dearom'),\n    onCalculate: () => dispatchAction('cip'),\n    onCheck: () => dispatchAction('check'),\n    onAnalyse: () => dispatchAction('analyse'),\n    onMiew: () => dispatchAction('miew'),\n    onAction: (action) => dispatch(onAction(action)),\n    onOpen: (menuName, isSelected) =>\n      dispatch({\n        type: 'OPENED',\n        data: { menuName, isSelected }\n      }),\n    onFullscreen: () => dispatchAction('fullscreen'),\n    onHelp: () => dispatchAction('help'),\n    onAbout: () => dispatchAction('about')\n  }\n}\n\nconst TopToolbarContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(TopToolbar)\n\nexport { TopToolbarContainer }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport * as KN from 'w3c-keyname'\n\nconst mac =\n  typeof navigator !== 'undefined' ? /Mac/.test(navigator.platform) : false // eslint-disable-line no-undef\n\nfunction normalizeKeyName(name) {\n  const parts = name.split(/\\+(?!$)/)\n  let result = parts[parts.length - 1]\n  if (result === 'Space') result = ' '\n  let alt\n  let ctrl\n  let shift\n  let meta\n\n  for (let i = 0; i < parts.length - 1; i++) {\n    const mod = parts[i]\n    if (/^(cmd|meta|m)$/i.test(mod)) meta = true\n    else if (/^a(lt)?$/i.test(mod)) alt = true\n    else if (/^(c|ctrl|control)$/i.test(mod)) ctrl = true\n    else if (/^s(hift)?$/i.test(mod)) shift = true\n    else if (/^mod$/i.test(mod))\n      if (mac) meta = true\n      else ctrl = true\n    else throw new Error('Unrecognized modifier name: ' + mod)\n  }\n\n  if (alt) result = 'Alt+' + result\n  if (ctrl) result = 'Ctrl+' + result\n  if (meta) result = 'Meta+' + result\n  if (shift) result = 'Shift+' + result\n\n  return result\n}\n\nfunction normalizeKeyMap(map) {\n  const copy = Object.create(null)\n\n  Object.keys(map).forEach((prop) => {\n    copy[normalizeKeyName(prop)] = map[prop]\n  })\n\n  return copy\n}\n\nfunction modifiers(name, event, shift) {\n  if (event.altKey) name = 'Alt+' + name\n  if (event.ctrlKey) name = 'Ctrl+' + name\n  if (event.metaKey) name = 'Meta+' + name\n  if (shift !== false && event.shiftKey) name = 'Shift+' + name\n\n  return name\n}\n\nfunction rusToEng(name, event) {\n  return name\n    .replace(/[а-я]/, KN.base[event.keyCode])\n    .replace(/[А-Я]/, KN.shift[event.keyCode])\n}\n\nfunction normalizeKeyEvent(event, base = false) {\n  const name = rusToEng(KN.keyName(event), event)\n  const isChar = name.length === 1 && name !== ' '\n\n  return isChar && !base\n    ? modifiers(name, event, !isChar)\n    : modifiers(KN.base[event.keyCode], event, true)\n}\n\nfunction keyNorm(obj) {\n  if (obj instanceof KeyboardEvent)\n    // eslint-disable-line no-undef\n    return normalizeKeyEvent(...arguments) // eslint-disable-line prefer-rest-params\n\n  return typeof obj === 'object' ? normalizeKeyMap(obj) : normalizeKeyName(obj)\n}\n\nfunction lookup(map, event) {\n  let name = rusToEng(KN.keyName(event), event)\n  if (name === 'Add') name = '+' // numpad '+' and '-'\n  if (name === 'Subtract') name = '-'\n\n  const isChar = name.length === 1 && name !== ' '\n  let res = map[modifiers(name, event, !isChar)]\n  let baseName\n\n  if (event.shiftKey && isChar && (baseName = KN.base[event.keyCode]))\n    res = map[modifiers(baseName, event, true)] || res\n\n  return res\n}\n\nkeyNorm.lookup = lookup\n\nexport default keyNorm\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { fromAtomsAttrs, FunctionalGroup } from 'ketcher-core'\nimport Editor from '../Editor'\n\nclass APointTool {\n  editor: Editor\n\n  constructor(editor) {\n    this.editor = editor\n    this.editor.selection(null)\n  }\n\n  mousemove(event) {\n    const struct = this.editor.render.ctab.molecule\n    const closestItem = this.editor.findItem(event, ['atoms'])\n    if (closestItem) {\n      const atom = struct.atoms.get(closestItem.id)\n      if (atom?.label !== 'R#' && atom?.rglabel === null)\n        this.editor.hover(closestItem, null, event)\n    } else {\n      this.editor.hover(null)\n    }\n  }\n\n  click(event) {\n    const editor = this.editor\n    const struct = editor.render.ctab\n    const molecule = struct.molecule\n    const functionalGroups = molecule.functionalGroups\n    const ci = editor.findItem(event, ['atoms'])\n    const atomResult: Array<number> = []\n    const result: Array<number> = []\n\n    if (ci && functionalGroups.size && ci.map === 'atoms') {\n      const atomId = FunctionalGroup.atomsInFunctionalGroup(\n        functionalGroups,\n        ci.id\n      )\n\n      if (atomId !== null) {\n        atomResult.push(atomId)\n      }\n    }\n\n    if (atomResult.length > 0) {\n      for (const id of atomResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByAtom(\n          functionalGroups,\n          id\n        )\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n      this.editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    }\n\n    if (ci && ci.map === 'atoms') {\n      this.editor.hover(null)\n      const atom = molecule.atoms.get(ci.id)\n\n      if (atom?.label === 'R#' && atom?.rglabel !== null) return\n\n      const res = editor.event.elementEdit.dispatch({\n        attpnt: atom?.attpnt\n      })\n      Promise.resolve(res)\n        .then((newatom) => {\n          if (atom?.attpnt !== newatom.attpnt) {\n            const action = fromAtomsAttrs(\n              editor.render.ctab,\n              ci.id,\n              newatom,\n              null\n            )\n            editor.update(action)\n          }\n        })\n        .catch(() => null) // w/o changes\n      return true\n    }\n    return true\n  }\n}\n\nexport default APointTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Vec2, fracAngle, Struct, FunctionalGroup } from 'ketcher-core'\n\nimport { inRange } from 'lodash'\n\nfunction calcAngle(pos0, pos1) {\n  const v = Vec2.diff(pos1, pos0)\n  return Math.atan2(v.y, v.x)\n}\n\nfunction calcNewAtomPos(pos0, pos1, ctrlKey) {\n  const v = new Vec2(1, 0).rotate(\n    ctrlKey ? calcAngle(pos0, pos1) : fracAngle(pos0, pos1)\n  )\n  v.add_(pos0) // eslint-disable-line no-underscore-dangle\n  return v\n}\n\nfunction degrees(angle) {\n  let degree = Math.round((angle / Math.PI) * 180)\n  if (degree > 180) degree -= 360\n  else if (degree <= -180) degree += 360\n  return degree\n}\n\nconst BONDS_MERGE_ANGLE = 10 // 'º'\nconst BONDS_MERGE_SCALE = 0.2\n\nfunction mergeBondsParams(struct1, bond1, struct2, bond2) {\n  const begin1 = struct1.atoms.get(bond1.begin)\n  const begin2 = struct2.atoms.get(bond2.begin)\n  const end1 = struct1.atoms.get(bond1.end)\n  const end2 = struct2.atoms.get(bond2.end)\n\n  const angle = calcAngle(begin1.pp, end1.pp) - calcAngle(begin2.pp, end2.pp)\n  const mergeAngle = Math.abs(degrees(angle) % 180)\n\n  const scale = Vec2.dist(begin1.pp, end1.pp) / Vec2.dist(begin2.pp, end2.pp)\n\n  const merged =\n    !inRange(mergeAngle, BONDS_MERGE_ANGLE, 180 - BONDS_MERGE_ANGLE) &&\n    inRange(scale, 1 - BONDS_MERGE_SCALE, 1 + BONDS_MERGE_SCALE)\n\n  return { merged, angle, scale, cross: Math.abs(degrees(angle)) > 90 }\n}\n\n/**\n * Get all items IDs that do not belong to sgroups\n * @param items {{ atoms?: number[]; bonds?: number[] } | null}\n * @param struct {Struct}\n * @returns {{ atoms: number[], bonds: number[] }}\n */\nfunction getOnlyNonGroupItems(items, struct) {\n  const atoms =\n    items.atoms?.filter((key) => struct.getGroupIdFromAtomId(key) === null) ||\n    []\n  const bonds =\n    items.bonds?.filter((key) => struct.getGroupIdFromBondId(key) === null) ||\n    []\n\n  return { atoms, bonds }\n}\n\n/**\n * Get all items IDs that do not belong to sgroups (except their attachment points)\n * @param items {{ atoms?: number[]; bonds?: number[] } | null}\n * @param struct {Struct}\n * @returns {{ atoms: number[], bonds: number[] }}\n */\nfunction getNonGroupItemsAndAttachmentPoints(items, struct) {\n  const atoms =\n    items.atoms?.filter(\n      (key) =>\n        struct.getGroupIdFromAtomId(key) === null ||\n        FunctionalGroup.isAttachmentPointAtom(key, struct)\n    ) || []\n  const bonds =\n    items.bonds?.filter((key) => struct.getGroupIdFromBondId(key) === null) ||\n    []\n\n  return { atoms, bonds }\n}\n\nexport default {\n  calcAngle,\n  fracAngle,\n  calcNewAtomPos,\n  degrees,\n  mergeBondsParams,\n  getOnlyNonGroupItems,\n  getNonGroupItemsAndAttachmentPoints\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  Action,\n  Atom,\n  Bond,\n  FunctionalGroup,\n  SGroup,\n  fromAtomAddition,\n  fromAtomsAttrs,\n  fromBondAddition,\n  fromFragmentDeletion,\n  fromSgroupDeletion,\n  ElementColor\n} from 'ketcher-core'\n\nimport Editor from '../Editor'\nimport utils from '../shared/utils'\n\nclass AtomTool {\n  editor: Editor\n  atomProps: any\n  dragCtx: any\n  #bondProps: { stereo: number; type: number }\n  isNotActiveTool: boolean | undefined\n\n  constructor(editor, atomProps) {\n    this.editor = editor\n    this.atomProps = atomProps\n    this.#bondProps = { type: 1, stereo: Bond.PATTERN.STEREO.NONE }\n\n    this.editor.hoverIcon\n      .show()\n      .attr('text', `${atomProps.label}`)\n      .attr('fill', `${ElementColor[atomProps.label]}`)\n    this.editor.updateHoverIconPosition()\n\n    if (editor.selection()) {\n      if (editor.selection()?.atoms) {\n        const action = fromAtomsAttrs(\n          editor.render.ctab,\n          editor.selection().atoms,\n          atomProps,\n          true\n        )\n        editor.update(action)\n        editor.selection(null)\n      }\n\n      this.isNotActiveTool = true\n    }\n  }\n\n  mousedown(event) {\n    const struct = this.editor.render.ctab\n    const sgroups = struct.sgroups\n    const molecule = struct.molecule\n    const functionalGroups = molecule.functionalGroups\n    this.editor.hover(null)\n    this.editor.selection(null)\n    const ci = this.editor.findItem(event, ['atoms', 'functionalGroups'])\n    if (\n      ci &&\n      ci.map === 'functionalGroups' &&\n      functionalGroups &&\n      FunctionalGroup.isContractedFunctionalGroup(ci.id, functionalGroups)\n    ) {\n      const action = new Action()\n      const selectedSgroup = sgroups.get(ci.id)\n      const sGroupAtoms = SGroup.getAtoms(molecule, selectedSgroup?.item)\n      const [firstAtom, ...atoms] = sGroupAtoms\n      const atomNeighbours = molecule.atomGetNeighbors(firstAtom)\n      const extraNeighbour = atomNeighbours?.some(\n        (atom) => !sGroupAtoms.includes(atom.aid)\n      )\n      if (extraNeighbour) {\n        action.mergeWith(fromSgroupDeletion(struct, ci.id))\n        action.mergeWith(fromFragmentDeletion(struct, { atoms: atoms }))\n        action.mergeWith(\n          fromAtomsAttrs(struct, firstAtom, this.atomProps, true)\n        )\n      } else {\n        const firstAtomPp = struct.atoms.get(firstAtom)?.a.pp\n        action.mergeWith(\n          fromFragmentDeletion(struct, {\n            atoms: SGroup.getAtoms(molecule, selectedSgroup?.item),\n            bonds: SGroup.getBonds(molecule, selectedSgroup?.item)\n          })\n        )\n        action.mergeWith(fromAtomAddition(struct, firstAtomPp, this.atomProps))\n      }\n      this.editor.update(action)\n    }\n    const atomResult: Array<number> = []\n    const result: Array<number> = []\n    if (ci && functionalGroups.size && ci.map === 'atoms') {\n      const atomId = FunctionalGroup.atomsInFunctionalGroup(\n        functionalGroups,\n        ci.id\n      )\n      if (atomId !== null) atomResult.push(atomId)\n    }\n    if (atomResult.length > 0) {\n      for (const id of atomResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByAtom(\n          functionalGroups,\n          id\n        )\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n      this.editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    }\n    if (!ci) {\n      // ci.type == 'Canvas'\n      this.dragCtx = {}\n    } else if (ci.map === 'atoms') {\n      this.dragCtx = { item: ci }\n    }\n  }\n\n  mouseLeaveClientArea() {\n    this.editor.hoverIcon.hide()\n  }\n\n  mouseover() {\n    this.editor.hoverIcon.show()\n    this.editor.updateHoverIconPosition()\n  }\n\n  mousemove(event) {\n    this.editor.hoverIcon.show()\n    const rnd = this.editor.render\n    const { layerX, layerY } = event\n\n    if (!this.dragCtx || !this.dragCtx.item) {\n      const { height, width } = this.editor.hoverIcon.getBBox()\n\n      this.editor.hoverIcon.attr({\n        x: layerX - width / 2,\n        y: layerY - height / 2\n      })\n      this.editor.hover(\n        this.editor.findItem(event, ['atoms', 'functionalGroups']),\n        null,\n        event\n      )\n      return\n    }\n\n    const dragCtx = this.dragCtx\n    const ci = this.editor.findItem(event, ['atoms'])\n\n    if (ci && ci.map === 'atoms' && ci.id === dragCtx.item.id) {\n      // fromAtomsAttrs\n      this.editor.hover(this.editor.findItem(event, ['atoms']))\n      return\n    }\n\n    // fromAtomAddition\n    const atom = rnd.ctab.molecule.atoms.get(dragCtx.item.id)\n    let angle = utils.calcAngle(atom?.pp, rnd.page2obj(event))\n    if (!event.ctrlKey) angle = utils.fracAngle(angle, null)\n    const degrees = utils.degrees(angle)\n    this.editor.event.message.dispatch({ info: degrees + 'º' })\n    const newAtomPos = utils.calcNewAtomPos(\n      atom?.pp,\n      rnd.page2obj(event),\n      event.ctrlKey\n    )\n    if (dragCtx.action) dragCtx.action.perform(rnd.ctab)\n\n    dragCtx.action = fromBondAddition(\n      rnd.ctab,\n      this.#bondProps,\n      dragCtx.item.id,\n      Object.assign({}, this.atomProps),\n      newAtomPos,\n      newAtomPos\n    )[0]\n    this.editor.update(dragCtx.action, true)\n  }\n\n  mouseup(event) {\n    const struct = this.editor.render.ctab\n    const molecule = struct.molecule\n    const functionalGroups = molecule.functionalGroups\n    const ci = this.editor.findItem(event, ['atoms', 'bonds'])\n    const atomResult: Array<number> = []\n    const result: Array<number> = []\n    if (ci && functionalGroups && ci.map === 'atoms') {\n      const atomId = FunctionalGroup.atomsInFunctionalGroup(\n        functionalGroups,\n        ci.id\n      )\n      if (atomId !== null) atomResult.push(atomId)\n    }\n    if (atomResult.length > 0) {\n      for (const id of atomResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByAtom(\n          functionalGroups,\n          id\n        )\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n      this.editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    }\n\n    if (this.dragCtx) {\n      const dragCtx = this.dragCtx\n      const rnd = this.editor.render\n\n      this.editor.update(\n        dragCtx.action ||\n          (dragCtx.item\n            ? fromAtomsAttrs(rnd.ctab, dragCtx.item.id, this.atomProps, true)\n            : fromAtomAddition(rnd.ctab, rnd.page2obj(event), this.atomProps))\n      )\n\n      delete this.dragCtx\n    }\n    this.editor.event.message.dispatch({\n      info: false\n    })\n    this.editor.hover(\n      this.editor.findItem(event, ['atoms', 'functionalGroups']),\n      null,\n      event\n    )\n  }\n}\n\nexport function atomLongtapEvent(tool, render) {\n  const { dragCtx, editor } = tool\n  const atomid = dragCtx.item?.id\n  const fgs = render.ctab.molecule.functionalGroups\n  // edit atom or add atom\n  const atom =\n    atomid !== undefined && atomid !== null\n      ? render.ctab.molecule.atoms.get(atomid)\n      : new Atom({ label: '' })\n  const fgId = FunctionalGroup.findFunctionalGroupByAtom(fgs, atomid)\n  // TODO: longtab event\n  dragCtx.timeout = setTimeout(() => {\n    delete tool.dragCtx\n    if (fgId != null) {\n      editor.event.removeFG.dispatch({ fgIds: [fgId] })\n      return\n    }\n    editor.selection(null)\n    const res = editor.event.quickEdit.dispatch(atom)\n    Promise.resolve(res)\n      .then((newatom) => {\n        const action = atomid\n          ? fromAtomsAttrs(render.ctab, atomid, newatom, null)\n          : fromAtomAddition(render.ctab, dragCtx.xy0, newatom)\n        editor.update(action)\n      })\n      .catch(() => null) // w/o changes\n  }, 750)\n\n  dragCtx.stopTapping = function () {\n    if (dragCtx.timeout) {\n      clearTimeout(dragCtx.timeout)\n      delete dragCtx.timeout\n    }\n  }\n}\n\nexport default AtomTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Elements, FunctionalGroup } from 'ketcher-core'\nimport Editor from '../Editor'\n\nclass AttachTool {\n  attach: any\n  editor: Editor\n\n  constructor(editor, attachPoints) {\n    this.attach = {\n      atomid: attachPoints.atomid || 0,\n      bondid: attachPoints.bondid || 0\n    }\n    this.editor = editor\n    this.editor.selection({\n      atoms: [this.attach.atomid],\n      bonds: [this.attach.bondid]\n    })\n  }\n\n  mousemove(event) {\n    const rnd = this.editor.render\n\n    const ci = this.editor.findItem(event, ['atoms', 'bonds'])\n    const struct = rnd.ctab.molecule\n    if (\n      ci &&\n      ((ci.map === 'atoms' &&\n        Elements.get(struct.atoms.get(ci.id)?.label as string)) ||\n        ci.map === 'bonds')\n    ) {\n      this.editor.hover(ci)\n    } else {\n      this.editor.hover(null)\n    }\n    return true\n  }\n\n  click(event) {\n    const editor = this.editor\n    const rnd = editor.render\n    const molecule = rnd.ctab.molecule\n    const functionalGroups = molecule.functionalGroups\n    const ci = editor.findItem(event, ['atoms', 'bonds'])\n    const atomResult: Array<number> = []\n    const bondResult: Array<number> = []\n    const result: Array<number> = []\n\n    if (ci && functionalGroups.size && ci.map === 'atoms') {\n      const atomId = FunctionalGroup.atomsInFunctionalGroup(\n        functionalGroups,\n        ci.id\n      )\n\n      if (atomId !== null) {\n        atomResult.push(atomId)\n      }\n    }\n\n    if (ci && functionalGroups.size && ci.map === 'bonds') {\n      const bondId = FunctionalGroup.bondsInFunctionalGroup(\n        molecule,\n        functionalGroups,\n        ci.id\n      )\n\n      if (bondId !== null) {\n        bondResult.push(bondId)\n      }\n    }\n\n    if (atomResult.length > 0) {\n      for (const id of atomResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByAtom(\n          functionalGroups,\n          id\n        )\n\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n      this.editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    } else if (bondResult.length > 0) {\n      for (const id of bondResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByBond(\n          molecule,\n          functionalGroups,\n          id\n        )\n\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n      this.editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    }\n\n    if (\n      ci &&\n      ((ci.map === 'atoms' &&\n        Elements.get(molecule.atoms.get(ci.id)?.label as string)) ||\n        ci.map === 'bonds')\n    ) {\n      if (ci.map === 'atoms') {\n        this.attach.atomid = ci.id\n      } else this.attach.bondid = ci.id\n\n      this.editor.selection({\n        atoms: [this.attach.atomid],\n        bonds: [this.attach.bondid]\n      })\n      this.editor.event.attachEdit.dispatch(this.attach)\n    }\n    return true\n  }\n}\n\nexport default AttachTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  Bond,\n  Vec2,\n  bondChangingAction,\n  fromBondAddition,\n  fromBondsAttrs,\n  FunctionalGroup,\n  SGroup,\n  fromOneBondDeletion,\n  Struct\n} from 'ketcher-core'\n\nimport utils from '../shared/utils'\nimport Editor from '../Editor'\n\nclass BondTool {\n  editor: Editor\n  atomProps: { label: string }\n  bondProps: any\n  dragCtx: any\n  isNotActiveTool: boolean | undefined\n\n  constructor(editor, bondProps) {\n    this.editor = editor\n    this.atomProps = { label: 'C' }\n    this.bondProps = bondProps\n    if (editor.selection() && editor.selection()?.bonds) {\n      const action = fromBondsAttrs(\n        editor.render.ctab,\n        editor.selection().bonds,\n        bondProps\n      )\n      editor.update(action)\n      editor.selection(null)\n      this.isNotActiveTool = true\n    }\n  }\n\n  mousedown(event) {\n    if (this.dragCtx) return\n    const struct = this.editor.render.ctab\n    const molecule = struct.molecule\n    const functionalGroups = molecule.functionalGroups\n    const ci = this.editor.findItem(event, ['atoms', 'bonds'])\n    const atomResult: Array<number> = []\n    const bondResult: Array<number> = []\n    const result: Array<number> = []\n    if (ci && functionalGroups.size && ci.map === 'atoms') {\n      const atomId = FunctionalGroup.atomsInFunctionalGroup(\n        functionalGroups,\n        ci.id\n      )\n      if (atomId !== null) atomResult.push(atomId)\n    }\n    if (ci && functionalGroups.size && ci.map === 'bonds') {\n      const bondId = FunctionalGroup.bondsInFunctionalGroup(\n        molecule,\n        functionalGroups,\n        ci.id\n      )\n      if (bondId !== null) bondResult.push(bondId)\n    }\n    if (atomResult.length > 0) {\n      for (const id of atomResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByAtom(\n          functionalGroups,\n          id\n        )\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n      this.editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    } else if (bondResult.length > 0) {\n      for (const id of bondResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByBond(\n          molecule,\n          functionalGroups,\n          id\n        )\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n      this.editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    }\n    const rnd = this.editor.render\n    this.editor.hover(null)\n    this.editor.selection(null)\n    this.dragCtx = {\n      xy0: rnd.page2obj(event),\n      item: this.editor.findItem(event, ['atoms', 'bonds'])\n    }\n    if (!this.dragCtx.item)\n      // ci.type == 'Canvas'\n      delete this.dragCtx.item\n    return true\n  }\n\n  mousemove(event) {\n    const struct = this.editor.render.ctab\n    const sgroups = struct.sgroups\n    const molecule = struct.molecule\n    const functionalGroups = molecule.functionalGroups\n    const editor = this.editor\n    const rnd = editor.render\n    if ('dragCtx' in this) {\n      const dragCtx = this.dragCtx\n\n      const pos = rnd.page2obj(event)\n      let angle = utils.calcAngle(dragCtx.xy0, pos)\n      if (!event.ctrlKey) angle = utils.fracAngle(angle, null)\n\n      const degrees = utils.degrees(angle)\n      this.editor.event.message.dispatch({ info: degrees + 'º' })\n\n      if (!('item' in dragCtx) || dragCtx.item.map === 'atoms') {\n        if ('action' in dragCtx) dragCtx.action.perform(rnd.ctab)\n        let beginAtom\n        let endAtom\n        let beginPos\n        let endPos\n        const extraNeighbour: Array<number> = []\n        if ('item' in dragCtx && dragCtx.item.map === 'atoms') {\n          // first mousedown event intersect with any atom\n          beginAtom = dragCtx.item.id\n          endAtom = editor.findItem(event, ['atoms'], dragCtx.item)\n          const closestSGroup = editor.findItem(event, ['functionalGroups'])\n          if (\n            closestSGroup &&\n            FunctionalGroup.isContractedFunctionalGroup(\n              closestSGroup.id,\n              functionalGroups\n            )\n          ) {\n            const sGroup = sgroups.get(closestSGroup.id)\n            const sGroupAtoms = SGroup.getAtoms(molecule, sGroup?.item)\n            endAtom = {\n              id: sGroupAtoms[0],\n              map: 'atoms'\n            }\n          }\n          const fGroupId =\n            endAtom &&\n            FunctionalGroup.findFunctionalGroupByAtom(\n              functionalGroups,\n              endAtom.id\n            )\n          const fGroup = typeof fGroupId === 'number' && sgroups.get(fGroupId)\n          const fGroupAtoms =\n            fGroup && (SGroup.getAtoms(molecule, fGroup.item) as any)\n          if (endAtom && fGroup && endAtom.id !== fGroupAtoms?.[0]) {\n            this.editor.event.removeFG.dispatch({ fgIds: [fGroupId] })\n            endAtom = null\n          }\n          if (endAtom && fGroup && endAtom.id === fGroupAtoms?.[0]) {\n            const atomNeighbours = molecule.atomGetNeighbors(endAtom.id)\n            atomNeighbours?.forEach((nei) => {\n              !fGroupAtoms?.includes(nei.aid) &&\n                !extraNeighbour.includes(nei.aid) &&\n                extraNeighbour.push(nei.aid)\n            })\n          }\n          if (extraNeighbour.length >= 1) {\n            endAtom = null\n          }\n        } else {\n          // first mousedown event intersect with any canvas\n          beginAtom = this.atomProps\n          beginPos = dragCtx.xy0\n          endAtom = editor.findItem(event, ['atoms'])\n          const atomResult: Array<number> = []\n          const result: Array<number> = []\n          if (\n            endAtom &&\n            endAtom.map === 'atoms' &&\n            functionalGroups.size &&\n            this.dragCtx\n          ) {\n            const atomId = FunctionalGroup.atomsInFunctionalGroup(\n              functionalGroups,\n              endAtom.id\n            )\n            if (atomId !== null) atomResult.push(atomId)\n          }\n          if (atomResult.length > 0) {\n            for (const id of atomResult) {\n              const fgId = FunctionalGroup.findFunctionalGroupByAtom(\n                functionalGroups,\n                id\n              )\n              fgId !== null && !result.includes(fgId) && result.push(fgId)\n            }\n          }\n          if (result.length > 0) {\n            this.editor.event.removeFG.dispatch({ fgIds: result })\n            delete this.dragCtx\n            return\n          }\n        }\n        let dist = Number.MAX_VALUE\n        if (endAtom?.map === 'atoms') {\n          // after mousedown events is appered, cursor is moved and then cursor intersects any atoms\n          endAtom = endAtom.id\n        } else {\n          endAtom = this.atomProps\n          const xy1 = rnd.page2obj(event)\n          dist = Vec2.dist(dragCtx.xy0, xy1)\n          if (beginPos) {\n            // rotation only, leght of bond = 1;\n            endPos = utils.calcNewAtomPos(beginPos, xy1, event.ctrlKey)\n          } else {\n            // first mousedown event intersect with any atom and\n            // rotation only, leght of bond = 1;\n            const atom = rnd.ctab.molecule.atoms.get(beginAtom)\n            beginPos = utils.calcNewAtomPos(\n              atom?.pp.get_xy0(),\n              xy1,\n              event.ctrlKey\n            )\n          }\n        }\n        // don't rotate the bond if the distance between the start and end point is too small\n        if (dist > 0.3) {\n          const [existingBondId, bond] = this.getExistingBond(\n            molecule,\n            beginAtom,\n            endAtom\n          )\n          dragCtx.action = fromBondAddition(\n            rnd.ctab,\n            this.bondProps,\n            beginAtom,\n            endAtom,\n            beginPos,\n            endPos\n          )[0]\n          if (existingBondId !== null) {\n            this.dragCtx.existedBond = bond\n            this.dragCtx.action.mergeWith(\n              fromOneBondDeletion(rnd.ctab, existingBondId)\n            )\n          }\n        } else {\n          delete dragCtx.action\n        }\n        this.restoreBondWhenHoveringOnCanvas(event)\n        this.editor.update(dragCtx.action, true)\n        return true\n      }\n    }\n    this.editor.hover(\n      this.editor.findItem(event, ['atoms', 'bonds']),\n      null,\n      event\n    )\n    return true\n  }\n\n  mouseup(event) {\n    if ('dragCtx' in this) {\n      const dragCtx = this.dragCtx\n      const rnd = this.editor.render\n      const struct = rnd.ctab.molecule\n      if ('action' in dragCtx) {\n        this.restoreBondWhenHoveringOnCanvas(event)\n        this.editor.update(dragCtx.action)\n      } else if (!('item' in dragCtx)) {\n        const xy = rnd.page2obj(event)\n        const v = new Vec2(1.0 / 2, 0).rotate(\n          this.bondProps.type === Bond.PATTERN.TYPE.SINGLE ? -Math.PI / 6 : 0\n        )\n        const bondAddition = fromBondAddition(\n          rnd.ctab,\n          this.bondProps,\n          { label: 'C' },\n          { label: 'C' },\n          Vec2.diff(xy, v),\n          Vec2.sum(xy, v)\n        )\n\n        this.editor.update(bondAddition[0])\n      } else if (dragCtx.item.map === 'atoms') {\n        // click on atom\n        this.editor.update(\n          fromBondAddition(\n            rnd.ctab,\n            this.bondProps,\n            dragCtx.item.id,\n            undefined\n          )[0]\n        )\n        delete this.dragCtx.existedBond\n      } else if (dragCtx.item.map === 'bonds') {\n        const bondProps = Object.assign({}, this.bondProps)\n        const bond = struct.bonds.get(dragCtx.item.id) as Bond\n\n        this.editor.update(\n          bondChangingAction(rnd.ctab, dragCtx.item.id, bond, bondProps)\n        )\n      }\n      delete this.dragCtx\n    }\n    this.editor.event.message.dispatch({\n      info: false\n    })\n    this.editor.hover(\n      this.editor.findItem(event, ['atoms', 'bonds']),\n      null,\n      event\n    )\n    return true\n  }\n\n  /*\n    If we want to add a new bond, we need to delete previous one\n    But we can change our mind, then deleted bond needs to be restored\n  */\n  restoreBondWhenHoveringOnCanvas(event) {\n    if (!this.dragCtx.existedBond) {\n      return\n    }\n    const isHoveringOverAtom = this.editor.findItem(event, ['atoms'])\n    if (!isHoveringOverAtom) {\n      const { begin, end } = this.dragCtx.existedBond\n      const bondEnd = this.dragCtx.item.id === begin ? end : begin\n      this.dragCtx.action.mergeWith(\n        fromBondAddition(\n          this.editor.render.ctab,\n          this.dragCtx.existedBond,\n          this.dragCtx.item.id,\n          bondEnd\n        )[0]\n      )\n      delete this.dragCtx.existedBond\n    }\n  }\n\n  getExistingBond(struct: Struct, begin: number, end: number) {\n    for (const [bondId, bond] of struct.bonds.entries()) {\n      const alreadyHasBondInOtherDirection =\n        (bond.begin === end && bond.end === begin) ||\n        (bond.begin === begin && bond.end === end)\n      if (alreadyHasBondInOtherDirection) {\n        return [bondId, bond] as const\n      }\n    }\n    return [null, null] as const\n  }\n}\n\nexport default BondTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  Bond,\n  Vec2,\n  bondChangingAction,\n  fromChain,\n  fromItemsFuse,\n  getHoverToFuse,\n  getItemsToFuse,\n  FunctionalGroup\n} from 'ketcher-core'\n\nimport { atomLongtapEvent } from './atom'\nimport utils from '../shared/utils'\nimport Editor from '../Editor'\n\nclass ChainTool {\n  editor: Editor\n  dragCtx: any\n\n  constructor(editor) {\n    this.editor = editor\n    this.editor.selection(null)\n  }\n\n  mousedown(event) {\n    if (this.dragCtx) return\n    const struct = this.editor.render.ctab\n    const molecule = struct.molecule\n    const functionalGroups = molecule.functionalGroups\n    const rnd = this.editor.render\n    const ci = this.editor.findItem(event, ['atoms', 'bonds'])\n    const atomResult: Array<number> = []\n    const bondResult: Array<number> = []\n    const result: Array<number> = []\n\n    if (ci && functionalGroups.size && ci.map === 'atoms') {\n      const atomId = FunctionalGroup.atomsInFunctionalGroup(\n        functionalGroups,\n        ci.id\n      )\n\n      if (atomId !== null) {\n        atomResult.push(atomId)\n      }\n    }\n\n    if (ci && functionalGroups.size && ci.map === 'bonds') {\n      const bondId = FunctionalGroup.bondsInFunctionalGroup(\n        molecule,\n        functionalGroups,\n        ci.id\n      )\n\n      if (bondId !== null) {\n        bondResult.push(bondId)\n      }\n    }\n\n    if (atomResult.length > 0) {\n      for (const id of atomResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByAtom(\n          functionalGroups,\n          id\n        )\n\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n      this.editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    } else if (bondResult.length > 0) {\n      for (const id of bondResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByBond(\n          molecule,\n          functionalGroups,\n          id\n        )\n\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n      this.editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    }\n\n    this.editor.hover(null)\n    this.dragCtx = {\n      xy0: rnd.page2obj(event),\n      item: ci\n    }\n\n    if (ci && ci.map === 'atoms') {\n      this.editor.selection({ atoms: [ci.id] }) // for change atom\n      // this event has to be stopped in others events by `tool.dragCtx.stopTapping()`\n      atomLongtapEvent(this, rnd)\n    }\n\n    if (!this.dragCtx.item)\n      // ci.type == 'Canvas'\n      delete this.dragCtx.item\n    return true\n  }\n\n  mousemove(event) {\n    const editor = this.editor\n    const restruct = editor.render.ctab\n    const dragCtx = this.dragCtx\n\n    editor.hover(this.editor.findItem(event, ['atoms', 'bonds']), null, event)\n    if (!dragCtx) {\n      return true\n    }\n\n    if (dragCtx && dragCtx.stopTapping) {\n      dragCtx.stopTapping()\n    }\n\n    editor.selection(null)\n\n    if (!dragCtx.item || dragCtx.item.map === 'atoms') {\n      if (dragCtx.action) {\n        dragCtx.action.perform(restruct)\n      }\n\n      const atoms = restruct.molecule.atoms\n\n      const pos0 = dragCtx.item ? atoms.get(dragCtx.item.id)?.pp : dragCtx.xy0\n\n      const pos1 = editor.render.page2obj(event)\n      const sectCount = Math.ceil(Vec2.diff(pos1, pos0).length())\n\n      const angle = event.ctrlKey\n        ? utils.calcAngle(pos0, pos1)\n        : utils.fracAngle(pos0, pos1)\n\n      const [action, newItems] = fromChain(\n        restruct,\n        pos0,\n        angle,\n        sectCount,\n        dragCtx.item ? dragCtx.item.id : null\n      )\n\n      editor.event.message.dispatch({\n        info: sectCount + ' sectors'\n      })\n\n      dragCtx.action = action\n      editor.update(dragCtx.action, true)\n\n      dragCtx.mergeItems = getItemsToFuse(editor, newItems)\n      editor.hover(getHoverToFuse(dragCtx.mergeItems))\n\n      return true\n    }\n\n    return true\n  }\n\n  mouseup() {\n    const struct = this.editor.render.ctab\n    const molecule = struct.molecule\n    const functionalGroups = molecule.functionalGroups\n    let atom\n    const atomResult: Array<number> = []\n    const result: Array<number> = []\n\n    if (this.dragCtx && this.dragCtx.mergeItems && functionalGroups.size) {\n      atom = this.dragCtx.mergeItems.atoms.values().next().value\n    }\n    if (atom) {\n      const atomId = FunctionalGroup.atomsInFunctionalGroup(\n        functionalGroups,\n        atom\n      )\n\n      if (atomId !== null) {\n        atomResult.push(atomId)\n      }\n    }\n\n    if (atomResult.length > 0) {\n      for (const id of atomResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByAtom(\n          functionalGroups,\n          id\n        )\n\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n      this.editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    }\n    const dragCtx = this.dragCtx\n\n    if (!dragCtx) {\n      return true\n    }\n\n    delete this.dragCtx\n\n    const editor = this.editor\n\n    if (dragCtx.stopTapping) {\n      dragCtx.stopTapping()\n    }\n\n    if (!dragCtx.action && dragCtx.item && dragCtx.item.map === 'bonds') {\n      const bond = molecule.bonds.get(dragCtx.item.id) as Bond\n\n      dragCtx.action = bondChangingAction(struct, dragCtx.item.id, bond, {\n        type: Bond.PATTERN.TYPE.SINGLE,\n        stereo: Bond.PATTERN.STEREO.NONE\n      })\n    } else {\n      dragCtx.action = dragCtx.action\n        ? fromItemsFuse(struct, dragCtx.mergeItems).mergeWith(dragCtx.action)\n        : fromItemsFuse(struct, dragCtx.mergeItems)\n    }\n\n    editor.selection(null)\n    editor.hover(null)\n\n    if (dragCtx.action) {\n      editor.update(dragCtx.action)\n    }\n\n    editor.event.message.dispatch({\n      info: false\n    })\n\n    return true\n  }\n\n  cancel() {\n    this.mouseup()\n  }\n\n  mouseleave() {\n    this.mouseup()\n  }\n}\n\nexport default ChainTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Elements, fromAtomsAttrs, FunctionalGroup } from 'ketcher-core'\nimport Editor from '../Editor'\n\nclass ChargeTool {\n  editor: Editor\n  charge: any\n\n  constructor(editor, charge) {\n    this.editor = editor\n    this.editor.selection(null)\n    this.charge = charge\n  }\n\n  mousemove(event) {\n    const struct = this.editor.render.ctab\n    const molecule = struct.molecule\n    const ci = this.editor.findItem(event, ['atoms'])\n    if (\n      ci &&\n      ci.map === 'atoms' &&\n      Elements.get(molecule.atoms.get(ci.id)?.label as number | string)\n    ) {\n      this.editor.hover(ci)\n    } else {\n      this.editor.hover(null, null, event)\n    }\n    return true\n  }\n\n  click(event) {\n    const editor = this.editor\n    const struct = this.editor.render.ctab\n    const molecule = struct.molecule\n    const functionalGroups = molecule.functionalGroups\n    const rnd = editor.render\n    const ci = editor.findItem(event, ['atoms', 'bonds'])\n    const atomResult: Array<number> = []\n    const result: Array<number> = []\n\n    if (ci && functionalGroups.size && ci.map === 'atoms') {\n      const atomId = FunctionalGroup.atomsInFunctionalGroup(\n        functionalGroups,\n        ci.id\n      )\n\n      if (atomId !== null) {\n        atomResult.push(atomId)\n      }\n    }\n\n    if (atomResult.length > 0) {\n      for (const id of atomResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByAtom(\n          functionalGroups,\n          id\n        )\n\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n      this.editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    }\n\n    if (\n      ci &&\n      ci.map === 'atoms' &&\n      Elements.get(molecule.atoms.get(ci.id)?.label as string | number)\n    ) {\n      this.editor.hover(ci)\n      this.editor.update(\n        fromAtomsAttrs(\n          rnd.ctab,\n          ci.id,\n          {\n            charge: molecule.atoms.get(ci.id)?.charge + this.charge\n          },\n          null\n        )\n      )\n    }\n    return true\n  }\n}\n\nexport default ChargeTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  findStereoAtoms,\n  fromAtomsAttrs,\n  fromStereoFlagUpdate\n} from 'ketcher-core'\n\nimport Editor from '../Editor'\n\nclass EnhancedStereoTool {\n  editor: Editor\n  stereoAtoms: Array<number>\n  isNotActiveTool: true\n\n  constructor(editor) {\n    const selection = editor.selection()\n    this.editor = editor\n    this.isNotActiveTool = true\n\n    this.stereoAtoms = findStereoAtoms(\n      editor.struct(),\n      selection\n        ? selection.atoms || []\n        : Array.from(editor.struct().atoms.keys())\n    )\n\n    if (this.stereoAtoms.length === 0) {\n      return\n    }\n\n    EnhancedStereoTool.changeAtomsStereoAction(\n      this.editor,\n      this.stereoAtoms\n    ).then((action) => action && editor.update(action))\n  }\n\n  static changeAtomsStereoAction(editor: Editor, stereoAtoms: Array<number>) {\n    const struct = editor.struct()\n    const restruct = editor.render.ctab\n    const stereoLabels = stereoAtoms.map((stereoAtom) => {\n      const atom = struct.atoms.get(stereoAtom)\n      return atom && atom.stereoLabel\n    })\n    const hasAnotherLabel = stereoLabels.some(\n      (stereoLabel) => stereoLabel !== stereoLabels[0]\n    )\n    const res = editor.event.enhancedStereoEdit.dispatch({\n      stereoLabel: hasAnotherLabel ? null : stereoLabels[0]\n    })\n\n    return res.then((stereoLabel) => {\n      if (!stereoLabel) {\n        return null\n      }\n\n      const action = stereoAtoms.reduce(\n        (acc, stereoAtom) => {\n          return acc.mergeWith(\n            fromStereoFlagUpdate(\n              restruct,\n              struct.atoms.get(stereoAtom)?.fragment\n            )\n          )\n        },\n        fromAtomsAttrs(\n          restruct,\n          stereoAtoms,\n          {\n            stereoLabel\n          },\n          false\n        )\n      )\n      action.operations.reverse()\n      return action\n    })\n  }\n}\n\nexport default EnhancedStereoTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { FunctionalGroup, Vec2 } from 'ketcher-core'\n\nfunction getElementsInRectangle(restruct, p0, p1) {\n  const bondList: Array<number> = []\n  const atomList: Array<number> = []\n  const sGroups = restruct.sgroups\n  const functionalGroups = restruct.molecule.functionalGroups\n\n  const x0 = Math.min(p0.x, p1.x)\n  const x1 = Math.max(p0.x, p1.x)\n  const y0 = Math.min(p0.y, p1.y)\n  const y1 = Math.max(p0.y, p1.y)\n\n  restruct.bonds.forEach((bond, bid) => {\n    const centre = Vec2.lc2(\n      restruct.atoms.get(bond.b.begin).a.pp,\n      0.5,\n      restruct.atoms.get(bond.b.end).a.pp,\n      0.5\n    )\n    if (\n      centre.x > x0 &&\n      centre.x < x1 &&\n      centre.y > y0 &&\n      centre.y < y1 &&\n      !FunctionalGroup.isBondInContractedFunctionalGroup(\n        bond.b,\n        sGroups,\n        functionalGroups\n      )\n    ) {\n      bondList.push(bid)\n    }\n  })\n\n  restruct.atoms.forEach((atom, aid) => {\n    const relatedFGId = FunctionalGroup.findFunctionalGroupByAtom(\n      functionalGroups,\n      aid\n    )\n    const sGroup = restruct.sgroups.get(relatedFGId)\n    if (\n      atom.a.pp.x > x0 &&\n      atom.a.pp.x < x1 &&\n      atom.a.pp.y > y0 &&\n      atom.a.pp.y < y1 &&\n      (!FunctionalGroup.isAtomInContractedFunctionalGroup(\n        atom.a,\n        sGroups,\n        functionalGroups,\n        true\n      ) ||\n        aid === sGroup.item.atoms[0])\n    ) {\n      atomList.push(aid)\n    }\n  })\n\n  const rxnArrowsList: Array<number> = []\n  const rxnPlusesList: Array<number> = []\n  const simpleObjectsList: Array<number> = []\n\n  restruct.rxnArrows.forEach((item, id) => {\n    if (\n      item.item.center().x > x0 &&\n      item.item.center().x < x1 &&\n      item.item.center().y > y0 &&\n      item.item.center().y < y1\n    ) {\n      rxnArrowsList.push(id)\n    }\n  })\n\n  restruct.rxnPluses.forEach((item, id) => {\n    if (\n      item.item.pp.x > x0 &&\n      item.item.pp.x < x1 &&\n      item.item.pp.y > y0 &&\n      item.item.pp.y < y1\n    ) {\n      rxnPlusesList.push(id)\n    }\n  })\n\n  restruct.simpleObjects.forEach((item, id) => {\n    const referencePoints = item.getReferencePoints(true)\n    const referencePointInRectangle = referencePoints.find(\n      (point) => point.x > x0 && point.x < x1 && point.y > y0 && point.y < y1\n    )\n    if (referencePointInRectangle) {\n      simpleObjectsList.push(id)\n    }\n  })\n\n  const enhancedFlagList: Array<number> = []\n  restruct.enhancedFlags.forEach((item, id) => {\n    if (!item.pp) return\n    if (item.pp.x > x0 && item.pp.x < x1 && item.pp.y > y0 && item.pp.y < y1) {\n      enhancedFlagList.push(id)\n    }\n  })\n\n  const sgroupDataList: Array<number> = []\n  restruct.sgroupData.forEach((item, id) => {\n    if (\n      item.sgroup.pp.x > x0 &&\n      item.sgroup.pp.x < x1 &&\n      item.sgroup.pp.y > y0 &&\n      item.sgroup.pp.y < y1\n    ) {\n      sgroupDataList.push(id)\n    }\n  })\n\n  const textsList: Array<number> = []\n  restruct.texts.forEach((item, id) => {\n    const referencePoints = item.getReferencePoints()\n    const referencePointInRectangle = referencePoints.find((point) => {\n      return point.x > x0 && point.x < x1 && point.y > y0 && point.y < y1\n    })\n\n    if (referencePointInRectangle) {\n      textsList.push(id)\n    }\n  })\n\n  return {\n    atoms: atomList,\n    bonds: bondList,\n    rxnArrows: rxnArrowsList,\n    rxnPluses: rxnPlusesList,\n    enhancedFlags: enhancedFlagList,\n    sgroupData: sgroupDataList,\n    simpleObjects: simpleObjectsList,\n    texts: textsList\n  }\n}\n\nfunction getElementsInPolygon(restruct, rr) {\n  // eslint-disable-line max-statements\n  const bondList: Array<number> = []\n  const atomList: Array<number> = []\n  const r: any = []\n  const sGroups = restruct.sgroups\n  const functionalGroups = restruct.molecule.functionalGroups\n\n  for (let i = 0; i < rr.length; ++i) {\n    r[i] = new Vec2(rr[i].x, rr[i].y)\n  }\n\n  restruct.bonds.forEach((bond, bid) => {\n    const centre = Vec2.lc2(\n      restruct.atoms.get(bond.b.begin).a.pp,\n      0.5,\n      restruct.atoms.get(bond.b.end).a.pp,\n      0.5\n    )\n    if (\n      isPointInPolygon(r, centre) &&\n      !FunctionalGroup.isBondInContractedFunctionalGroup(\n        bond.b,\n        sGroups,\n        functionalGroups\n      )\n    ) {\n      bondList.push(bid)\n    }\n  })\n\n  restruct.atoms.forEach((atom, aid) => {\n    const relatedFGId = FunctionalGroup.findFunctionalGroupByAtom(\n      functionalGroups,\n      aid\n    )\n    const sGroup = restruct.sgroups.get(relatedFGId)\n    if (\n      isPointInPolygon(r, atom.a.pp) &&\n      (!FunctionalGroup.isAtomInContractedFunctionalGroup(\n        atom.a,\n        sGroups,\n        functionalGroups,\n        true\n      ) ||\n        aid === sGroup.item.atoms[0])\n    ) {\n      atomList.push(aid)\n    }\n  })\n\n  const rxnArrowsList: Array<number> = []\n  const rxnPlusesList: Array<number> = []\n  const simpleObjectsList: Array<number> = []\n  const textsList: Array<number> = []\n\n  restruct.rxnArrows.forEach((item, id) => {\n    const referencePoints = item.getReferencePoints(true)\n    const referencePointInPolygon = referencePoints.find((point) =>\n      isPointInPolygon(r, point)\n    )\n    if (referencePointInPolygon) {\n      rxnArrowsList.push(id)\n    }\n  })\n\n  restruct.rxnPluses.forEach((item, id) => {\n    if (isPointInPolygon(r, item.item.pp)) {\n      rxnPlusesList.push(id)\n    }\n  })\n\n  restruct.simpleObjects.forEach((item, id) => {\n    const referencePoints = item.getReferencePoints(true)\n    const referencePointInPolygon = referencePoints.find((point) =>\n      isPointInPolygon(r, point)\n    )\n    if (referencePointInPolygon) {\n      simpleObjectsList.push(id)\n    }\n  })\n\n  restruct.texts.forEach((item, id) => {\n    const referencePoints = item.getReferencePoints()\n    const referencePointInPolygon = referencePoints.find((point) =>\n      isPointInPolygon(r, point)\n    )\n\n    if (referencePointInPolygon) {\n      textsList.push(id)\n    }\n  })\n\n  const enhancedFlagList: Array<number> = []\n  restruct.enhancedFlags.forEach((item, id) => {\n    if (item.pp && isPointInPolygon(r, item.pp)) {\n      enhancedFlagList.push(id)\n    }\n  })\n\n  const sgroupDataList: Array<number> = []\n  restruct.sgroupData.forEach((item, id) => {\n    if (isPointInPolygon(r, item.sgroup.pp)) {\n      sgroupDataList.push(id)\n    }\n  })\n\n  return {\n    atoms: atomList,\n    bonds: bondList,\n    rxnArrows: rxnArrowsList,\n    rxnPluses: rxnPlusesList,\n    enhancedFlags: enhancedFlagList,\n    sgroupData: sgroupDataList,\n    simpleObjects: simpleObjectsList,\n    texts: textsList\n  }\n}\n\n// TODO: test me see testPolygon from\n// 'Remove unused methods from render' commit\nfunction isPointInPolygon(r, p) {\n  // eslint-disable-line max-statements\n  const d = new Vec2(0, 1)\n  const n = d.rotate(Math.PI / 2)\n  let v0 = Vec2.diff(r[r.length - 1], p)\n  let n0 = Vec2.dot(n, v0)\n  let d0 = Vec2.dot(d, v0)\n  let w0 = new Vec2(0, 0)\n  let counter = 0\n  const eps = 1e-5\n  let flag1 = false\n  let flag0 = false\n\n  for (let i = 0; i < r.length; ++i) {\n    const v1 = Vec2.diff(r[i], p)\n    const w1 = Vec2.diff(v1, v0)\n    const n1 = Vec2.dot(n, v1)\n    const d1 = Vec2.dot(d, v1)\n    flag1 = false\n    if (n1 * n0 < 0) {\n      if (d1 * d0 > -eps) {\n        if (d0 > -eps) flag1 = true\n        /* eslint-disable no-mixed-operators */\n      } else if (\n        (Math.abs(n0) * Math.abs(d1) - Math.abs(n1) * Math.abs(d0)) * d1 >\n        0\n      ) {\n        /* eslint-enable no-mixed-operators */\n        flag1 = true\n      }\n    }\n    if (flag1 && flag0 && Vec2.dot(w1, n) * Vec2.dot(w0, n) >= 0) {\n      flag1 = false\n    }\n    if (flag1) {\n      counter++\n    }\n    v0 = v1\n    n0 = n1\n    d0 = d1\n    w0 = w1\n    flag0 = flag1\n  }\n  return counter % 2 !== 0\n}\n\nexport default {\n  inRectangle: getElementsInRectangle,\n  inPolygon: getElementsInPolygon\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Scale } from 'ketcher-core'\nimport locate from './locate'\nimport Editor from '../../Editor'\n\nclass LassoHelper {\n  mode: any\n  editor: Editor\n  fragment: any\n  points: any\n  selection: any\n\n  constructor(mode, editor, fragment) {\n    this.mode = mode\n    this.fragment = fragment\n    this.editor = editor\n  }\n\n  getSelection() {\n    const rnd = this.editor.render\n\n    if (this.mode === 0) {\n      return locate.inPolygon(rnd.ctab, this.points)\n    }\n\n    if (this.mode === 1) {\n      return locate.inRectangle(rnd.ctab, this.points[0], this.points[1])\n    }\n\n    throw new Error('Selector mode unknown') // eslint-disable-line no-else-return\n  }\n\n  begin(event) {\n    const rnd = this.editor.render\n    this.points = [rnd.page2obj(event)]\n    if (this.mode === 1) {\n      this.points.push(this.points[0])\n    }\n  }\n\n  running() {\n    return !!this.points\n  }\n\n  addPoint(event) {\n    if (!this.points) {\n      return null\n    }\n\n    const rnd = this.editor.render\n\n    if (this.mode === 0) {\n      this.points.push(rnd.page2obj(event))\n    } else if (this.mode === 1) {\n      this.points = [this.points[0], rnd.page2obj(event)]\n    }\n\n    this.update()\n    return this.getSelection()\n  }\n\n  update() {\n    if (this.selection) {\n      this.selection.remove()\n      this.selection = null\n    }\n\n    if (this.points && this.points.length > 1) {\n      const rnd = this.editor.render\n      const dp = this.points.map((p) =>\n        Scale.obj2scaled(p, rnd.options).add(rnd.options.offset)\n      )\n      this.selection =\n        this.mode === 0\n          ? rnd.selectionPolygon(dp)\n          : rnd.selectionRectangle(dp[0], dp[1])\n    }\n  }\n\n  end() {\n    const ret = this.getSelection()\n    this.points = null\n    this.update()\n    return ret\n  }\n\n  cancel() {\n    this.points = null\n    this.update()\n  }\n}\n\nexport default LassoHelper\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  Pile,\n  SgContexts,\n  checkOverlapping,\n  fromSeveralSgroupAddition,\n  fromSgroupAction,\n  fromSgroupDeletion,\n  FunctionalGroup,\n  SGroup,\n  Pool\n} from 'ketcher-core'\n\nimport LassoHelper from './helper/lasso'\nimport { isEqual } from 'lodash/fp'\nimport { selMerge } from './select'\nimport Editor from '../Editor'\n\nconst searchMaps = [\n  'atoms',\n  'bonds',\n  'sgroups',\n  'functionalGroups',\n  'sgroupData'\n]\n\nclass SGroupTool {\n  editor: Editor\n  lassoHelper: any\n  isNotActiveTool: boolean | undefined\n\n  constructor(editor) {\n    this.editor = editor\n    this.lassoHelper = new LassoHelper(1, editor, null)\n\n    this.checkSelection()\n  }\n\n  checkSelection() {\n    const selection = this.editor.selection() || {}\n\n    if (selection.atoms && selection.bonds) {\n      const selectedAtoms = this.editor.selection()?.atoms\n      const struct = this.editor.render.ctab\n      const molecule = struct.molecule\n      const sgroups: Pool<SGroup> = molecule.sgroups\n      const newSelected: { atoms: Array<any>; bonds: Array<any> } = {\n        atoms: [],\n        bonds: []\n      }\n      let actualSgroupId\n      let atomsResult: Array<number> = []\n      let extraAtoms\n      const functionalGroups = molecule.functionalGroups\n      const result: Array<number> = []\n\n      const id = sgroups.find((_, sgroup) =>\n        isEqual(sgroup.atoms, selectedAtoms)\n      )\n\n      if (selectedAtoms && functionalGroups.size) {\n        for (const atom of selectedAtoms) {\n          const atomId = FunctionalGroup.atomsInFunctionalGroup(\n            functionalGroups,\n            atom\n          )\n\n          if (atomId == null) {\n            extraAtoms = true\n          }\n\n          const atomFromStruct = atomId !== null && struct.atoms.get(atomId)?.a\n\n          if (atomFromStruct) {\n            for (const sgId of atomFromStruct.sgs.values()) {\n              actualSgroupId = sgId\n            }\n          }\n\n          if (\n            atomFromStruct &&\n            FunctionalGroup.isAtomInContractedFunctionalGroup(\n              atomFromStruct,\n              sgroups,\n              functionalGroups,\n              false\n            )\n          ) {\n            const sgroupAtoms =\n              actualSgroupId !== undefined &&\n              SGroup.getAtoms(molecule, sgroups.get(actualSgroupId))\n            const sgroupBonds =\n              actualSgroupId !== undefined &&\n              SGroup.getBonds(molecule, sgroups.get(actualSgroupId))\n            atom === sgroupAtoms[0] &&\n              newSelected.atoms.push(...(sgroupAtoms as Array<any>)) &&\n              newSelected.bonds.push(...(sgroupBonds as Array<any>))\n          }\n\n          if (atomFromStruct) {\n            atomsResult.push(atomId)\n          }\n        }\n      }\n\n      if (extraAtoms) {\n        atomsResult = []\n      }\n\n      if (atomsResult && atomsResult.length > 0) {\n        for (const id of atomsResult) {\n          const fgId = FunctionalGroup.findFunctionalGroupByAtom(\n            functionalGroups,\n            id\n          )\n\n          if (fgId !== null && !result.includes(fgId)) {\n            result.push(fgId)\n          }\n        }\n      }\n\n      if (result.length) {\n        this.editor.selection(null)\n        this.editor.event.removeFG.dispatch({ fgIds: result })\n        return\n      }\n\n      SGroupTool.sgroupDialog(this.editor, id ?? null)\n      this.isNotActiveTool = true\n    }\n  }\n\n  mousedown(event) {\n    const ci = this.editor.findItem(event, searchMaps)\n    const struct = this.editor.render.ctab\n    const sgroups = struct.sgroups\n    const molecule = struct.molecule\n    const functionalGroups = molecule.functionalGroups\n    const atomResult: Array<number> = []\n    const bondResult: Array<number> = []\n    const result: Array<number> = []\n\n    if (ci && functionalGroups.size && ci.map === 'atoms') {\n      const atomId = FunctionalGroup.atomsInFunctionalGroup(\n        functionalGroups,\n        ci.id\n      )\n      const atomFromStruct = atomId !== null && struct.atoms.get(atomId)?.a\n\n      if (\n        atomFromStruct &&\n        !FunctionalGroup.isAtomInContractedFunctionalGroup(\n          atomFromStruct,\n          sgroups,\n          functionalGroups,\n          true\n        )\n      ) {\n        atomResult.push(atomId)\n      }\n    }\n\n    if (ci && functionalGroups.size && ci.map === 'bonds') {\n      const bondId = FunctionalGroup.bondsInFunctionalGroup(\n        molecule,\n        functionalGroups,\n        ci.id\n      )\n      const bondFromStruct = bondId !== null && struct.bonds.get(bondId)?.b\n\n      if (\n        bondFromStruct &&\n        !FunctionalGroup.isBondInContractedFunctionalGroup(\n          bondFromStruct,\n          sgroups,\n          functionalGroups\n        )\n      ) {\n        bondResult.push(bondId)\n      }\n    }\n\n    if (ci && functionalGroups.size && ci.map === 'functionalGroups') {\n      const sgroup = sgroups.get(ci.id)\n\n      if (FunctionalGroup.isFunctionalGroup(sgroup?.item)) {\n        this.editor.event.removeFG.dispatch({ fgIds: [ci.id] })\n        return\n      }\n    }\n\n    if (atomResult.length > 0) {\n      for (const id of atomResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByAtom(\n          functionalGroups,\n          id\n        )\n\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n\n      this.editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    } else if (bondResult.length > 0) {\n      for (const id of bondResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByBond(\n          molecule,\n          functionalGroups,\n          id\n        )\n\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n\n      this.editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    }\n\n    if (!ci) {\n      //  ci.type == 'Canvas'\n      this.lassoHelper.begin(event)\n    }\n  }\n\n  mousemove(event) {\n    if (this.lassoHelper.running(event)) {\n      this.editor.selection(this.lassoHelper.addPoint(event))\n    } else {\n      this.editor.hover(this.editor.findItem(event, searchMaps), null, event)\n    }\n  }\n\n  mouseleave(event) {\n    if (this.lassoHelper.running(event)) {\n      this.lassoHelper.end(event)\n    }\n  }\n\n  mouseup(event) {\n    const struct = this.editor.render.ctab\n    const sgroups = struct.sgroups\n    const molecule = struct.molecule\n    const functionalGroups = molecule.functionalGroups\n    const ci = this.editor.findItem(event, searchMaps)\n    const selected = this.editor.selection()\n    const newSelected: Record<string, Array<any>> = { atoms: [], bonds: [] }\n    let actualSgroupId\n    let atomsResult: Array<number> | null = []\n    let extraAtoms\n    let bondsResult: Array<number> | null = []\n    let extraBonds\n    const result: Array<number> = []\n    if (\n      ci &&\n      ci.map === 'functionalGroups' &&\n      functionalGroups.size &&\n      FunctionalGroup.isContractedFunctionalGroup(ci.id, functionalGroups)\n    )\n      return\n\n    if (selected && functionalGroups.size && selected.atoms) {\n      for (const atom of selected.atoms) {\n        const atomId = FunctionalGroup.atomsInFunctionalGroup(\n          functionalGroups,\n          atom\n        )\n\n        if (atomId == null) {\n          extraAtoms = true\n        }\n\n        const atomFromStruct = atomId !== null && struct.atoms.get(atomId)?.a\n\n        if (atomFromStruct) {\n          for (const sgId of atomFromStruct.sgs.values()) {\n            actualSgroupId = sgId\n          }\n        }\n\n        if (\n          atomFromStruct &&\n          FunctionalGroup.isAtomInContractedFunctionalGroup(\n            atomFromStruct,\n            sgroups,\n            functionalGroups,\n            true\n          )\n        ) {\n          const sgroupAtoms =\n            actualSgroupId !== undefined &&\n            SGroup.getAtoms(molecule, struct.sgroups.get(actualSgroupId)?.item)\n          const sgroupBonds =\n            actualSgroupId !== undefined &&\n            SGroup.getBonds(molecule, struct.sgroups.get(actualSgroupId)?.item)\n          atom === sgroupAtoms[0] &&\n            newSelected.atoms.push(...(sgroupAtoms as Array<any>)) &&\n            newSelected.bonds.push(...(sgroupBonds as Array<any>))\n        }\n\n        if (atomFromStruct) {\n          atomsResult.push(atomId)\n        }\n      }\n    }\n\n    if (selected && functionalGroups.size && selected.bonds) {\n      for (const bond of selected.bonds) {\n        const bondId = FunctionalGroup.bondsInFunctionalGroup(\n          molecule,\n          functionalGroups,\n          bond\n        )\n\n        if (bondId === null) {\n          extraBonds = true\n        }\n\n        const bondFromStruct = bondId !== null && struct.bonds.get(bondId)?.b\n        if (bondFromStruct) {\n          bondsResult.push(bondId)\n        }\n      }\n    }\n\n    if (atomsResult.length) {\n      atomsResult.forEach((id) => {\n        const fgId = FunctionalGroup.findFunctionalGroupByAtom(\n          functionalGroups,\n          id\n        ) as number\n        const sgroupAtoms = SGroup.getAtoms(\n          molecule,\n          struct.sgroups.get(fgId)?.item\n        )\n        newSelected.atoms.push(...sgroupAtoms)\n      })\n    }\n\n    if (bondsResult.length) {\n      bondsResult.forEach((id) => {\n        const fgId = FunctionalGroup.findFunctionalGroupByBond(\n          molecule,\n          functionalGroups,\n          id\n        ) as number\n        const sgroupBonds = SGroup.getBonds(\n          molecule,\n          struct.sgroups.get(fgId)?.item\n        )\n        newSelected.bonds.push(...sgroupBonds)\n      })\n    }\n\n    if (extraAtoms || extraBonds) {\n      atomsResult = null\n      bondsResult = null\n    }\n\n    if (atomsResult && atomsResult.length > 0) {\n      for (const id of atomsResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByAtom(\n          functionalGroups,\n          id\n        )\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n    }\n\n    if (bondsResult && bondsResult.length > 0) {\n      for (const id of bondsResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByBond(\n          molecule,\n          functionalGroups,\n          id\n        )\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n    }\n\n    if (result.length === 1) {\n      this.editor.selection(null)\n      this.lassoHelper.cancel()\n      this.editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    }\n\n    let id = null // id of an existing group, if we're editing one\n    let selection: any = null // atoms to include in a newly created group\n\n    if (this.lassoHelper.running(event)) {\n      // TODO it catches more events than needed, to be re-factored\n      selection =\n        newSelected.atoms.length > 0\n          ? selMerge(this.lassoHelper.end(event), newSelected, false)\n          : this.lassoHelper.end(event)\n      this.editor.selection(selection)\n    } else {\n      if (!ci) {\n        // ci.type == 'Canvas'\n        return\n      }\n\n      this.editor.hover(this.editor.findItem(event, searchMaps), null, event)\n      if (ci.map === 'atoms') {\n        // if we click the SGroup tool on a single atom or bond, make a group out of those\n        selection = { atoms: [ci.id] }\n      } else if (ci.map === 'bonds') {\n        const bond = this.editor.render.ctab.bonds.get(ci.id)\n        selection = {\n          atoms: [bond?.b.begin, bond?.b.end],\n          bonds: [ci.id]\n        }\n      } else if (ci.map === 'sgroups' || ci.map === 'sgroupData') {\n        id = ci.id\n      } else {\n        return\n      }\n    }\n\n    const isAtomsOrBondsSelected =\n      selection?.atoms?.length || selection?.bonds?.length\n    // TODO: handle click on an existing group?\n    if (id !== null || isAtomsOrBondsSelected) {\n      this.editor.selection(selection)\n      SGroupTool.sgroupDialog(this.editor, id)\n    }\n  }\n\n  cancel() {\n    if (this.lassoHelper.running()) {\n      this.lassoHelper.end()\n    }\n    this.editor.selection(null)\n  }\n\n  static sgroupDialog(editor, id) {\n    const restruct = editor.render.ctab\n    const struct = restruct.molecule\n    const selection = editor.selection() || {}\n    const sg = id !== null ? struct.sgroups.get(id) : null\n\n    let attrs\n    if (sg) {\n      attrs = sg.getAttrs()\n      if (!attrs.context) attrs.context = getContextBySgroup(restruct, sg.atoms)\n    } else {\n      attrs = {\n        context: getContextBySelection(restruct, selection)\n      }\n    }\n\n    const res = editor.event.sgroupEdit.dispatch({\n      type: sg?.type,\n      attrs\n    })\n\n    Promise.resolve(res)\n      .then((newSg) => {\n        // TODO: check before signal\n        if (\n          newSg.type !== 'DAT' && // when data s-group separates\n          checkOverlapping(struct, selection.atoms || [])\n        ) {\n          editor.event.message.dispatch({\n            error: 'Partial S-group overlapping is not allowed.'\n          })\n        } else {\n          if (\n            !sg &&\n            newSg.type !== 'DAT' &&\n            (!selection.atoms || selection.atoms.length === 0)\n          )\n            return\n\n          const isDataSg = sg && sg.getAttrs().context === newSg.attrs.context\n\n          if (isDataSg) {\n            const action = fromSeveralSgroupAddition(\n              restruct,\n              newSg.type,\n              sg.atoms,\n              newSg.attrs\n            ).mergeWith(fromSgroupDeletion(restruct, id))\n\n            editor.update(action)\n            editor.selection(selection)\n            return\n          }\n\n          const result = fromContextType(id, editor, newSg, selection)\n          editor.update(result.action)\n          editor.selection(null)\n        }\n      })\n      .catch(() => null)\n  }\n}\n\nfunction getContextBySgroup(restruct, sgAtoms) {\n  const struct = restruct.molecule\n\n  if (sgAtoms.length === 1) {\n    return SgContexts.Atom\n  }\n\n  if (manyComponentsSelected(restruct, sgAtoms)) {\n    return SgContexts.Multifragment\n  }\n\n  if (singleComponentSelected(restruct, sgAtoms)) {\n    return SgContexts.Fragment\n  }\n\n  const atomSet = new Pile(sgAtoms)\n\n  const sgBonds = Array.from(struct.bonds.values()).filter(\n    (bond: any) => atomSet.has(bond.begin) && atomSet.has(bond.end)\n  )\n\n  return anyChainedBonds(sgBonds) ? SgContexts.Group : SgContexts.Bond\n}\n\nfunction getContextBySelection(restruct, selection) {\n  const struct = restruct.molecule\n\n  if (selection.atoms && !selection.bonds) {\n    return SgContexts.Atom\n  }\n\n  const bonds = selection.bonds.map((bondid) => struct.bonds.get(bondid))\n\n  if (!anyChainedBonds(bonds)) {\n    return SgContexts.Bond\n  }\n\n  selection.atoms = selection.atoms || []\n\n  const atomSet = new Pile(selection.atoms)\n  const allBondsSelected = bonds.every(\n    (bond) => atomSet.has(bond.begin) && atomSet.has(bond.end)\n  )\n\n  if (singleComponentSelected(restruct, selection.atoms) && allBondsSelected) {\n    return SgContexts.Fragment\n  }\n\n  return manyComponentsSelected(restruct, selection.atoms)\n    ? SgContexts.Multifragment\n    : SgContexts.Group\n}\n\nfunction fromContextType(id, editor, newSg, currSelection) {\n  const restruct = editor.render.ctab\n  const sg = restruct.molecule.sgroups.get(id)\n  const sourceAtoms = (sg && sg.atoms) || currSelection.atoms || []\n  const context = newSg.attrs.context\n\n  const result = fromSgroupAction(\n    context,\n    restruct,\n    newSg,\n    sourceAtoms,\n    currSelection\n  )\n\n  result.selection = result.selection || currSelection\n\n  if (id !== null && id !== undefined) {\n    result.action = result.action.mergeWith(fromSgroupDeletion(restruct, id))\n  }\n\n  editor.selection(result.selection)\n\n  return result\n}\n\nfunction anyChainedBonds(bonds) {\n  if (bonds.length === 0) {\n    return true\n  }\n\n  for (let i = 0; i < bonds.length; ++i) {\n    const fixedBond = bonds[i]\n    for (let j = 0; j < bonds.length; ++j) {\n      if (i === j) continue\n\n      const bond = bonds[j]\n\n      if (fixedBond.end === bond.begin || fixedBond.end === bond.end) {\n        return true\n      }\n    }\n  }\n\n  return false\n}\n\nfunction singleComponentSelected(restruct, atoms) {\n  return countOfSelectedComponents(restruct, atoms) === 1\n}\n\nfunction manyComponentsSelected(restruct, atoms) {\n  return countOfSelectedComponents(restruct, atoms) > 1\n}\n\nfunction countOfSelectedComponents(restruct, atoms): any {\n  const atomSet = new Pile(atoms)\n\n  return Array.from(restruct.connectedComponents.values()).reduce(\n    (acc: number, component) =>\n      acc + (atomSet.isSuperset(component as Pile) ? 1 : 0),\n    0\n  )\n}\n\nexport default SGroupTool\n","import { mergeMapOfItemsToSet, Struct } from 'ketcher-core'\n\ntype Items = {\n  atoms?: number[]\n  bonds?: number[]\n}\n\nfunction getGroupIdsFromItemArrays(struct: Struct, items?: Items): number[] {\n  if (!struct.sgroups.size) return []\n\n  const groupsIds = new Set<number>()\n\n  items?.atoms?.forEach((atomId) => {\n    const groupId = struct.getGroupIdFromAtomId(atomId)\n    if (groupId !== null) groupsIds.add(groupId)\n  })\n\n  items?.bonds?.forEach((bondId) => {\n    const groupId = struct.getGroupIdFromBondId(bondId)\n    if (groupId !== null) groupsIds.add(groupId)\n  })\n\n  return Array.from(groupsIds)\n}\n\ntype MergeItems = {\n  atoms: Map<number, number>\n  bonds: Map<number, number>\n}\n\nfunction getGroupIdsFromItemMaps(\n  struct: Struct,\n  mergeMaps: MergeItems | null\n): number[] {\n  const atoms =\n    mergeMaps?.atoms && Array.from(mergeMapOfItemsToSet(mergeMaps.atoms))\n  const bonds =\n    mergeMaps?.bonds && Array.from(mergeMapOfItemsToSet(mergeMaps.bonds))\n\n  return getGroupIdsFromItemArrays(struct, { atoms, bonds })\n}\n\nexport { getGroupIdsFromItemArrays, getGroupIdsFromItemMaps }\n","import { Action, fromItemsFuse, ReStruct, setExpandSGroup } from 'ketcher-core'\nimport Editor from '../../Editor'\nimport { getGroupIdsFromItemMaps } from './getGroupIdsFromItems'\n\ntype MergeItems = {\n  atoms: Map<number, number>\n  bonds: Map<number, number>\n}\n\nexport function dropAndMerge(\n  editor: Editor,\n  mergeItems: MergeItems,\n  action?: Action\n): void {\n  const restruct = editor.render.ctab\n  const isMerging = !!mergeItems\n  let dropItemAction = new Action()\n\n  if (isMerging) {\n    const expandGroupsAction = getExpandGroupsInMergeAction(\n      editor.render.ctab,\n      mergeItems\n    )\n    dropItemAction = dropItemAction.mergeWith(expandGroupsAction)\n  }\n\n  dropItemAction = fromItemsFuse(restruct, mergeItems).mergeWith(dropItemAction)\n\n  if (action) {\n    dropItemAction = dropItemAction.mergeWith(action)\n  }\n\n  editor.hover(null)\n  if (isMerging) editor.selection(null)\n\n  if (dropItemAction?.operations.length > 0) {\n    editor.update(dropItemAction)\n  }\n}\n\nfunction getExpandGroupsInMergeAction(\n  restruct: ReStruct,\n  mergeItems: MergeItems\n): Action {\n  const action = new Action()\n  const groupsInMerge = getGroupIdsFromItemMaps(restruct.molecule, mergeItems)\n  if (groupsInMerge.length) {\n    groupsInMerge.forEach((groupId) => {\n      action.mergeWith(setExpandSGroup(restruct, groupId, { expanded: true }))\n    })\n  }\n\n  return action\n}\n","import { getItemsToFuse } from 'ketcher-core'\nimport Editor from '../../Editor'\nimport utils from '../../shared/utils'\n\nexport function getMergeItems(\n  editor: Editor,\n  items: Record<string, number[]>\n): Record<string, Map<unknown, unknown>> | null {\n  const nonGroupItemsAndAttachPoints = {\n    ...items,\n    ...utils.getNonGroupItemsAndAttachmentPoints(\n      items,\n      editor.render.ctab.molecule\n    )\n  }\n\n  return getItemsToFuse(editor, nonGroupItemsAndAttachPoints)\n}\n","import { Action, Atom, fromAtomsAttrs } from 'ketcher-core'\nimport { fromElement } from '../../data/convert/structconv'\n\nexport function isAtomsArray(selectedElements: Atom | Atom[]): boolean {\n  return (\n    Array.isArray(selectedElements) &&\n    selectedElements?.every((element) => element instanceof Atom)\n  )\n}\n\ntype somePropertiesOfAtom = Partial<{\n  [attribute in keyof Atom]: string | number | boolean\n}>\n\n// If all atoms have the same value, then this value is used as a baseline\n// otherwise it is set to an empty string. Afterwards, empty string denotes that the value is not changed\nexport function generateCommonProperties(\n  selectedElements: Atom[]\n): somePropertiesOfAtom {\n  const normalizedAtom = fromElement(selectedElements[0])\n  const properties = Object.getOwnPropertyNames(normalizedAtom)\n  const resultAtomAttributes: somePropertiesOfAtom = {}\n  properties.forEach((property) => {\n    const uniqueValues = new Set()\n    selectedElements.forEach((element) => {\n      uniqueValues.add(element[property])\n    })\n    const allAtomsHaveTheSameValue = uniqueValues.size === 1\n    if (allAtomsHaveTheSameValue) {\n      resultAtomAttributes[property] = normalizedAtom[property]\n    } else {\n      resultAtomAttributes[property] = ''\n    }\n  })\n  return resultAtomAttributes\n}\n\nfunction castAtomPropToType(property, value) {\n  const typesMapping = {\n    charge: Number,\n    exactChangeFlag: Number,\n    unsaturatedAtom: Number\n  }\n  if (typesMapping[property]) {\n    return typesMapping[property](value)\n  }\n  return value\n}\n\nexport function updateOnlyChangedProperties(atomId, userChangedAtom, molecule) {\n  const unchangedAtom = molecule.atoms.get(atomId)\n  const updatedKeys = Object.getOwnPropertyNames(userChangedAtom).filter(\n    (key) => userChangedAtom[key] !== ''\n  )\n  return Object.getOwnPropertyNames(unchangedAtom).reduce(\n    (updatedAtom, key) => {\n      const isPropertyChanged = updatedKeys.includes(key)\n      if (isPropertyChanged) {\n        updatedAtom[key] = castAtomPropToType(key, userChangedAtom[key])\n      } else {\n        updatedAtom[key] = unchangedAtom[key]\n      }\n      return updatedAtom\n    },\n    {}\n  )\n}\n\nexport function updateSelectedAtoms({\n  atoms,\n  changeAtomPromise,\n  editor\n}: {\n  atoms: number[]\n  editor\n  changeAtomPromise: Promise<Atom>\n}) {\n  const action = new Action()\n  const struct = editor.render.ctab\n  const { molecule } = struct\n  if (atoms) {\n    Promise.resolve(changeAtomPromise)\n      .then((userChangedAtom) => {\n        // TODO: deep compare to not produce dummy, e.g.\n        // atom.label != attrs.label || !atom.atomList.equals(attrs.atomList)\n        atoms.forEach((atomId) => {\n          const atomWithChangedProperties = updateOnlyChangedProperties(\n            atomId,\n            userChangedAtom,\n            molecule\n          )\n          action.mergeWith(\n            fromAtomsAttrs(struct, atomId, atomWithChangedProperties, false)\n          )\n        })\n        editor.update(action)\n      })\n      .catch(() => null)\n  }\n}\n","import { Vec2 } from 'ketcher-core'\nimport _ from 'lodash'\n\nconst edgeOffset = 150\n\nexport function isCloseToEdgeOfScreen(event) {\n  const { clientX, clientY } = event\n  const body = document.body\n  const isCloseToLeftEdgeOfScreen = clientX <= edgeOffset\n  const isCloseToTopEdgeOfScreen = clientY <= edgeOffset\n  const isCloseToRightEdgeOfScreen = body.clientWidth - clientX <= edgeOffset\n  const isCloseToBottomEdgeOfScreen = body.clientHeight - clientY <= edgeOffset\n  return {\n    isCloseToLeftEdgeOfScreen,\n    isCloseToTopEdgeOfScreen,\n    isCloseToRightEdgeOfScreen,\n    isCloseToBottomEdgeOfScreen\n  }\n}\n\nexport function isCloseToEdgeOfCanvas(event, canvasSize) {\n  const { layerX, layerY } = event\n  const isCloseToLeftEdgeOfCanvas = layerX <= edgeOffset\n  const isCloseToTopEdgeOfCanvas = layerY <= edgeOffset\n  const isCloseToRightEdgeOfCanvas = canvasSize.x - layerX <= edgeOffset\n  const isCloseToBottomEdgeOfCanvas = canvasSize.y - layerY <= edgeOffset\n  return {\n    isCloseToLeftEdgeOfCanvas,\n    isCloseToTopEdgeOfCanvas,\n    isCloseToRightEdgeOfCanvas,\n    isCloseToBottomEdgeOfCanvas\n  }\n}\n\nexport function calculateCanvasExtension(\n  clientArea,\n  currentCanvasSize,\n  extensionVector\n) {\n  const newHorizontalScrollPosition = clientArea.scrollLeft + extensionVector.x\n  const newVerticalScrollPosition = clientArea.scrollTop + extensionVector.y\n  let horizontalExtension = 0\n  let verticalExtension = 0\n  if (newHorizontalScrollPosition > currentCanvasSize.x) {\n    horizontalExtension = newHorizontalScrollPosition - currentCanvasSize.x\n  }\n  if (newHorizontalScrollPosition < 0) {\n    horizontalExtension = Math.abs(newHorizontalScrollPosition)\n  }\n  if (newVerticalScrollPosition > currentCanvasSize.y) {\n    verticalExtension = newVerticalScrollPosition - currentCanvasSize.y\n  }\n  if (newVerticalScrollPosition < 0) {\n    verticalExtension = Math.abs(newVerticalScrollPosition)\n  }\n  return new Vec2(horizontalExtension, verticalExtension, 0)\n}\n\nexport function shiftAndExtendCanvasByVector(vector: Vec2, render) {\n  const clientArea = render.clientArea\n  const extensionVector = calculateCanvasExtension(\n    clientArea,\n    render.sz.scaled(render.options.zoom),\n    vector\n  ).scaled(1 / render.options.zoom)\n\n  if (extensionVector.x > 0 || extensionVector.y > 0) {\n    render.setPaperSize(render.sz.add(extensionVector))\n    render.setOffset(render.options.offset.add(vector))\n    render.ctab.translate(vector)\n  }\n\n  scrollByVector(vector, render)\n  render.update(false)\n}\n\nexport function scrollByVector(vector: Vec2, render) {\n  const clientArea = render.clientArea\n  clientArea.scrollLeft += vector.x * render.options.scale\n  clientArea.scrollTop += vector.y * render.options.scale\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  Action,\n  SGroup,\n  fromBondsAttrs,\n  fromItemsFuse,\n  fromMultipleMove,\n  fromTextDeletion,\n  fromTextUpdating,\n  getHoverToFuse,\n  FunctionalGroup,\n  fromSimpleObjectResizing,\n  fromArrowResizing,\n  ReStruct,\n  ReSGroup,\n  Vec2,\n  Atom\n} from 'ketcher-core'\n\nimport LassoHelper from './helper/lasso'\nimport { atomLongtapEvent } from './atom'\nimport SGroupTool from './sgroup'\nimport utils from '../shared/utils'\nimport { xor } from 'lodash/fp'\nimport { Editor } from '../Editor'\nimport { dropAndMerge } from './helper/dropAndMerge'\nimport { getGroupIdsFromItemArrays } from './helper/getGroupIdsFromItems'\nimport { getMergeItems } from './helper/getMergeItems'\nimport { updateSelectedAtoms } from 'src/script/ui/state/modal/atoms'\nimport {\n  isCloseToEdgeOfCanvas,\n  isCloseToEdgeOfScreen,\n  scrollByVector,\n  shiftAndExtendCanvasByVector\n} from '../utils/canvasExtension'\n\nclass SelectTool {\n  #mode: string\n  #lassoHelper: LassoHelper\n  editor: Editor\n  dragCtx: any\n\n  constructor(editor, mode) {\n    this.editor = editor\n    this.#mode = mode\n    this.#lassoHelper = new LassoHelper(\n      this.#mode === 'lasso' ? 0 : 1,\n      editor,\n      this.#mode === 'fragment'\n    )\n  }\n\n  isSelectionRunning() {\n    return this.#lassoHelper.running()\n  }\n\n  mousedown(event) {\n    const rnd = this.editor.render\n    const ctab = rnd.ctab\n    const molecule = ctab.molecule\n\n    this.editor.hover(null) // TODO review hovering for touch devicess\n\n    const map = getMapsForClosestItem(\n      this.#lassoHelper.fragment || event.ctrlKey\n    )\n    const ci = this.editor.findItem(event, map, null)\n\n    const selected = {\n      ...(ci?.map === 'atoms' && { atoms: [ci.id] }),\n      ...(ci?.map === 'bonds' && { bonds: [ci.id] })\n    }\n    const selectedSgroups = ci\n      ? getGroupIdsFromItemArrays(molecule, selected)\n      : []\n    const newSelected = getNewSelectedItems(this.editor, selectedSgroups)\n    if (newSelected.atoms?.length || newSelected.bonds?.length) {\n      this.editor.selection(newSelected)\n    }\n\n    this.dragCtx = {\n      item: ci,\n      xy0: rnd.page2obj(event)\n    }\n\n    if (!ci || ci.map === 'atoms') {\n      atomLongtapEvent(this, rnd)\n    }\n\n    if (!ci) {\n      //  ci.type == 'Canvas'\n      if (!event.shiftKey) this.editor.selection(null)\n      delete this.dragCtx.item\n      if (!this.#lassoHelper.fragment) this.#lassoHelper.begin(event)\n      return true\n    }\n\n    let sel = closestToSel(ci)\n    const sgroups = ctab.sgroups.get(ci.id)\n    const selection = this.editor.selection()\n    if (ci.map === 'frags') {\n      const frag = ctab.frags.get(ci.id)\n      sel = {\n        atoms: frag.fragGetAtoms(ctab, ci.id),\n        bonds: frag.fragGetBonds(ctab, ci.id)\n      }\n    } else if (\n      (ci.map === 'sgroups' || ci.map === 'functionalGroups') &&\n      sgroups\n    ) {\n      const sgroup = sgroups.item\n      sel = {\n        atoms: SGroup.getAtoms(molecule, sgroup),\n        bonds: SGroup.getBonds(molecule, sgroup)\n      }\n    } else if (ci.map === 'rgroups') {\n      const rgroup = ctab.rgroups.get(ci.id)\n      sel = {\n        atoms: rgroup.getAtoms(rnd),\n        bonds: rgroup.getBonds(rnd)\n      }\n    } else if (ci.map === 'sgroupData') {\n      if (isSelected(selection, ci)) return true\n    }\n\n    if (event.shiftKey) {\n      this.editor.selection(selMerge(sel, selection, true))\n    } else {\n      this.editor.selection(null)\n      this.editor.selection(isSelected(selection, ci) ? selection : sel)\n    }\n    return true\n  }\n\n  mousemove(event) {\n    const editor = this.editor\n    const rnd = editor.render\n    const restruct = editor.render.ctab\n    const dragCtx = this.dragCtx\n    if (dragCtx?.stopTapping) dragCtx.stopTapping()\n    if (dragCtx?.item) {\n      const atoms = restruct.molecule.atoms\n      const selection = editor.selection()\n\n      /* handle atoms */\n      const shouldDisplayDegree =\n        dragCtx.item.map === 'atoms' &&\n        atoms?.get(dragCtx.item.id)?.neighbors.length === 1 &&\n        selection?.atoms?.length === 1 &&\n        !selection.bonds\n      if (shouldDisplayDegree) {\n        // moving selected objects\n        const pos = rnd.page2obj(event)\n        const angle = utils.calcAngle(dragCtx.xy0, pos)\n        const degrees = utils.degrees(angle)\n        editor.event.message.dispatch({ info: degrees + 'º' })\n      }\n      /* end */\n\n      /* handle simpleObjects */\n      if (dragCtx.item.map === 'simpleObjects' && dragCtx.item.ref) {\n        if (dragCtx.action) dragCtx.action.perform(rnd.ctab)\n        const props = getResizingProps(editor, dragCtx, event)\n        dragCtx.action = fromSimpleObjectResizing(...props, event.shiftKey)\n        editor.update(dragCtx.action, true)\n        return true\n      }\n      /* end + fullstop */\n\n      /* handle rxnArrows */\n      if (dragCtx.item.map === 'rxnArrows' && dragCtx.item.ref) {\n        if (dragCtx?.action) dragCtx.action.perform(rnd.ctab)\n        const props = getResizingProps(editor, dragCtx, event)\n        dragCtx.action = fromArrowResizing(...props)\n        editor.update(dragCtx.action, true)\n        return true\n      }\n      /* end + fullstop */\n\n      /* handle functionalGroups */\n      if (dragCtx.item.map === 'functionalGroups' && !dragCtx.action) {\n        editor.event.showInfo.dispatch(null)\n      }\n      /* end */\n\n      if (dragCtx.action) {\n        dragCtx.action.perform(restruct)\n      }\n\n      const expSel = editor.explicitSelected()\n      dragCtx.action = fromMultipleMove(\n        restruct,\n        expSel,\n        editor.render.page2obj(event).sub(dragCtx.xy0)\n      )\n\n      dragCtx.mergeItems = getMergeItems(editor, expSel)\n      editor.hover(getHoverToFuse(dragCtx.mergeItems))\n\n      extendCanvas(rnd, event)\n      editor.update(dragCtx.action, true)\n      return true\n    }\n\n    if (this.#lassoHelper.running()) {\n      const sel = this.#lassoHelper.addPoint(event)\n      editor.selection(\n        !event.shiftKey ? sel : selMerge(sel, editor.selection(), false)\n      )\n      return true\n    }\n\n    const maps = getMapsForClosestItem(\n      this.#lassoHelper.fragment || event.ctrlKey\n    )\n    editor.hover(editor.findItem(event, maps, null), null, event)\n\n    return true\n  }\n\n  mouseup(event) {\n    const editor = this.editor\n    const selected = editor.selection()\n    const struct = editor.render.ctab\n    const molecule = struct.molecule\n\n    // add all items of all selectedSGroups to selection\n    const selectedSgroups = selected\n      ? getGroupIdsFromItemArrays(molecule, selected)\n      : []\n    const newSelected = getNewSelectedItems(editor, selectedSgroups)\n\n    if (this.dragCtx?.stopTapping) this.dragCtx.stopTapping()\n\n    /* ignore salts and solvents */\n    const possibleSaltOrSolvent = struct.sgroups.get(\n      selectedSgroups[selectedSgroups.length - 1]\n    )\n    const isDraggingSaltOrSolventOnStructure = SGroup.isSaltOrSolvent(\n      possibleSaltOrSolvent?.item.data.name\n    )\n    if (\n      this.dragCtx &&\n      (isDraggingSaltOrSolventOnStructure ||\n        this.isDraggingStructureOnSaltOrSolvent(this.dragCtx, struct.sgroups))\n    ) {\n      preventSaltAndSolventsMerge(struct, this.dragCtx, editor)\n      delete this.dragCtx\n    }\n    /* end */\n\n    if (this.dragCtx?.item) {\n      dropAndMerge(editor, this.dragCtx.mergeItems, this.dragCtx.action)\n      delete this.dragCtx\n    } else if (this.#lassoHelper.running()) {\n      // TODO it catches more events than needed, to be re-factored\n      this.selectElementsOnCanvas(newSelected, editor, event)\n    } else if (this.#lassoHelper.fragment) {\n      if (\n        !event.shiftKey &&\n        this.editor.render.clientArea.contains(event.target)\n      )\n        editor.selection(null)\n    }\n    editor.event.message.dispatch({\n      info: false\n    })\n  }\n\n  dblclick(event) {\n    const editor = this.editor\n    const struct = editor.render.ctab\n    const { molecule, sgroups } = struct\n    const functionalGroups = molecule.functionalGroups\n    const rnd = editor.render\n    const ci = editor.findItem(\n      event,\n      ['atoms', 'bonds', 'sgroups', 'functionalGroups', 'sgroupData', 'texts'],\n      null\n    )\n\n    const atomResult: any[] = []\n    const bondResult: any[] = []\n    const result: any[] = []\n    if (ci && functionalGroups && ci.map === 'atoms') {\n      const atomId = FunctionalGroup.atomsInFunctionalGroup(\n        functionalGroups,\n        ci.id\n      )\n      const atomFromStruct = atomId !== null && struct.atoms.get(atomId)?.a\n      if (\n        atomId !== null &&\n        !FunctionalGroup.isAtomInContractedFunctionalGroup(\n          // TODO: examine if this code is really needed, seems like its a hack\n          atomFromStruct,\n          sgroups,\n          functionalGroups,\n          true\n        )\n      )\n        atomResult.push(atomId)\n    }\n    if (ci && functionalGroups && ci.map === 'bonds') {\n      const bondId = FunctionalGroup.bondsInFunctionalGroup(\n        molecule,\n        functionalGroups,\n        ci.id\n      )\n      const bondFromStruct = bondId !== null && struct.bonds.get(bondId)?.b\n      if (\n        bondFromStruct &&\n        !FunctionalGroup.isBondInContractedFunctionalGroup(\n          // TODO: examine if this code is really needed, seems like its a hack\n          bondFromStruct,\n          sgroups,\n          functionalGroups\n        )\n      )\n        bondResult.push(bondId)\n    }\n    if (atomResult.length > 0) {\n      for (const id of atomResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByAtom(\n          functionalGroups,\n          id\n        )\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n      editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    } else if (bondResult.length > 0) {\n      for (const id of bondResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByBond(\n          molecule,\n          functionalGroups,\n          id\n        )\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n      this.editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    }\n    if (!ci) return\n\n    const selection = this.editor.selection()\n\n    if (ci.map === 'atoms') {\n      const atoms = getSelectedAtoms(selection, molecule)\n      const changeAtomPromise = editor.event.elementEdit.dispatch(atoms)\n      updateSelectedAtoms({\n        atoms: selection?.atoms || [],\n        editor,\n        changeAtomPromise\n      })\n    } else if (ci.map === 'bonds') {\n      const bond = rnd.ctab.bonds.get(ci.id)?.b\n      const rb = editor.event.bondEdit.dispatch(bond)\n\n      if (selection?.bonds) {\n        const action = new Action()\n        const bondsSelection = selection.bonds\n        Promise.resolve(rb)\n          .then((newbond) => {\n            bondsSelection.forEach((bid) => {\n              action.mergeWith(fromBondsAttrs(struct, bid, newbond))\n            })\n            editor.update(action)\n          })\n          .catch(() => null) // w/o changes\n      }\n    } else if (\n      (ci.map === 'sgroups' &&\n        !FunctionalGroup.isFunctionalGroup(molecule.sgroups.get(ci.id))) ||\n      ci.map === 'sgroupData'\n    ) {\n      editor.selection(closestToSel(ci))\n      SGroupTool.sgroupDialog(editor, ci.id)\n    } else if (ci.map === 'texts') {\n      editor.selection(closestToSel(ci))\n      const text = molecule.texts.get(ci.id)\n      const dialog = editor.event.elementEdit.dispatch({\n        ...text,\n        type: 'text'\n      })\n\n      dialog\n        .then(({ content }) => {\n          if (!content) {\n            editor.update(fromTextDeletion(struct, ci.id))\n          } else if (content !== text?.content) {\n            editor.update(fromTextUpdating(struct, ci.id, content))\n          }\n        })\n        .catch(() => null)\n    }\n    return true\n  }\n\n  mouseleave(_) {\n    if (this.dragCtx && this.dragCtx.stopTapping) this.dragCtx.stopTapping()\n\n    if (this.dragCtx && this.dragCtx.action) {\n      const action = this.dragCtx.action\n      this.editor.update(action)\n    }\n    if (this.#lassoHelper.running())\n      this.editor.selection(this.#lassoHelper.end())\n\n    delete this.dragCtx\n\n    this.editor.hover(null)\n  }\n\n  selectElementsOnCanvas(\n    elements: { atoms: number[]; bonds: number[] },\n    editor: Editor,\n    event\n  ) {\n    const sel =\n      elements.atoms.length > 0\n        ? selMerge(this.#lassoHelper.end(), elements, false)\n        : this.#lassoHelper.end()\n    editor.selection(\n      !event.shiftKey ? sel : selMerge(sel, editor.selection(), false)\n    )\n  }\n\n  isDraggingStructureOnSaltOrSolvent(dragCtx, sgroups: Map<number, ReSGroup>) {\n    let isDraggingOnSaltOrSolventAtom\n    let isDraggingOnSaltOrSolventBond\n    if (dragCtx?.mergeItems) {\n      const mergeAtoms = Array.from(dragCtx.mergeItems.atoms.values())\n      const mergeBonds = Array.from(dragCtx.mergeItems.bonds.values())\n      const sgroupsOnCanvas = Array.from(sgroups.values()).map(\n        ({ item }) => item\n      )\n      isDraggingOnSaltOrSolventAtom = mergeAtoms.some((atomId) =>\n        SGroup.isAtomInSaltOrSolvent(atomId as number, sgroupsOnCanvas)\n      )\n      isDraggingOnSaltOrSolventBond = mergeBonds.some((bondId) =>\n        SGroup.isBondInSaltOrSolvent(bondId as number, sgroupsOnCanvas)\n      )\n    }\n    return isDraggingOnSaltOrSolventAtom || isDraggingOnSaltOrSolventBond\n  }\n}\n\nfunction extendCanvas(render, event) {\n  const offset = 1\n  const {\n    isCloseToLeftEdgeOfCanvas,\n    isCloseToTopEdgeOfCanvas,\n    isCloseToRightEdgeOfCanvas,\n    isCloseToBottomEdgeOfCanvas\n  } = isCloseToEdgeOfCanvas(event, render.sz)\n  const {\n    isCloseToLeftEdgeOfScreen,\n    isCloseToTopEdgeOfScreen,\n    isCloseToRightEdgeOfScreen,\n    isCloseToBottomEdgeOfScreen\n  } = isCloseToEdgeOfScreen(event)\n\n  if (isCloseToLeftEdgeOfCanvas) {\n    shiftAndExtendCanvasByVector(new Vec2(-offset, 0, 0), render)\n  }\n\n  if (isCloseToTopEdgeOfCanvas) {\n    shiftAndExtendCanvasByVector(new Vec2(0, -offset, 0), render)\n  }\n\n  if (isCloseToRightEdgeOfCanvas) {\n    shiftAndExtendCanvasByVector(new Vec2(offset, 0, 0), render)\n  }\n\n  if (isCloseToBottomEdgeOfCanvas) {\n    shiftAndExtendCanvasByVector(new Vec2(0, offset, 0), render)\n  }\n\n  const isCloseToSomeEdgeOfCanvas = [\n    isCloseToTopEdgeOfCanvas,\n    isCloseToRightEdgeOfCanvas,\n    isCloseToBottomEdgeOfCanvas,\n    isCloseToLeftEdgeOfCanvas\n  ].some((isCloseToEdge) => isCloseToEdge)\n\n  if (isCloseToSomeEdgeOfCanvas) {\n    return\n  }\n\n  if (isCloseToTopEdgeOfScreen) {\n    scrollByVector(new Vec2(0, -offset), render)\n  }\n\n  if (isCloseToBottomEdgeOfScreen) {\n    scrollByVector(new Vec2(0, offset), render)\n  }\n\n  if (isCloseToLeftEdgeOfScreen) {\n    scrollByVector(new Vec2(-offset, 0), render)\n  }\n\n  if (isCloseToRightEdgeOfScreen) {\n    scrollByVector(new Vec2(offset, 0), render)\n  }\n}\n\nfunction closestToSel(ci) {\n  const res = {}\n  res[ci.map] = [ci.id]\n  return res\n}\n\n// TODO: deep-merge?\nexport function selMerge(selection, add, reversible: boolean) {\n  if (add) {\n    Object.keys(add).forEach((item) => {\n      if (!selection[item]) selection[item] = add[item].slice()\n      else selection[item] = uniqArray(selection[item], add[item], reversible)\n    })\n  }\n  return selection\n}\n\nfunction isSelected(selection, item) {\n  return (\n    selection && selection[item.map] && selection[item.map].includes(item.id)\n  )\n}\n\nexport function getSelectedAtoms(selection, molecule) {\n  if (selection?.atoms) {\n    return mapAtomIdsToAtoms(selection?.atoms, molecule)\n  }\n  return []\n}\n\nexport function mapAtomIdsToAtoms(atomsIds: number[], molecule): Atom[] {\n  return atomsIds.map((atomId) => {\n    const atomOrReAtom = molecule.atoms.get(atomId)\n    return atomOrReAtom.a || atomOrReAtom\n  })\n}\n\nfunction uniqArray(dest, add, reversible: boolean) {\n  return add.reduce((_, item) => {\n    if (reversible) dest = xor(dest, [item])\n    else if (!dest.includes(item)) dest.push(item)\n    return dest\n  }, [])\n}\n\nfunction preventSaltAndSolventsMerge(\n  struct: ReStruct,\n  dragCtx,\n  editor: Editor\n) {\n  const action = dragCtx.action\n    ? fromItemsFuse(struct, null).mergeWith(dragCtx.action)\n    : fromItemsFuse(struct, null)\n  editor.hover(null)\n  if (dragCtx.mergeItems) {\n    editor.selection(null)\n  }\n  editor.update(action)\n  editor.event.message.dispatch({\n    info: false\n  })\n}\n\nfunction getMapsForClosestItem(selectFragment: boolean) {\n  return [\n    'sgroups',\n    'functionalGroups',\n    'sgroupData',\n    'rgroups',\n    'rxnArrows',\n    'rxnPluses',\n    'enhancedFlags',\n    'simpleObjects',\n    'texts',\n    ...(selectFragment ? ['frags'] : ['atoms', 'bonds'])\n  ]\n}\n\nfunction getResizingProps(\n  editor: Editor,\n  dragCtx,\n  event\n): [ReStruct, number, Vec2, Vec2, any] {\n  const current = editor.render.page2obj(event)\n  const diff = current.sub(dragCtx.xy0)\n  return [editor.render.ctab, dragCtx.item.id, diff, current, dragCtx.item.ref]\n}\n\nfunction getNewSelectedItems(\n  editor: Editor,\n  selectedSgroups: number[]\n): { atoms: number[]; bonds: number[] } {\n  const newSelected: Record<'atoms' | 'bonds', number[]> = {\n    atoms: [],\n    bonds: []\n  }\n\n  for (const sgId of selectedSgroups) {\n    const sgroup = editor.render.ctab.sgroups.get(sgId)\n    if (sgroup) {\n      const sgroupAtoms = SGroup.getAtoms(editor.struct(), sgroup.item)\n      const sgroupBonds = SGroup.getBonds(editor.struct(), sgroup.item)\n      newSelected.atoms.push(...sgroupAtoms)\n      newSelected.bonds.push(...sgroupBonds)\n    }\n  }\n\n  return newSelected\n}\n\nexport default SelectTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  fromArrowDeletion,\n  fromFragmentDeletion,\n  fromOneAtomDeletion,\n  fromOneBondDeletion,\n  fromPlusDeletion,\n  fromSgroupDeletion,\n  fromSimpleObjectDeletion,\n  fromTextDeletion,\n  FunctionalGroup,\n  SGroup\n} from 'ketcher-core'\n\nimport LassoHelper from './helper/lasso'\nimport { selMerge } from './select'\nimport Editor from '../Editor'\n\nclass EraserTool {\n  editor: Editor\n  maps: Array<string>\n  lassoHelper: LassoHelper\n  isNotActiveTool: boolean | undefined\n\n  constructor(editor, mode) {\n    this.editor = editor\n    this.maps = [\n      'atoms',\n      'bonds',\n      'rxnArrows',\n      'rxnPluses',\n      'sgroups',\n      'functionalGroups',\n      'sgroupData',\n      'simpleObjects',\n      'texts'\n    ]\n    this.lassoHelper = new LassoHelper(mode || 0, editor, null)\n\n    if (editor.selection()) {\n      const action = fromFragmentDeletion(\n        editor.render.ctab,\n        editor.selection()\n      )\n      editor.update(action)\n      editor.selection(null)\n      this.isNotActiveTool = true\n    }\n  }\n\n  mousedown(event) {\n    const ci = this.editor.findItem(event, this.maps)\n\n    if (!ci) {\n      //  ci.type == 'Canvas'\n      this.lassoHelper.begin(event)\n    }\n  }\n\n  mousemove(event) {\n    if (this.lassoHelper.running()) {\n      this.editor.selection(this.lassoHelper.addPoint(event))\n    } else {\n      this.editor.hover(this.editor.findItem(event, this.maps), null, event)\n    }\n  }\n\n  mouseup() {\n    const struct = this.editor.render.ctab\n    const sgroups = struct.sgroups\n    const molecule = struct.molecule\n    const functionalGroups = molecule.functionalGroups\n    const selected = this.editor.selection()\n    const newSelected: Record<string, any> = { atoms: [], bonds: [] }\n    let actualSgroupId\n    const atomsResult: Array<number> = []\n    const bondsResult: Array<number> = []\n    const preResult: Array<number> = []\n\n    if (selected && functionalGroups.size && selected.atoms) {\n      for (const atom of selected.atoms) {\n        const atomId = FunctionalGroup.atomsInFunctionalGroup(\n          functionalGroups,\n          atom\n        )\n        const atomFromStruct = atomId !== null && struct.atoms.get(atomId)?.a\n\n        if (atomFromStruct) {\n          for (const sgId of atomFromStruct.sgs.values()) {\n            actualSgroupId = sgId\n          }\n        }\n\n        if (\n          atomFromStruct &&\n          FunctionalGroup.isAtomInContractedFunctionalGroup(\n            atomFromStruct,\n            sgroups,\n            functionalGroups,\n            true\n          )\n        ) {\n          const sgroupAtoms =\n            actualSgroupId !== undefined &&\n            SGroup.getAtoms(molecule, struct.sgroups.get(actualSgroupId)?.item)\n          const sgroupBonds =\n            actualSgroupId !== undefined &&\n            SGroup.getBonds(molecule, struct.sgroups.get(actualSgroupId)?.item)\n          atom === sgroupAtoms[0] &&\n            newSelected.atoms.push(...(sgroupAtoms as Array<any>)) &&\n            newSelected.bonds.push(...(sgroupBonds as Array<any>))\n        }\n\n        if (\n          atomFromStruct &&\n          !FunctionalGroup.isAtomInContractedFunctionalGroup(\n            atomFromStruct,\n            sgroups,\n            functionalGroups,\n            true\n          )\n        ) {\n          atomsResult.push(atomId)\n        }\n      }\n    }\n\n    if (selected && functionalGroups.size && selected.bonds) {\n      for (const bond of selected.bonds) {\n        const bondId = FunctionalGroup.bondsInFunctionalGroup(\n          molecule,\n          functionalGroups,\n          bond\n        )\n        const bondFromStruct = bondId !== null && struct.bonds.get(bondId)?.b\n\n        if (\n          bondFromStruct &&\n          !FunctionalGroup.isBondInContractedFunctionalGroup(\n            bondFromStruct,\n            sgroups,\n            functionalGroups\n          )\n        ) {\n          bondsResult.push(bondId)\n        }\n      }\n    }\n\n    if (atomsResult.length > 0) {\n      for (const id of atomsResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByAtom(\n          functionalGroups,\n          id\n        )\n        fgId !== null && !preResult.includes(fgId) && preResult.push(fgId)\n      }\n    }\n\n    if (bondsResult.length > 0) {\n      for (const id of bondsResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByBond(\n          molecule,\n          functionalGroups,\n          id\n        )\n        fgId !== null && !preResult.includes(fgId) && preResult.push(fgId)\n      }\n    }\n\n    if (preResult.length > 0) {\n      const result: Array<number> = []\n      preResult.forEach((fgId) => {\n        const sgAtoms = sgroups.get(fgId)?.item.atoms\n        sgAtoms.forEach((atom) => {\n          !atomsResult.includes(atom) &&\n            !result.includes(fgId) &&\n            result.push(fgId)\n        })\n      })\n\n      if (result.length > 0) {\n        this.editor.selection(null)\n        this.editor.event.removeFG.dispatch({ fgIds: result })\n        this.lassoHelper.cancel()\n      }\n    }\n\n    // eslint-disable-line max-statements\n    const rnd = this.editor.render\n\n    if (this.lassoHelper.running()) {\n      // TODO it catches more events than needed, to be re-factored\n      const sel =\n        newSelected.atoms.length > 0\n          ? selMerge(this.lassoHelper.end(), newSelected, false)\n          : this.lassoHelper.end()\n      this.editor.update(fromFragmentDeletion(rnd.ctab, sel))\n      this.editor.selection(null)\n    }\n  }\n\n  click(event) {\n    const rnd = this.editor.render\n    const restruct = rnd.ctab\n    const sgroups = restruct.sgroups\n    const molecule = restruct.molecule\n    const functionalGroups = molecule.functionalGroups\n    const ci = this.editor.findItem(event, this.maps)\n    const atomResult: Array<number> = []\n    const bondResult: Array<number> = []\n    const result: Array<number> = []\n\n    if (\n      ci &&\n      functionalGroups &&\n      ci.map === 'functionalGroups' &&\n      !FunctionalGroup.isContractedFunctionalGroup(ci.id, functionalGroups)\n    ) {\n      const sGroup = sgroups.get(ci.id)\n\n      if (FunctionalGroup.isFunctionalGroup(sGroup?.item)) {\n        result.push(ci.id)\n      }\n    } else if (ci && functionalGroups && ci.map === 'atoms') {\n      const atomId = FunctionalGroup.atomsInFunctionalGroup(\n        functionalGroups,\n        ci.id\n      )\n      const atomFromStruct = atomId !== null && restruct.atoms.get(atomId)?.a\n\n      if (\n        atomFromStruct &&\n        !FunctionalGroup.isAtomInContractedFunctionalGroup(\n          atomFromStruct,\n          sgroups,\n          functionalGroups,\n          true\n        )\n      ) {\n        atomResult.push(atomId)\n      }\n    } else if (ci && functionalGroups && ci.map === 'bonds') {\n      const bondId = FunctionalGroup.bondsInFunctionalGroup(\n        molecule,\n        functionalGroups,\n        ci.id\n      )\n      const bondFromStruct = bondId !== null && restruct.bonds.get(bondId)?.b\n\n      if (\n        bondFromStruct &&\n        !FunctionalGroup.isBondInContractedFunctionalGroup(\n          bondFromStruct,\n          sgroups,\n          functionalGroups\n        )\n      ) {\n        bondResult.push(bondId)\n      }\n    }\n\n    if (atomResult.length) {\n      for (const id of atomResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByAtom(\n          functionalGroups,\n          id\n        )\n\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n    } else if (bondResult.length) {\n      for (const id of bondResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByBond(\n          molecule,\n          functionalGroups,\n          id\n        )\n\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n    }\n\n    if (result.length) {\n      this.editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    }\n\n    if (!ci) return // ci.type == 'Canvas'\n\n    this.editor.hover(null)\n\n    if (ci.map === 'atoms') {\n      this.editor.update(fromOneAtomDeletion(restruct, ci.id))\n    } else if (ci.map === 'bonds') {\n      this.editor.update(fromOneBondDeletion(restruct, ci.id))\n    } else if (\n      ci.map === 'functionalGroups' &&\n      FunctionalGroup.isContractedFunctionalGroup(ci.id, functionalGroups)\n    ) {\n      const sGroup = sgroups.get(ci.id)\n      this.editor.update(\n        fromFragmentDeletion(rnd.ctab, {\n          atoms: [...SGroup.getAtoms(molecule, sGroup?.item)],\n          bonds: [...SGroup.getBonds(molecule, sGroup?.item)]\n        })\n      )\n    } else if (ci.map === 'sgroups' || ci.map === 'sgroupData') {\n      const sGroup = sgroups.get(ci.id)\n\n      if (FunctionalGroup.isFunctionalGroup(sGroup?.item)) {\n        this.editor.event.removeFG.dispatch({ fgIds: [ci.id] })\n      } else {\n        this.editor.update(fromSgroupDeletion(restruct, ci.id))\n      }\n    } else if (ci.map === 'rxnArrows') {\n      this.editor.update(fromArrowDeletion(restruct, ci.id))\n    } else if (ci.map === 'rxnPluses') {\n      this.editor.update(fromPlusDeletion(restruct, ci.id))\n    } else if (ci.map === 'simpleObjects') {\n      this.editor.update(fromSimpleObjectDeletion(restruct, ci.id))\n    } else if (ci.map === 'texts') {\n      this.editor.update(fromTextDeletion(restruct, ci.id))\n    } else {\n      // TODO re-factoring needed - should be \"map-independent\"\n      console.error(\n        'EraserTool: unable to delete the object ' + ci.map + '[' + ci.id + ']'\n      )\n      return\n    }\n    this.editor.selection(null)\n  }\n\n  mouseleave() {\n    this.mouseup()\n  }\n\n  cancel() {\n    if (this.lassoHelper.running()) {\n      this.lassoHelper.end()\n    }\n\n    this.editor.selection(null)\n  }\n}\n\nexport default EraserTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport Editor from '../Editor'\nimport { Vec2 } from 'ketcher-core'\n\nclass HandTool {\n  editor: Editor\n  begPos: Vec2 | null = null\n  endPos: Vec2 | null = null\n\n  constructor(editor) {\n    this.editor = editor\n    const { clientX, clientY } = this.editor.lastEvent || {\n      clientX: 0,\n      clientY: 0\n    }\n    this.editor.event.cursor.dispatch({\n      status: 'enable',\n      cursorPosition: { clientX, clientY }\n    })\n  }\n\n  mousedown(event) {\n    const { clientX, clientY } = event\n    this.begPos = new Vec2(clientX, clientY)\n  }\n\n  mousemove(event) {\n    this.editor.event.cursor.dispatch({ status: 'move' })\n    this.editor.hover(\n      this.editor.findItem(event, ['atoms', 'bonds'], null),\n      null,\n      event\n    )\n\n    if (this.begPos == null) {\n      return\n    }\n    const { clientX, clientY } = event\n    this.endPos = new Vec2(clientX, clientY)\n\n    const rnd = this.editor.render\n    const diff = Vec2.diff(this.endPos, this.begPos).scaled(\n      1 / this.editor.zoom()\n    )\n    this.begPos = this.endPos\n\n    rnd.ctab.translate(diff)\n    rnd.options.offset = rnd.options.offset.add(diff)\n    rnd.update(false)\n  }\n\n  mouseup(event) {\n    if (this.begPos === null) return\n    const rnd = this.editor.render\n    this.endPos = rnd.page2obj(event)\n    this.begPos = null\n    this.endPos = null\n    rnd.update(false)\n  }\n\n  mouseover() {\n    this.editor.event.cursor.dispatch({ status: 'mouseover' })\n  }\n\n  mouseLeaveClientArea() {\n    this.begPos = null\n    this.endPos = null\n    this.editor.event.cursor.dispatch({ status: 'leave' })\n  }\n\n  cancel() {\n    this.editor.event.cursor.dispatch({ status: 'disable' })\n  }\n}\n\nexport default HandTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  fromItemsFuse,\n  fromPaste,\n  fromTemplateOnAtom,\n  getHoverToFuse,\n  getItemsToFuse,\n  SGroup,\n  Struct,\n  Vec2\n} from 'ketcher-core'\nimport Editor from '../Editor'\nimport { dropAndMerge } from './helper/dropAndMerge'\nimport { getGroupIdsFromItemArrays } from './helper/getGroupIdsFromItems'\nimport { getMergeItems } from './helper/getMergeItems'\nimport utils from '../shared/utils'\n\nclass PasteTool {\n  editor: Editor\n  struct: Struct\n  action: any\n  templateAction: any\n  dragCtx: any\n  findItems: string[]\n  mergeItems: any\n  isSingleContractedGroup: boolean\n\n  constructor(editor, struct) {\n    this.editor = editor\n    this.editor.selection(null)\n    this.struct = struct\n\n    this.isSingleContractedGroup =\n      struct.isSingleGroup() && !struct.functionalGroups.get(0)?.isExpanded\n\n    const rnd = this.editor.render\n    const { clientHeight, clientWidth } = rnd.clientArea\n    const point = this.editor.lastEvent\n      ? rnd.page2obj(this.editor.lastEvent)\n      : rnd.page2obj({\n          pageX: clientWidth / 2,\n          pageY: clientHeight / 2\n        } as MouseEvent)\n\n    const [action, pasteItems] = fromPaste(rnd.ctab, this.struct, point)\n    this.action = action\n    this.editor.update(this.action, true)\n\n    this.findItems = ['functionalGroups']\n    this.mergeItems = getItemsToFuse(this.editor, pasteItems)\n    this.editor.hover(getHoverToFuse(this.mergeItems), this)\n  }\n\n  mousedown(event) {\n    if (\n      !this.isSingleContractedGroup ||\n      SGroup.isSaltOrSolvent(this.struct.sgroups.get(0)?.data.name)\n    ) {\n      return\n    }\n\n    if (this.action) {\n      // remove pasted group from canvas to find closest group correctly\n      this.action?.perform(this.editor.render.ctab)\n    }\n\n    const closestGroupItem = this.editor.findItem(event, ['functionalGroups'])\n    const closestGroup = this.editor.struct().sgroups.get(closestGroupItem?.id)\n\n    // not dropping on a group (tmp, should be removed when dealing with other entities)\n    if (!closestGroupItem || SGroup.isSaltOrSolvent(closestGroup?.data.name)) {\n      // recreate action and continue as usual\n      const [action] = fromPaste(\n        this.editor.render.ctab,\n        this.struct,\n        this.editor.render.page2obj(event)\n      )\n      this.action = action\n      return\n    }\n\n    // remove action to prevent error when trying to \"perform\" it again in mousemove\n    this.action = null\n\n    this.dragCtx = {\n      xy0: this.editor.render.page2obj(event),\n      item: closestGroupItem\n    }\n  }\n\n  mousemove(event) {\n    if (this.action) {\n      this.action?.perform(this.editor.render.ctab)\n    }\n\n    if (this.dragCtx) {\n      // template-like logic for group-on-group actions\n      let pos0: Vec2 | null | undefined = null\n      const pos1 = this.editor.render.page2obj(event)\n\n      const extraBond = true\n\n      const targetGroup = this.editor.struct().sgroups.get(this.dragCtx.item.id)\n      const atomId = targetGroup?.getAttAtomId(this.editor.struct())\n\n      if (atomId !== undefined) {\n        const atom = this.editor.struct().atoms.get(atomId)\n        pos0 = atom?.pp\n      }\n\n      // calc angle\n      let angle = utils.calcAngle(pos0, pos1)\n\n      if (!event.ctrlKey) {\n        angle = utils.fracAngle(angle, null)\n      }\n\n      const degrees = utils.degrees(angle)\n\n      // check if anything changed since last time\n      if (\n        this.dragCtx.hasOwnProperty('angle') &&\n        this.dragCtx.angle === degrees\n      )\n        return\n\n      if (this.dragCtx.action) {\n        this.dragCtx.action.perform(this.editor.render.ctab)\n      }\n\n      this.dragCtx.angle = degrees\n\n      const [action] = fromTemplateOnAtom(\n        this.editor.render.ctab,\n        prepareTemplateFromSingleGroup(this.struct),\n        atomId,\n        angle,\n        extraBond\n      )\n\n      this.dragCtx.action = action\n      this.editor.update(this.dragCtx.action, true)\n    } else {\n      // common paste logic\n      const [action, pasteItems] = fromPaste(\n        this.editor.render.ctab,\n        this.struct,\n        this.editor.render.page2obj(event)\n      )\n      this.action = action\n      this.editor.update(this.action, true)\n\n      this.mergeItems = getMergeItems(this.editor, pasteItems)\n      this.editor.hover(getHoverToFuse(this.mergeItems))\n    }\n  }\n\n  mouseup() {\n    const idsOfItemsMerged = this.mergeItems && {\n      ...(this.mergeItems.atoms && {\n        atoms: Array.from(this.mergeItems.atoms.values())\n      }),\n      ...(this.mergeItems.bonds && {\n        bonds: Array.from(this.mergeItems.bonds.values())\n      })\n    }\n\n    const groupsIdsInvolvedInMerge = getGroupIdsFromItemArrays(\n      this.editor.struct(),\n      idsOfItemsMerged\n    )\n\n    if (groupsIdsInvolvedInMerge.length) {\n      this.editor.event.removeFG.dispatch({ fgIds: groupsIdsInvolvedInMerge })\n      return\n    }\n\n    if (this.dragCtx) {\n      const dragCtx = this.dragCtx\n      delete this.dragCtx\n\n      dragCtx.action = dragCtx.action\n        ? fromItemsFuse(this.editor.render.ctab, dragCtx.mergeItems).mergeWith(\n            dragCtx.action\n          )\n        : fromItemsFuse(this.editor.render.ctab, dragCtx.mergeItems)\n\n      this.editor.hover(null)\n      this.editor.update(dragCtx.action)\n      this.editor.event.message.dispatch({ info: false })\n    } else {\n      // need to delete action first, because editor.update calls this.cancel() and thus action revert 🤦‍♂️\n      const action = this.action\n      delete this.action\n      dropAndMerge(this.editor, this.mergeItems, action)\n    }\n  }\n\n  cancel() {\n    const rnd = this.editor.render\n    this.editor.hover(null)\n\n    if (this.action) {\n      this.action.perform(rnd.ctab) // revert the action\n      delete this.action\n      rnd.update()\n    }\n  }\n\n  mouseleave() {\n    this.cancel()\n  }\n}\n\ntype Template = {\n  aid?: number\n  molecule?: Struct\n  xy0?: Vec2\n  angle0?: number\n}\n\n/** Adds position and angle info to the molecule, similar to Template tool native behavior */\nfunction prepareTemplateFromSingleGroup(molecule: Struct): Template | null {\n  const template: Template = {}\n  const sgroup = molecule.sgroups.get(0)\n  const xy0 = new Vec2()\n\n  molecule.atoms.forEach((atom) => {\n    xy0.add_(atom.pp) // eslint-disable-line no-underscore-dangle\n  })\n\n  template.aid = sgroup?.getAttAtomId(molecule) || 0\n  template.molecule = molecule\n  template.xy0 = xy0.scaled(1 / (molecule.atoms.size || 1)) // template center\n\n  const atom = molecule.atoms.get(template.aid)\n  if (atom) {\n    template.angle0 = utils.calcAngle(atom.pp, template.xy0) // center tilt\n  }\n\n  return template\n}\n\nexport default PasteTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  Atom,\n  fromAtomAddition,\n  fromAtomsAttrs,\n  FunctionalGroup\n} from 'ketcher-core'\nimport Editor from '../Editor'\n\nclass RGroupAtomTool {\n  editor: Editor\n\n  constructor(editor) {\n    // TODO: map atoms with labels\n    editor.selection(null)\n    this.editor = editor\n  }\n\n  mousemove(event) {\n    const struct = this.editor.render.ctab.molecule\n    const ci = this.editor.findItem(event, ['atoms'])\n\n    if (ci) {\n      const atom = struct.atoms.get(ci.id)\n      if (atom?.attpnt === null) this.editor.hover(ci, null, event)\n    } else {\n      this.editor.hover(null)\n    }\n  }\n\n  click(event) {\n    const struct = this.editor.render.ctab\n    const molecule = struct.molecule\n    const functionalGroups = molecule.functionalGroups\n    const rnd = this.editor.render\n    const ci = this.editor.findItem(event, ['atoms'])\n    const atomResult: Array<number> = []\n    const result: Array<number> = []\n\n    if (ci && functionalGroups && ci.map === 'atoms') {\n      const atomId = FunctionalGroup.atomsInFunctionalGroup(\n        functionalGroups,\n        ci.id\n      )\n\n      if (atomId !== null) {\n        atomResult.push(atomId)\n      }\n    }\n\n    if (atomResult.length > 0) {\n      for (const id of atomResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByAtom(\n          functionalGroups,\n          id\n        )\n\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n      this.editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    }\n\n    if (!ci) {\n      //  ci.type == 'Canvas'\n      this.editor.hover(null)\n      propsDialog(this.editor, null, rnd.page2obj(event))\n      return true\n    } else if (ci.map === 'atoms') {\n      const struct = this.editor.render.ctab.molecule\n      const atom = struct.atoms.get(ci.id)\n      this.editor.hover(this.editor.findItem(event, ['atoms']), null, event)\n\n      if (atom?.attpnt !== null) return\n\n      propsDialog(this.editor, ci.id, null)\n      return true\n    }\n    return true\n  }\n}\n\nfunction propsDialog(editor, id, pos) {\n  const struct = editor.render.ctab.molecule\n  const atom = id || id === 0 ? struct.atoms.get(id) : null\n  const rglabel = atom ? atom.rglabel : 0\n  const label = atom ? atom.label : 'R#'\n\n  const res = editor.event.elementEdit.dispatch({\n    label: 'R#',\n    rglabel,\n    fragId: atom ? atom.fragment : null\n  })\n\n  Promise.resolve(res)\n    .then((elem) => {\n      // TODO review: using Atom.attrlist as a source of default property values\n      elem = Object.assign({}, Atom.attrlist, elem)\n\n      if (!id && id !== 0 && elem.rglabel) {\n        editor.update(fromAtomAddition(editor.render.ctab, pos, elem))\n      } else if (rglabel !== elem.rglabel) {\n        elem.aam = atom.aam // WTF??\n        elem.attpnt = atom.attpnt\n\n        if (!elem.rglabel && label !== 'R#') {\n          elem.label = label\n        }\n\n        editor.update(fromAtomsAttrs(editor.render.ctab, id, elem, false))\n      }\n    })\n    .catch(() => null) // w/o changes\n}\n\nexport default RGroupAtomTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  RGroup,\n  fromRGroupAttrs,\n  fromRGroupFragment,\n  fromUpdateIfThen,\n  FunctionalGroup\n} from 'ketcher-core'\nimport Editor from '../Editor'\n\nclass RGroupFragmentTool {\n  editor: Editor\n\n  constructor(editor) {\n    // TODO: check if it's a fragments already\n    editor.selection(null)\n    this.editor = editor\n  }\n\n  mousemove(event) {\n    this.editor.hover(\n      this.editor.findItem(event, ['frags', 'rgroups']),\n      null,\n      event\n    )\n  }\n\n  click(event) {\n    const struct = this.editor.render.ctab\n    const molecule = struct.molecule\n    const functionalGroups = molecule.functionalGroups\n    const editor = this.editor\n    const ci = editor.findItem(event, ['frags', 'rgroups'])\n    const ce = editor.findItem(event, ['atoms', 'bonds'])\n    const atomResult: Array<number> = []\n    const bondResult: Array<number> = []\n    const result: Array<number> = []\n\n    if (ce && functionalGroups && ce.map === 'atoms') {\n      const atomId = FunctionalGroup.atomsInFunctionalGroup(\n        functionalGroups,\n        ce.id\n      )\n\n      if (atomId !== null) {\n        atomResult.push(atomId)\n      }\n    }\n\n    if (ce && functionalGroups && ce.map === 'bonds') {\n      const bondId = FunctionalGroup.bondsInFunctionalGroup(\n        molecule,\n        functionalGroups,\n        ce.id\n      )\n\n      if (bondId !== null) {\n        bondResult.push(bondId)\n      }\n    }\n\n    if (atomResult.length > 0) {\n      for (const id of atomResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByAtom(\n          functionalGroups,\n          id\n        )\n\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n      this.editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    } else if (bondResult.length > 0) {\n      for (const id of bondResult) {\n        const fgId = FunctionalGroup.findFunctionalGroupByBond(\n          molecule,\n          functionalGroups,\n          id\n        )\n\n        if (fgId !== null && !result.includes(fgId)) {\n          result.push(fgId)\n        }\n      }\n      this.editor.event.removeFG.dispatch({ fgIds: result })\n      return\n    }\n\n    if (!ci) {\n      return true\n    }\n\n    this.editor.hover(null)\n\n    const label =\n      ci.map === 'rgroups'\n        ? ci.id\n        : RGroup.findRGroupByFragment(molecule.rgroups, ci.id)\n\n    const rg = Object.assign(\n      { label },\n      ci.map === 'frags' ? { fragId: ci.id } : molecule.rgroups.get(ci.id)\n    )\n\n    const res = editor.event.rgroupEdit.dispatch(rg)\n\n    Promise.resolve(res)\n      .then((newRg) => {\n        let action\n\n        if (ci.map !== 'rgroups') {\n          const rgidOld = RGroup.findRGroupByFragment(\n            struct.molecule.rgroups,\n            ci.id\n          )\n          action = fromRGroupFragment(struct, newRg.label, ci.id).mergeWith(\n            fromUpdateIfThen(struct, newRg.label, rgidOld)\n          )\n        } else {\n          action = fromRGroupAttrs(struct, ci.id, newRg)\n        }\n\n        editor.update(action)\n      })\n      .catch(() => null) // w/o changes\n\n    return true\n  }\n\n  cancel() {\n    this.editor.hover(null)\n  }\n}\n\nexport default RGroupFragmentTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  fromArrowAddition,\n  fromArrowDeletion,\n  fromArrowResizing,\n  fromMultipleMove,\n  Vec2\n} from 'ketcher-core'\nimport Editor from '../Editor'\n\nclass ReactionArrowTool {\n  mode: any\n  editor: Editor\n  dragCtx: any\n\n  constructor(editor, mode) {\n    this.mode = mode\n    this.editor = editor\n    this.editor.selection(null)\n  }\n\n  mousedown(event) {\n    const rnd = this.editor.render\n    const p0 = rnd.page2obj(event)\n    this.dragCtx = { p0 }\n\n    const ci = this.editor.findItem(event, ['rxnArrows'])\n\n    if (ci && ci.map === 'rxnArrows') {\n      this.editor.hover(null)\n      this.editor.selection({ rxnArrows: [ci.id] })\n      this.dragCtx.ci = ci\n    } else {\n      this.dragCtx.isNew = true\n      this.editor.selection(null)\n    }\n  }\n\n  mousemove(event) {\n    const rnd = this.editor.render\n\n    if (this.dragCtx) {\n      const current = rnd.page2obj(event)\n      const diff = current.sub(this.dragCtx.p0)\n      this.dragCtx.previous = current\n\n      if (this.dragCtx.ci) {\n        if (this.dragCtx.action) {\n          this.dragCtx.action.perform(rnd.ctab)\n        }\n\n        if (!this.dragCtx.ci.ref) {\n          this.dragCtx.action = fromMultipleMove(\n            rnd.ctab,\n            this.editor.selection() || {},\n            diff\n          )\n        } else {\n          this.dragCtx.action = fromArrowResizing(\n            rnd.ctab,\n            this.dragCtx.ci.id,\n            diff,\n            current,\n            this.dragCtx.ci.ref\n          )\n        }\n        this.editor.update(this.dragCtx.action, true)\n      } else {\n        if (!this.dragCtx.action) {\n          const action = fromArrowAddition(\n            rnd.ctab,\n            [this.dragCtx.p0, this.dragCtx.p0],\n            this.mode\n          )\n          // TODO: need to rework  actions/operations logic\n          const addOperation = action.operations[0]\n          this.dragCtx.itemId = addOperation.data.id\n          this.dragCtx.action = action\n          this.editor.update(this.dragCtx.action, true)\n        } else {\n          this.dragCtx.action.perform(rnd.ctab)\n        }\n\n        this.dragCtx.action = fromArrowResizing(\n          rnd.ctab,\n          this.dragCtx.itemId,\n          diff,\n          current,\n          null\n        )\n        this.editor.update(this.dragCtx.action, true)\n      }\n    } else {\n      const items = this.editor.findItem(event, ['rxnArrows'])\n      this.editor.hover(items, null, event)\n    }\n  }\n\n  mouseup() {\n    if (!this.dragCtx) {\n      return true\n    }\n\n    const rnd = this.editor.render\n\n    const p0 = this.dragCtx.p0\n    const p1 = getDefaultLengthPos(p0, this.dragCtx.previous)\n\n    if (this.dragCtx.action) {\n      if (this.dragCtx.isNew) {\n        this.editor.update(\n          fromArrowDeletion(rnd.ctab, this.dragCtx.itemId),\n          true\n        )\n        this.dragCtx.action = fromArrowAddition(rnd.ctab, [p0, p1], this.mode)\n      }\n\n      this.editor.update(this.dragCtx.action)\n    }\n    delete this.dragCtx\n    return true\n  }\n\n  click(event) {\n    const rnd = this.editor.render\n    const ci = this.editor.findItem(event, ['rxnArrows'])\n    const p0 = rnd.page2obj(event)\n\n    if (!ci) {\n      const pos = [p0, getDefaultLengthPos(p0, null)]\n      this.editor.update(fromArrowAddition(rnd.ctab, pos, this.mode))\n    }\n  }\n}\n\nfunction getArrowParams(x1, y1, x2, y2) {\n  const length = Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2)\n  const angle = calcAngle(x2, y2, x1, y1)\n  return { length, angle }\n}\n\nfunction getDefaultLengthPos(pos1, pos2) {\n  const minLength = 1.5\n  const defaultLength = 2\n  if (!pos2) {\n    return new Vec2(pos1.x + defaultLength, pos1.y)\n  }\n  const arrowParams = getArrowParams(pos1.x, pos1.y, pos2.x, pos2.y)\n  if (arrowParams.length <= minLength) {\n    const newPos = new Vec2()\n    newPos.x =\n      pos1.x + defaultLength * Math.cos((Math.PI * arrowParams.angle) / 180)\n    newPos.y =\n      pos1.y + defaultLength * Math.sin((Math.PI * arrowParams.angle) / 180)\n    return newPos\n  }\n  return pos2\n}\n\nfunction calcAngle(x1, y1, x2, y2) {\n  const x = x1 - x2\n  const y = y1 - y2\n  if (!x && !y) {\n    return 0\n  }\n  return (180 + (Math.atan2(-y, -x) * 180) / Math.PI + 360) % 360\n}\n\nexport default ReactionArrowTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Action, Scale, fromAtomsAttrs } from 'ketcher-core'\nimport Editor from '../Editor'\n\nclass ReactionMapTool {\n  editor: Editor\n  rcs: any\n  dragCtx: any\n  line: any\n\n  constructor(editor) {\n    this.editor = editor\n    this.editor.selection(null)\n  }\n\n  mousedown(event) {\n    const rnd = this.editor.render\n    this.rcs = rnd.ctab.molecule.getComponents()\n\n    const closestItem = this.editor.findItem(event, ['atoms'])\n\n    if (closestItem?.map === 'atoms') {\n      this.editor.hover(null)\n      this.dragCtx = {\n        item: closestItem,\n        xy0: rnd.page2obj(event)\n      }\n    }\n  }\n\n  mousemove(event) {\n    const editor = this.editor\n    const rnd = editor.render\n\n    if ('dragCtx' in this) {\n      const closestItem = this.editor.findItem(\n        event,\n        ['atoms'],\n        this.dragCtx.item\n      )\n      const atoms = rnd.ctab.molecule.atoms\n\n      if (closestItem?.map === 'atoms') {\n        editor.hover(closestItem)\n        this.updateLine(\n          atoms.get(this.dragCtx.item.id)?.pp,\n          atoms.get(closestItem.id)?.pp\n        )\n      } else {\n        editor.hover(null)\n        this.updateLine(\n          atoms.get(this.dragCtx.item.id)?.pp,\n          rnd.page2obj(event)\n        )\n      }\n    } else {\n      editor.hover(editor.findItem(event, ['atoms']), null, event)\n    }\n  }\n\n  updateLine(p1, p2) {\n    if (this.line) {\n      this.line.remove()\n      this.line = null\n    }\n\n    if (p1 && p2) {\n      const rnd = this.editor.render\n      this.line = rnd.selectionLine(\n        Scale.obj2scaled(p1, rnd.options).add(rnd.options.offset),\n        Scale.obj2scaled(p2, rnd.options).add(rnd.options.offset)\n      )\n    }\n  }\n\n  mouseup(event) {\n    if ('dragCtx' in this) {\n      const rnd = this.editor.render\n      const closestItem = this.editor.findItem(event, ['atoms'])\n\n      if (closestItem?.map === 'atoms') {\n        const action = new Action()\n        const atoms = rnd.ctab.molecule.atoms\n        const atom1 = atoms.get(this.dragCtx.item.id)\n        const atom2 = atoms.get(closestItem.id)\n        const aam1 = atom1?.aam\n        const aam2 = atom2?.aam\n\n        if (!aam1 || aam1 !== aam2) {\n          if ((aam1 && aam1 !== aam2) || (!aam1 && aam2)) {\n            // eslint-disable-line no-mixed-operators\n            atoms.forEach((atom, aid) => {\n              if (\n                aid !== this.dragCtx.item.id &&\n                ((aam1 && atom.aam === aam1) || (aam2 && atom.aam === aam2))\n              )\n                action.mergeWith(\n                  fromAtomsAttrs(rnd.ctab, aid, { aam: 0 }, null)\n                )\n            })\n          }\n\n          if (aam1) {\n            action.mergeWith(\n              fromAtomsAttrs(rnd.ctab, closestItem.id, { aam: aam1 }, null)\n            )\n          } else {\n            let aam = 0\n            atoms.forEach((atom) => {\n              aam = Math.max(aam, atom.aam || 0)\n            })\n            action.mergeWith(\n              fromAtomsAttrs(\n                rnd.ctab,\n                this.dragCtx.item.id,\n                { aam: aam + 1 },\n                null\n              )\n            )\n            action.mergeWith(\n              fromAtomsAttrs(rnd.ctab, closestItem.id, { aam: aam + 1 }, null)\n            )\n          }\n          this.editor.update(action)\n        }\n      }\n      this.updateLine(null, null)\n      delete this.dragCtx\n    }\n    this.editor.hover(this.editor.findItem(event, ['atoms']), null, event)\n  }\n}\n\nexport default ReactionMapTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { fromMultipleMove, fromPlusAddition } from 'ketcher-core'\nimport Editor from '../Editor'\n\nclass ReactionPlusTool {\n  editor: Editor\n  dragCtx: any\n\n  constructor(editor) {\n    this.editor = editor\n    this.editor.selection(null)\n  }\n\n  mousedown(event) {\n    const rnd = this.editor.render\n    const ci = this.editor.findItem(event, ['rxnPluses'])\n\n    if (ci && ci.map === 'rxnPluses') {\n      this.editor.hover(null)\n      this.editor.selection({ rxnPluses: [ci.id] })\n      this.dragCtx = { xy0: rnd.page2obj(event) }\n    }\n  }\n\n  mousemove(event) {\n    const editor = this.editor\n    const rnd = editor.render\n\n    if ('dragCtx' in this) {\n      if (this.dragCtx.action) {\n        this.dragCtx.action.perform(rnd.ctab)\n      }\n\n      this.dragCtx.action = fromMultipleMove(\n        rnd.ctab,\n        this.editor.selection() || {},\n        rnd.page2obj(event).sub(this.dragCtx.xy0)\n      )\n      editor.update(this.dragCtx.action, true)\n    } else {\n      editor.hover(editor.findItem(event, ['rxnPluses']), null, event)\n    }\n  }\n\n  mouseup() {\n    if (!this.dragCtx) {\n      return true\n    }\n\n    if (this.dragCtx.action) {\n      this.editor.update(this.dragCtx.action) // TODO investigate, subsequent undo/redo fails\n    }\n\n    delete this.dragCtx\n    return true\n  }\n\n  click(event) {\n    const rnd = this.editor.render\n    const ci = this.editor.findItem(event, ['rxnPluses'])\n\n    if (!ci) {\n      this.editor.update(fromPlusAddition(rnd.ctab, rnd.page2obj(event)))\n    }\n  }\n}\n\nexport default ReactionPlusTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Action, fromAtomsAttrs } from 'ketcher-core'\nimport Editor from '../Editor'\n\nclass ReactionUnmapTool {\n  editor: Editor\n\n  constructor(editor) {\n    this.editor = editor\n    this.editor.selection(null)\n  }\n\n  mousemove(event) {\n    const ci = this.editor.findItem(event, ['atoms'])\n\n    if (ci && ci.map === 'atoms') {\n      this.editor.hover(\n        this.editor.render.ctab.molecule.atoms.get(ci.id)?.aam ? ci : null,\n        null,\n        event\n      )\n    } else {\n      this.editor.hover(null)\n    }\n  }\n\n  mouseup(event) {\n    const ci = this.editor.findItem(event, ['atoms'])\n    const atoms = this.editor.render.ctab.molecule.atoms\n\n    if (ci && ci.map === 'atoms' && atoms.get(ci.id)?.aam) {\n      const action = new Action()\n      const aam = atoms.get(ci.id)?.aam\n      atoms.forEach((atom, aid) => {\n        if (atom.aam === aam) {\n          action.mergeWith(\n            fromAtomsAttrs(this.editor.render.ctab, aid, { aam: 0 }, null)\n          )\n        }\n      })\n      this.editor.update(action)\n    }\n    this.editor.hover(this.editor.findItem(event, ['atoms']), null, event)\n  }\n}\n\nexport default ReactionUnmapTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  Vec2,\n  fromBondAlign,\n  fromFlip,\n  fromItemsFuse,\n  fromRotate,\n  getHoverToFuse,\n  getItemsToFuse,\n  HalfBond\n} from 'ketcher-core'\n\nimport utils from '../shared/utils'\nimport Editor from '../Editor'\n\nclass RotateTool {\n  editor: Editor\n  dragCtx: any\n  isNotActiveTool: boolean | undefined\n\n  constructor(editor, dir) {\n    this.editor = editor\n\n    if (dir) {\n      const restruct = editor.render.ctab\n      const selection = editor.selection()\n      const singleBond =\n        selection &&\n        selection.bonds &&\n        Object.keys(selection).length === 1 &&\n        selection.bonds.length === 1\n      const action = !singleBond\n        ? fromFlip(restruct, selection, dir, null)\n        : fromBondAlign(restruct, selection.bonds[0], dir)\n      editor.update(action)\n      this.isNotActiveTool = true\n      return\n    }\n\n    if (!editor.selection() || !editor.selection()?.atoms) {\n      // otherwise, clear selection\n      this.editor.selection(null)\n    }\n  }\n\n  mousedown(event) {\n    let xy0 = new Vec2()\n    const selection = this.editor.selection()\n    const rnd = this.editor.render\n    const struct = rnd.ctab.molecule\n\n    if (selection && selection.atoms) {\n      let rotId: number | null = null\n      let rotAll = false\n\n      selection.atoms.forEach((aid) => {\n        const atom = struct.atoms.get(aid)\n\n        xy0.add_(atom?.pp as Vec2) // eslint-disable-line no-underscore-dangle\n\n        if (rotAll) return\n\n        atom?.neighbors.find((nei) => {\n          const hb = struct.halfBonds.get(nei)\n\n          if (hb) {\n            if (selection.atoms?.indexOf(hb.end as number) === -1) {\n              if (hb.loop >= 0) {\n                const neiAtom = struct.atoms.get(aid)\n                if (\n                  !neiAtom?.neighbors.find((neiNei) => {\n                    const neiHb = struct.halfBonds.get(neiNei) as HalfBond\n                    return (\n                      neiHb?.loop >= 0 &&\n                      selection.atoms?.indexOf(neiHb?.end) !== -1\n                    )\n                  })\n                ) {\n                  rotAll = true\n                  return true\n                }\n              }\n              if (rotId == null) {\n                rotId = aid\n              } else if (rotId !== aid) {\n                rotAll = true\n                return true\n              }\n            }\n          }\n          return false\n        })\n      })\n\n      if (!rotAll && rotId !== null) {\n        xy0 = struct.atoms.get(rotId)?.pp as Vec2\n      } else {\n        xy0 = xy0.scaled(1 / selection.atoms.length)\n      }\n    } else if (struct.atoms?.size) {\n      struct.atoms.forEach((atom) => {\n        xy0.add_(atom.pp)\n      }) // eslint-disable-line no-underscore-dangle, max-len\n      // poor man struct center (without sdata, etc)\n      xy0 = xy0.scaled(1 / struct.atoms.size)\n    } else {\n      xy0 = rnd.page2obj(event)\n    }\n    this.dragCtx = {\n      xy0,\n      angle1: utils.calcAngle(xy0, rnd.page2obj(event))\n    }\n    return true\n  }\n\n  mousemove(event) {\n    if (!this.dragCtx) {\n      this.editor.hover(null, null, event)\n      return true\n    }\n\n    const rnd = this.editor.render\n    const dragCtx = this.dragCtx\n\n    const pos = rnd.page2obj(event)\n    let angle = utils.calcAngle(dragCtx.xy0, pos) - dragCtx.angle1\n\n    if (!event.ctrlKey) {\n      angle = utils.fracAngle(angle, null)\n    }\n\n    const degrees = utils.degrees(angle)\n\n    if ('angle' in dragCtx && dragCtx.angle === degrees) {\n      return true\n    }\n\n    if ('action' in dragCtx) {\n      dragCtx.action.perform(rnd.ctab)\n    }\n\n    dragCtx.angle = degrees\n    dragCtx.action = fromRotate(\n      rnd.ctab,\n      this.editor.selection(),\n      dragCtx.xy0,\n      angle\n    )\n\n    this.editor.event.message.dispatch({ info: degrees + 'º' })\n\n    const expSel = this.editor.explicitSelected()\n    dragCtx.mergeItems = getItemsToFuse(this.editor, expSel)\n    this.editor.hover(getHoverToFuse(dragCtx.mergeItems), null, event)\n\n    this.editor.update(dragCtx.action, true)\n    return true\n  }\n\n  mouseup() {\n    if (!this.dragCtx) {\n      return true\n    }\n\n    const dragCtx = this.dragCtx\n    const restruct = this.editor.render.ctab\n\n    const action = dragCtx.action\n      ? fromItemsFuse(restruct, dragCtx.mergeItems).mergeWith(dragCtx.action)\n      : fromItemsFuse(restruct, dragCtx.mergeItems)\n    delete this.dragCtx\n\n    this.editor.update(action)\n\n    if (dragCtx.mergeItems) {\n      this.editor.selection(null)\n    }\n\n    this.editor.event.message.dispatch({\n      info: false\n    })\n    return true\n  }\n\n  cancel() {\n    this.mouseup()\n  }\n\n  mouseleave() {\n    this.mouseup()\n  }\n}\n\nexport default RotateTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  fromMultipleMove,\n  fromSimpleObjectAddition,\n  fromSimpleObjectDeletion,\n  fromSimpleObjectResizing\n} from 'ketcher-core'\nimport Editor from '../Editor'\n\nclass SimpleObjectTool {\n  mode: any\n  editor: Editor\n  dragCtx: any\n\n  constructor(editor, mode) {\n    this.mode = mode\n    this.editor = editor\n    this.editor.selection(null)\n  }\n\n  mousedown(event) {\n    const rnd = this.editor.render\n    const p0 = rnd.page2obj(event)\n    this.dragCtx = { p0 }\n\n    const ci = this.editor.findItem(event, ['simpleObjects'])\n\n    if (ci && ci.map === 'simpleObjects') {\n      this.editor.hover(null)\n      this.editor.selection({ simpleObjects: [ci.id] })\n      this.dragCtx.ci = ci\n    } else {\n      this.dragCtx.isNew = true\n      this.editor.selection(null)\n    }\n  }\n\n  mousemove(event) {\n    const rnd = this.editor.render\n\n    if (this.dragCtx) {\n      const current = rnd.page2obj(event)\n      const diff = current.sub(this.dragCtx.p0)\n      this.dragCtx.previous = current\n\n      if (this.dragCtx.ci) {\n        if (this.dragCtx.action) {\n          this.dragCtx.action.perform(rnd.ctab)\n        }\n\n        if (!this.dragCtx.ci.ref) {\n          this.dragCtx.action = fromMultipleMove(\n            rnd.ctab,\n            this.editor.selection() || {},\n            diff\n          )\n        } else {\n          this.dragCtx.action = fromSimpleObjectResizing(\n            rnd.ctab,\n            this.dragCtx.ci.id,\n            diff,\n            current,\n            this.dragCtx.ci.ref,\n            event.shiftKey\n          )\n        }\n        this.editor.update(this.dragCtx.action, true)\n      } else {\n        if (!this.dragCtx.action) {\n          const action = fromSimpleObjectAddition(\n            rnd.ctab,\n            [this.dragCtx.p0, this.dragCtx.p0],\n            this.mode,\n            false\n          )\n          // TODO: need to rework  actions/operations logic\n          const addOperation = action.operations[0]\n          this.dragCtx.itemId = addOperation.data.id\n          this.dragCtx.action = action\n          this.editor.update(this.dragCtx.action, true)\n        } else {\n          this.dragCtx.action.perform(rnd.ctab)\n        }\n\n        this.dragCtx.action = fromSimpleObjectResizing(\n          rnd.ctab,\n          this.dragCtx.itemId,\n          diff,\n          current,\n          null,\n          event.shiftKey\n        )\n        this.editor.update(this.dragCtx.action, true)\n      }\n    } else {\n      const items = this.editor.findItem(event, ['simpleObjects'])\n      this.editor.hover(items, null, event)\n    }\n  }\n\n  mouseup(event) {\n    if (!this.dragCtx) {\n      return true\n    }\n\n    if (this.dragCtx.action) {\n      if (this.dragCtx.isNew) {\n        const rnd = this.editor.render\n        this.editor.update(\n          fromSimpleObjectDeletion(rnd.ctab, this.dragCtx.itemId),\n          true\n        )\n        this.dragCtx.action = fromSimpleObjectAddition(\n          rnd.ctab,\n          [this.dragCtx.p0, this.dragCtx.previous],\n          this.mode,\n          event.shiftKey\n        )\n      }\n      this.editor.update(this.dragCtx.action)\n    }\n\n    delete this.dragCtx\n    return true\n  }\n}\n\nexport default SimpleObjectTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  Vec2,\n  fromItemsFuse,\n  fromTemplateOnAtom,\n  fromTemplateOnBondAction,\n  fromTemplateOnCanvas,\n  getHoverToFuse,\n  getItemsToFuse,\n  FunctionalGroup,\n  SGroup,\n  ReStruct,\n  Struct,\n  fromFragmentDeletion,\n  fromPaste,\n  fromSgroupDeletion,\n  Action\n} from 'ketcher-core'\n\nimport utils from '../shared/utils'\nimport Editor from '../Editor'\nimport { getGroupIdsFromItemArrays } from './helper/getGroupIdsFromItems'\nimport { getMergeItems } from './helper/getMergeItems'\n\ntype MergeItems = Record<string, Map<unknown, unknown>> | null\n\nclass TemplateTool {\n  editor: Editor\n  mode: any\n  template: any\n  findItems: Array<string>\n  mergeItems: MergeItems = null\n  dragCtx: any\n  targetGroupsIds: Array<number> = []\n  isSaltOrSolvent: boolean\n  followAction: any\n\n  constructor(editor, tmpl) {\n    this.editor = editor\n    this.mode = getTemplateMode(tmpl)\n    this.editor.selection(null)\n    this.isSaltOrSolvent = SGroup.isSaltOrSolvent(tmpl.struct.name)\n\n    this.template = {\n      aid: parseInt(tmpl.aid) || 0,\n      bid: parseInt(tmpl.bid) || 0\n    }\n\n    const frag = tmpl.struct\n    frag.rescale()\n\n    const xy0 = new Vec2()\n    frag.atoms.forEach((atom) => {\n      xy0.add_(atom.pp) // eslint-disable-line no-underscore-dangle\n    })\n\n    this.template.molecule = frag // preloaded struct\n    this.findItems = []\n    this.template.xy0 = xy0.scaled(1 / (frag.atoms.size || 1)) // template center\n\n    const atom = frag.atoms.get(this.template.aid)\n    if (atom) {\n      this.template.angle0 = utils.calcAngle(atom.pp, this.template.xy0) // center tilt\n      this.findItems.push('atoms')\n    }\n\n    const bond = frag.bonds.get(this.template.bid)\n    if (bond && this.mode !== 'fg') {\n      // template location sign against attachment bond\n      this.template.sign = getSign(frag, bond, this.template.xy0)\n      this.findItems.push('bonds')\n    }\n\n    const sgroup = frag.sgroups.size\n    if (sgroup) {\n      this.findItems.push('functionalGroups')\n    }\n  }\n\n  mousedown(event) {\n    if (this.followAction) {\n      this.followAction.perform(this.editor.render.ctab)\n      delete this.followAction\n    }\n\n    const closestItem = this.editor.findItem(event, [\n      'atoms',\n      'bonds',\n      'sgroups',\n      'functionalGroups'\n    ])\n    const ctab = this.editor.render.ctab\n    const struct = ctab.molecule\n\n    if (struct.functionalGroups.size) {\n      this.targetGroupsIds = getGroupIdsFromItemArrays(struct, {\n        ...(closestItem?.map === 'atoms' && { atoms: [closestItem.id] }),\n        ...(closestItem?.map === 'bonds' && { bonds: [closestItem.id] })\n      })\n\n      if (\n        closestItem?.map === 'functionalGroups' &&\n        FunctionalGroup.isContractedFunctionalGroup(\n          closestItem.id,\n          struct.functionalGroups\n        )\n      ) {\n        this.targetGroupsIds.push(closestItem.id)\n      }\n    }\n\n    this.editor.hover(null)\n\n    const dragCtxItem = getDragCtxItem(\n      this.editor,\n      event,\n      this.mode,\n      this.mergeItems,\n      this.findItems\n    )\n\n    this.dragCtx = {\n      xy0: this.editor.render.page2obj(event),\n      item: dragCtxItem\n    }\n\n    const dragCtx = this.dragCtx\n    const ci = dragCtx.item\n\n    if (!ci || this.isSaltOrSolvent) {\n      //  ci.type == 'Canvas'\n      delete dragCtx.item\n      return\n    }\n\n    if (ci.map === 'bonds' && this.mode !== 'fg') {\n      // calculate fragment center\n      const xy0 = new Vec2()\n      const bond = struct.bonds.get(ci.id)\n      const frid = struct.atoms.get(bond?.begin as number)?.fragment\n      const frIds = struct.getFragmentIds(frid as number)\n      let count = 0\n\n      let loop = struct.halfBonds.get(bond?.hb1 as number)?.loop\n\n      if (loop && loop < 0) {\n        loop = struct.halfBonds.get(bond?.hb2 as number)?.loop\n      }\n\n      if (loop && loop >= 0) {\n        const loopHbs = struct.loops.get(loop)?.hbs\n        loopHbs?.forEach((hb) => {\n          const halfBondBegin = struct.halfBonds.get(hb)?.begin\n\n          if (halfBondBegin) {\n            const hbbAtom = struct.atoms.get(halfBondBegin)\n\n            if (hbbAtom) {\n              xy0.add_(hbbAtom.pp) // eslint-disable-line no-underscore-dangle, max-len\n              count++\n            }\n          }\n        })\n      } else {\n        frIds.forEach((id) => {\n          const atomById = struct.atoms.get(id)\n\n          if (atomById) {\n            xy0.add_(atomById.pp) // eslint-disable-line no-underscore-dangle\n            count++\n          }\n        })\n      }\n\n      dragCtx.v0 = xy0.scaled(1 / count)\n\n      const sign = getSign(struct, bond, dragCtx.v0)\n\n      // calculate default template flip\n      dragCtx.sign1 = sign || 1\n      dragCtx.sign2 = this.template.sign\n    }\n  }\n\n  mousemove(event) {\n    if (!this.dragCtx) {\n      if (this.followAction) {\n        this.followAction.perform(this.editor.render.ctab)\n      }\n\n      const [followAction, pasteItems] = fromPaste(\n        this.editor.render.ctab,\n        this.template.molecule,\n        this.editor.render.page2obj(event)\n      )\n\n      this.followAction = followAction\n      this.editor.update(followAction, true)\n\n      if (this.mode === 'fg') {\n        const skip = getIgnoredGroupItem(this.editor.struct(), pasteItems)\n        const ci = this.editor.findItem(event, this.findItems, skip)\n\n        this.editor.hover(ci ?? null, null, event)\n      } else {\n        this.mergeItems = getMergeItems(this.editor, pasteItems)\n        this.editor.hover(getHoverToFuse(this.mergeItems))\n      }\n\n      return\n    }\n\n    const dragCtx = this.dragCtx\n    const ci = dragCtx.item\n    let targetPos: Vec2 | null | undefined = null\n    const eventPos = this.editor.render.page2obj(event)\n    const struct = this.editor.render.ctab.molecule\n\n    /* moving when attached to bond */\n    if (ci && ci.map === 'bonds' && this.mode !== 'fg') {\n      const bond = struct.bonds.get(ci.id)\n      let sign = getSign(struct, bond, eventPos)\n\n      if (dragCtx.sign1 * this.template.sign > 0) {\n        sign = -sign\n      }\n\n      if (sign !== dragCtx.sign2 || !dragCtx.action) {\n        if (dragCtx.action) {\n          dragCtx.action.perform(this.editor.render.ctab)\n        } // undo previous action\n\n        dragCtx.sign2 = sign\n        const [action, pasteItems] = fromTemplateOnBondAction(\n          this.editor.render.ctab,\n          this.template,\n          ci.id,\n          this.editor.event,\n          dragCtx.sign1 * dragCtx.sign2 > 0,\n          false\n        ) as Array<any>\n\n        dragCtx.action = action\n        this.editor.update(dragCtx.action, true)\n\n        dragCtx.mergeItems = getItemsToFuse(this.editor, pasteItems)\n        this.editor.hover(getHoverToFuse(dragCtx.mergeItems))\n      }\n      return true\n    }\n    /* end */\n\n    let extraBond: boolean | null = null\n    // calc initial pos and is extra bond needed\n    if (!ci) {\n      //  ci.type == 'Canvas'\n      targetPos = dragCtx.xy0\n    } else if (ci.map === 'atoms' || ci.map === 'functionalGroups') {\n      const atomId = getTargetAtomId(struct, ci)\n\n      if (atomId !== undefined) {\n        const atom = struct.atoms.get(atomId)\n        targetPos = atom?.pp\n\n        if (targetPos) {\n          extraBond =\n            this.mode === 'fg' ? true : Vec2.dist(targetPos, eventPos) > 1\n        }\n      }\n    }\n\n    if (!targetPos) {\n      return true\n    }\n\n    // calc angle\n    let angle = utils.calcAngle(targetPos, eventPos)\n\n    if (!event.ctrlKey) {\n      angle = utils.fracAngle(angle, null)\n    }\n\n    const degrees = utils.degrees(angle)\n    this.editor.event.message.dispatch({ info: degrees + 'º' })\n\n    // check if anything changed since last time\n    if (\n      // eslint-disable-next-line no-prototype-builtins\n      dragCtx.hasOwnProperty('angle') &&\n      dragCtx.angle === degrees &&\n      // eslint-disable-next-line no-prototype-builtins\n      (!dragCtx.hasOwnProperty('extra_bond') ||\n        dragCtx.extra_bond === extraBond)\n    ) {\n      return true\n    }\n\n    // undo previous action\n    if (dragCtx.action) {\n      dragCtx.action.perform(this.editor.render.ctab)\n    }\n\n    // create new action\n    dragCtx.angle = degrees\n    let action = null\n    let pasteItems\n\n    if (!ci) {\n      const isAddingFunctionalGroup = this.template?.molecule?.sgroups.size\n      if (isAddingFunctionalGroup) {\n        // skip, b/c we dont want to do any additional actions (e.g. rotating for s-groups)\n        return true\n      }\n      ;[action, pasteItems] = fromTemplateOnCanvas(\n        this.editor.render.ctab,\n        this.template,\n        targetPos,\n        angle\n      )\n    } else if (ci?.map === 'atoms' || ci?.map === 'functionalGroups') {\n      const atomId = getTargetAtomId(struct, ci)\n      ;[action, pasteItems] = fromTemplateOnAtom(\n        this.editor.render.ctab,\n        this.template,\n        atomId,\n        angle,\n        extraBond\n      )\n      dragCtx.extra_bond = extraBond\n    }\n    dragCtx.action = action\n\n    this.editor.update(dragCtx.action, true)\n\n    if (this.mode !== 'fg') {\n      dragCtx.mergeItems = getItemsToFuse(this.editor, pasteItems)\n      this.editor.hover(getHoverToFuse(dragCtx.mergeItems))\n    }\n\n    // TODO: refactor after #2195 comes into effect\n    if (this.targetGroupsIds.length) this.targetGroupsIds.length = 0\n\n    return true\n  }\n\n  mouseup(event) {\n    const dragCtx = this.dragCtx\n\n    if (this.targetGroupsIds.length && this.mode !== 'fg') {\n      this.editor.event.removeFG.dispatch({ fgIds: this.targetGroupsIds })\n      return\n    }\n\n    if (!dragCtx) {\n      return true\n    }\n\n    delete this.dragCtx\n\n    const restruct = this.editor.render.ctab\n    const struct = restruct.molecule\n    let ci = dragCtx.item\n    const functionalGroups = struct.functionalGroups\n\n    /* after moving around bond */\n    if (dragCtx.action && ci && ci.map === 'bonds' && this.mode !== 'fg') {\n      dragCtx.action.perform(restruct) // revert drag action\n\n      const promise = fromTemplateOnBondAction(\n        restruct,\n        this.template,\n        ci.id,\n        this.editor.event,\n        dragCtx.sign1 * dragCtx.sign2 > 0,\n        true\n      ) as Promise<any>\n\n      promise.then(([action, pasteItems]) => {\n        const mergeItems = getItemsToFuse(this.editor, pasteItems)\n        action = fromItemsFuse(restruct, mergeItems).mergeWith(action)\n        this.editor.update(action)\n      })\n      return true\n    }\n    /* end */\n\n    let action, functionalGroupRemoveAction\n    let pasteItems = null\n\n    if (this.isSaltOrSolvent) {\n      addSaltsAndSolventsOnCanvasWithoutMerge(\n        restruct,\n        this.template,\n        dragCtx,\n        this.editor\n      )\n      return true\n    } else if (\n      ci?.map === 'functionalGroups' &&\n      FunctionalGroup.isContractedFunctionalGroup(ci.id, functionalGroups) &&\n      this.mode === 'fg' &&\n      this.targetGroupsIds.length\n    ) {\n      functionalGroupRemoveAction = new Action()\n      const struct = this.editor.struct()\n      const restruct = this.editor.render.ctab\n      const functionalGroupToReplace = struct.sgroups.get(ci.id)!\n      const attachmentAtomId = functionalGroupToReplace.getAttAtomId(struct)\n      const atomsWithoutAttachmentAtom = SGroup.getAtoms(\n        struct,\n        functionalGroupToReplace\n      ).filter((id) => id !== attachmentAtomId)\n\n      functionalGroupRemoveAction.mergeWith(fromSgroupDeletion(restruct, ci.id))\n      functionalGroupRemoveAction.mergeWith(\n        fromFragmentDeletion(restruct, { atoms: atomsWithoutAttachmentAtom })\n      )\n\n      ci = { map: 'atoms', id: attachmentAtomId }\n    }\n\n    if (!dragCtx.action) {\n      if (!ci) {\n        //  ci.type == 'Canvas'\n        ;[action, pasteItems] = fromTemplateOnCanvas(\n          restruct,\n          this.template,\n          dragCtx.xy0,\n          0\n        )\n        dragCtx.action = action\n      } else if (ci.map === 'atoms') {\n        const degree = restruct.atoms.get(ci.id)?.a.neighbors.length\n        let angle\n\n        if (degree && degree > 1) {\n          // common case\n          angle = null\n        } else if (degree === 1) {\n          // on chain end\n          const atom = struct.atoms.get(ci.id)\n          const neiId = atom && struct.halfBonds.get(atom.neighbors[0])?.end\n          const nei: any = (neiId || neiId === 0) && struct.atoms.get(neiId)\n\n          angle = event.ctrlKey\n            ? utils.calcAngle(nei?.pp, atom?.pp)\n            : utils.fracAngle(utils.calcAngle(nei.pp, atom?.pp), null)\n        } else {\n          // on single atom\n          angle = 0\n        }\n\n        ;[action, pasteItems] = fromTemplateOnAtom(\n          restruct,\n          this.template,\n          ci.id,\n          angle,\n          this.mode === 'fg'\n        )\n        if (functionalGroupRemoveAction) {\n          action = functionalGroupRemoveAction.mergeWith(action)\n        }\n        dragCtx.action = action\n      } else if (ci.map === 'bonds' && this.mode !== 'fg') {\n        const promise = fromTemplateOnBondAction(\n          restruct,\n          this.template,\n          ci.id,\n          this.editor.event,\n          dragCtx.sign1 * dragCtx.sign2 > 0,\n          true\n        ) as Promise<any>\n\n        promise.then(([action, pasteItems]) => {\n          if (this.mode !== 'fg') {\n            const mergeItems = getItemsToFuse(this.editor, pasteItems)\n            action = fromItemsFuse(restruct, mergeItems).mergeWith(action)\n            this.editor.update(action)\n          }\n        })\n\n        return true\n      }\n    }\n\n    this.editor.selection(null)\n\n    if (!dragCtx.mergeItems && pasteItems && this.mode !== 'fg') {\n      dragCtx.mergeItems = getItemsToFuse(this.editor, pasteItems)\n    }\n    dragCtx.action = dragCtx.action\n      ? fromItemsFuse(restruct, dragCtx.mergeItems).mergeWith(dragCtx.action)\n      : fromItemsFuse(restruct, dragCtx.mergeItems)\n\n    const completeAction = dragCtx.action\n    if (completeAction && !completeAction.isDummy()) {\n      this.editor.update(completeAction)\n    }\n    this.editor.hover(this.editor.findItem(event, this.findItems), null, event)\n    this.editor.event.showInfo.dispatch(null)\n    this.editor.event.message.dispatch({ info: false })\n\n    return true\n  }\n\n  cancel(e) {\n    if (this.followAction) {\n      this.followAction.perform(this.editor.render.ctab)\n      delete this.followAction\n    }\n\n    this.mouseup(e)\n  }\n\n  mouseleave(e) {\n    this.mouseup(e)\n  }\n}\n\nfunction addSaltsAndSolventsOnCanvasWithoutMerge(\n  restruct: ReStruct,\n  template: Struct,\n  dragCtx,\n  editor: Editor\n) {\n  const [action] = fromTemplateOnCanvas(restruct, template, dragCtx.xy0, 0)\n  editor.update(action)\n  editor.selection(null)\n  editor.hover(null)\n  editor.event.message.dispatch({\n    info: false\n  })\n}\n\nfunction getTemplateMode(tmpl) {\n  if (tmpl.mode) return tmpl.mode\n  if (['Functional Groups', 'Salts and Solvents'].includes(tmpl.props?.group))\n    return 'fg'\n  return null\n}\n\nfunction getSign(molecule, bond, v) {\n  const begin = molecule.atoms.get(bond.begin).pp\n  const end = molecule.atoms.get(bond.end).pp\n\n  const sign = Vec2.cross(Vec2.diff(begin, end), Vec2.diff(v, end))\n\n  if (sign > 0) {\n    return 1\n  }\n\n  if (sign < 0) {\n    return -1\n  }\n\n  return 0\n}\n\nfunction getTargetAtomId(struct: Struct, ci): number | void {\n  if (ci.map === 'atoms') {\n    return ci.id\n  }\n\n  if (ci.map === 'functionalGroups') {\n    const group = struct.sgroups.get(ci.id)\n    return group?.getAttAtomId(struct)\n  }\n}\n\nfunction getIgnoredGroupItem(struct: Struct, pasteItems) {\n  const groupId = struct.getGroupIdFromAtomId(pasteItems.atoms[0])\n  return { map: 'functionalGroups', id: groupId }\n}\n\nfunction getDragCtxItem(\n  editor: Editor,\n  event,\n  mode: string,\n  mergeItems: MergeItems,\n  findItems\n): { map: string; id: number } | null {\n  if (mode === 'fg') return editor.findItem(event, findItems)\n  if (mergeItems?.atoms.size === 1 && mergeItems.bonds.size === 0) {\n    // get ID of single dst (target) atom we are hovering over\n    return { map: 'atoms', id: mergeItems.atoms.values().next().value }\n  }\n  return null\n}\n\nexport default TemplateTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  Action,\n  Text,\n  Vec2,\n  fromMultipleMove,\n  fromTextCreation,\n  fromTextDeletion,\n  fromTextUpdating\n} from 'ketcher-core'\n\ninterface Result {\n  content: string\n}\n\nclass TextTool {\n  editor: any\n  dragCtx: any\n\n  constructor(editor) {\n    this.editor = editor\n    this.editor.selection(null)\n  }\n\n  mousedown(event) {\n    const render = this.editor.render\n    const closestItem = this.editor.findItem(event, ['texts'])\n\n    this.editor.selection(null)\n\n    if (closestItem && closestItem.map === 'texts') {\n      this.editor.hover(null)\n      this.editor.selection({ texts: [closestItem.id] })\n      this.dragCtx = {\n        xy0: render.page2obj(event),\n        action: new Action()\n      }\n    }\n  }\n\n  mousemove(event) {\n    const render = this.editor.render\n\n    if (this.dragCtx) {\n      if (this.dragCtx.action) {\n        this.dragCtx.action.perform(render.ctab)\n      }\n\n      this.dragCtx.action = fromMultipleMove(\n        render.ctab,\n        this.editor.selection() || {},\n        render.page2obj(event).sub(this.dragCtx.xy0)\n      )\n      this.editor.update(this.dragCtx.action, true)\n    } else {\n      this.editor.hover(this.editor.findItem(event, ['texts']), null, event)\n    }\n  }\n\n  mouseup() {\n    if (this.dragCtx) {\n      this.editor.update(this.dragCtx.action)\n      delete this.dragCtx\n    }\n    return true\n  }\n\n  click(event) {\n    const render = this.editor.render\n    const closestItem = this.editor.findItem(event, ['texts'])\n    this.editor.hover(null)\n\n    if (!closestItem) {\n      propsDialog(this.editor, null, render.page2obj(event), [])\n    }\n\n    return true\n  }\n\n  dblclick(event) {\n    const closestItem = this.editor.findItem(event, ['texts'])\n    this.editor.hover(null)\n\n    if (closestItem.map === 'texts') {\n      propsDialog(\n        this.editor,\n        closestItem.id,\n        closestItem.position,\n        closestItem.pos\n      )\n    }\n\n    return true\n  }\n}\n\nfunction propsDialog(\n  editor: any,\n  id: number | null,\n  position: Vec2,\n  pos: Array<Vec2>\n) {\n  const struct = editor.render.ctab.molecule\n  const text: Text | null = id || id === 0 ? struct.texts.get(id) : null\n  const origilContent = text ? text.content : ''\n\n  const res = editor.event.elementEdit.dispatch({\n    content: origilContent,\n    id,\n    position,\n    pos,\n    type: 'text'\n  })\n\n  res\n    .then(({ content }: Result) => {\n      if (!id && id !== 0 && content) {\n        editor.update(\n          fromTextCreation(editor.render.ctab, content, position, pos)\n        )\n      } else if (!content) {\n        editor.update(fromTextDeletion(editor.render.ctab, id!))\n      } else if (content !== origilContent) {\n        editor.update(fromTextUpdating(editor.render.ctab, id!, content))\n      }\n    })\n    .catch(() => null)\n}\n\nexport default TextTool\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport APointTool from './apoint'\nimport AtomTool from './atom'\nimport AttachTool from './attach'\nimport BondTool from './bond'\nimport ChainTool from './chain'\nimport ChargeTool from './charge'\nimport EnhancedStereoTool from './enhanced-stereo'\nimport EraserTool from './eraser'\nimport HandTool from './hand'\nimport PasteTool from './paste'\nimport RGroupAtomTool from './rgroupatom'\nimport RGroupFragmentTool from './rgroupfragment'\nimport ReactionArrowTool from './reactionarrow'\nimport ReactionMapTool from './reactionmap'\nimport ReactionPlusTool from './reactionplus'\nimport ReactionUnmapTool from './reactionunmap'\nimport RotateTool from './rotate'\nimport SGroupTool from './sgroup'\nimport SelectTool from './select'\nimport SimpleObjectTool from './simpleobject'\nimport TemplateTool from './template'\nimport TextTool from './text'\n\nconst tools = {\n  hand: HandTool,\n  rgroupatom: RGroupAtomTool,\n  select: SelectTool,\n  sgroup: SGroupTool,\n  eraser: EraserTool,\n  atom: AtomTool,\n  bond: BondTool,\n  chain: ChainTool,\n  template: TemplateTool,\n  charge: ChargeTool,\n  rgroupfragment: RGroupFragmentTool,\n  apoint: APointTool,\n  attach: AttachTool,\n  reactionarrow: ReactionArrowTool,\n  reactionplus: ReactionPlusTool,\n  reactionmap: ReactionMapTool,\n  reactionunmap: ReactionUnmapTool,\n  paste: PasteTool,\n  rotate: RotateTool,\n  enhancedStereo: EnhancedStereoTool,\n  simpleobject: SimpleObjectTool,\n  text: TextTool\n}\n\nexport default tools\n","import { Dispatch } from 'redux'\nimport {\n  fromAtomAddition,\n  fromAtomsAttrs,\n  fromBondAddition,\n  fromBondsAttrs,\n  fromFragmentDeletion,\n  FunctionalGroup,\n  SGroup,\n  Atom\n} from 'ketcher-core'\nimport { openDialog } from './modal'\nimport Tools from '../../editor/tool'\nimport { getSelectedAtoms } from '../../editor/tool/select'\nimport { onAction } from './shared'\nimport { Editor } from '../../editor'\nimport { updateSelectedAtoms } from 'src/script/ui/state/modal/atoms'\nimport { fromAtom, toAtom, fromBond, toBond } from '../data/convert/structconv'\n\ntype TNewAction = {\n  tool?: string\n  dialog?: string\n  opts?: any\n}\n\ntype HandlersProps = {\n  hoveredItemId: number\n  newAction: TNewAction\n  editor: Editor\n  dispatch: Dispatch\n}\n\ntype HandleHotkeyOverItemProps = {\n  hoveredItem: Record<string, number>\n  newAction: TNewAction\n  editor: Editor\n  dispatch: Dispatch\n}\n\nexport function handleHotkeyOverItem(props: HandleHotkeyOverItemProps) {\n  if (props.newAction.tool === 'eraser') {\n    handleEraser(props)\n  } else if (props.newAction.dialog) {\n    handleDialog(props)\n  } else if (props.newAction.tool) {\n    handleTool(props)\n  }\n}\n\nfunction handleEraser({ editor, hoveredItem }: HandleHotkeyOverItemProps) {\n  const action = fromFragmentDeletion(\n    editor.render.ctab,\n    mapItemsToArrays(hoveredItem)\n  )\n  editor.update(action)\n  editor.hover(null)\n}\n\nfunction handleDialog({\n  hoveredItem,\n  newAction,\n  editor,\n  dispatch\n}: HandleHotkeyOverItemProps) {\n  const dialogType = Object.keys(hoveredItem)[0]\n  const dialogHandler = getDialogHandler(dialogType)\n  const hoveredItemId = hoveredItem[dialogType]\n\n  if (dialogHandler) {\n    const props: HandlersProps = {\n      hoveredItemId,\n      newAction,\n      editor,\n      dispatch\n    }\n    return dialogHandler(props)\n  }\n}\n\nfunction getDialogHandler(itemType: string) {\n  const dialogs = {\n    atoms: (props: HandlersProps) => handleAtomPropsDialog(props),\n    bonds: (props: HandlersProps) => handleBondPropsDialog(props)\n  }\n\n  const dialog = dialogs[itemType]\n  return dialog\n}\n\nfunction handleAtomPropsDialog({\n  hoveredItemId,\n  newAction,\n  editor,\n  dispatch\n}: HandlersProps) {\n  const selection = editor.selection()\n  const atomsSelected = selection?.atoms\n  const restruct = editor.render.ctab\n\n  if (atomsSelected && atomsSelected.includes(hoveredItemId)) {\n    const atoms = getSelectedAtoms(selection, restruct.molecule)\n    const changeAtomPromise = editor.event.elementEdit.dispatch(atoms)\n\n    updateSelectedAtoms({\n      atoms: selection.atoms || [],\n      editor,\n      changeAtomPromise\n    })\n  } else {\n    const atomFromStruct = restruct.atoms.get(hoveredItemId)\n    const convertedAtomForModal = fromAtom(atomFromStruct?.a)\n\n    openDialog(dispatch, newAction.dialog, convertedAtomForModal)\n      .then((res) => {\n        const updatedAtom = fromAtomsAttrs(\n          restruct,\n          hoveredItemId,\n          toAtom(res),\n          false\n        )\n\n        editor.update(updatedAtom)\n      })\n      .catch(() => null)\n  }\n}\n\nfunction handleBondPropsDialog({\n  hoveredItemId,\n  newAction,\n  editor,\n  dispatch\n}: HandlersProps) {\n  const restruct = editor.render.ctab\n  const bondFromStruct = restruct.bonds.get(hoveredItemId)\n  const convertedBondForModal = fromBond(bondFromStruct?.b)\n\n  openDialog(dispatch, newAction.dialog, convertedBondForModal)\n    .then((res) => {\n      const updatedBond = fromBondsAttrs(\n        restruct,\n        hoveredItemId,\n        toBond(res),\n        false\n      )\n\n      editor.update(updatedBond)\n    })\n    .catch(() => null)\n}\n\nfunction handleTool({\n  hoveredItem,\n  newAction,\n  editor,\n  dispatch\n}: HandleHotkeyOverItemProps) {\n  for (const item in hoveredItem) {\n    const toolHandler = getToolHandler(item, newAction.tool)\n    const isChangeStructureTool = newAction.tool !== 'hand'\n    const hoveredItemId = hoveredItem[item]\n\n    if (toolHandler) {\n      const props: HandlersProps = {\n        hoveredItemId,\n        editor,\n        newAction,\n        dispatch\n      }\n      isFunctionalGroupChange(props).then((result) => {\n        if (!result && isChangeStructureTool) return\n        toolHandler(props)\n      })\n    }\n  }\n}\n\nasync function isFunctionalGroupChange(props: HandlersProps): Promise<boolean> {\n  return await isChangingFunctionalGroup(props)\n}\n\nfunction getToolHandler(itemType: string, toolName = '') {\n  const items = {\n    atoms: {\n      atom: (props: HandlersProps) => handleAtomTool(props),\n      bond: (props: HandlersProps) => handleBondTool(props),\n      charge: (props: HandlersProps) => handleChargeTool(props),\n      rgroupatom: (props: HandlersProps) => handleRGroupAtomTool(props),\n      sgroup: ({ editor, hoveredItemId }: HandlersProps) => {\n        Tools.sgroup.sgroupDialog(editor, hoveredItemId)\n      },\n      hand: ({ dispatch }: HandlersProps) =>\n        dispatch(onAction({ tool: 'hand' }))\n    },\n    _default: {}\n  }\n\n  const item = items[itemType]\n\n  if (item) {\n    return item[toolName]\n  }\n  return items._default[toolName]\n}\n\nfunction handleAtomTool({ hoveredItemId, newAction, editor }: HandlersProps) {\n  const atomProps = { ...newAction.opts }\n  const updatedAtoms = fromAtomsAttrs(\n    editor.render.ctab,\n    hoveredItemId,\n    atomProps,\n    true\n  )\n  editor.update(updatedAtoms)\n}\n\nfunction handleBondTool({ hoveredItemId, newAction, editor }: HandlersProps) {\n  const newBond = fromBondAddition(\n    editor.render.ctab,\n    newAction.opts,\n    hoveredItemId,\n    undefined\n  )[0]\n  editor.update(newBond)\n}\n\nfunction handleChargeTool({ hoveredItemId, newAction, editor }: HandlersProps) {\n  const existingAtom = editor.render.ctab.atoms.get(hoveredItemId)?.a\n  if (existingAtom) {\n    const updatedAtom = fromAtomsAttrs(\n      editor.render.ctab,\n      hoveredItemId,\n      {\n        charge: existingAtom.charge + newAction.opts\n      },\n      null\n    )\n    editor.update(updatedAtom)\n  }\n}\n\nfunction mapItemsToArrays(\n  items: Record<string, number>\n): Record<string, number[]> {\n  const mappedItems = {}\n  for (const item in items) {\n    mappedItems[item] = [items[item]]\n  }\n  return mappedItems\n}\n\nasync function handleRGroupAtomTool({ hoveredItemId, editor }: HandlersProps) {\n  const struct = editor.render.ctab.molecule\n  const atom =\n    hoveredItemId || hoveredItemId === 0\n      ? struct.atoms.get(hoveredItemId)\n      : null\n  const rglabel = atom ? atom.rglabel : 0\n  const label = atom ? atom.label : 'R#'\n\n  try {\n    let element = await editor.event.elementEdit.dispatch({\n      label: 'R#',\n      rglabel,\n      fragId: atom ? atom.fragment : null\n    })\n    element = Object.assign({}, Atom.attrlist, element)\n\n    if (!hoveredItemId && hoveredItemId !== 0 && element.rglabel) {\n      editor.update(fromAtomAddition(editor.render.ctab, null, element))\n    } else if (rglabel !== element.rglabel) {\n      if (!element.rglabel && label !== 'R#') {\n        element.label = label\n      }\n\n      editor.update(\n        fromAtomsAttrs(editor.render.ctab, hoveredItemId, element, false)\n      )\n    }\n  } catch (error) {} // w/o changes\n}\n\nasync function isChangingFunctionalGroup({\n  hoveredItemId,\n  editor\n}: HandlersProps) {\n  const atomResult: number[] = []\n  const result: number[] = []\n  const atom = editor.render.ctab.atoms.get(hoveredItemId)?.a\n  const molecule = editor.render.ctab.molecule\n  const functionalGroups = molecule.functionalGroups\n  const sgroupsOnCanvas = Array.from(molecule.sgroups.values())\n  if (atom && functionalGroups) {\n    const atomId = FunctionalGroup.atomsInFunctionalGroup(\n      functionalGroups,\n      hoveredItemId\n    )\n\n    if (atomId !== null) {\n      atomResult.push(atomId)\n    }\n  }\n\n  const isFunctionalGroup = atomResult.length > 0\n\n  if (isFunctionalGroup) {\n    if (\n      SGroup.isAtomInSaltOrSolvent(\n        hoveredItemId as number,\n        sgroupsOnCanvas as SGroup[]\n      )\n    ) {\n      return false\n    }\n    for (const id of atomResult) {\n      const fgId = FunctionalGroup.findFunctionalGroupByAtom(\n        functionalGroups,\n        id\n      )\n\n      if (fgId !== null && !result.includes(fgId)) {\n        result.push(fgId)\n      }\n    }\n    return await editor.event.removeFG.dispatch({ fgIds: result })\n  }\n  return true\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport * as clipArea from '../component/cliparea/cliparea'\n\nimport {\n  KetSerializer,\n  MolSerializer,\n  formatProperties,\n  ChemicalMimeType\n} from 'ketcher-core'\nimport { debounce, isEqual } from 'lodash/fp'\nimport { load, onAction } from './shared'\n\nimport actions from '../action'\nimport tools from '../action/tools'\nimport keyNorm from '../data/convert/keynorm'\nimport { openDialog } from './modal'\nimport { isIE } from 'react-device-detect'\nimport { handleHotkeyOverItem } from './handleHotkeysOverItem'\nimport { SettingsManager } from '../utils/settingsManager'\n\nexport function initKeydownListener(element) {\n  return function (dispatch, getState) {\n    const hotKeys = initHotKeys()\n    element.addEventListener('keydown', (event) =>\n      keyHandle(dispatch, getState(), hotKeys, event)\n    )\n  }\n}\n\nfunction removeNotRenderedStruct(actionTool, event, dispatch) {\n  const { code, metaKey } = event\n  if (actionTool.tool === 'paste' && code === 'KeyS' && metaKey) {\n    const savedSelectedTool = SettingsManager.selectionTool\n    dispatch({\n      type: 'ACTION',\n      action: savedSelectedTool || tools['select-rectangle'].action\n    })\n  }\n}\n\n/* HotKeys */\nfunction keyHandle(dispatch, state, hotKeys, event) {\n  if (state.modal) return\n\n  const { editor } = state\n  const { render } = editor\n  const actionState = state.actionState\n  const actionTool = actionState.activeTool\n\n  const key = keyNorm(event)\n  const atomsSelected = editor.selection() && editor.selection().atoms\n\n  let group: any = null\n\n  if (key && key.length === 1 && atomsSelected && key.match(/\\w/)) {\n    openDialog(dispatch, 'labelEdit', { letter: key })\n      .then((res) => {\n        dispatch(onAction({ tool: 'atom', opts: res }))\n      })\n      .catch(() => null)\n    event.preventDefault()\n  } else if (key && key.length === 1 && key.match('/')) {\n    const hotkeyDialogTypes = {\n      atoms: actions['atom-props'].action,\n      bonds: actions['bond-props'].action\n    }\n\n    const hoveredItem = getHoveredItem(render.ctab)\n    if (!hoveredItem) {\n      return\n    }\n    const dialogType = Object.keys(hoveredItem)[0]\n\n    if (Object.hasOwn(hotkeyDialogTypes, dialogType)) {\n      handleHotkeyOverItem({\n        hoveredItem,\n        newAction: hotkeyDialogTypes[dialogType],\n        editor,\n        dispatch\n      })\n    }\n\n    event.preventDefault()\n  } else if ((group = keyNorm.lookup(hotKeys, event)) !== undefined) {\n    const index = checkGroupOnTool(group, actionTool) // index currentTool in group || -1\n    const groupLength = group !== null ? group.length : 1\n    const newIndex = (index + 1) % groupLength\n\n    const actName = group[newIndex]\n    if (actionState[actName] && actionState[actName].disabled === true) {\n      event.preventDefault()\n      return\n    }\n    // Removing from what should be saved - structure, which was added to paste tool,\n    // but not yet rendered on canvas\n    removeNotRenderedStruct(actionTool, event, dispatch)\n\n    if (clipArea.actions.indexOf(actName) === -1) {\n      let newAction = actions[actName].action\n      const hoveredItem = getHoveredItem(render.ctab)\n      // check if atom is currently hovered over\n      // in this case we do not want to activate the corresponding tool\n      // and just insert the atom directly\n      if (hoveredItem && newAction.tool !== 'select') {\n        newAction = getCurrentAction(group[index]) || newAction\n        handleHotkeyOverItem({\n          hoveredItem,\n          newAction,\n          editor,\n          dispatch\n        })\n      } else {\n        dispatch(onAction(newAction))\n      }\n\n      event.preventDefault()\n    } else if (isIE) {\n      clipArea.exec(event)\n    }\n  }\n}\n\nfunction getCurrentAction(prevActName) {\n  return actions[prevActName]?.action\n}\n\nfunction getHoveredItem(\n  ctab: Record<string, Map<number, Record<string, unknown>>>\n): Record<string, number> | null {\n  const hoveredItem = {}\n\n  for (const ctabItem in ctab) {\n    if (Object.keys(hoveredItem).length) {\n      break\n    }\n\n    if (!(ctab[ctabItem] instanceof Map)) {\n      continue\n    }\n\n    ctab[ctabItem].forEach((item, id) => {\n      if (item.hover) {\n        hoveredItem[ctabItem] = id\n      }\n    })\n  }\n\n  return Object.keys(hoveredItem).length ? hoveredItem : null\n}\n\nfunction setHotKey(key, actName, hotKeys) {\n  if (Array.isArray(hotKeys[key])) hotKeys[key].push(actName)\n  else hotKeys[key] = [actName]\n}\n\nfunction initHotKeys() {\n  const hotKeys = {}\n  let act\n\n  Object.keys(actions).forEach((actName) => {\n    act = actions[actName]\n    if (!act.shortcut) return\n\n    if (Array.isArray(act.shortcut)) {\n      act.shortcut.forEach((key) => {\n        setHotKey(key, actName, hotKeys)\n      })\n    } else {\n      setHotKey(act.shortcut, actName, hotKeys)\n    }\n  })\n\n  return keyNorm(hotKeys)\n}\n\nfunction checkGroupOnTool(group, actionTool) {\n  let index = group.indexOf(actionTool.tool)\n\n  group.forEach((actName, i) => {\n    if (isEqual(actions[actName].action, actionTool)) index = i\n  })\n\n  return index\n}\n\nconst rxnTextPlain = /\\$RXN\\n+\\s+0\\s+0\\s+0\\n*/\n\n/* ClipArea */\nexport function initClipboard(dispatch) {\n  const formats = Object.keys(formatProperties).map(\n    (format) => formatProperties[format].mime\n  )\n\n  const debAction = debounce(0, (action) => dispatch(onAction(action)))\n  const loadStruct = debounce(0, (structStr, opts) =>\n    dispatch(load(structStr, opts))\n  )\n\n  return {\n    formats,\n    focused() {\n      const state = global.currentState\n      return !state.modal\n    },\n    onCut() {\n      const state = global.currentState\n      const editor = state.editor\n      const data = clipData(editor)\n      if (data) debAction({ tool: 'eraser', opts: 1 })\n      else editor.selection(null)\n      return data\n    },\n    onCopy() {\n      const state = global.currentState\n      const editor = state.editor\n      const data = clipData(editor)\n      editor.selection(null)\n      return data\n    },\n    onPaste(data) {\n      const structStr =\n        data[ChemicalMimeType.KET] ||\n        data[ChemicalMimeType.Mol] ||\n        data[ChemicalMimeType.Rxn] ||\n        data['text/plain']\n\n      if (structStr || !rxnTextPlain.test(data['text/plain']))\n        loadStruct(structStr, { fragment: true })\n    }\n  }\n}\n\nfunction clipData(editor) {\n  const res = {}\n  const struct = editor.structSelected()\n  const errorHandler = editor.errorHandler\n\n  if (struct.isBlank()) return null\n  const simpleObjectOrText = Boolean(\n    struct.simpleObjects.size || struct.texts.size\n  )\n  if (simpleObjectOrText && isIE) {\n    errorHandler(\n      'The structure you are trying to copy contains Simple object or/and Text object.' +\n        'To copy Simple object or Text object in Internet Explorer try \"Copy as KET\" button'\n    )\n    return null\n  }\n  const molSerializer = new MolSerializer()\n  try {\n    const serializer = new KetSerializer()\n    const ket = serializer.serialize(struct)\n    res[ChemicalMimeType.KET] = ket\n\n    const type = struct.isReaction ? ChemicalMimeType.Mol : ChemicalMimeType.Rxn\n    const data = molSerializer.serialize(struct)\n    res['text/plain'] = data\n    res[type] = data\n\n    // res['chemical/x-daylight-smiles'] = smiles.stringify(struct);\n    return res\n  } catch (e: any) {\n    errorHandler(e.message)\n  }\n\n  return null\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport ClipArea from '../component/cliparea/cliparea'\nimport { connect } from 'react-redux'\nimport { initClipboard } from '../state/hotkeys'\n\nconst AppClipArea = connect(null, (dispatch) => dispatch(initClipboard as any))(\n  ClipArea\n)\n\nexport default AppClipArea\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { useEffect, useRef } from 'react'\nimport { useSettingsContext } from '../../../../hooks'\n\ninterface AppHiddenCallProps {\n  onInitTmpls: (cacheEl, url) => void\n}\n\ntype Props = AppHiddenCallProps\n// todo: come up with better name\nconst AppHidden = (props: Props) => {\n  const { onInitTmpls } = props\n\n  const ref = useRef(null)\n  const { staticResourcesUrl } = useSettingsContext()\n\n  useEffect(() => {\n    onInitTmpls(ref.current, staticResourcesUrl)\n  }, [])\n\n  return <div style={{ display: 'none' }} ref={ref} />\n}\n\nexport type { AppHiddenCallProps }\nexport { AppHidden }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { AppHidden, AppHiddenCallProps } from './AppHidden'\n\nimport { Dispatch } from 'redux'\nimport { connect } from 'react-redux'\nimport { initTmplLib } from '../../state/templates'\n\nconst mapDispatchToProps = (dispatch: Dispatch): AppHiddenCallProps => ({\n  onInitTmpls: (cacheEl, url) => {\n    initTmplLib(dispatch, url, cacheEl)\n  }\n})\n\nconst AppHiddenContainer = connect(null, mapDispatchToProps)(AppHidden)\n\nexport { AppHiddenContainer }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nconst mediaSizes = {\n  smallWidth: 600,\n  smallHeight: 600\n}\n\nexport default mediaSizes\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport * as KN from 'w3c-keyname'\n\nimport {\n  FC,\n  PropsWithChildren,\n  ReactElement,\n  useLayoutEffect,\n  useRef\n} from 'react'\n\nimport Icon from '../../../component/view/icon'\nimport clsx from 'clsx'\nimport styles from './Dialog.module.less'\n\ninterface DialogParamsCallProps {\n  onCancel: () => void\n  onOk: (result: any) => void\n}\n\nexport interface DialogParams extends DialogParamsCallProps {\n  className?: string\n}\n\ninterface DialogProps {\n  title?: string\n  params: DialogParams\n  buttons?: Array<string | ReactElement>\n  className?: string\n  needMargin?: boolean\n  withDivider?: boolean\n  headerContent?: ReactElement\n  footerContent?: ReactElement\n  buttonsNameMap?: {\n    [key in string]: string\n  }\n  focusable?: boolean\n}\n\ninterface DialogCallProps {\n  result?: () => any\n  valid?: () => boolean\n}\n\ntype Props = DialogProps & DialogCallProps\n\nconst Dialog: FC<PropsWithChildren & Props> = (props) => {\n  const {\n    children,\n    title,\n    params,\n    result = () => null,\n    valid = () => !!result(),\n    buttons = ['OK'],\n    headerContent,\n    footerContent,\n    className,\n    buttonsNameMap,\n    needMargin = true,\n    withDivider = false,\n    focusable = true,\n    ...rest\n  } = props\n  const dialogRef = useRef<HTMLDivElement>(null)\n\n  useLayoutEffect(() => {\n    if (focusable) {\n      ;(dialogRef.current as HTMLElement).focus()\n    }\n\n    return () => {\n      ;(\n        dialogRef.current\n          ?.closest('.Ketcher-root')\n          ?.getElementsByClassName('cliparea')[0] as HTMLElement\n      ).focus()\n    }\n  }, [focusable])\n\n  const isButtonOk = (button) => {\n    return button === 'OK' || button === 'Save'\n  }\n\n  const exit = (mode) => {\n    const key = isButtonOk(mode) ? 'onOk' : 'onCancel'\n    if (params && key in params && (key !== 'onOk' || valid())) {\n      params[key](result())\n    }\n  }\n\n  const keyDown = (event) => {\n    const key = KN.keyName(event)\n    const active = document.activeElement\n    const activeTextarea = active && active.tagName === 'TEXTAREA'\n    if (key === 'Escape' || (key === 'Enter' && !activeTextarea)) {\n      exit(key === 'Enter' ? 'OK' : 'Cancel')\n      event.preventDefault()\n      event.stopPropagation()\n    }\n  }\n\n  return (\n    <div\n      ref={dialogRef}\n      role=\"dialog\"\n      onSubmit={(event) => event.preventDefault()}\n      onKeyDown={keyDown}\n      tabIndex={-1}\n      className={clsx(styles.dialog, className, params.className)}\n      {...rest}\n    >\n      <header\n        className={clsx(styles.header, withDivider && styles.withDivider)}\n      >\n        {headerContent || <span>{title}</span>}\n        <div className={styles.btnContainer}>\n          <button className={styles.buttonTop} onClick={() => exit('Cancel')}>\n            <Icon name={'close'} className={styles.closeButton} />\n          </button>\n        </div>\n      </header>\n      <div className={clsx(styles.body, needMargin && styles.withMargin)}>\n        {children}\n      </div>\n\n      {(footerContent || buttons.length > 0) && (\n        <footer className={styles.footer}>\n          {footerContent}\n          {buttons.length > 0 &&\n            buttons.map((button) =>\n              typeof button !== 'string' ? (\n                button\n              ) : (\n                <input\n                  key={button}\n                  type=\"button\"\n                  className={clsx(\n                    isButtonOk(button) ? styles.ok : styles.cancel,\n                    button === 'Save' && styles.save\n                  )}\n                  value={\n                    buttonsNameMap && buttonsNameMap[button]\n                      ? buttonsNameMap[button]\n                      : button\n                  }\n                  disabled={isButtonOk(button) && !valid()}\n                  onClick={() => exit(button)}\n                />\n              )\n            )}\n        </footer>\n      )}\n    </div>\n  )\n}\n\nexport default Dialog\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport styles from './LoadingCircles.module.less'\n\nexport const LoadingCircles = () => (\n  <div className={styles.container}>\n    <span />\n    <span />\n    <span />\n  </div>\n)\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Fragment, FunctionalGroup, Vec2, Scale } from 'ketcher-core'\n\nconst SELECTION_DISTANCE_COEFFICIENT = 0.4\nconst SELECTION_WITHIN_TEXT = 0\n\nconst findMaps = {\n  atoms: findClosestAtom,\n  bonds: findClosestBond,\n  enhancedFlags: findClosestEnhancedFlag,\n  sgroupData: findClosestDataSGroupData,\n  sgroups: findClosestSGroup,\n  functionalGroups: findClosestFG,\n  rxnArrows: findClosestRxnArrow,\n  rxnPluses: findClosestRxnPlus,\n  frags: findClosestFrag,\n  rgroups: findClosestRGroup,\n  simpleObjects: findClosestSimpleObject,\n  texts: findClosestText\n}\n\nfunction rectangleContainsPoint(startX, startY, width, height, x, y) {\n  return (\n    startX <= x && x <= startX + width && startY <= y && y <= startY + height\n  )\n}\n\nfunction findClosestText(restruct, cursorPosition) {\n  let minDist = null\n  let ret = null\n\n  restruct.texts.forEach((text, id) => {\n    const referencePoints = text.getReferencePoints(restruct)\n    const topX = referencePoints[0].x\n    const topY = referencePoints[0].y\n    const bottomX = referencePoints[2].x\n    const bottomY = referencePoints[2].y\n\n    const distances = []\n\n    if (cursorPosition.x >= topX && cursorPosition.x <= bottomX) {\n      if (cursorPosition.y < topY) {\n        distances.push(topY - cursorPosition.y)\n      } else if (cursorPosition.y > bottomY) {\n        distances.push(cursorPosition.y - bottomY)\n      } else {\n        distances.push(cursorPosition.y - topY, bottomY - cursorPosition.y)\n      }\n    }\n\n    if (cursorPosition.x < topX && cursorPosition.y < topY) {\n      distances.push(Vec2.dist(new Vec2(topX, topY), cursorPosition))\n    }\n\n    if (cursorPosition.x > bottomX && cursorPosition.y > bottomY) {\n      distances.push(Vec2.dist(new Vec2(bottomX, bottomY), cursorPosition))\n    }\n\n    if (cursorPosition.x < topX && cursorPosition.y > bottomY) {\n      distances.push(Vec2.dist(new Vec2(topX, bottomY), cursorPosition))\n    }\n\n    if (cursorPosition.x > bottomX && cursorPosition.y < topY) {\n      distances.push(Vec2.dist(new Vec2(bottomX, topY), cursorPosition))\n    }\n\n    if (cursorPosition.y >= topY && cursorPosition.y <= bottomY) {\n      if (cursorPosition.x < topX) {\n        distances.push(topX - cursorPosition.x)\n      } else if (cursorPosition.x > bottomX) {\n        distances.push(cursorPosition.x - bottomX)\n      } else {\n        distances.push(SELECTION_WITHIN_TEXT)\n      }\n    }\n\n    const dist = Math.min(...distances)\n\n    if (dist < SELECTION_DISTANCE_COEFFICIENT && (!ret || dist < minDist)) {\n      minDist = dist\n      ret = { id, dist: minDist }\n    }\n  })\n  return ret\n}\n\nfunction findClosestSimpleObject(restruct, pos) {\n  let minDist = null\n  let refPoint = null\n  let ret = null\n\n  restruct.simpleObjects.forEach((simpleObject, id) => {\n    const dist = simpleObject.calcDistance(pos, restruct.render.options.scale)\n\n    if (dist.minDist < 0.3 && (!ret || dist.minDist < minDist)) {\n      minDist = dist.minDist\n      refPoint = dist.refPoint\n\n      ret = { id, dist: minDist, ref: refPoint }\n    }\n  })\n  return ret\n}\n\nfunction findClosestAtom(restruct, pos, skip, minDist) {\n  let closestAtom = null\n  const maxMinDist = SELECTION_DISTANCE_COEFFICIENT\n  const skipId = skip && skip.map === 'atoms' ? skip.id : null\n  const sGroups = restruct.sgroups\n  const functionalGroups = restruct.molecule.functionalGroups\n\n  minDist = minDist || maxMinDist\n  minDist = Math.min(minDist, maxMinDist)\n\n  restruct.atoms.forEach((atom, aid) => {\n    if (\n      FunctionalGroup.isAtomInContractedFunctionalGroup(\n        atom.a,\n        sGroups,\n        functionalGroups,\n        true\n      )\n    ) {\n      return null\n    }\n    if (aid === skipId) return\n\n    const dist = Vec2.dist(pos, atom.a.pp)\n\n    if (dist < minDist) {\n      closestAtom = aid\n      minDist = dist\n    }\n  })\n\n  if (closestAtom !== null) {\n    return {\n      id: closestAtom,\n      dist: minDist\n    }\n  }\n\n  return null\n}\n\nfunction findClosestBond(restruct, pos, skip, minDist, scale) {\n  // eslint-disable-line max-params\n  let closestBond = null\n  let closestBondCenter = null\n  const maxMinDist = 0.8 * SELECTION_DISTANCE_COEFFICIENT\n  const skipId = skip && skip.map === 'bonds' ? skip.id : null\n  const sGroups = restruct.sgroups\n  const functionalGroups = restruct.molecule.functionalGroups\n\n  minDist = minDist || maxMinDist\n  minDist = Math.min(minDist, maxMinDist)\n\n  let minCDist = minDist\n\n  restruct.bonds.forEach((bond, bid) => {\n    if (bid === skipId) return\n\n    const a1 = restruct.atoms.get(bond.b.begin).a\n    const a2 = restruct.atoms.get(bond.b.end).a\n    if (\n      FunctionalGroup.isBondInContractedFunctionalGroup(\n        bond.b,\n        sGroups,\n        functionalGroups\n      )\n    )\n      return null\n\n    const mid = Vec2.lc2(a1.pp, 0.5, a2.pp, 0.5)\n    const cdist = Vec2.dist(pos, mid)\n\n    if (cdist < minCDist) {\n      minCDist = cdist\n      closestBondCenter = bid\n    }\n  })\n\n  restruct.bonds.forEach((bond, bid) => {\n    if (bid === skipId) return\n    if (\n      FunctionalGroup.isBondInContractedFunctionalGroup(\n        bond.b,\n        sGroups,\n        functionalGroups\n      )\n    )\n      return null\n\n    const hb = restruct.molecule.halfBonds.get(bond.b.hb1)\n    const dir = hb.dir\n    const norm = hb.norm\n\n    const p1 = restruct.atoms.get(bond.b.begin).a.pp\n    const p2 = restruct.atoms.get(bond.b.end).a.pp\n\n    const inStripe = Vec2.dot(pos.sub(p1), dir) * Vec2.dot(pos.sub(p2), dir) < 0\n\n    if (inStripe) {\n      const dist = Math.abs(Vec2.dot(pos.sub(p1), norm))\n\n      if (dist < minDist) {\n        closestBond = bid\n        minDist = dist\n      }\n    }\n  })\n\n  if (closestBondCenter !== null) {\n    return {\n      id: closestBondCenter,\n      dist: minCDist\n    }\n  }\n\n  if (\n    closestBond !== null &&\n    minDist > SELECTION_DISTANCE_COEFFICIENT * scale\n  ) {\n    return {\n      id: closestBond,\n      dist: minDist\n    }\n  }\n\n  return null\n}\n\nfunction findClosestEnhancedFlag(restruct, pos, skip, _minDist, options) {\n  let minDist\n  let ret = null\n  restruct.enhancedFlags.forEach((item, id) => {\n    const fragment = restruct.molecule.frags.get(id)\n\n    if (!fragment || !fragment.enhancedStereoFlag || !options.showStereoFlags)\n      return\n\n    const p = fragment.stereoFlagPosition\n      ? new Vec2(fragment.stereoFlagPosition.x, fragment.stereoFlagPosition.y)\n      : Fragment.getDefaultStereoFlagPosition(restruct.molecule, id)\n    if (!p || Math.abs(pos.x - p.x) >= 1.0) return\n\n    const dist = Math.abs(pos.y - p.y)\n\n    if (dist < 0.3 && (!ret || dist < minDist)) {\n      minDist = dist\n      ret = { id, dist: minDist }\n    }\n  })\n  return ret\n}\n\nfunction findClosestDataSGroupData(restruct, pos) {\n  let minDist = null\n  let ret = null\n\n  restruct.sgroupData.forEach((item, id) => {\n    if (item.sgroup.type !== 'DAT') throw new Error('Data group expected')\n\n    if (item.sgroup.data.fieldName !== 'MRV_IMPLICIT_H') {\n      const box = item.sgroup.dataArea\n      const inBox =\n        box.p0.y < pos.y &&\n        box.p1.y > pos.y &&\n        box.p0.x < pos.x &&\n        box.p1.x > pos.x\n      const xDist = Math.min(\n        Math.abs(box.p0.x - pos.x),\n        Math.abs(box.p1.x - pos.x)\n      )\n\n      if (inBox && (ret === null || xDist < minDist)) {\n        ret = { id, dist: xDist }\n        minDist = xDist\n      }\n    }\n  })\n\n  return ret\n}\n\nfunction findClosestFrag(restruct, pos, skip, minDist, scale) {\n  minDist = Math.min(\n    minDist || SELECTION_DISTANCE_COEFFICIENT,\n    SELECTION_DISTANCE_COEFFICIENT\n  )\n\n  const struct = restruct.molecule\n\n  const closestAtom = findClosestAtom(restruct, pos, skip, minDist)\n\n  if (closestAtom) {\n    return {\n      id: struct.atoms.get(closestAtom.id).fragment,\n      dist: closestAtom.dist\n    }\n  }\n\n  const closestBond = findClosestBond(restruct, pos, skip, minDist, scale)\n\n  if (closestBond) {\n    const atomId = struct.bonds.get(closestBond.id).begin\n    return {\n      id: struct.atoms.get(atomId).fragment,\n      dist: closestBond.dist\n    }\n  }\n\n  return null\n}\n\nfunction findClosestRGroup(restruct, pos, skip, minDist) {\n  minDist = Math.min(\n    minDist || SELECTION_DISTANCE_COEFFICIENT,\n    SELECTION_DISTANCE_COEFFICIENT\n  )\n\n  let ret = null\n\n  restruct.rgroups.forEach((rgroup, rgid) => {\n    if (\n      rgid !== skip &&\n      rgroup.labelBox &&\n      rgroup.labelBox.contains(pos, 0.5)\n    ) {\n      const dist = Vec2.dist(rgroup.labelBox.centre(), pos)\n\n      if (!ret || dist < minDist) {\n        minDist = dist\n        ret = { id: rgid, dist: minDist }\n      }\n    }\n  })\n\n  return ret\n}\n\nfunction findClosestRxnArrow(restruct, pos) {\n  let minDist = null\n  let refPoint = null\n  let ret = null\n\n  restruct.rxnArrows.forEach((rxnArrow, id) => {\n    const dist = rxnArrow.calcDistance(pos, restruct.render.options.scale)\n\n    if (dist.minDist < 0.3 && (!ret || dist.minDist < minDist)) {\n      minDist = dist.minDist\n      refPoint = dist.refPoint\n\n      ret = { id, dist: minDist, ref: refPoint }\n    }\n  })\n  return ret\n}\n\nfunction findClosestRxnPlus(restruct, pos) {\n  let minDist = null\n  let ret = null\n\n  restruct.rxnPluses.forEach((plus, id) => {\n    const p = plus.item.pp\n    const dist = Math.max(Math.abs(pos.x - p.x), Math.abs(pos.y - p.y))\n\n    if (dist < 0.3 && (!ret || dist < minDist)) {\n      minDist = dist\n      ret = { id, dist: minDist }\n    }\n  })\n\n  return ret\n}\n\nfunction findClosestSGroup(restruct, pos) {\n  let ret = null\n  let minDist = SELECTION_DISTANCE_COEFFICIENT\n\n  restruct.molecule.sgroups.forEach((sg, sgid) => {\n    if (sg.functionalGroup && !sg.expanded && sg.firstSgroupAtom) return null\n\n    const d = sg.bracketDir\n    const n = d.rotateSC(1, 0)\n    const pg = new Vec2(Vec2.dot(pos, d), Vec2.dot(pos, n))\n\n    sg.areas.forEach((box) => {\n      const inBox =\n        box.p0.y < pg.y && box.p1.y > pg.y && box.p0.x < pg.x && box.p1.x > pg.x\n      const xDist = Math.min(\n        Math.abs(box.p0.x - pg.x),\n        Math.abs(box.p1.x - pg.x)\n      )\n\n      if (inBox && (ret === null || xDist < minDist)) {\n        ret = sgid\n        minDist = xDist\n      }\n    })\n  })\n\n  if (ret !== null) {\n    return {\n      id: ret,\n      dist: minDist\n    }\n  }\n\n  return null\n}\n\nfunction findClosestFG(restruct, pos, skip) {\n  const sGroups = restruct.sgroups\n  const skipId = skip && skip.map === 'functionalGroups' ? skip.id : null\n  for (const [reSGroupId, reSGroup] of sGroups.entries()) {\n    if (reSGroupId === skipId) continue\n\n    const { startX, startY, width, height } =\n      reSGroup.getTextHighlightDimensions()\n    const { x, y } = Scale.obj2scaled(pos, restruct.render.options)\n    if (rectangleContainsPoint(startX, startY, width, height, x, y)) {\n      const centerX = startX + width / 2\n      const centerY = startY + height / 2\n      const rectangleCenter = new Vec2(centerX, centerY)\n      const cursorPosition = new Vec2(x, y)\n\n      const dist = Vec2.dist(rectangleCenter, cursorPosition)\n      const { id } = reSGroup.item\n      return { id, dist }\n    }\n  }\n  return null\n}\n\nfunction findClosestItem(restruct, pos, maps, skip, scale) {\n  // eslint-disable-line max-params\n  maps = maps || Object.keys(findMaps)\n\n  return maps.reduce((res, mp) => {\n    const minDist = res ? res.dist : null\n    const item = findMaps[mp](restruct, pos, skip, minDist, scale)\n\n    if (item !== null && (res === null || item.dist < res.dist)) {\n      const { id, dist, ...other } = item\n      return {\n        map: mp,\n        id: id,\n        dist: dist,\n        ...other\n      }\n    }\n\n    return res\n  }, null)\n}\n\n/**\n * @param restruct { ReStruct }\n * @param selected { object }\n * @param maps { Array<string> }\n * @param scale { number }\n * @return {{\n * \t\tatoms: Map<number, number>?\n * \t\tbonds: Map<number, number>?\n * }}\n */\nfunction findCloseMerge(restruct, selected, maps = ['atoms', 'bonds'], scale) {\n  const pos = {\n    atoms: new Map(), // aid -> position\n    bonds: new Map() // bid -> position\n  }\n\n  const struct = restruct.molecule\n\n  selected.atoms.forEach((aid) => {\n    pos.atoms.set(aid, struct.atoms.get(aid).pp)\n  })\n\n  selected.bonds.forEach((bid) => {\n    const bond = struct.bonds.get(bid)\n    pos.bonds.set(\n      bid,\n      Vec2.lc2(\n        struct.atoms.get(bond.begin).pp,\n        0.5,\n        struct.atoms.get(bond.end).pp,\n        0.5\n      )\n    )\n  })\n\n  const result = {}\n  maps.forEach((mp) => {\n    result[mp] = Array.from(pos[mp].keys()).reduce((res, srcId) => {\n      const skip = { map: mp, id: srcId }\n      const item = findMaps[mp](restruct, pos[mp].get(srcId), skip, null, scale)\n\n      if (item && !selected[mp].includes(item.id)) res.set(srcId, item.id)\n\n      return res\n    }, new Map())\n  })\n\n  return result\n}\n\nexport default {\n  atom: findClosestAtom, // used in Actions\n  item: findClosestItem,\n  merge: findCloseMerge\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { OperationType } from 'ketcher-core'\n\ntype Position = {\n  x: number\n  y: number\n}\n\ntype ArrowPosition = [Position, Position]\n\ntype Data = {\n  operation: any\n  id?: number\n  label?: string\n  position?: Position | ArrowPosition\n  attribute?: any\n  from?: any\n  to?: any\n  atomId?: any\n  fragId?: any\n  sGroupId?: any\n  type?: any\n  mode?: any\n}\n\nexport function customOnChangeHandler(action, handler) {\n  const data: Data[] = []\n\n  action.operations.reverse().forEach((operation) => {\n    const op = operation._inverted\n    switch (op.type) {\n      case OperationType.ATOM_ADD:\n      case OperationType.ATOM_DELETE:\n        data.push({\n          operation: op.type,\n          id: op.data.aid,\n          label: op.data.atom.label ? op.data.atom.label : '',\n          position: {\n            x: +op.data.pos.x.toFixed(2),\n            y: +op.data.pos.y.toFixed(2)\n          }\n        })\n        break\n\n      case OperationType.ATOM_ATTR:\n        data.push({\n          operation: operation.type,\n          id: operation.data.aid,\n          attribute: operation.data.attribute,\n          from: operation.data.value,\n          to: operation.data2.value\n        })\n        break\n\n      case OperationType.ATOM_MOVE:\n        data.push({\n          operation: op.type,\n          id: op.data.aid,\n          position: {\n            x: +op.data.d.x.toFixed(2),\n            y: +op.data.d.y.toFixed(2)\n          }\n        })\n        break\n\n      case OperationType.BOND_ADD:\n      case OperationType.BOND_DELETE:\n        data.push({\n          operation: op.type,\n          id: op.data.bid\n        })\n        break\n\n      case OperationType.FRAGMENT_ADD:\n      case OperationType.FRAGMENT_DELETE:\n        data.push({\n          operation: op.type,\n          id: op.frid\n        })\n        break\n\n      case OperationType.FRAGMENT_ADD_STEREO_ATOM:\n      case OperationType.FRAGMENT_DELETE_STEREO_ATOM:\n        data.push({\n          operation: op.type,\n          atomId: op.data.aid,\n          fragId: op.data.frid\n        })\n        break\n\n      case OperationType.S_GROUP_ATOM_ADD:\n      case OperationType.S_GROUP_ATOM_REMOVE:\n        data.push({\n          operation: op.type,\n          atomId: op.data.aid,\n          sGroupId: op.data.sgid\n        })\n        break\n\n      case OperationType.S_GROUP_CREATE:\n      case OperationType.S_GROUP_DELETE:\n        data.push({\n          operation: op.type,\n          type: op.data.type,\n          sGroupId: op.data.sgid\n        })\n        break\n\n      case OperationType.RXN_ARROW_ADD:\n      case OperationType.RXN_ARROW_DELETE:\n        data.push({\n          operation: op.type,\n          id: op.data.id,\n          mode: op.data.mode,\n          position: op.data.pos.map((pos) => ({\n            x: +pos.x.toFixed(2),\n            y: +pos.y.toFixed(2)\n          }))\n        })\n        break\n\n      case OperationType.RXN_ARROW_RESIZE:\n        data.push({\n          operation: op.type,\n          id: op.data.id\n        })\n        break\n\n      case OperationType.RXN_ARROW_MOVE:\n        data.push({\n          operation: op.type,\n          id: op.data.id,\n          position: {\n            x: +op.data.d.x.toFixed(2),\n            y: +op.data.d.y.toFixed(2)\n          }\n        })\n        break\n\n      case OperationType.R_GROUP_FRAGMENT:\n        data.push({\n          operation: operation.type,\n          id: op.frid\n        })\n        break\n\n      case OperationType.SIMPLE_OBJECT_ADD:\n      case OperationType.SIMPLE_OBJECT_DELETE:\n        data.push({\n          operation: op.type,\n          id: op.data.id,\n          mode: op.data.mode\n        })\n        break\n\n      case OperationType.SIMPLE_OBJECT_RESIZE:\n        data.push({\n          operation: op.type,\n          id: op.data.id\n        })\n        break\n\n      case OperationType.SIMPLE_OBJECT_MOVE:\n        data.push({\n          operation: operation.type,\n          id: operation.data.id,\n          position: {\n            x: +operation.data.d.x.toFixed(2),\n            y: +operation.data.d.y.toFixed(2)\n          }\n        })\n        break\n\n      default:\n        data.push({\n          operation: op.type\n        })\n    }\n  })\n\n  return handler(data)\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { fromHighlightCreate, fromHighlightClear } from 'ketcher-core'\nimport type { Struct } from 'ketcher-core'\n\nimport type { Editor } from './Editor'\n\ntype HighlightAttributes = {\n  atoms: number[]\n  bonds: number[]\n  color: string\n}\n\nexport class Highlighter {\n  editor: Editor\n\n  constructor(editor: Editor) {\n    this.editor = editor\n  }\n\n  getAll() {\n    const highlightsMap = this.editor.render.ctab.molecule.highlights\n    const highlightsArray = [...highlightsMap].map(([id, highlight]) => ({\n      id,\n      highlight\n    }))\n    return highlightsArray\n  }\n\n  create(...args: HighlightAttributes[]) {\n    const createdHighlights: HighlightAttributes[] = []\n\n    args.forEach((arg) => {\n      const { atoms, bonds, color } = arg\n      if (typeof color !== 'string') {\n        return\n      }\n\n      if (!atoms && !bonds) {\n        return\n      }\n\n      const restruct = this.editor.render.ctab\n\n      const { validAtoms, validBonds } = getValidInputOnly(\n        restruct.molecule,\n        atoms,\n        bonds\n      )\n\n      if (validAtoms.length === 0 && validBonds.length === 0) {\n        return\n      }\n\n      createdHighlights.push({ atoms: validAtoms, bonds: validBonds, color })\n    })\n    const action = fromHighlightCreate(\n      this.editor.render.ctab,\n      createdHighlights\n    )\n    this.editor.update(action)\n  }\n\n  clear() {\n    const action = fromHighlightClear(this.editor.render.ctab)\n    this.editor.update(action)\n  }\n\n  /*\n  // Update by ID\n  update(\n    id: number,\n    {\n      atoms,\n      bonds,\n      color\n    }: {\n      atoms?: number[]\n      bonds?: number[]\n      color: string\n    }\n  ) {\n    if (typeof color !== 'string' || typeof id !== 'number') {\n      return\n    }\n    if (!atoms && !bonds) {\n      return\n    }\n\n    const restruct = this.editor.render.ctab\n\n    const { validAtoms, validBonds } = getValidInputOnly(\n      restruct.molecule,\n      atoms,\n      bonds\n    )\n\n    if (validAtoms.length === 0 && validBonds.length === 0) {\n      return\n    }\n\n    const action = fromHighlightUpdate(\n      id,\n      this.editor.render.ctab,\n      validAtoms,\n      validBonds,\n      color\n    )\n    this.editor.update(action)\n  }\n\n  // Add items to highlight by id\n  append(\n    id: number,\n    {\n      atoms,\n      bonds,\n      color\n    }: {\n      atoms?: number[]\n      bonds?: number[]\n      color?: string\n    }\n  ) {\n    if (!atoms && !bonds && !color) {\n      return\n    }\n    const restruct = this.editor.render.ctab\n\n    const { validAtoms, validBonds } = getValidInputOnly(\n      restruct.molecule,\n      atoms,\n      bonds\n    )\n\n    if (validAtoms.length === 0 && validBonds.length === 0 && !color) {\n      return\n    }\n\n    const currentHighlight = restruct.molecule.highlights.get(id)\n\n    if (currentHighlight) {\n      const mergedHighlight = {\n        atoms: union(currentHighlight.atoms, validAtoms),\n        bonds: union(currentHighlight.bonds, validBonds),\n        color: color || currentHighlight.color\n      }\n\n      const action = fromHighlightUpdate(\n        id,\n        restruct,\n        mergedHighlight.atoms,\n        mergedHighlight.bonds,\n        mergedHighlight.color\n      )\n      this.editor.update(action)\n    }\n  }\n\n  // Delete by ID\n  delete(id: number) {\n    if (typeof id !== 'number') {\n      return\n    }\n\n    const action = fromHighlightDelete(this.editor.render.ctab, id)\n    this.editor.update(action)\n  }\n  */\n}\n\ntype ValidInput = {\n  validAtoms: number[]\n  validBonds: number[]\n}\n\nfunction getValidInputOnly(struct: Struct, atoms, bonds): ValidInput {\n  if (!Array.isArray(atoms)) {\n    atoms = []\n  }\n\n  if (!Array.isArray(bonds)) {\n    bonds = []\n  }\n\n  const { atoms: structAtoms, bonds: structBonds } = struct\n\n  // Filter out atom ids that are not in struct\n  if (atoms.length > 0) {\n    atoms = atoms.filter((aid) => structAtoms.has(aid))\n  }\n\n  // Filter out bond ids that are not in struct\n  if (bonds.length > 0) {\n    bonds = bonds.filter((bid) => structBonds.has(bid))\n  }\n\n  return {\n    validAtoms: atoms,\n    validBonds: bonds\n  }\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  Action,\n  Editor as KetcherEditor,\n  Pile,\n  Render,\n  Struct,\n  Vec2,\n  fromDescriptorsAlign,\n  fromNewCanvas\n} from 'ketcher-core'\nimport {\n  DOMSubscription,\n  PipelineSubscription,\n  Subscription\n} from 'subscription'\n\nimport closest from './shared/closest'\nimport { customOnChangeHandler } from './utils'\nimport { isEqual } from 'lodash/fp'\nimport toolMap from './tool'\nimport { Highlighter } from './highlighter'\nimport { showFunctionalGroupsTooltip } from './utils/functionalGroupsTooltip'\nimport { contextMenuInfo } from '../ui/views/components/ContextMenu/contextMenu.types'\n\nconst SCALE = 40\nconst HISTORY_SIZE = 32 // put me to options\nconst HOVER_ICON_OPACITY = 0.7\n\nconst structObjects = [\n  'atoms',\n  'bonds',\n  'frags',\n  'sgroups',\n  'sgroupData',\n  'rgroups',\n  'rxnArrows',\n  'rxnPluses',\n  'enhancedFlags',\n  'simpleObjects',\n  'texts'\n]\n\nconst highlightTargets = [\n  'atoms',\n  'bonds',\n  'rxnArrows',\n  'rxnPluses',\n  'functionalGroups',\n  'frags',\n  'merge',\n  'rgroups',\n  'sgroups',\n  'sgroupData',\n  'enhancedFlags',\n  'simpleObjects',\n  'texts'\n]\n\nfunction selectStereoFlagsIfNecessary(\n  atoms: any,\n  expAtoms: number[]\n): number[] {\n  const atomsOfFragments = {}\n  atoms.forEach((atom, atomId) => {\n    atomsOfFragments[atom.fragment]\n      ? atomsOfFragments[atom.fragment].push(atomId)\n      : (atomsOfFragments[atom.fragment] = [atomId])\n  })\n\n  const stereoFlags: number[] = []\n\n  Object.keys(atomsOfFragments).forEach((fragId) => {\n    let shouldSelSFlag = true\n    atomsOfFragments[fragId].forEach((atomId) => {\n      if (!expAtoms.includes(atomId)) shouldSelSFlag = false\n    })\n    shouldSelSFlag && stereoFlags.push(Number(fragId))\n  })\n  return stereoFlags\n}\n\nexport interface Selection {\n  atoms?: Array<number>\n  bonds?: Array<number>\n  enhancedFlags?: Array<number>\n  rxnPluses?: Array<number>\n  rxnArrows?: Array<number>\n}\n\nclass Editor implements KetcherEditor {\n  #origin?: any\n  render: Render\n  _selection: Selection | null\n  _tool: any\n  historyStack: any\n  historyPtr: any\n  errorHandler: ((message: string) => void) | null\n  highlights: Highlighter\n  hoverIcon: any\n  lastCursorPosition: { x: number; y: number }\n  contextMenu: contextMenuInfo\n  event: {\n    message: Subscription\n    elementEdit: PipelineSubscription\n    bondEdit: PipelineSubscription\n    rgroupEdit: PipelineSubscription\n    sgroupEdit: PipelineSubscription\n    sdataEdit: PipelineSubscription\n    quickEdit: PipelineSubscription\n    attachEdit: PipelineSubscription\n    removeFG: PipelineSubscription\n    change: Subscription\n    selectionChange: PipelineSubscription\n    aromatizeStruct: PipelineSubscription\n    dearomatizeStruct: PipelineSubscription\n    enhancedStereoEdit: PipelineSubscription\n    confirm: PipelineSubscription\n    showInfo: PipelineSubscription\n    apiSettings: PipelineSubscription\n    cursor: Subscription\n  }\n\n  lastEvent: any\n\n  constructor(clientArea, options) {\n    this.render = new Render(\n      clientArea,\n      Object.assign(\n        {\n          scale: SCALE\n        },\n        options\n      )\n    )\n\n    this._selection = null // eslint-disable-line\n    this._tool = null // eslint-disable-line\n    this.historyStack = []\n    this.historyPtr = 0\n    this.errorHandler = null\n    this.highlights = new Highlighter(this)\n    this.renderAndRecoordinateStruct =\n      this.renderAndRecoordinateStruct.bind(this)\n    this.setOptions = this.setOptions.bind(this)\n\n    this.lastCursorPosition = {\n      x: 0,\n      y: 0\n    }\n    this.createHoverIcon()\n    this.contextMenu = {}\n\n    this.event = {\n      message: new Subscription(),\n      elementEdit: new PipelineSubscription(),\n      bondEdit: new PipelineSubscription(),\n      rgroupEdit: new PipelineSubscription(),\n      sgroupEdit: new PipelineSubscription(),\n      sdataEdit: new PipelineSubscription(),\n      quickEdit: new PipelineSubscription(),\n      attachEdit: new PipelineSubscription(),\n      removeFG: new PipelineSubscription(),\n      change: new Subscription(),\n      selectionChange: new PipelineSubscription(),\n      aromatizeStruct: new PipelineSubscription(),\n      dearomatizeStruct: new PipelineSubscription(),\n      // TODO: correct\n      enhancedStereoEdit: new PipelineSubscription(),\n      confirm: new PipelineSubscription(),\n      cursor: new PipelineSubscription(),\n      showInfo: new PipelineSubscription(),\n      apiSettings: new PipelineSubscription()\n    }\n\n    domEventSetup(this, clientArea)\n  }\n\n  isDitrty(): boolean {\n    const position = this.historyPtr\n    const length = this.historyStack.length\n    if (!length || !this.#origin) {\n      return false\n    }\n    return !isEqual(this.historyStack[position - 1], this.#origin)\n  }\n\n  setOrigin(): void {\n    const position = this.historyPtr\n    this.#origin = position ? this.historyStack[position - 1] : null\n  }\n\n  tool(name?: any, opts?: any) {\n    /* eslint-disable no-underscore-dangle */\n    if (arguments.length === 0) {\n      return this._tool\n    }\n\n    if (this._tool && this._tool.cancel) {\n      this._tool.cancel()\n    }\n\n    const tool = new toolMap[name](this, opts)\n\n    const isAtomToolChosen = name === 'atom'\n    if (!isAtomToolChosen) {\n      this.hoverIcon.hide()\n    }\n\n    if (!tool || tool.isNotActiveTool) {\n      return null\n    }\n\n    this._tool = tool\n    return this._tool\n    /* eslint-enable no-underscore-dangle */\n  }\n\n  updateHoverIconPosition() {\n    const { x, y } = this.lastCursorPosition\n    const { height, width } = this.hoverIcon.getBBox()\n    this.hoverIcon.attr({\n      x: x - width / 2,\n      y: y - height / 2\n    })\n  }\n\n  createHoverIcon() {\n    this.hoverIcon = this.render.paper\n      .text(0, 0, '')\n      .attr('font-size', this.options().fontsz)\n      .attr('opacity', HOVER_ICON_OPACITY)\n\n    this.updateHoverIconPosition()\n  }\n\n  clear() {\n    this.struct(undefined)\n  }\n\n  renderAndRecoordinateStruct(struct: Struct) {\n    const action = fromNewCanvas(this.render.ctab, struct)\n    this.update(action)\n\n    const structCenter = getStructCenter(this.render.ctab)\n    recoordinate(this, structCenter)\n    return this.render.ctab.molecule\n  }\n\n  struct(value?: Struct): Struct {\n    if (arguments.length === 0) {\n      return this.render.ctab.molecule\n    }\n\n    this.selection(null)\n    const struct = value || new Struct()\n\n    const molecule = this.renderAndRecoordinateStruct(struct)\n\n    this.createHoverIcon()\n    return molecule\n  }\n\n  // this is used by API addFragment method\n  structToAddFragment(value: Struct): Struct {\n    const superStruct = value.mergeInto(this.render.ctab.molecule)\n\n    return this.renderAndRecoordinateStruct(superStruct)\n  }\n\n  setOptions(opts: string) {\n    const options = JSON.parse(opts)\n    this.event.apiSettings.dispatch({ ...this.options(), ...options })\n    return this.render.updateOptions(opts)\n  }\n\n  options(value?: any) {\n    if (arguments.length === 0) {\n      return this.render.options\n    }\n\n    const struct = this.render.ctab.molecule\n    const zoom = this.render.options.zoom\n    this.render.clientArea.innerHTML = ''\n\n    this.render = new Render(\n      this.render.clientArea,\n      Object.assign({ scale: SCALE }, value)\n    )\n    this.render.setMolecule(struct) // TODO: reuse this.struct here?\n    this.render.setZoom(zoom)\n    this.render.update()\n    return this.render.options\n  }\n\n  zoom(value?: any) {\n    if (arguments.length === 0) {\n      return this.render.options.zoom\n    }\n\n    this.render.setZoom(value)\n\n    const selection = this.selection()\n    const structCenter = getStructCenter(this.render.ctab, selection)\n    recoordinate(this, structCenter)\n\n    this.render.update()\n    return this.render.options.zoom\n  }\n\n  selection(ci?: any) {\n    if (arguments.length === 0) {\n      return this._selection // eslint-disable-line\n    }\n\n    let ReStruct = this.render.ctab\n\n    this._selection = null // eslint-disable-line\n    if (ci === 'all') {\n      // TODO: better way will be this.struct()\n      ci = structObjects.reduce((res, key) => {\n        res[key] = Array.from(ReStruct[key].keys())\n        return res\n      }, {})\n    }\n\n    if (ci === 'descriptors') {\n      ReStruct = this.render.ctab\n      ci = { sgroupData: Array.from(ReStruct.sgroupData.keys()) }\n    }\n\n    if (ci) {\n      const res: Selection = {}\n\n      Object.keys(ci).forEach((key) => {\n        if (ci[key].length > 0)\n          // TODO: deep merge\n          res[key] = ci[key].slice()\n      })\n\n      if (Object.keys(res).length !== 0) {\n        this._selection = res // eslint-disable-line\n      }\n      const stereoFlags = selectStereoFlagsIfNecessary(\n        this.struct().atoms,\n        this.explicitSelected().atoms\n      )\n      if (stereoFlags.length !== 0) {\n        this._selection && this._selection.enhancedFlags\n          ? (this._selection.enhancedFlags = Array.from(\n              new Set([...this._selection.enhancedFlags, ...stereoFlags])\n            ))\n          : (res.enhancedFlags = stereoFlags)\n      }\n    }\n\n    this.render.ctab.setSelection(this._selection) // eslint-disable-line\n    this.event.selectionChange.dispatch(this._selection) // eslint-disable-line\n\n    this.render.update()\n    return this._selection // eslint-disable-line\n  }\n\n  hover(ci: any, newTool?: any, event?: PointerEvent) {\n    const tool = newTool || this._tool // eslint-disable-line\n\n    if (\n      'ci' in tool &&\n      (!ci || tool.ci.map !== ci.map || tool.ci.id !== ci.id)\n    ) {\n      setHover(tool.ci, false, this.render)\n      delete tool.ci\n    }\n\n    if (ci && setHover(ci, true, this.render)) tool.ci = ci\n\n    if (!event) return\n\n    showFunctionalGroupsTooltip(this)\n  }\n\n  update(action: Action | true, ignoreHistory?: boolean) {\n    if (action === true) {\n      this.render.update(true) // force\n    } else {\n      if (!ignoreHistory && !action.isDummy()) {\n        this.historyStack.splice(this.historyPtr, HISTORY_SIZE + 1, action)\n        if (this.historyStack.length > HISTORY_SIZE) {\n          this.historyStack.shift()\n        }\n        this.historyPtr = this.historyStack.length\n        this.event.change.dispatch(action) // TODO: stoppable here\n      }\n      this.render.update()\n    }\n  }\n\n  historySize() {\n    return {\n      undo: this.historyPtr,\n      redo: this.historyStack.length - this.historyPtr\n    }\n  }\n\n  undo() {\n    if (this.historyPtr === 0) {\n      throw new Error('Undo stack is empty')\n    }\n    if (this.tool() && this.tool().cancel) {\n      this.tool().cancel()\n    }\n\n    this.selection(null)\n\n    if (this._tool instanceof toolMap.paste) {\n      this.event.change.dispatch()\n      return\n    }\n\n    this.historyPtr--\n    const stack = this.historyStack[this.historyPtr]\n    const action = stack.perform(this.render.ctab)\n\n    this.historyStack[this.historyPtr] = action\n    this.event.change.dispatch(action)\n    this.render.update()\n  }\n\n  redo() {\n    if (this.historyPtr === this.historyStack.length) {\n      throw new Error('Redo stack is empty')\n    }\n\n    if (this.tool() && this.tool().cancel) {\n      this.tool().cancel()\n    }\n\n    this.selection(null)\n    if (this._tool instanceof toolMap.paste) {\n      this.event.change.dispatch()\n      return\n    }\n\n    const action = this.historyStack[this.historyPtr].perform(this.render.ctab)\n    this.historyStack[this.historyPtr] = action\n    this.historyPtr++\n    this.event.change.dispatch(action)\n    this.render.update()\n  }\n\n  subscribe(eventName: any, handler: any) {\n    const subscriber = {\n      handler: handler\n    }\n\n    switch (eventName) {\n      case 'change':\n        const subscribeFuncWrapper = (action) =>\n          customOnChangeHandler(action, handler)\n        subscriber.handler = subscribeFuncWrapper\n        this.event[eventName].add(subscribeFuncWrapper)\n        break\n\n      default:\n        this.event[eventName].add(handler)\n    }\n\n    return subscriber\n  }\n\n  unsubscribe(eventName: any, subscriber: any) {\n    // Only for event type - subscription\n    this.event[eventName].remove(subscriber.handler)\n  }\n\n  findItem(event: any, maps: any, skip: any = null) {\n    const pos = new Vec2(this.render.page2obj(event))\n\n    return closest.item(this.render.ctab, pos, maps, skip, this.render.options)\n  }\n\n  findMerge(srcItems: any, maps: any) {\n    return closest.merge(this.render.ctab, srcItems, maps, this.render.options)\n  }\n\n  explicitSelected() {\n    const selection = this.selection() || {}\n    const res = structObjects.reduce((acc, key) => {\n      acc[key] = selection[key] ? selection[key].slice() : []\n      return acc\n    }, {} as any)\n\n    const struct = this.render.ctab.molecule\n\n    // \"auto-select\" the atoms for the bonds in selection\n    if (res.bonds) {\n      res.bonds.forEach((bid) => {\n        const bond = struct.bonds.get(bid)!\n        res.atoms = res.atoms || []\n        if (res.atoms.indexOf(bond.begin) < 0) {\n          res.atoms.push(bond.begin)\n        }\n\n        if (res.atoms.indexOf(bond.end) < 0) {\n          res.atoms.push(bond.end)\n        }\n      })\n    }\n\n    // \"auto-select\" the bonds with both atoms selected\n    if (res.atoms && res.bonds) {\n      struct.bonds.forEach((bond, bid) => {\n        if (\n          res.bonds.indexOf(bid) < 0 &&\n          res.atoms.indexOf(bond.begin) >= 0 &&\n          res.atoms.indexOf(bond.end) >= 0\n        ) {\n          res.bonds = res.bonds || []\n          res.bonds.push(bid)\n        }\n      })\n    }\n\n    return res\n  }\n\n  structSelected() {\n    const struct = this.render.ctab.molecule\n    const selection = this.explicitSelected()\n    const dst = struct.clone(\n      new Pile(selection.atoms),\n      new Pile(selection.bonds),\n      true,\n      null,\n      new Pile(selection.simpleObjects),\n      new Pile(selection.texts)\n    )\n\n    // Copy by its own as Struct.clone doesn't support\n    // arrows/pluses id sets\n    struct.rxnArrows.forEach((item, id) => {\n      if (selection.rxnArrows.indexOf(id) !== -1)\n        dst.rxnArrows.add(item.clone())\n    })\n    struct.rxnPluses.forEach((item, id) => {\n      if (selection.rxnPluses.indexOf(id) !== -1)\n        dst.rxnPluses.add(item.clone())\n    })\n\n    dst.isReaction = struct.isReaction && struct.isRxn()\n\n    return dst\n  }\n\n  alignDescriptors() {\n    this.selection(null)\n    const action = fromDescriptorsAlign(this.render.ctab)\n    this.update(action)\n    this.render.update(true)\n  }\n}\n\n/**\n * Main button pressed, usually the left button or the un-initialized state\n * See: https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/button\n */\nfunction isMouseMainButtonPressed(event: MouseEvent) {\n  return event.button === 0\n}\n\nfunction resetSelectionOnCanvasClick(\n  editor: Editor,\n  eventName: string,\n  clientArea: HTMLElement,\n  event\n) {\n  if (\n    eventName === 'mouseup' &&\n    editor.selection() &&\n    clientArea.contains(event.target)\n  ) {\n    editor.selection(null)\n  }\n}\n\nfunction updateLastCursorPosition(editor: Editor, event) {\n  const events = ['mousemove', 'click', 'mousedown', 'mouseup', 'mouseover']\n  if (events.includes(event.type)) {\n    editor.lastCursorPosition = {\n      x: event.layerX,\n      y: event.layerY\n    }\n  }\n}\n\nfunction isContextMenuClosed(editor: Editor) {\n  return !Object.values(editor.contextMenu).some(Boolean)\n}\n\nfunction useToolIfNeeded(\n  editor: Editor,\n  eventName: string,\n  clientArea: HTMLElement,\n  event\n) {\n  const EditorTool = editor.tool()\n  editor.lastEvent = event\n  const conditions = [\n    !!EditorTool,\n    eventName in EditorTool,\n    clientArea.contains(event.target) || EditorTool.isSelectionRunning?.(),\n    isContextMenuClosed(editor)\n  ]\n\n  if (conditions.every((condition) => condition)) {\n    EditorTool[eventName](event)\n    return true\n  }\n\n  return false\n}\n\nfunction domEventSetup(editor: Editor, clientArea: HTMLElement) {\n  // TODO: addEventListener('resize', ...);\n  ;[\n    { target: clientArea, eventName: 'click' },\n    { target: clientArea, eventName: 'dblclick' },\n    { target: clientArea, eventName: 'mousedown' },\n    { target: document, eventName: 'mousemove' },\n    { target: document, eventName: 'mouseup' },\n    { target: document, eventName: 'mouseleave' },\n    {\n      target: clientArea,\n      eventName: 'mouseleave',\n      toolEventName: 'mouseLeaveClientArea'\n    },\n    { target: clientArea, eventName: 'mouseover' }\n  ].forEach(({ target, eventName, toolEventName }) => {\n    editor.event[eventName] = new DOMSubscription()\n    const subs = editor.event[eventName]\n\n    target.addEventListener(eventName, subs.dispatch.bind(subs))\n\n    subs.add((event) => {\n      updateLastCursorPosition(editor, event)\n\n      if (\n        ['mouseup', 'mousedown', 'click', 'dbclick'].includes(event.type) &&\n        !isMouseMainButtonPressed(event)\n      ) {\n        return true\n      }\n\n      if (eventName !== 'mouseup' && eventName !== 'mouseleave') {\n        // to complete drag actions\n        if (!event.target || event.target.nodeName === 'DIV') {\n          // click on scroll\n          editor.hover(null)\n          return true\n        }\n      }\n\n      const isToolUsed = useToolIfNeeded(\n        editor,\n        toolEventName || eventName,\n        clientArea,\n        event\n      )\n      if (isToolUsed) {\n        return true\n      }\n\n      resetSelectionOnCanvasClick(editor, eventName, clientArea, event)\n\n      return true\n    }, -1)\n  })\n}\n\nfunction recoordinate(editor: Editor, rp?: Vec2 /* , vp */) {\n  // rp is a point in scaled coordinates, which will be positioned\n  // vp is the point where the reference point should now be (in view coordinates)\n  //    or the center if not set\n  console.assert(rp, 'Reference point not specified')\n  if (rp) {\n    editor.render.setScrollOffset(rp.x, rp.y)\n  } else {\n    editor.render.setScrollOffset(0, 0)\n  }\n}\n\nfunction getStructCenter(ReStruct, selection?) {\n  const bb = ReStruct.getVBoxObj(selection || {})\n  return Vec2.lc2(bb.p0, 0.5, bb.p1, 0.5)\n}\n\nexport { Editor }\nexport default Editor\n\nfunction setHover(ci: any, visible: any, render: any) {\n  if (highlightTargets.indexOf(ci.map) === -1) {\n    return false\n  }\n\n  let item: any = null\n\n  if (ci.map === 'merge') {\n    Object.keys(ci.items).forEach((mp) => {\n      ci.items[mp].forEach((dstId) => {\n        item = render.ctab[mp].get(dstId)!\n\n        if (item) {\n          item.setHover(visible, render)\n        }\n      })\n    })\n\n    return true\n  }\n\n  if (ci.map === 'functionalGroups') ci.map = 'sgroups' // TODO: Refactor object\n\n  item = (render.ctab[ci.map] as Map<any, any>).get(ci.id)\n  if (!item) {\n    return true // TODO: fix, attempt to highlight a deleted item\n  }\n\n  if (\n    (ci.map === 'sgroups' && item.item.type === 'DAT') ||\n    ci.map === 'sgroupData'\n  ) {\n    // set highlight for both the group and the data item\n    const item1 = render.ctab.sgroups.get(ci.id)\n    if (item1) {\n      item1.setHover(visible, render)\n    }\n\n    const item2 = render.ctab.sgroupData.get(ci.id)\n    if (item2) {\n      item2.setHover(visible, render)\n    }\n  } else {\n    item.setHover(visible, render)\n  }\n  return true\n}\n","import { useState, useEffect } from 'react'\n\nconst Cursor = ({ Icon, PressedIcon, enableHandTool }) => {\n  const [position, setPosition] = useState({\n    clientX: 50,\n    clientY: 50\n  })\n\n  const [mousedown, setMouseDown] = useState(false)\n\n  const updatePosition = (event) => {\n    const { pageX, pageY, clientX, clientY } = event\n\n    setPosition({\n      clientX,\n      clientY\n    })\n  }\n  const handleMouseDown = () => {\n    setMouseDown(true)\n  }\n  const handleMouseUp = () => {\n    setMouseDown(false)\n  }\n\n  const handleMouseOver = (event) => {\n    const { pageX, pageY, clientX, clientY } = event\n\n    setPosition({\n      clientX,\n      clientY\n    })\n  }\n  useEffect(() => {\n    document.addEventListener('mousemove', updatePosition, false)\n    document.addEventListener('mouseenter', updatePosition, false)\n    document.addEventListener('mousedown', handleMouseDown, false)\n    document.addEventListener('mouseup', handleMouseUp, false)\n\n    return () => {\n      document.removeEventListener('mousedown', handleMouseDown)\n      document.removeEventListener('mouseup', handleMouseUp)\n      document.removeEventListener('mousemove', updatePosition)\n      document.removeEventListener('mouseenter', updatePosition)\n    }\n  }, [])\n\n  if (!enableHandTool) return null\n\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        top: 0,\n        bottom: 0,\n        left: 0,\n        right: 0,\n        zIndex: 9999,\n        pointerEvents: 'none'\n      }}\n    >\n      {mousedown ? (\n        <PressedIcon\n          style={{\n            position: 'absolute',\n            left: position.clientX,\n            top: position.clientY\n          }}\n        />\n      ) : (\n        <Icon\n          style={{\n            position: 'absolute',\n            left: position.clientX,\n            top: position.clientY\n          }}\n        />\n      )}\n    </div>\n  )\n}\n\nexport default Cursor\n","import { FunctionalGroup } from 'ketcher-core'\nimport type { PredicateParams } from 'react-contexify'\n\nexport enum CONTEXT_MENU_ID {\n  FOR_BONDS = 'context-menu-for-bonds',\n  FOR_ATOMS = 'context-menu-for-atoms',\n  FOR_SELECTION = 'context-menu-for-selection',\n  FOR_FUNCTIONAL_GROUPS = 'context-menu-for-functional-groups'\n}\n\nexport type ItemData = unknown\n\nexport type ContextMenuShowProps = {\n  id: CONTEXT_MENU_ID\n  functionalGroups?: FunctionalGroup[]\n  bondIds?: number[]\n  atomIds?: number[]\n} | null\n\nexport type ItemEventParams = PredicateParams<ContextMenuShowProps, ItemData>\n\nexport type contextMenuInfo = {\n  [id in CONTEXT_MENU_ID]?: boolean\n}\n","import { useCallback } from 'react'\nimport { useAppContext } from 'src/hooks'\nimport Editor from 'src/script/editor'\nimport { mapAtomIdsToAtoms } from 'src/script/editor/tool/select'\nimport { updateSelectedAtoms } from 'src/script/ui/state/modal/atoms'\nimport { ItemEventParams } from '../contextMenu.types'\n\nconst useAtomEdit = () => {\n  const { getKetcherInstance } = useAppContext()\n\n  const handler = useCallback(\n    async ({ props }: ItemEventParams) => {\n      const editor = getKetcherInstance().editor as Editor\n      const molecule = editor.render.ctab\n      const atomIds = props?.atomIds || []\n      const atoms = mapAtomIdsToAtoms(atomIds, molecule)\n\n      const newAtom = editor.event.elementEdit.dispatch(atoms)\n\n      updateSelectedAtoms({\n        atoms: atomIds,\n        changeAtomPromise: newAtom,\n        editor\n      })\n    },\n    [getKetcherInstance]\n  )\n\n  const disabled = useCallback(({ props }: ItemEventParams) => {\n    const atomIds = props?.atomIds\n    if (Array.isArray(atomIds) && atomIds.length !== 0) {\n      return false\n    }\n\n    return true\n  }, [])\n\n  return [handler, disabled] as const\n}\n\nexport default useAtomEdit\n","import { difference } from 'lodash'\n\n/**\n * Remove the word `bond` out of the title\n *\n * @example\n * formatTitle('Single Bond') === 'Single'\n */\nexport const formatTitle = (title: string) => {\n  return title.slice(0, -5)\n}\n\n/**\n * Get bond names from default export of `src/script/ui/action/tools.js`\n *\n * @returns `['bond-single', 'bond-up', 'bond-down', 'bond-updown', 'bond-double',\n * 'bond-crossed', 'bond-triple', 'bond-aromatic', 'bond-any', 'bond-hydrogen',\n * 'bond-singledouble', 'bond-singlearomatic', 'bond-doublearomatic', 'bond-dative']`\n */\nexport const getBondNames = (tools) => {\n  return Object.keys(tools).filter((key) => key.startsWith('bond-'))\n}\n\nexport const queryBondNames = [\n  'bond-any',\n  'bond-aromatic',\n  'bond-singledouble',\n  'bond-singlearomatic',\n  'bond-doublearomatic'\n]\n\n/**\n * Get bond names except for query bonds\n *\n * @returns `['bond-single', 'bond-up', 'bond-down', 'bond-updown', 'bond-double',\n * 'bond-crossed', 'bond-triple', 'bond-aromatic', 'bond-hydrogen', 'bond-dative']`\n */\nexport const getNonQueryBondNames = (tools) => {\n  const allBondNames = getBondNames(tools)\n  return difference(allBondNames, queryBondNames)\n}\n\nexport const noOperation = () => null\n\nexport function onlyHasProperty<T extends object>(\n  checkedObject: T,\n  key: keyof T\n) {\n  const numberOfProps = Object.keys(checkedObject).length\n  return numberOfProps === 1 && key in checkedObject\n}\n","import { findStereoAtoms } from 'ketcher-core'\nimport { useCallback, useRef } from 'react'\nimport { useAppContext } from 'src/hooks'\nimport Editor from 'src/script/editor'\nimport EnhancedStereoTool from 'src/script/editor/tool/enhanced-stereo'\nimport { ItemEventParams } from '../contextMenu.types'\nimport { noOperation } from '../utils'\n\nconst useAtomStereo = () => {\n  const { getKetcherInstance } = useAppContext()\n  const stereoAtomIdsRef = useRef<number[] | undefined>()\n\n  const handler = useCallback(\n    async ({ props }: ItemEventParams) => {\n      if (!props || !stereoAtomIdsRef.current) {\n        return\n      }\n\n      const editor = getKetcherInstance().editor as Editor\n\n      try {\n        const action = await EnhancedStereoTool.changeAtomsStereoAction(\n          editor,\n          stereoAtomIdsRef.current\n        )\n\n        action && editor.update(action)\n      } catch (error) {\n        noOperation()\n      }\n    },\n    [getKetcherInstance]\n  )\n\n  const disabled = useCallback(\n    ({ props }: ItemEventParams) => {\n      const editor = getKetcherInstance().editor as Editor\n      const stereoAtomIds: undefined | number[] = findStereoAtoms(\n        editor.struct(),\n        props?.atomIds\n      )\n      stereoAtomIdsRef.current = stereoAtomIds\n\n      if (Array.isArray(stereoAtomIds) && stereoAtomIds.length !== 0) {\n        return false\n      }\n\n      return true\n    },\n    [getKetcherInstance]\n  )\n\n  return [handler, disabled] as const\n}\n\nexport default useAtomStereo\n","import { fromFragmentDeletion } from 'ketcher-core'\nimport { useCallback } from 'react'\nimport { useAppContext } from 'src/hooks'\nimport Editor from 'src/script/editor'\nimport { ItemEventParams } from '../contextMenu.types'\n\nconst useDelete = () => {\n  const { getKetcherInstance } = useAppContext()\n\n  const handler = useCallback(\n    async ({ props }: ItemEventParams) => {\n      const editor = getKetcherInstance().editor as Editor\n      const molecule = editor.render.ctab\n      const itemsToDelete = editor.selection() || {\n        bonds: props?.bondIds,\n        atoms: props?.atomIds\n      }\n\n      const action = fromFragmentDeletion(molecule, itemsToDelete)\n      editor.update(action)\n\n      editor.selection(null)\n    },\n    [getKetcherInstance]\n  )\n\n  return handler\n}\n\nexport default useDelete\n","import { Item } from 'react-contexify'\nimport useAtomEdit from '../hooks/useAtomEdit'\nimport useAtomStereo from '../hooks/useAtomStereo'\nimport useDelete from '../hooks/useDelete'\n\nconst AtomMenuItems: React.FC = (props) => {\n  const [handleEdit] = useAtomEdit()\n  const [handleStereo, stereoDisabled] = useAtomStereo()\n  const handleDelete = useDelete()\n\n  return (\n    <>\n      <Item {...props} onClick={handleEdit}>\n        Edit...\n      </Item>\n\n      <Item {...props} disabled={stereoDisabled} onClick={handleStereo}>\n        Enhanced stereochemistry...\n      </Item>\n\n      <Item {...props} onClick={handleDelete}>\n        Delete\n      </Item>\n    </>\n  )\n}\n\nexport default AtomMenuItems\n","import { fromBondsAttrs } from 'ketcher-core'\nimport { useCallback } from 'react'\nimport { useAppContext } from 'src/hooks'\nimport Editor from 'src/script/editor'\nimport { ItemEventParams } from '../contextMenu.types'\nimport { noOperation } from '../utils'\n\nconst useBondEdit = () => {\n  const { getKetcherInstance } = useAppContext()\n\n  const handler = useCallback(\n    async ({ props }: ItemEventParams) => {\n      const editor = getKetcherInstance().editor as Editor\n      const bondIds = props?.bondIds || []\n      const bond = editor.render.ctab.bonds.get(bondIds[0])?.b\n      try {\n        const newBond = await editor.event.bondEdit.dispatch(bond)\n        editor.update(fromBondsAttrs(editor.render.ctab, bondIds, newBond))\n      } catch (error) {\n        noOperation()\n      }\n    },\n    [getKetcherInstance]\n  )\n\n  const disabled = useCallback(({ props }: ItemEventParams) => {\n    const selectedBondIds = props?.bondIds\n    if (Array.isArray(selectedBondIds) && selectedBondIds.length !== 0) {\n      return false\n    }\n\n    return true\n  }, [])\n\n  return [handler, disabled] as const\n}\n\nexport default useBondEdit\n","import { ReStruct } from 'ketcher-core'\nimport { useCallback } from 'react'\nimport { useAppContext } from 'src/hooks'\nimport Editor from 'src/script/editor'\nimport SGroupTool from 'src/script/editor/tool/sgroup'\nimport { ItemEventParams } from '../contextMenu.types'\n\nconst useBondSGroupAttach = () => {\n  const { getKetcherInstance } = useAppContext()\n\n  const handler = useCallback(\n    ({ props }: ItemEventParams) => {\n      const editor = getKetcherInstance().editor as Editor\n      const struct: ReStruct = editor.render.ctab\n      const bondId = props!.bondIds![0]\n      const bond = struct.bonds.get(bondId)!\n\n      const selection = {\n        atoms: [bond?.b.begin, bond?.b.end],\n        bonds: [bondId]\n      }\n\n      editor.selection(selection)\n      SGroupTool.sgroupDialog(editor, null)\n    },\n    [getKetcherInstance]\n  )\n\n  const hidden = useCallback(\n    ({ props }: ItemEventParams) => {\n      const editor = getKetcherInstance().editor as Editor\n      const struct: ReStruct = editor.render.ctab\n      const bondIds = props!.bondIds!\n\n      if (bondIds.length > 1) {\n        return true\n      }\n\n      const bond = struct.bonds.get(bondIds[0])!\n      const attachedSGroups = bond.b.getAttachedSGroups(struct.molecule)\n\n      return attachedSGroups.size > 0\n    },\n    [getKetcherInstance]\n  )\n\n  return [handler, hidden] as const\n}\n\nexport default useBondSGroupAttach\n","import { Pile, ReStruct } from 'ketcher-core'\nimport { useCallback, useRef } from 'react'\nimport { useAppContext } from 'src/hooks'\nimport Editor from 'src/script/editor'\nimport SGroupTool from 'src/script/editor/tool/sgroup'\nimport { ItemEventParams } from '../contextMenu.types'\n\nconst useBondSGroupEdit = () => {\n  const { getKetcherInstance } = useAppContext()\n  const sGroupsRef = useRef(new Pile<number>())\n\n  const handler = useCallback(() => {\n    const editor = getKetcherInstance().editor as Editor\n    const sGroups = Array.from(sGroupsRef.current)\n    SGroupTool.sgroupDialog(editor, sGroups[0])\n  }, [getKetcherInstance])\n\n  // In react-contexify, `disabled` is executed before `hidden`\n  const disabled = useCallback(\n    ({ props }: ItemEventParams) => {\n      const editor = getKetcherInstance().editor as Editor\n      const struct: ReStruct = editor.render.ctab\n      const bondIds = props!.bondIds!\n\n      if (bondIds.length > 1) {\n        return true\n      }\n\n      const bond = struct.bonds.get(bondIds[0])!\n      sGroupsRef.current = bond.b.getAttachedSGroups(struct.molecule)\n\n      return sGroupsRef.current.size > 1\n    },\n    [getKetcherInstance]\n  )\n\n  const hidden = useCallback(() => {\n    return sGroupsRef.current.size === 0\n  }, [])\n\n  return [handler, disabled, hidden] as const\n}\n\nexport default useBondSGroupEdit\n","import { fromBondsAttrs } from 'ketcher-core'\nimport { useCallback } from 'react'\nimport { useAppContext } from 'src/hooks'\nimport Editor from 'src/script/editor'\nimport tools from 'src/script/ui/action/tools'\nimport { ItemEventParams } from '../contextMenu.types'\n\nconst useBondTypeChange = () => {\n  const { getKetcherInstance } = useAppContext()\n\n  const handler = useCallback(\n    ({ id, props }: ItemEventParams) => {\n      const editor = getKetcherInstance().editor as Editor\n      const molecule = editor.render.ctab\n      const bondIds = props?.bondIds || []\n      const bondProps = tools[id].action.opts\n\n      editor.update(fromBondsAttrs(molecule, bondIds, bondProps))\n    },\n    [getKetcherInstance]\n  )\n\n  const disabled = useCallback(({ props }: ItemEventParams) => {\n    const selectedBondIds = props?.bondIds\n    if (Array.isArray(selectedBondIds) && selectedBondIds.length !== 0) {\n      return false\n    }\n\n    return true\n  }, [])\n\n  return [handler, disabled] as const\n}\n\nexport default useBondTypeChange\n","import { Item, Submenu } from 'react-contexify'\nimport tools from 'src/script/ui/action/tools'\nimport Icon from 'src/script/ui/component/view/icon'\nimport styles from '../ContextMenu.module.less'\nimport useBondEdit from '../hooks/useBondEdit'\nimport useBondSGroupAttach from '../hooks/useBondSGroupAttach'\nimport useBondSGroupEdit from '../hooks/useBondSGroupEdit'\nimport useBondTypeChange from '../hooks/useBondTypeChange'\nimport useDelete from '../hooks/useDelete'\nimport { formatTitle, getNonQueryBondNames, queryBondNames } from '../utils'\n\nconst nonQueryBondNames = getNonQueryBondNames(tools)\n\nconst BondMenuItems: React.FC = (props) => {\n  const [handleEdit] = useBondEdit()\n  const [handleTypeChange] = useBondTypeChange()\n  const [handleSGroupAttach, sGroupAttachHidden] = useBondSGroupAttach()\n  const [handleSGroupEdit, sGroupEditDisabled, sGroupEditHidden] =\n    useBondSGroupEdit()\n  const handleDelete = useDelete()\n\n  return (\n    <>\n      <Item {...props} onClick={handleEdit}>\n        Edit...\n      </Item>\n\n      {nonQueryBondNames.map((name) => (\n        <Item {...props} id={name} onClick={handleTypeChange} key={name}>\n          <Icon name={name} className={styles.icon} />\n          <span>{formatTitle(tools[name].title)}</span>\n        </Item>\n      ))}\n\n      <Submenu {...props} label=\"Query bonds\" className={styles.subMenu}>\n        {queryBondNames.map((name) => (\n          <Item id={name} onClick={handleTypeChange} key={name}>\n            <Icon name={name} className={styles.icon} />\n            <span>{formatTitle(tools[name].title)}</span>\n          </Item>\n        ))}\n      </Submenu>\n\n      <Item {...props} hidden={sGroupAttachHidden} onClick={handleSGroupAttach}>\n        Attach S-Group...\n      </Item>\n\n      <Item\n        {...props}\n        hidden={sGroupEditHidden}\n        disabled={sGroupEditDisabled}\n        onClick={handleSGroupEdit}\n      >\n        Edit S-Group...\n      </Item>\n\n      <Item {...props} onClick={handleDelete}>\n        Delete\n      </Item>\n    </>\n  )\n}\n\nexport default BondMenuItems\n","import { Action, setExpandSGroup } from 'ketcher-core'\nimport { useCallback } from 'react'\nimport { useDispatch } from 'react-redux'\nimport { useAppContext } from 'src/hooks'\nimport Editor from 'src/script/editor'\nimport { highlightFG } from 'src/script/ui/state/functionalGroups'\nimport { ItemEventParams } from '../contextMenu.types'\n\n/**\n * Fullname: useFunctionalGroupExpandOrContract\n */\nconst useFunctionalGroupEoc = () => {\n  const { getKetcherInstance } = useAppContext()\n  const dispatch = useDispatch()\n\n  const handler = useCallback(\n    ({ props }: ItemEventParams, toExpand: boolean) => {\n      const editor = getKetcherInstance().editor as Editor\n      const molecule = editor.render.ctab\n      const selectedFunctionalGroups = props?.functionalGroups\n      const action = new Action()\n\n      selectedFunctionalGroups?.forEach((functionalGroup) => {\n        action.mergeWith(\n          setExpandSGroup(molecule, functionalGroup.relatedSGroupId, {\n            expanded: toExpand\n          })\n        )\n      })\n\n      editor.update(action)\n      highlightFG(dispatch, { group: null, id: null })\n    },\n    [dispatch, getKetcherInstance]\n  )\n\n  const hidden = useCallback(\n    ({ props }: ItemEventParams, toExpand: boolean) => {\n      return Boolean(\n        props?.functionalGroups?.every((functionalGroup) =>\n          toExpand ? functionalGroup.isExpanded : !functionalGroup.isExpanded\n        )\n      )\n    },\n    []\n  )\n\n  return [handler, hidden] as const\n}\n\nexport default useFunctionalGroupEoc\n","import { Action, fromSgroupDeletion } from 'ketcher-core'\nimport { useCallback } from 'react'\nimport { useDispatch } from 'react-redux'\nimport { useAppContext } from 'src/hooks'\nimport Editor from 'src/script/editor'\nimport { highlightFG } from 'src/script/ui/state/functionalGroups'\nimport { ItemEventParams } from '../contextMenu.types'\n\nconst useFunctionalGroupRemove = () => {\n  const { getKetcherInstance } = useAppContext()\n  const dispatch = useDispatch()\n\n  const handler = useCallback(\n    ({ props }: ItemEventParams) => {\n      const editor = getKetcherInstance().editor as Editor\n      const selectedFunctionalGroups = props?.functionalGroups\n      const action = new Action()\n\n      selectedFunctionalGroups?.forEach((functionalGroup) => {\n        action.mergeWith(\n          fromSgroupDeletion(\n            editor.render.ctab,\n            functionalGroup.relatedSGroupId\n          )\n        )\n      })\n\n      editor.update(action)\n      highlightFG(dispatch, { group: null, id: null })\n    },\n    [dispatch, getKetcherInstance]\n  )\n\n  return handler\n}\n\nexport default useFunctionalGroupRemove\n","import { Item } from 'react-contexify'\nimport useFunctionalGroupEoc from '../hooks/useFunctionalGroupEoc'\nimport useFunctionalGroupRemove from '../hooks/useFunctionalGroupRemove'\n\nconst FunctionalGroupMenuItems: React.FC = (props) => {\n  const [handleExpandOrContract, ExpandOrContractHidden] =\n    useFunctionalGroupEoc()\n  const handleRemove = useFunctionalGroupRemove()\n\n  return (\n    <>\n      <Item\n        {...props}\n        hidden={(params) => ExpandOrContractHidden(params, true)}\n        onClick={(params) => handleExpandOrContract(params, true)}\n      >\n        Expand Abbreviation\n      </Item>\n      <Item\n        {...props}\n        hidden={(params) => ExpandOrContractHidden(params, false)}\n        onClick={(params) => handleExpandOrContract(params, false)}\n      >\n        Contract Abbreviation\n      </Item>\n      <Item {...props} onClick={handleRemove}>\n        Remove Abbreviation\n      </Item>\n    </>\n  )\n}\n\nexport default FunctionalGroupMenuItems\n","import { Item, Submenu } from 'react-contexify'\nimport tools from 'src/script/ui/action/tools'\nimport Icon from 'src/script/ui/component/view/icon'\nimport styles from '../ContextMenu.module.less'\nimport useAtomEdit from '../hooks/useAtomEdit'\nimport useAtomStereo from '../hooks/useAtomStereo'\nimport useBondEdit from '../hooks/useBondEdit'\nimport useBondTypeChange from '../hooks/useBondTypeChange'\nimport useDelete from '../hooks/useDelete'\nimport { formatTitle, getBondNames } from '../utils'\n\nconst bondNames = getBondNames(tools)\n\nconst SelectionMenuItems: React.FC = (props) => {\n  const [handleBondEdit, bondEditDisabled] = useBondEdit()\n  const [handleAtomEdit, atomEditDisabled] = useAtomEdit()\n  const [handleTypeChange, bondTypeChangeDisabled] = useBondTypeChange()\n  const [handleAtomStereo, atomStereoDisabled] = useAtomStereo()\n  const handleDelete = useDelete()\n\n  return (\n    <>\n      <Item {...props} disabled={bondEditDisabled} onClick={handleBondEdit}>\n        Edit selected bond(s)...\n      </Item>\n\n      <Item {...props} disabled={atomEditDisabled} onClick={handleAtomEdit}>\n        Edit selected atom(s)...\n      </Item>\n\n      <Submenu\n        {...props}\n        label=\"Bond type\"\n        disabled={bondTypeChangeDisabled}\n        className={styles.subMenu}\n      >\n        {bondNames.map((name) => (\n          <Item id={name} onClick={handleTypeChange} key={name}>\n            <Icon name={name} className={styles.icon} />\n            <span>{formatTitle(tools[name].title)}</span>\n          </Item>\n        ))}\n      </Submenu>\n\n      <Item {...props} disabled={atomStereoDisabled} onClick={handleAtomStereo}>\n        Enhanced stereochemistry...\n      </Item>\n\n      <Item {...props} onClick={handleDelete}>\n        Delete\n      </Item>\n    </>\n  )\n}\n\nexport default SelectionMenuItems\n","/****************************************************************************\n * Copyright 2022 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { useCallback } from 'react'\nimport { Menu, MenuProps } from 'react-contexify'\nimport 'react-contexify/ReactContexify.css'\nimport { useAppContext } from 'src/hooks'\nimport Editor from 'src/script/editor'\nimport styles from './ContextMenu.module.less'\nimport { CONTEXT_MENU_ID } from './contextMenu.types'\nimport AtomMenuItems from './menuItems/AtomMenuItems'\nimport BondMenuItems from './menuItems/BondMenuItems'\nimport FunctionalGroupMenuItems from './menuItems/FunctionalGroupMenuItems'\nimport SelectionMenuItems from './menuItems/SelectionMenuItems'\n\nconst props: Partial<MenuProps> = {\n  animation: false,\n  className: styles.contextMenu\n}\n\nconst ContextMenu: React.FC = () => {\n  const { getKetcherInstance } = useAppContext()\n\n  const trackVisibility = useCallback(\n    (id: CONTEXT_MENU_ID, visible: boolean) => {\n      const editor = getKetcherInstance().editor as Editor\n      if (visible) {\n        editor.hoverIcon.hide()\n      }\n      editor.contextMenu[id] = visible\n    },\n    [getKetcherInstance]\n  )\n\n  return (\n    <>\n      <Menu\n        {...props}\n        id={CONTEXT_MENU_ID.FOR_BONDS}\n        onVisibilityChange={(visible) =>\n          trackVisibility(CONTEXT_MENU_ID.FOR_BONDS, visible)\n        }\n      >\n        <BondMenuItems />\n      </Menu>\n\n      <Menu\n        {...props}\n        id={CONTEXT_MENU_ID.FOR_ATOMS}\n        onVisibilityChange={(visible) =>\n          trackVisibility(CONTEXT_MENU_ID.FOR_ATOMS, visible)\n        }\n      >\n        <AtomMenuItems />\n      </Menu>\n\n      <Menu\n        {...props}\n        id={CONTEXT_MENU_ID.FOR_SELECTION}\n        onVisibilityChange={(visible) =>\n          trackVisibility(CONTEXT_MENU_ID.FOR_SELECTION, visible)\n        }\n      >\n        <SelectionMenuItems />\n      </Menu>\n\n      <Menu\n        {...props}\n        id={CONTEXT_MENU_ID.FOR_FUNCTIONAL_GROUPS}\n        onVisibilityChange={(visible) =>\n          trackVisibility(CONTEXT_MENU_ID.FOR_FUNCTIONAL_GROUPS, visible)\n        }\n      >\n        <FunctionalGroupMenuItems />\n      </Menu>\n    </>\n  )\n}\n\nexport default ContextMenu\n","/****************************************************************************\n * Copyright 2022 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { FunctionalGroup } from 'ketcher-core'\nimport { PropsWithChildren, useCallback } from 'react'\nimport { useContextMenu } from 'react-contexify'\nimport { useAppContext } from 'src/hooks'\nimport Editor from 'src/script/editor'\nimport { ContextMenuShowProps, CONTEXT_MENU_ID } from './contextMenu.types'\nimport { onlyHasProperty } from './utils'\n\nconst ContextMenuTrigger: React.FC<PropsWithChildren> = ({ children }) => {\n  const { getKetcherInstance } = useAppContext()\n  const { show } = useContextMenu<ContextMenuShowProps>()\n\n  const getSelectedFunctionalGroups = useCallback(() => {\n    const editor = getKetcherInstance().editor as Editor\n    const struct = editor.struct()\n    const selectedAtomIds = editor.selection()?.atoms\n    // Map could do deduplication\n    const selectedFunctionalGroups = new Map<number, FunctionalGroup>()\n\n    selectedAtomIds?.forEach((atomId) => {\n      const functionalGroup = FunctionalGroup.findFunctionalGroupByAtom(\n        struct.functionalGroups,\n        atomId,\n        true\n      )\n\n      functionalGroup !== null &&\n        selectedFunctionalGroups.set(\n          functionalGroup.relatedSGroupId,\n          functionalGroup\n        )\n    })\n\n    return selectedFunctionalGroups\n  }, [getKetcherInstance])\n\n  const handleDisplay = useCallback<React.MouseEventHandler<HTMLDivElement>>(\n    (event) => {\n      event.preventDefault()\n\n      const editor = getKetcherInstance().editor as Editor\n      const closestItem = editor.findItem(event, null)\n      const selection = editor.selection()\n      const functionalGroupsInSelection = getSelectedFunctionalGroups()\n\n      let showProps: ContextMenuShowProps = null\n\n      if (selection) {\n        if (functionalGroupsInSelection.size > 0) {\n          const functionalGroups = Array.from(\n            functionalGroupsInSelection.values()\n          )\n          showProps = {\n            id: CONTEXT_MENU_ID.FOR_FUNCTIONAL_GROUPS,\n            functionalGroups\n          }\n        } else if (onlyHasProperty(selection, 'bonds')) {\n          showProps = {\n            id: CONTEXT_MENU_ID.FOR_BONDS,\n            bondIds: selection.bonds\n          }\n        } else if (onlyHasProperty(selection, 'atoms')) {\n          showProps = {\n            id: CONTEXT_MENU_ID.FOR_ATOMS,\n            atomIds: selection.atoms\n          }\n        } else {\n          showProps = {\n            id: CONTEXT_MENU_ID.FOR_SELECTION,\n            bondIds: selection.bonds,\n            atomIds: selection.atoms\n          }\n        }\n      } else if (closestItem) {\n        const struct = editor.struct()\n\n        switch (closestItem.map) {\n          case 'bonds':\n            {\n              const functionalGroup = FunctionalGroup.findFunctionalGroupByBond(\n                struct,\n                struct.functionalGroups,\n                closestItem.id,\n                true\n              )\n\n              showProps =\n                functionalGroup === null\n                  ? {\n                      id: CONTEXT_MENU_ID.FOR_BONDS,\n                      bondIds: [closestItem.id]\n                    }\n                  : {\n                      id: CONTEXT_MENU_ID.FOR_FUNCTIONAL_GROUPS,\n                      functionalGroups: [functionalGroup]\n                    }\n            }\n            break\n\n          case 'atoms': {\n            const functionalGroup = FunctionalGroup.findFunctionalGroupByAtom(\n              struct.functionalGroups,\n              closestItem.id,\n              true\n            )\n\n            showProps =\n              functionalGroup === null\n                ? {\n                    id: CONTEXT_MENU_ID.FOR_ATOMS,\n                    atomIds: [closestItem.id]\n                  }\n                : {\n                    id: CONTEXT_MENU_ID.FOR_FUNCTIONAL_GROUPS,\n                    functionalGroups: [functionalGroup]\n                  }\n            break\n          }\n\n          case 'sgroups':\n          case 'functionalGroups': {\n            const sGroup = struct.sgroups.get(closestItem.id)\n            const functionalGroup = FunctionalGroup.findFunctionalGroupBySGroup(\n              struct.functionalGroups,\n              sGroup\n            )\n\n            showProps = functionalGroup\n              ? {\n                  id: CONTEXT_MENU_ID.FOR_FUNCTIONAL_GROUPS,\n                  functionalGroups: [functionalGroup]\n                }\n              : null\n            break\n          }\n        }\n      }\n\n      showProps &&\n        show({\n          id: showProps.id,\n          event,\n          props: showProps\n        })\n    },\n    [getKetcherInstance, getSelectedFunctionalGroups, show]\n  )\n\n  return (\n    <div style={{ height: '100%' }} onContextMenu={handleDisplay}>\n      {children}\n    </div>\n  )\n}\n\nexport default ContextMenuTrigger\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Component, ComponentType, createRef } from 'react'\nimport { MolSerializer, Struct } from 'ketcher-core'\nimport { RenderStruct } from '../utils'\ninterface StructRenderProps {\n  struct: Struct\n  options: any\n  id?: any\n  Tag?: string | ComponentType<any>\n}\n\nclass StructRender extends Component<StructRenderProps> {\n  tagRef: React.RefObject<HTMLElement>\n  constructor(props) {\n    super(props)\n    this.tagRef = createRef()\n  }\n\n  shouldComponentUpdate(previousProps) {\n    return Boolean(this.props.id && this.props.id !== previousProps.id)\n  }\n\n  update() {\n    const el = this.tagRef.current\n    const { struct, options } = this.props\n    let parsedStruct: Struct | null\n    if (!(struct instanceof Struct)) {\n      try {\n        const molSerialzer = new MolSerializer()\n        parsedStruct = molSerialzer.deserialize(struct)\n      } catch (e) {\n        // TODO: add error handler call\n        // legacy message: Could not parse structure\n        parsedStruct = null\n      }\n    } else {\n      parsedStruct = struct\n    }\n    el?.childNodes.forEach((node) => {\n      node.remove()\n    })\n    RenderStruct.render(el, parsedStruct, options)\n  }\n\n  componentDidMount() {\n    this.update()\n  }\n\n  componentDidUpdate() {\n    this.update()\n  }\n\n  render() {\n    const { struct, Tag = 'div', ...props } = this.props\n    return (\n      <Tag ref={this.tagRef} /* ref=\"el\" */ {...props}>\n        {struct ? null : 'No molecule'}\n      </Tag>\n    )\n  }\n}\n\nexport default StructRender\n","import { Render, Point } from 'ketcher-core'\n\nconst X_COORD_INDEX = 0\nconst Y_COORD_INDEX = 1\n\nexport const calculateMiddleCoordsForRect = (\n  rectCoords: Array<Array<number>>\n): Array<Point> | [] => {\n  if (!rectCoords) {\n    return []\n  }\n\n  const middleCoordForRectangleSides: Array<Point> = []\n\n  const previousPoint: Point = {\n    x: rectCoords[0][X_COORD_INDEX],\n    y: rectCoords[0][Y_COORD_INDEX]\n  }\n\n  for (let i = 1; i < rectCoords.length; i++) {\n    if (!previousPoint.x || !previousPoint.y) {\n      return []\n    }\n\n    const middleX = (previousPoint.x + rectCoords[i][X_COORD_INDEX]) / 2\n    const middleY = (previousPoint.y + rectCoords[i][Y_COORD_INDEX]) / 2\n    middleCoordForRectangleSides.push({ x: middleX, y: middleY })\n    previousPoint.x = rectCoords[i][X_COORD_INDEX]\n    previousPoint.y = rectCoords[i][Y_COORD_INDEX]\n  }\n\n  return middleCoordForRectangleSides\n}\n\nexport const calculateScrollOffsetX = (render: Render) => {\n  return render?.options.offset?.x - render?.clientArea?.scrollLeft\n}\n\nexport const calculateScrollOffsetY = (render: Render) => {\n  return render?.options?.offset?.y - render?.clientArea?.scrollTop\n}\n","import { useEffect, useRef, useState, FC } from 'react'\nimport { Vec2, Render, SGroup, Struct } from 'ketcher-core'\nimport clsx from 'clsx'\nimport classes from './InfoPanel.module.less'\nimport {\n  calculateMiddleCoordsForRect,\n  calculateScrollOffsetX,\n  calculateScrollOffsetY\n} from './helpers'\n\nconst BAR_PANEL_SIZE = 32\nconst LEFT_PADDING_MULTIPLIER = 3\n\nfunction getPanelPositionRelativeToRect(\n  clientX: number,\n  clientY: number,\n  sGroup: SGroup,\n  render: Render,\n  width: number,\n  height: number\n): Vec2 | null {\n  const viewportLeftLimit = BAR_PANEL_SIZE * LEFT_PADDING_MULTIPLIER + width\n  const viewportBottomLimit =\n    render?.clientArea?.clientHeight - BAR_PANEL_SIZE - height\n  const viewportRightLimit =\n    render?.clientArea?.clientWidth - BAR_PANEL_SIZE - width\n\n  // [['M', 23, 43], ['L', 23, 24]] we should remove first elements => [[23,43], [23,24]]\n  const rectCoords: Array<Array<number>> = sGroup.hovering.attrs?.path?.map(\n    (line) => line.slice(1)\n  )\n\n  const [middleLeftSide, middleBottomSide, middleRightSide, middleTopSide] =\n    calculateMiddleCoordsForRect(rectCoords)\n\n  if (\n    !middleBottomSide?.x ||\n    !middleBottomSide?.y ||\n    !middleTopSide?.y ||\n    !middleLeftSide?.x ||\n    !middleLeftSide?.y ||\n    !middleRightSide?.x ||\n    !middleRightSide?.y\n  ) {\n    return null\n  }\n\n  // Default position for panel is in the bottom;\n  let x = middleBottomSide.x - width / 2\n  let y = middleBottomSide.y\n\n  if (clientY > viewportBottomLimit) {\n    y = middleTopSide.y - height\n  }\n\n  if (clientX > viewportRightLimit) {\n    x = middleLeftSide.x - width\n    y = middleLeftSide.y - height / 2\n  }\n\n  if (clientX < viewportLeftLimit) {\n    x = middleRightSide.x\n    y = middleRightSide.y - height / 2\n  }\n\n  x += calculateScrollOffsetX(render)\n  y += calculateScrollOffsetY(render)\n\n  return new Vec2(x, y)\n}\n\ninterface SGroupDataRenderProps {\n  clientX: number\n  clientY: number\n  render: Render\n  groupStruct: Struct\n  sGroup: SGroup\n  sGroupData: string | null\n  className?: string\n}\n\nconst SGroupDataRender: FC<SGroupDataRenderProps> = (props) => {\n  const { clientX, clientY, render, className, sGroup, sGroupData } = props\n  const [wrapperHeight, setWrapperHeight] = useState(0)\n  const [wrapperWidth, setWrapperWidth] = useState(0)\n  const wrapperRef = useRef<HTMLDivElement>(null)\n\n  useEffect(() => {\n    if (wrapperRef.current) {\n      setWrapperHeight(wrapperRef.current.clientHeight)\n      setWrapperWidth(wrapperRef.current.clientWidth)\n    }\n  })\n\n  const panelCoordinate = getPanelPositionRelativeToRect(\n    clientX,\n    clientY,\n    sGroup,\n    render,\n    wrapperWidth,\n    wrapperHeight\n  )\n\n  return panelCoordinate ? (\n    <div\n      ref={wrapperRef}\n      style={{ left: panelCoordinate.x + 'px', top: panelCoordinate.y + 'px' }}\n      className={clsx(classes.infoPanel, className)}\n    >\n      {sGroupData}\n    </div>\n  ) : null\n}\n\nexport default SGroupDataRender\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nexport const functionalGroupsSelector = (state) => state.functionalGroups.lib\nexport const functionGroupInfoSelector = (state) =>\n  state.functionalGroups.functionalGroupInfo\nexport const modeSelector = (state) => state.functionalGroups.mode\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { useState, useEffect, useRef, FC } from 'react'\nimport { Scale, Vec2, Render, Struct, SGroup } from 'ketcher-core'\n\nimport StructRender from '../../../component/structrender'\nimport SGroupDataRender from './SGroupDataRender'\nimport { calculateScrollOffsetX, calculateScrollOffsetY } from './helpers'\nimport { functionGroupInfoSelector } from '../../../state/functionalGroups/selectors'\nimport { connect } from 'react-redux'\nimport clsx from 'clsx'\n\nimport classes from './InfoPanel.module.less'\n\nconst HOVER_PANEL_PADDING = 20\n\nfunction getSGroupFirstAtom(sGroup: SGroup, render: Render): Vec2 {\n  const { firstSgroupAtom } = sGroup\n  if (firstSgroupAtom) return firstSgroupAtom.pp\n  const [firstAtomId] = sGroup.atoms\n  return render.ctab.atoms?.get(firstAtomId)?.a.pp || new Vec2(0, 0)\n}\n\nfunction getPanelPosition(\n  clientX: number,\n  clientY: number,\n  render: Render,\n  sGroup: SGroup\n): [Vec2, Vec2] {\n  let width = 0\n  let height = 0\n  let x = 0\n  let y = 0\n\n  if (sGroup) {\n    // calculate width and height\n    const groupBoundingBox = sGroup.areas[0]\n    const start = Scale.obj2scaled(groupBoundingBox.p0, render.options)\n    const end = Scale.obj2scaled(groupBoundingBox.p1, render.options)\n    width = end.x - start.x\n    height = end.y - start.y\n    // calculate initial position\n    const firstAtomPosition = getSGroupFirstAtom(sGroup, render)\n    const panelPosition = Scale.obj2scaled(firstAtomPosition, {\n      scale: render.options.scale * render.options.zoom\n    })\n    x = panelPosition.x - width / 2 - HOVER_PANEL_PADDING\n    y = panelPosition.y + HOVER_PANEL_PADDING\n    // adjust position to keep inside viewport\n    const viewportRightLimit = render?.clientArea?.clientWidth - width / 2\n    const viewportLeftLimit = HOVER_PANEL_PADDING * 2 + width / 2\n    const viewportBottomLimit = render?.clientArea?.clientHeight - height\n    if (clientX > viewportRightLimit) {\n      x = panelPosition.x - width - HOVER_PANEL_PADDING\n    } else if (clientX < viewportLeftLimit) {\n      x = panelPosition.x - HOVER_PANEL_PADDING\n    }\n    if (clientY > viewportBottomLimit) {\n      y = panelPosition.y - height - HOVER_PANEL_PADDING * 3\n    }\n    // adjust position to current scroll offset\n    x += calculateScrollOffsetX(render)\n    y += calculateScrollOffsetY(render)\n  }\n\n  return [new Vec2(x, y), new Vec2(width, height)]\n}\ninterface InfoPanelProps {\n  clientX: number | undefined\n  clientY: number | undefined\n  render: Render\n  groupStruct: Struct\n  sGroup: SGroup\n  className?: string\n}\n\nconst InfoPanel: FC<InfoPanelProps> = (props) => {\n  const { clientX, clientY, render, className, groupStruct, sGroup } = props\n  const [molecule, setMolecule] = useState<Struct | null>(null)\n  const [sGroupData, setSGroupData] = useState<string | null>(null)\n  const childRef = useRef(null)\n  const groupName = sGroup?.data?.name\n\n  useEffect(() => {\n    // workaround for current release; just don't show tooltip for CIP data\n    // in future release CIP will be atom/bond property, not a s-group property\n    const CIP_FIELD_NAME = 'INDIGO_CIP_DESC'\n    if (\n      !groupStruct &&\n      sGroup?.type === 'DAT' &&\n      sGroup.data?.fieldName !== CIP_FIELD_NAME\n    ) {\n      setSGroupData(`${sGroup.data?.fieldName}=${sGroup.data?.fieldValue}`)\n    } else {\n      setSGroupData(null)\n    }\n  }, [groupStruct, sGroup])\n\n  useEffect(() => {\n    setMolecule(groupStruct ? groupStruct.clone() : null)\n  }, [groupName, groupStruct])\n\n  if (\n    (!molecule && !sGroupData) ||\n    clientX === undefined ||\n    clientY === undefined\n  ) {\n    return null\n  }\n\n  const [position, size] = getPanelPosition(clientX, clientY, render, sGroup)\n  const { x, y } = position\n  const width = size.x\n  const height = size.y\n\n  return molecule ? (\n    <div\n      style={{\n        left: x + 'px',\n        top: y + 'px'\n      }}\n      className={clsx(classes.infoPanel, className)}\n    >\n      <StructRender\n        struct={molecule}\n        id={groupName}\n        ref={childRef}\n        options={{\n          ...render.options,\n          autoScale: true,\n          autoScaleMargin: 0,\n          rescaleAmount: 1,\n          cachePrefix: 'infoPanel',\n          viewSz: new Vec2(width, height),\n          width: width,\n          height: height\n        }}\n      />\n    </div>\n  ) : (\n    <SGroupDataRender\n      clientX={clientX}\n      clientY={clientY}\n      render={render}\n      groupStruct={groupStruct}\n      sGroup={sGroup}\n      sGroupData={sGroupData}\n      className={className}\n    />\n  )\n}\n\nexport default connect((store: any) => ({\n  clientX: functionGroupInfoSelector(store)?.event?.clientX,\n  clientY: functionGroupInfoSelector(store)?.event?.clientY,\n  groupStruct: functionGroupInfoSelector(store)?.groupStruct || null,\n  sGroup: functionGroupInfoSelector(store)?.sGroup || null,\n  render: store.editor?.render?.ctab?.render\n}))(InfoPanel)\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Component, createRef } from 'react'\n\nimport Editor from '../../../../editor'\nimport { LoadingCircles } from '../Spinner/LoadingCircles'\nimport classes from './StructEditor.module.less'\nimport clsx from 'clsx'\nimport { upperFirst } from 'lodash/fp'\nimport handIcon from '../../../../../icons/files/hand.svg'\nimport compressedHandIcon from '../../../../../icons/files/compressed-hand.svg'\nimport Cursor from '../Cursor'\nimport { ContextMenu, ContextMenuTrigger } from '../ContextMenu'\n\nimport InfoPanel from './InfoPanel'\n\n// TODO: need to update component after making refactoring of store\nfunction setupEditor(editor, props, oldProps = {}) {\n  const { struct, tool, toolOpts, options } = props\n\n  if (struct !== oldProps.struct) editor.struct(struct)\n\n  if (tool !== oldProps.tool || toolOpts !== oldProps.toolOpts) {\n    editor.tool(tool, toolOpts)\n    if (toolOpts !== oldProps.toolOpts) {\n      editor.event.message.dispatch({ info: JSON.stringify(toolOpts) })\n    }\n  }\n\n  if (oldProps.options && options !== oldProps.options) editor.options(options)\n\n  Object.keys(editor.event).forEach((name) => {\n    const eventName = `on${upperFirst(name)}`\n\n    if (props[eventName] !== oldProps[eventName]) {\n      if (oldProps[eventName]) {\n        editor.event[name].remove(oldProps[eventName])\n      }\n\n      if (props[eventName]) {\n        editor.event[name].add(props[eventName])\n      }\n    }\n  })\n}\n\nfunction removeEditorHandlers(editor, props) {\n  Object.keys(editor.event).forEach((name) => {\n    const eventName = `on${upperFirst(name)}`\n\n    if (props[eventName]) editor.event[name].remove(props[eventName])\n  })\n}\n\nclass StructEditor extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      enableCursor: false,\n      clientX: 0,\n      clientY: 0\n    }\n    this.editorRef = createRef()\n    this.logRef = createRef()\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    return (\n      this.props.indigoVerification !== nextProps.indigoVerification ||\n      nextState.enableCursor !== this.state.enableCursor\n    )\n  }\n\n  UNSAFE_componentWillReceiveProps(props) {\n    setupEditor(this.editor, props, this.props)\n  }\n\n  componentDidMount() {\n    this.editor = new Editor(this.editorRef.current, {\n      ...this.props.options\n    })\n    setupEditor(this.editor, this.props)\n    if (this.props.onInit) this.props.onInit(this.editor)\n\n    this.editor.event.message.add((msg) => {\n      const el = this.logRef.current\n      if (msg.info && this.props.showAttachmentPoints) {\n        try {\n          const parsedInfo = JSON.parse(msg.info)\n          el.innerHTML = `Atom Id: ${parsedInfo.atomid}, Bond Id: ${parsedInfo.bondid}`\n        } catch {\n          el.innerHTML = msg.info\n        }\n        el.classList.add(classes.visible)\n      } else {\n        el.classList.remove(classes.visible)\n      }\n    })\n\n    this.editor.event.cursor.add((csr) => {\n      switch (csr.status) {\n        case 'enable':\n          this.editorRef.current.classList.add(classes.enableCursor)\n          const { left, top, right, bottom } =\n            this.editorRef.current.getBoundingClientRect()\n          const { clientX, clientY } = csr.cursorPosition\n          const handShouldBeShown =\n            clientX >= left &&\n            clientX <= right &&\n            clientY >= top &&\n            clientX <= bottom\n          if (!this.state.enableCursor && handShouldBeShown) {\n            this.setState({\n              enableCursor: true\n            })\n          }\n          break\n        case 'move':\n          this.editorRef.current.classList.add(classes.enableCursor)\n          this.setState({\n            enableCursor: true,\n            clientX,\n            clientY\n          })\n          break\n        case 'disable':\n          this.editorRef.current.classList.remove(classes.enableCursor)\n          this.setState({\n            enableCursor: false\n          })\n          break\n        case 'leave':\n          this.editorRef.current.classList.remove(classes.enableCursor)\n          this.setState({\n            enableCursor: false\n          })\n          break\n        case 'mouseover':\n          this.editorRef.current.classList.add(classes.enableCursor)\n          this.setState({\n            enableCursor: true\n          })\n          break\n        default:\n          break\n      }\n    })\n\n    this.editor.event.message.dispatch({\n      info: JSON.stringify(this.props.toolOpts)\n    })\n  }\n\n  componentWillUnmount() {\n    removeEditorHandlers(this.editor, this.props)\n  }\n\n  render() {\n    const {\n      Tag = 'div',\n      struct,\n      tool,\n      toolOpts,\n      options,\n      onInit,\n      onSelectionChange,\n      onElementEdit,\n      onEnhancedStereoEdit,\n      onQuickEdit,\n      onBondEdit,\n      onRgroupEdit,\n      onSgroupEdit,\n      onRemoveFG,\n      onMessage,\n      onAromatizeStruct,\n      onDearomatizeStruct,\n      onAttachEdit,\n      indigoVerification,\n      onCipChange,\n      className,\n      onConfirm,\n      onShowInfo,\n      onApiSettings,\n      showAttachmentPoints = true,\n      ...props\n    } = this.props\n\n    const { clientX = 0, clientY = 0 } = this.state\n\n    return (\n      <Tag className={clsx(classes.canvas, className)} {...props}>\n        <ContextMenuTrigger>\n          <div\n            ref={this.editorRef}\n            className={clsx(classes.intermediateCanvas)}\n          >\n            {/* svg here */}\n          </div>\n        </ContextMenuTrigger>\n\n        <Cursor\n          Icon={handIcon}\n          PressedIcon={compressedHandIcon}\n          enableHandTool={this.state.enableCursor}\n        />\n\n        <div className={classes.measureLog} ref={this.logRef} />\n\n        {indigoVerification && (\n          <div className={classes.spinnerOverlay}>\n            <LoadingCircles />\n          </div>\n        )}\n\n        <InfoPanel\n          clientX={clientX}\n          clientY={clientY}\n          render={this.props.render}\n          groupStruct={this.props.groupStruct}\n          sGroup={this.props.sGroup}\n        />\n\n        <ContextMenu />\n      </Tag>\n    )\n  }\n}\n\nexport default StructEditor\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Dialog } from '../../../../components'\nimport Logo from './logo.svg'\nimport classes from './About.module.less'\nimport { connect } from 'react-redux'\nimport { Fragment } from 'react'\n\nfunction AboutDialog(props) {\n  const indigoInfo = props.indigoVersion && props.indigoVersion.split('.r') // Indigo version and build info\n\n  return (\n    <Dialog\n      className={`${classes.about} ${classes.dialog_body}`}\n      params={props}\n      buttons={[\n        <button onClick={props.onOk} className={classes.okButton} key=\"ok\">\n          Ok\n        </button>\n      ]}\n    >\n      <div className={classes.headerContent}>\n        <a href={props.overviewLink} target=\"_blank\" rel=\"noopener noreferrer\">\n          <Logo />\n          <span className={classes.title}>Ketcher</span>\n        </a>\n      </div>\n      <div className={classes.body}>\n        <div className={classes.verionsInfo}>\n          <dl className={classes.ketcherVersionInfo}>\n            <dt>\n              <a\n                href={props.overviewLink}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                Version {props.version}\n              </a>\n            </dt>\n            <dd>\n              Build at <time>{props.date}</time>\n            </dd>\n            <div className={classes.infoLinks}>\n              <dt>\n                <a\n                  href={props.feedbackLink}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  Feedback\n                </a>\n              </dt>\n              <dt>\n                <a\n                  href={props.lifeScienciesLink}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  Epam Life Sciencies\n                </a>\n              </dt>\n            </div>\n            <br />\n            <div className={classes.indigoVersion}>\n              <a\n                href=\"http://lifescience.opensource.epam.com/indigo/\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                {' '}\n                Indigo Toolkit\n              </a>\n              {props.indigoMachine && <div>{props.indigoMachine}</div>}\n            </div>\n            <div>\n              {props.indigoVersion ? (\n                <Fragment>\n                  <dd>Version {indigoInfo[0]}</dd>\n                  {indigoInfo[1] && <dd>Build {indigoInfo[1]}</dd>}\n                </Fragment>\n              ) : (\n                <p>Standalone</p>\n              )}\n            </div>\n          </dl>\n        </div>\n      </div>\n    </Dialog>\n  )\n}\n\nconst mapStateToProps = (state) => ({\n  date: state.options.app.buildDate.replace('T', '; '),\n  indigoVersion: state.options.app.indigoVersion,\n  indigoMachine: state.options.app.indigoMachine,\n  feedbackLink: 'http://lifescience.opensource.epam.com/ketcher/#feedback',\n  overviewLink: 'https://lifescience.opensource.epam.com/ketcher/index.html',\n  lifeScienciesLink: 'http://lifescience.opensource.epam.com/',\n  version: state.options.app.version\n})\n\nconst mapDispatchToProps = (dispatch) => ({\n  onOk: (_result) => {\n    dispatch({ type: 'MODAL_CLOSE' })\n  }\n})\n\nconst About = connect(mapStateToProps, mapDispatchToProps)(AboutDialog)\n\nexport default About\n","/****************************************************************************\n * Copyright 2022 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { forwardRef } from 'react'\nimport { Popover } from '@mui/material'\nimport styled from '@emotion/styled'\n\nconst ErrorMessage = styled(Popover)`\n  & .MuiPopover-paper {\n    padding: 0 8px;\n    box-shadow: 4px 0px, 2px rgba(0, 0, 0, 0.25);\n    font-size: 12px;\n    max-width: 160px;\n  }\n`\n\nexport const ErrorPopover = ({ error, anchorEl, handleClose }) => (\n  <ErrorMessage\n    id=\"form-error\"\n    open={true}\n    anchorEl={anchorEl}\n    disableAutoFocus\n    sx={{\n      pointerEvents: 'none'\n    }}\n    onClose={handleClose}\n    anchorOrigin={{\n      vertical: 'bottom',\n      horizontal: 'center'\n    }}\n    transformOrigin={{\n      vertical: 'top',\n      horizontal: 'left'\n    }}\n  >\n    <>\n      {/* <p style={{ color: 'red' }}>Will work properly if:</p>  TODO: uncomment when error messages are changed */}\n      <p>{error}</p>\n    </>\n  </ErrorMessage>\n)\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport React, { PureComponent, ComponentType, useRef, useEffect } from 'react'\n\nimport classes from './input.module.less'\nimport clsx from 'clsx'\n\ntype Props = {\n  component?: ComponentType\n  children?: React.ReactNode\n  className?: string\n  type: string\n  value: number | string | boolean\n  onChange: (val: any) => void\n  placeholder?: string\n  isFocused?: boolean\n  innerRef?: React.Ref<any>\n  schema?: any\n  multiple?: boolean\n}\n\nexport function GenericInput({\n  schema,\n  value = '',\n  onChange,\n  innerRef,\n  type = 'text',\n  isFocused = false,\n  ...props\n}) {\n  const inputRef = useRef<HTMLInputElement>(innerRef)\n\n  useEffect(() => {\n    if (innerRef && inputRef.current) {\n      innerRef.current = inputRef.current\n    }\n  }, [innerRef])\n\n  useEffect(() => {\n    if (inputRef.current && isFocused) {\n      inputRef.current.focus()\n    }\n  }, [inputRef, isFocused])\n\n  return (\n    <>\n      <input\n        type={type}\n        value={value}\n        onInput={onChange}\n        onChange={onChange}\n        className={clsx(classes.input, classes.genericInput)}\n        ref={inputRef}\n        {...props}\n      />\n      {type === 'checkbox' && <span className={classes.checkbox} />}\n      {type === 'radio' && <span className={classes.radioButton} />}\n    </>\n  )\n}\n\nGenericInput.val = function (ev, schema) {\n  const input = ev.target\n  const isNumber =\n    input.type === 'number' ||\n    input.type === 'range' ||\n    (schema && (schema.type === 'number' || schema.type === 'integer'))\n  const value = isNumber ? input.value.replace(/,/g, '.') : input.value\n\n  return isNumber && !isNaN(value - 0) ? value - 0 : value // eslint-disable-line\n}\n\nfunction TextArea({ schema, value, onChange, ...rest }) {\n  return <textarea value={value} onInput={onChange} {...rest} />\n}\n\nTextArea.val = (ev) => ev.target.value\n\nfunction CheckBox({ schema, value = '', onChange, innerRef, ...rest }) {\n  return (\n    <div className={classes.fieldSetItem}>\n      <input\n        type=\"checkbox\"\n        checked={Boolean(value)}\n        onClick={onChange}\n        onChange={onChange}\n        className={classes.input}\n        ref={innerRef}\n        {...rest}\n      />\n      <span className={classes.checkbox} />\n    </div>\n  )\n}\n\nCheckBox.val = function (ev) {\n  ev.stopPropagation()\n  return !!ev.target.checked\n}\n\nfunction Select({\n  schema,\n  value,\n  name,\n  onSelect,\n  className,\n  multiple = false\n}) {\n  return (\n    <select\n      onChange={onSelect}\n      value={value}\n      name={name}\n      multiple={multiple}\n      className={clsx(classes.select, className)}\n    >\n      {enumSchema(schema, (title, val) => (\n        <option key={val} value={val}>\n          {title}\n        </option>\n      ))}\n    </select>\n  )\n}\n\nSelect.val = function (ev, schema) {\n  const select = ev.target as HTMLSelectElement\n  if (!select.multiple) return enumSchema(schema, select.selectedIndex)\n\n  const options = select.options\n\n  return Array.from(options).reduce(\n    (res, o: HTMLOptionElement, i) =>\n      !o.selected ? res : [enumSchema(schema, i), ...res],\n    [] as HTMLOptionElement[]\n  )\n}\n\nfunction FieldSet({\n  schema,\n  value,\n  selected,\n  onSelect,\n  type = 'radio',\n  checked,\n  ...rest\n}) {\n  return (\n    <fieldset onClick={onSelect}>\n      {enumSchema(schema, (title, val) => (\n        <li key={title} className={classes.fieldSetItem}>\n          <label className={classes.fieldSetLabel}>\n            <input\n              type={type}\n              defaultChecked={\n                type === 'radio' ? selected(val, checked) : selected(val, value)\n              }\n              value={typeof val !== 'object' && val}\n              className={classes.input}\n              {...rest}\n            />\n            {type === 'checkbox' && <span className={classes.checkbox} />}\n            {type === 'radio' && <span className={classes.radioButton} />}\n            {title}\n          </label>\n        </li>\n      ))}\n    </fieldset>\n  )\n}\n\nFieldSet.val = function (ev, schema) {\n  const input = ev.target as HTMLInputElement\n\n  if (ev.target.tagName !== 'INPUT') {\n    ev.stopPropagation()\n    return undefined\n  }\n\n  // Hm.. looks like premature optimization\n  //      should we inline this?\n\n  const fieldset = input?.parentNode?.parentNode?.parentNode\n  const inputCollection = fieldset?.querySelectorAll('input')\n  let result\n\n  if (inputCollection?.length) {\n    result = Array.from(inputCollection).reduce(\n      (res, inp: HTMLInputElement, i) =>\n        !inp.checked ? res : [enumSchema(schema, i), ...res],\n\n      [] as HTMLInputElement[]\n    )\n  }\n\n  return input.type === 'radio' ? result[0] : result\n}\n\nfunction Slider({ value, onChange, name, ...rest }) {\n  return (\n    <div className={classes.slider} key={name}>\n      <input\n        type=\"checkbox\"\n        checked={value}\n        onClick={onChange}\n        onChange={onChange}\n        name={name}\n        {...rest}\n      />\n      <span />\n    </div>\n  )\n}\n\nSlider.val = function (ev) {\n  ev.stopPropagation()\n  return !!ev.target.checked\n}\n\nfunction enumSchema(schema, cbOrIndex) {\n  const isTypeValue = Array.isArray(schema)\n  if (!isTypeValue && schema.items) schema = schema.items\n\n  if (typeof cbOrIndex === 'function') {\n    return (isTypeValue ? schema : schema.enum).map((item, i) => {\n      const title = isTypeValue\n        ? item.title\n        : schema.enumNames && schema.enumNames[i]\n      return cbOrIndex(\n        title !== undefined ? title : item,\n        item && item.value !== undefined ? item.value : item\n      )\n    })\n  }\n\n  if (!isTypeValue) return schema.enum[cbOrIndex]\n\n  const res = schema[cbOrIndex]\n  return res.value !== undefined ? res.value : res\n}\n\nfunction inputCtrl(component, schema, onChange) {\n  let props = {}\n  if (schema) {\n    // TODO: infer maxLength, min, max, step, etc\n    if (schema.type === 'number' || schema.type === 'integer')\n      props = { type: 'text' }\n  }\n\n  return {\n    onChange: (ev) => {\n      const val = !component.val ? ev : component.val(ev, schema)\n      onChange(val)\n    },\n    ...props\n  }\n}\n\nfunction singleSelectCtrl(component, schema, onChange) {\n  return {\n    selected: (testVal, value) => value === testVal,\n    onSelect: (ev) => {\n      const val = !component.val ? ev : component.val(ev, schema)\n      if (val !== undefined) onChange(val)\n    }\n  }\n}\n\nfunction multipleSelectCtrl(component, schema, onChange) {\n  return {\n    multiple: true,\n    selected: (testVal, values) => values && values.indexOf(testVal) >= 0,\n    onSelect: (ev, values) => {\n      if (component.val) {\n        const val = component.val(ev, schema)\n        if (val !== undefined) onChange(val)\n      } else {\n        const i = values ? values.indexOf(ev) : -1\n        if (i < 0) onChange(values ? [ev, ...values] : [ev])\n        else onChange([...values.slice(0, i), ...values.slice(i + 1)])\n      }\n    }\n  }\n}\n\nfunction ctrlMap(component, props: Props) {\n  const { schema, multiple, onChange } = props\n  if (\n    !schema ||\n    (!schema.enum && !schema.items && !Array.isArray(schema)) ||\n    schema.type === 'string'\n  )\n    return inputCtrl(component, schema, onChange)\n\n  if (multiple || schema.type === 'array')\n    return multipleSelectCtrl(component, schema, onChange)\n\n  return singleSelectCtrl(component, schema, onChange)\n}\n\nfunction componentMap(props: Props) {\n  const { schema, type, multiple } = props\n  if (!schema || (!schema.enum && !schema.items && !Array.isArray(schema))) {\n    if (type === 'checkbox' || (schema && schema.type === 'boolean')) {\n      return CheckBox\n    }\n\n    return type === 'textarea' ? TextArea : GenericInput\n  }\n\n  if (schema?.type === 'boolean' && schema?.description === 'slider') {\n    return Slider\n  }\n\n  if (multiple || schema.type === 'array')\n    return type === 'checkbox' ? FieldSet : Select\n\n  return type === 'radio' ? FieldSet : Select\n}\n\nconst AnyComponentWithRef = React.forwardRef(\n  ({ Component, ...props }: any, ref) => <Component {...props} innerRef={ref} />\n)\n\nclass Input extends PureComponent<\n  Props & { innerRef: React.Ref<HTMLInputElement> }\n> {\n  component: any\n  ctrl: {\n    type?: string\n    onChange?: (val: any) => void\n    onSelect?: (ev, values) => void\n    selected?: (testVal: any, value: any) => boolean\n    multiple?: boolean\n  }\n\n  constructor(props: Props & { innerRef: React.Ref<HTMLInputElement> }) {\n    super(props)\n    this.component = props.component || componentMap(props)\n    this.ctrl = ctrlMap(this.component, props)\n  }\n\n  render() {\n    const { children, onChange, ...restProps } = this.props\n\n    return (\n      <AnyComponentWithRef\n        Component={this.component}\n        ref={this.props.innerRef}\n        {...this.ctrl}\n        {...restProps}\n      />\n    )\n  }\n}\n\nexport default React.forwardRef(\n  (props: Props, ref: React.Ref<HTMLInputElement>) => (\n    <Input innerRef={ref} {...props} />\n  )\n)\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport MuiSelect, { SelectChangeEvent } from '@mui/material/Select'\nimport Divider from '@mui/material/Divider'\nimport MenuItem from '@mui/material/MenuItem'\nimport { useEffect, useState } from 'react'\nimport clsx from 'clsx'\nimport styles from './Select.module.less'\n\nimport Icon from '../../view/icon'\n\nexport interface Option {\n  value: string\n  label: string\n}\n\ninterface Props {\n  options: Array<Option>\n  onChange: (value: string) => void\n  className?: string\n  value?: string\n  multiple?: boolean\n  disabled?: boolean\n}\n\nconst ChevronIcon = ({ className }) => (\n  <Icon name=\"chevron\" className={clsx(className, styles.chevronIcon)} />\n)\n\nconst Select = ({\n  className,\n  value,\n  onChange,\n  multiple = false,\n  disabled,\n  options\n}: Props) => {\n  const [currentValue, setCurrentValue] = useState<Option>()\n\n  useEffect(() => {\n    let option\n    if (options) {\n      option = options.find((option) => option.value === value)\n    }\n    return setCurrentValue(option)\n  }, [options, value])\n\n  const handleChange = (event: SelectChangeEvent) => {\n    onChange(event.target.value)\n  }\n\n  return (\n    <MuiSelect\n      className={clsx(styles.selectContainer, className)}\n      value={currentValue?.value ?? ''}\n      onChange={handleChange}\n      multiple={multiple}\n      disabled={disabled}\n      MenuProps={{ className: styles.dropdownList }}\n      IconComponent={ChevronIcon}\n    >\n      {options &&\n        options.map((option) => {\n          const isDivider: boolean =\n            typeof option?.value === 'string'\n              ? option.value.includes('Divider')\n              : false\n\n          return isDivider ? (\n            <Divider className={styles.listDivider} key={option.value} />\n          ) : (\n            <MenuItem\n              value={option.value}\n              key={option.value}\n              disableRipple={true}\n            >\n              {option.label}\n            </MenuItem>\n          )\n        })}\n    </MuiSelect>\n  )\n}\n\nexport default Select\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Component, useCallback, useState } from 'react'\n\nimport Ajv from 'ajv'\nimport { ErrorPopover } from './errorPopover'\nimport { FormContext } from '../../../../../contexts'\nimport Input from '../input'\nimport Select from '../Select'\nimport classes from './form.module.less'\nimport clsx from 'clsx'\nimport { connect } from 'react-redux'\nimport { getSelectOptionsFromSchema } from '../../../utils'\nimport { updateFormState } from '../../../state/modal/form'\nimport { useFormContext } from '../../../../../hooks'\nimport { cloneDeep } from 'lodash'\n\nclass Form extends Component {\n  constructor(props) {\n    super(props)\n    const { onUpdate, schema, init } = this.props\n\n    this.schema = propSchema(schema, props)\n\n    if (init) {\n      const { valid, errors } = this.schema.serialize(init)\n      const errs = getErrorsObj(errors)\n      const initialState = { ...init, init: true }\n      onUpdate(initialState, valid, errs)\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    const { schema, result, customValid, ...rest } = this.props\n    if (schema.key && schema.key !== prevProps.schema.key) {\n      this.schema = propSchema(schema, rest)\n      this.schema.serialize(result) // hack: valid first state\n      this.updateState(result)\n    }\n  }\n\n  updateState(newState) {\n    const { onUpdate } = this.props\n    const { instance, valid, errors } = this.schema.serialize(newState)\n    const errs = getErrorsObj(errors)\n    onUpdate(instance, valid, errs)\n  }\n\n  field(name, onChange) {\n    const { result, errors } = this.props\n    const value = result[name]\n\n    return {\n      dataError: errors && errors[name],\n      value,\n      onChange: (val) => {\n        const newState = Object.assign({}, this.props.result, { [name]: val })\n        this.updateState(newState)\n        if (onChange) onChange(val)\n      }\n    }\n  }\n\n  render() {\n    const { schema, children } = this.props\n\n    return (\n      <form>\n        <FormContext.Provider value={{ schema, stateStore: this }}>\n          {children}\n        </FormContext.Provider>\n      </form>\n    )\n  }\n}\n\nexport default connect(null, (dispatch) => ({\n  onUpdate: (result, valid, errors) => {\n    dispatch(updateFormState({ result, valid, errors }))\n  }\n}))(Form)\n\nfunction Label({ labelPos, title, children, ...props }) {\n  const tooltip = props.tooltip ? props.tooltip : null\n\n  return (\n    <label {...props}>\n      {title && labelPos !== 'after' ? (\n        <span title={tooltip}>{title}</span>\n      ) : (\n        ''\n      )}\n      {children}\n      {title && labelPos === 'after' ? (\n        <span title={tooltip}>{title}</span>\n      ) : (\n        ''\n      )}\n    </label>\n  )\n}\n\nfunction Field(props) {\n  const { name, onChange, component, labelPos, className, ...rest } = props\n  const [anchorEl, setAnchorEl] = useState(null)\n  const handlePopoverOpen = useCallback((event) => {\n    setAnchorEl(event.currentTarget)\n  }, [])\n  const handlePopoverClose = useCallback(() => {\n    setAnchorEl(null)\n  }, [])\n  const { schema, stateStore } = useFormContext()\n  const desc = rest.schema || schema.properties[name]\n  const { dataError, ...fieldOpts } = stateStore.field(name, onChange)\n  const Component = component\n  const formField = component ? (\n    <Component name={name} schema={desc} {...fieldOpts} {...rest} />\n  ) : (\n    <Input name={name} schema={desc} {...fieldOpts} {...rest} />\n  )\n\n  if (labelPos === false) return formField\n  return (\n    <Label\n      className={clsx({ [classes.dataError]: dataError }, className)}\n      error={dataError}\n      title={rest.title || desc.title}\n      labelPos={labelPos}\n      tooltip={rest?.tooltip}\n    >\n      <span\n        className={classes.inputWrapper}\n        onMouseEnter={handlePopoverOpen}\n        onMouseLeave={handlePopoverClose}\n      >\n        {formField}\n      </span>\n      {dataError && anchorEl && (\n        <ErrorPopover\n          anchorEl={anchorEl}\n          open={!!anchorEl}\n          error={dataError}\n          onClose={handlePopoverClose}\n        />\n      )}\n    </Label>\n  )\n}\n\nconst SelectOneOf = (props) => {\n  const { title, name, schema, ...prop } = props\n\n  const selectDesc = {\n    title,\n    enum: [],\n    enumNames: []\n  }\n\n  Object.keys(schema).forEach((item) => {\n    selectDesc.enum.push(item)\n    selectDesc.enumNames.push(schema[item].title || item)\n  })\n\n  return (\n    <Field\n      name={name}\n      options={getSelectOptionsFromSchema(selectDesc)}\n      title={title}\n      {...prop}\n      component={Select}\n    />\n  )\n}\n\n//\n\nfunction propSchema(schema, { customValid, serialize = {}, deserialize = {} }) {\n  const ajv = new Ajv({ allErrors: true, verbose: true, strictSchema: false })\n  const schemaCopy = cloneDeep(schema)\n\n  if (customValid) {\n    Object.entries(customValid).forEach(([formatName, formatValidator]) => {\n      ajv.addFormat(formatName, formatValidator)\n      const {\n        pattern,\n        maxLength,\n        enum: enumIsReservedWord,\n        enumNames,\n        ...rest\n      } = schemaCopy.properties[formatName]\n      schemaCopy.properties[formatName] = {\n        ...rest,\n        format: formatName\n      }\n    })\n  }\n\n  const validate = ajv.compile(schemaCopy)\n\n  return {\n    key: schema.key || '',\n    serialize: (inst) => {\n      validate(inst)\n      return {\n        instance: serializeRewrite(serialize, inst, schemaCopy),\n        valid: validate(inst),\n        errors: validate.errors || []\n      }\n    },\n    deserialize: (inst) => {\n      validate(inst)\n      return deserializeRewrite(deserialize, inst)\n    }\n  }\n}\n\nfunction serializeRewrite(serializeMap, instance, schema) {\n  const res = {}\n  if (typeof instance !== 'object' || !schema.properties) {\n    return instance !== undefined ? instance : schema.default\n  }\n\n  Object.keys(schema.properties).forEach((p) => {\n    if (p in instance) res[p] = instance[serializeMap[p]] || instance[p]\n  })\n\n  return res\n}\n\nfunction deserializeRewrite(deserializeMap, instance) {\n  return instance\n}\n\nfunction getInvalidMessage(item) {\n  if (!item.parentSchema.invalidMessage) return item.message\n  return typeof item.parentSchema.invalidMessage === 'function'\n    ? item.parentSchema.invalidMessage(item.data)\n    : item.parentSchema.invalidMessage\n}\n\nfunction getErrorsObj(errors) {\n  const errs = {}\n  let field\n\n  errors.forEach((item) => {\n    field = item.instancePath.slice(1)\n    if (!errs[field]) errs[field] = getInvalidMessage(item)\n  })\n\n  return errs\n}\n\nexport { Field, SelectOneOf }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { useCallback, useState } from 'react'\n\nimport { HexColorPicker, HexColorInput } from 'react-colorful'\nimport classes from './ColorPicker.module.less'\nimport clsx from 'clsx'\nimport Icon from '../../../component/view/icon'\n\ninterface ColorPickerProps {\n  value: string\n  name: string\n  schema: any\n  type?: string\n}\n\ninterface ColorPickerCallProps {\n  onChange: (value: string) => void\n}\n\ntype Props = ColorPickerProps & ColorPickerCallProps\n\nconst presetColors = [\n  '#FF4545',\n  '#FFAD31',\n  '#68D442',\n  '#3ACACC',\n  '#4434FF',\n  '#9C9C9C',\n  '#000000'\n]\n\nconst ColorPicker = (props: Props) => {\n  const [isOpen, setIsOpen] = useState(false)\n  const [isPaletteOpen, setIsPaletteOpen] = useState(false)\n  const { onChange, value } = props\n\n  const handleChange = useCallback(\n    (color) => {\n      onChange(color)\n    },\n    [onChange]\n  )\n\n  const throttle = useCallback((func, limit) => {\n    let inThrottle\n    return (e) => {\n      if (!inThrottle) {\n        func(e)\n        inThrottle = true\n        setTimeout(() => (inThrottle = false), limit)\n      }\n    }\n  }, [])\n\n  const handleClick = useCallback(\n    throttle((e) => {\n      e.preventDefault()\n      setIsOpen((prev) => !prev)\n      setIsPaletteOpen(false)\n    }, 200),\n    []\n  )\n\n  const handlePaletteOpen = () => {\n    setIsPaletteOpen(true)\n  }\n  const handleColorChange = (color) => {\n    handleChange(color)\n  }\n\n  const handleBlur = (e) => {\n    if (!e.currentTarget.contains(e.relatedTarget)) {\n      handleClick(e)\n    }\n  }\n\n  return (\n    <div\n      className={classes.colorPickerWrapper}\n      data-testid={isOpen ? 'color-picker-field-open' : 'color-picker-field'}\n      onClick={(e) => e.preventDefault()}\n    >\n      <div\n        className={clsx({\n          [classes.colorPickerInput]: true,\n          [classes.selectedInput]: isOpen\n        })}\n        onClick={handleClick}\n      >\n        <div\n          className={classes.colorPickerPreview}\n          data-testid=\"color-picker-preview\"\n          style={{ backgroundColor: value }}\n        />\n\n        <Icon\n          className={clsx({\n            [classes.expandIcon]: true,\n            [classes.turnedIcon]: !isOpen\n          })}\n          name=\"chevron\"\n        />\n      </div>\n      {isOpen && (\n        <div\n          className={clsx(\n            classes.colorPickerWrap,\n            isPaletteOpen && classes.withPalette\n          )}\n          onBlur={handleBlur}\n          data-testid=\"color-picker-preset\"\n        >\n          <div className={classes.presetColors}>\n            <button\n              className={clsx(\n                classes.chooseColor,\n                isPaletteOpen && classes.clicked\n              )}\n              onClick={handlePaletteOpen}\n              autoFocus\n              data-testid=\"color-picker-btn\"\n            />\n            {presetColors.map((color) => (\n              <button\n                key={color}\n                onClick={() => handleColorChange(color)}\n                style={{ backgroundColor: color }}\n                className={classes.presetColor}\n              />\n            ))}\n          </div>\n\n          {isPaletteOpen && (\n            <div className={classes.colorPicker} data-testid=\"color-palette\">\n              <HexColorPicker color={value} onChange={handleChange} />\n              <div className={classes.colorContainer}>\n                <span className={classes.hex}>HEX</span>\n                <HexColorInput\n                  data-testid=\"color-picker-input\"\n                  color={value}\n                  onChange={handleChange}\n                />\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n\nexport default ColorPicker\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport React, { useEffect, useState } from 'react'\n\nimport Input from '../input'\nimport Select from '../Select'\nimport styles from './measure-input.module.less'\nimport { getSelectOptionsFromSchema } from '../../../utils'\n\nconst selectOptions = getSelectOptionsFromSchema({\n  enum: ['cm', 'px', 'pt', 'inch']\n})\n\nconst MeasureInput = ({ schema, value, onChange, name, ...rest }) => {\n  const [measure, setMeasure] = useState('px')\n  const [cust, setCust] = useState(value || schema.default)\n\n  useEffect(() => {\n    if (measure === 'px' && cust?.toFixed() - 0 !== value) {\n      setMeasure('px')\n      setCust(value)\n    } // Hack: Set init value (RESET)\n  }, [])\n\n  const handleChange = (value) => {\n    const convValue = convertValue(value, measure, 'px')\n    setCust(value)\n    onChange(convValue)\n  }\n\n  const handleMeasChange = (m) => {\n    setCust((prev) => {\n      convertValue(prev, measure, m)\n    })\n    setMeasure(m)\n  }\n\n  const calcValue = () => {\n    const newValue = convertValue(value, 'px', measure)\n    setCust(newValue)\n  }\n\n  useEffect(() => {\n    calcValue()\n  }, [value, measure, calcValue])\n\n  const desc = schema || schema.properties[name]\n\n  return (\n    <div className={styles.measureInput} {...rest}>\n      <span>{rest.title || desc.title}</span>\n      <div style={{ display: 'flex' }}>\n        <Input\n          schema={schema}\n          step={measure === 'px' || measure === 'pt' ? '1' : '0.001'}\n          value={cust}\n          onChange={handleChange}\n        />\n        <Select\n          onChange={handleMeasChange}\n          options={selectOptions}\n          value={measure}\n          className={styles.select}\n        />\n      </div>\n    </div>\n  )\n}\n\nconst measureMap = {\n  px: 1,\n  cm: 37.795278,\n  pt: 1.333333,\n  inch: 96\n}\n\nfunction convertValue(value, measureFrom, measureTo) {\n  if ((!value && value !== 0) || isNaN(value)) return null // eslint-disable-line\n\n  return measureTo === 'px' || measureTo === 'pt'\n    ? ((value * measureMap[measureFrom]) / measureMap[measureTo]).toFixed() - 0\n    : ((value * measureMap[measureFrom]) / measureMap[measureTo]).toFixed(3) - 0\n}\n\nexport default MeasureInput\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Component } from 'react'\nimport clsx from 'clsx'\n\nimport { fileOpener } from '../../utils'\nimport classes from './buttons.module.less'\n\nclass OpenButton extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {}\n    if (props.server) {\n      fileOpener(props.server).then((opener) => {\n        this.setState({ opener })\n      })\n    }\n  }\n\n  open(ev) {\n    const files = ev.target.files\n    const noop = () => null\n    const { onLoad = noop, onError = noop } = this.props\n\n    if (this.state.opener && files.length)\n      this.state.opener(files[0]).then(onLoad, onError)\n    else if (files.length) onLoad(files[0])\n    ev.target.value = null\n    ev.preventDefault()\n  }\n\n  render() {\n    const { children, type, server, className, ...props } = this.props\n\n    return (\n      <button\n        onClick={() => this.btn.click()}\n        className={clsx(classes.openButton, className)}\n        {...props}\n      >\n        <input\n          onChange={(ev) => this.open(ev)}\n          accept={type}\n          type=\"file\"\n          ref={(el) => {\n            this.btn = el\n          }}\n        />\n        {children}\n      </button>\n    )\n  }\n}\n\nexport default OpenButton\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\nimport { OutputFormatType } from 'ketcher-core'\n\nimport { saveAs } from 'file-saver'\nimport React, { PropsWithChildren } from 'react'\nimport { useAppContext } from '../../../../hooks'\n\ntype Props = {\n  server?: any\n  filename: string\n  outputFormat?: OutputFormatType\n  data: any\n  type?: string\n  mode?: string\n  onSave?: () => void\n  onError?: (err: any) => void\n  className?: string\n  title?: string\n}\n\ntype FileSaverReturnType = Promise<\n  (data: Blob | string, fn, type: string | undefined) => void | never\n>\n\ntype SaverType = Awaited<FileSaverReturnType>\ntype SaveButtonProps = PropsWithChildren<Props>\n\nconst SaveButton = (props: SaveButtonProps) => {\n  const noop = () => null\n  const {\n    server,\n    filename = 'unnamed',\n    outputFormat,\n    data,\n    type,\n    mode = 'saveFile',\n    onSave = noop,\n    onError = noop,\n    className,\n    title\n  } = props\n  const { getKetcherInstance } = useAppContext()\n\n  const save = (event: React.KeyboardEvent | React.MouseEvent) => {\n    event.preventDefault()\n    switch (mode) {\n      case 'saveImage':\n        saveImage()\n        break\n      case 'saveFile':\n      default:\n        saveFile()\n    }\n  }\n\n  const saveFile = () => {\n    if (data) {\n      try {\n        fileSaver(server).then((saver: SaverType) => {\n          saver(data, filename, type)\n          onSave()\n        })\n      } catch (error) {\n        onError(error)\n      }\n    }\n  }\n\n  const saveImage = () => {\n    const ketcherInstance = getKetcherInstance()\n    if (outputFormat) {\n      ketcherInstance\n        .generateImage(data, { outputFormat })\n        .then((blob) => {\n          saveAs(blob, `${filename}.${outputFormat}`)\n          onSave()\n        })\n        .catch((error) => {\n          onError(error)\n        })\n    }\n  }\n\n  return (\n    <button\n      title={title}\n      className={className}\n      onClick={(event) => {\n        save(event)\n      }}\n    >\n      {props.children}\n    </button>\n  )\n}\n\nconst fileSaver = (server): FileSaverReturnType => {\n  return new Promise((resolve, reject) => {\n    if (global.Blob && saveAs) {\n      resolve((data, fn, type) => {\n        const blob = new Blob([data], { type }) // eslint-disable-line no-undef\n        saveAs(blob, fn)\n      })\n    } else if (server) {\n      resolve(\n        server.then(() => {\n          throw Error(\"Server doesn't still support echo method\")\n        })\n      )\n    } else {\n      reject(new Error('Your browser does not support opening files locally'))\n    }\n  })\n}\n\nexport { SaveButton }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport React, { useState } from 'react'\nimport classes from './Accordion.module.less'\nimport clsx from 'clsx'\nimport Icon from '../../../../../../component/view/icon'\n\nconst Accordion = ({ tabs, className, changedGroups }): React.ReactElement => {\n  const [expandedAccordions, setExpandedAccordions] = useState<string[]>([\n    'General'\n  ])\n\n  const handleAccordionChange = (accordion) => () => {\n    const isExpand = !expandedAccordions.includes(accordion)\n    setExpandedAccordions(\n      isExpand\n        ? [...expandedAccordions, accordion]\n        : [...expandedAccordions].filter(\n            (expandedAccordion) => expandedAccordion !== accordion\n          )\n    )\n  }\n\n  return (\n    <div className={clsx(classes.accordionWrapper, className)}>\n      {tabs.map(({ label, content, key }) => {\n        const shouldGroupBeRended = expandedAccordions.includes(label)\n        return (\n          <div key={key}>\n            <div\n              onClick={handleAccordionChange(label)}\n              className={classes.accordionSummaryWrapper}\n            >\n              <div className={classes.accordionSummary}>\n                <Icon\n                  className={clsx({\n                    [classes.expandIcon]: true,\n                    [classes.turnedIcon]: !shouldGroupBeRended\n                  })}\n                  name=\"chevron\"\n                />\n                <div className={classes.groupLabel}>\n                  <Icon name=\"elements-group\" className={classes.groupIcon} />\n                  <span>{label}</span>\n                </div>\n                {changedGroups.has(label) && (\n                  <span className={classes.changeMarker}></span>\n                )}\n              </div>\n            </div>\n            <div\n              className={clsx({\n                [classes.accordionDetailsWrapper]: true,\n                [classes.hiddenAccordion]: !shouldGroupBeRended\n              })}\n            >\n              <div className={classes.accordionDetails}>{content}</div>\n            </div>\n          </div>\n        )\n      })}\n    </div>\n  )\n}\n\nexport default Accordion\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { useCallback, useEffect, useState } from 'react'\n\nimport FontFaceObserver from 'font-face-observer'\nimport Select from './Select'\n\nconst commonFonts = [\n  'Arial',\n  'Arial Black',\n  'Comic Sans MS',\n  'Courier New',\n  'Georgia',\n  'Impact',\n  'Charcoal',\n  'Lucida Console',\n  'Monaco',\n  'Palatino Linotype',\n  'Book Antiqua',\n  'Palatino',\n  'Tahoma',\n  'Geneva',\n  'Times New Roman',\n  'Times',\n  'Verdana',\n  'Symbol',\n  'MS Serif',\n  'MS Sans Serif',\n  'New York',\n  'Droid Sans',\n  'Droid Serif',\n  'Droid Sans Mono',\n  'Roboto'\n]\n\nfunction checkInSystem() {\n  const availableFontsPromises = commonFonts.map((fontName) => {\n    const observer = new FontFaceObserver(fontName)\n    return observer.check().then(\n      () => fontName,\n      () => null\n    )\n  })\n\n  return Promise.all(availableFontsPromises)\n}\n\nfunction SystemFonts(props) {\n  const [availableFonts, setAvailableFonts] = useState(null)\n  const { value, onChange } = props\n  const onChangeCallback = useCallback(\n    (value) => {\n      onChange(value)\n    },\n    [onChange]\n  )\n\n  useEffect(() => {\n    let mounted = true\n    checkInSystem().then((results) => {\n      const fonts = results\n        .filter((i) => i !== null)\n        .map((font) => {\n          return { value: `30px ${font}`, label: font }\n        })\n      if (mounted) {\n        setAvailableFonts(fonts)\n      }\n    })\n\n    return () => (mounted = false)\n  }, [])\n\n  return (\n    <Select\n      onChange={onChangeCallback}\n      value={value}\n      disabled={availableFonts === null}\n      options={availableFonts}\n    />\n  )\n}\n\nexport default SystemFonts\n","const fieldGroups = {\n  resetToSelect: 'General',\n  rotationStep: 'General',\n  showValenceWarnings: 'General',\n  atomColoring: 'General',\n  font: 'General',\n  fontsz: 'General',\n  fontszsub: 'General',\n  showStereoFlags: 'Stereochemistry',\n  stereoLabelStyle: 'Stereochemistry',\n  colorOfAbsoluteCenters: 'Stereochemistry',\n  colorOfAndCenters: 'Stereochemistry',\n  colorOfOrCenters: 'Stereochemistry',\n  colorStereogenicCenters: 'Stereochemistry',\n  autoFadeOfStereoLabels: 'Stereochemistry',\n  absFlagLabel: 'Stereochemistry',\n  andFlagLabel: 'Stereochemistry',\n  orFlagLabel: 'Stereochemistry',\n  mixedFlagLabel: 'Stereochemistry',\n  ignoreChiralFlag: 'Stereochemistry',\n  carbonExplicitly: 'Atoms',\n  showCharge: 'Atoms',\n  showValence: 'Atoms',\n  showHydrogenLabels: 'Atoms',\n  aromaticCircle: 'Bonds',\n  doubleBondWidth: 'Bonds',\n  bondThickness: 'Bonds',\n  stereoBondWidth: 'Bonds',\n  'smart-layout': 'Server',\n  'ignore-stereochemistry-errors': 'Server',\n  'mass-skip-error-on-pseudoatoms': 'Server',\n  'gross-formula-add-rsites': 'Server',\n  'gross-formula-add-isotopes': 'Server',\n  miewMode: '3D Viewer',\n  miewTheme: '3D Viewer',\n  miewAtomLabel: '3D Viewer',\n  showAtomIds: 'Options for Debugging',\n  showBondIds: 'Options for Debugging',\n  showHalfBondIds: 'Options for Debugging',\n  showLoopIds: 'Options for Debugging'\n}\n\nexport default fieldGroups\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { BaseCallProps, BaseProps } from '../../../modal.types'\nimport Form, { Field } from '../../../../../component/form/form/form'\nimport {\n  setDefaultSettings,\n  updateFormState\n} from '../../../../../state/modal/form'\nimport { useEffect, useState } from 'react'\n\nimport ColorPicker from '../../../../../component/form/colorPicker/ColorPicker'\nimport { Dialog } from '../../../../components'\nimport Icon from '../../../../../component/view/icon'\nimport MeasureInput from '../../../../../component/form/MeasureInput/measure-input'\nimport OpenButton from '../../../../../component/view/openbutton'\nimport { SaveButton } from '../../../../../component/view/savebutton'\nimport Select from '../../../../../component/form/Select'\nimport Accordion from './Accordion'\nimport { StructService } from 'ketcher-core'\nimport SystemFonts from '../../../../../component/form/systemfonts'\nimport classes from './Settings.module.less'\nimport { connect } from 'react-redux'\nimport { getSelectOptionsFromSchema } from '../../../../../utils'\nimport { saveSettings } from '../../../../../state/options'\nimport settingsSchema, {\n  getDefaultOptions\n} from '../../../../../data/schema/options-schema'\nimport fieldGroups from './fieldGroups'\nimport { isEqual } from 'lodash'\n\ninterface SettingsProps extends BaseProps {\n  initState: any\n  appOpts: {\n    version: string\n    buildDate: string\n    buildNumber: string\n    indigoVersion: string\n    imagoVersions: Array<string>\n    server: boolean\n    templates: boolean\n  }\n  server: StructService\n}\n\ninterface SettingsCallProps extends BaseCallProps {\n  onOpenFile: (any) => void\n  onReset: () => void\n}\n\nconst defaultSettings = getDefaultOptions()\n\nconst HeaderContent = ({\n  server,\n  onOpenFile,\n  onReset,\n  formState,\n  initState\n}) => {\n  const getIsResetDisabled = () => {\n    if (formState.result.init) return isEqual(defaultSettings, initState)\n    else return isEqual(defaultSettings, formState.result)\n  }\n\n  return (\n    <div className={classes.headerContent}>\n      <span className={classes.title}> Settings</span>\n      <OpenButton\n        title=\"Open from File\"\n        key=\"settings\"\n        server={server}\n        onLoad={onOpenFile}\n        className={classes.button}\n      >\n        <Icon name=\"open-1\" />\n      </OpenButton>\n      <SaveButton\n        title=\"Save to File\"\n        key=\"ketcher-settings\"\n        data={JSON.stringify(formState.result)}\n        filename=\"ketcher-settings\"\n        className={classes.button}\n      >\n        <Icon name=\"save-1\" />\n      </SaveButton>\n      <button\n        title=\"Reset\"\n        key=\"settings-button\"\n        onClick={onReset}\n        className={classes.button}\n        disabled={getIsResetDisabled()}\n      >\n        <Icon name=\"reset\" />\n      </button>\n    </div>\n  )\n}\n\ntype Props = SettingsProps & SettingsCallProps\n\nconst settingsProps = settingsSchema.properties\n\nconst SettingsDialog = (props: Props) => {\n  const {\n    initState,\n    formState,\n    server,\n    onOpenFile,\n    onReset,\n    appOpts,\n    ...prop\n  } = props\n\n  const [changedGroups, setChangedGroups] = useState(new Set())\n\n  useEffect(() => {\n    const changed = new Set<string>()\n\n    for (const key in initState) {\n      if (initState[key] !== formState.result[key]) {\n        const group = fieldGroups[key]\n        changed.add(group)\n      }\n    }\n    setChangedGroups(changed)\n  }, [initState, formState.result])\n\n  const generalTab = {\n    key: 'general',\n    label: 'General',\n    content: (\n      <fieldset>\n        <Field\n          name=\"resetToSelect\"\n          component={Select}\n          options={getSelectOptionsFromSchema(settingsProps?.resetToSelect)}\n        />\n        <Field name=\"rotationStep\" />\n        <Field name=\"showValenceWarnings\" />\n        <Field name=\"atomColoring\" />\n        <Field name=\"font\" component={SystemFonts} />\n        <Field name=\"fontsz\" component={MeasureInput} labelPos={false} />\n        <Field name=\"fontszsub\" component={MeasureInput} labelPos={false} />\n      </fieldset>\n    )\n  }\n  const stereoTab = {\n    key: 'stereo',\n    label: 'Stereochemistry',\n    content: (\n      <fieldset>\n        <Field name=\"showStereoFlags\" />\n        <Field\n          name=\"stereoLabelStyle\"\n          component={Select}\n          options={getSelectOptionsFromSchema(settingsProps?.stereoLabelStyle)}\n        />\n        <Field name=\"colorOfAbsoluteCenters\" component={ColorPicker} />\n        <Field name=\"colorOfAndCenters\" component={ColorPicker} />\n        <Field name=\"colorOfOrCenters\" component={ColorPicker} />\n        <Field\n          name=\"colorStereogenicCenters\"\n          component={Select}\n          options={getSelectOptionsFromSchema(\n            settingsProps?.colorStereogenicCenters\n          )}\n        />\n        <Field name=\"autoFadeOfStereoLabels\" />\n        <Field name=\"absFlagLabel\" />\n        <Field name=\"andFlagLabel\" />\n        <Field name=\"orFlagLabel\" />\n        <Field name=\"mixedFlagLabel\" />\n        <Field\n          name=\"ignoreChiralFlag\"\n          tooltip=\"Ignore chiral flag while loading from molfiles. By default all the stereo will be ABS\"\n        />\n      </fieldset>\n    )\n  }\n  const atomsTab = {\n    key: 'atoms',\n    label: 'Atoms',\n    content: (\n      <fieldset>\n        <Field name=\"carbonExplicitly\" />\n        <Field name=\"showCharge\" />\n        <Field name=\"showValence\" />\n        <Field\n          name=\"showHydrogenLabels\"\n          component={Select}\n          options={getSelectOptionsFromSchema(\n            settingsProps?.showHydrogenLabels\n          )}\n        />\n      </fieldset>\n    )\n  }\n  const bondsTab = {\n    key: 'bonds',\n    label: 'Bonds',\n    content: (\n      <fieldset>\n        <Field name=\"aromaticCircle\" />\n        <Field\n          name=\"doubleBondWidth\"\n          component={MeasureInput}\n          labelPos={false}\n        />\n        <Field name=\"bondThickness\" component={MeasureInput} labelPos={false} />\n        <Field\n          name=\"stereoBondWidth\"\n          component={MeasureInput}\n          labelPos={false}\n        />\n      </fieldset>\n    )\n  }\n  const serverTab = {\n    key: 'server',\n    label: 'Server',\n    content: (\n      <fieldset disabled={!appOpts.server}>\n        <Field name=\"smart-layout\" />\n        <Field name=\"ignore-stereochemistry-errors\" />\n        <Field name=\"mass-skip-error-on-pseudoatoms\" />\n        <Field name=\"gross-formula-add-rsites\" />\n        <Field name=\"gross-formula-add-isotopes\" />\n      </fieldset>\n    )\n  }\n  const threeDViewerTab = {\n    key: '3dviewer',\n    label: '3D Viewer',\n    content: (\n      // eslint-disable-next-line dot-notation\n      <fieldset className={classes.viewer}>\n        <Field\n          name=\"miewMode\"\n          component={Select}\n          options={getSelectOptionsFromSchema(settingsProps?.miewMode)}\n        />\n        <Field\n          name=\"miewTheme\"\n          component={Select}\n          options={getSelectOptionsFromSchema(settingsProps?.miewTheme)}\n        />\n        <Field\n          name=\"miewAtomLabel\"\n          component={Select}\n          options={getSelectOptionsFromSchema(settingsProps?.miewAtomLabel)}\n        />\n      </fieldset>\n    )\n  }\n  const debuggingTab = {\n    key: 'debugging',\n    label: 'Options for Debugging',\n    content: (\n      <fieldset>\n        <Field name=\"showAtomIds\" />\n        <Field name=\"showBondIds\" />\n        <Field name=\"showHalfBondIds\" />\n        <Field name=\"showLoopIds\" />\n      </fieldset>\n    )\n  }\n\n  const tabs = [\n    generalTab,\n    stereoTab,\n    atomsTab,\n    bondsTab,\n    serverTab,\n    threeDViewerTab,\n    debuggingTab\n  ]\n\n  return (\n    <Dialog\n      className={classes.settings}\n      result={() => formState.result}\n      valid={() => formState.valid}\n      params={prop}\n      buttonsNameMap={{ OK: 'Apply' }}\n      buttons={['Cancel', 'OK']}\n      withDivider\n      needMargin={false}\n      headerContent={\n        <HeaderContent\n          server={server}\n          onOpenFile={onOpenFile}\n          onReset={onReset}\n          formState={formState}\n          initState={initState}\n        />\n      }\n    >\n      <Form schema={settingsSchema} init={initState} {...formState}>\n        <Accordion\n          tabs={tabs}\n          className={classes.accordion}\n          changedGroups={changedGroups}\n        />\n      </Form>\n    </Dialog>\n  )\n}\n\nconst mapStateToProps = (state) => ({\n  server: state.options.app.server ? state.server : null,\n  appOpts: state.options.app,\n  initState: state.options.settings,\n  formState: state.modal.form\n})\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({\n  onOpenFile: (newOpts) => {\n    try {\n      dispatch(updateFormState({ result: JSON.parse(newOpts) }))\n    } catch (ex) {\n      console.info('Bad file')\n    }\n  },\n  onReset: () => dispatch(setDefaultSettings()),\n  onOk: (res) => {\n    dispatch(saveSettings(res))\n    ownProps.onOk(res)\n  }\n})\n\nconst Settings = connect(mapStateToProps, mapDispatchToProps)(SettingsDialog)\n\nexport default Settings\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nfunction ErrorsCheck(props) {\n  const { moleculeErrors, checkSchema } = props\n  const moleculeErrorsTypes = Object.keys(moleculeErrors)\n\n  const getOptionName = (option) => {\n    const { items } = checkSchema.properties.checkOptions\n    const nameIndex = items.enum.indexOf(option)\n    return items.enumNames[nameIndex]\n  }\n\n  return (\n    <>\n      <fieldset>\n        {moleculeErrorsTypes.length === 0 ? (\n          <div>\n            <dd>No errors detected</dd>\n          </div>\n        ) : (\n          moleculeErrorsTypes.map((type, key) => (\n            <div key={key}>\n              <dt>{getOptionName(type)} warning:</dt>\n              <dd>{moleculeErrors[type]}</dd>\n            </div>\n          ))\n        )}\n      </fieldset>\n    </>\n  )\n}\n\nexport default ErrorsCheck\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport Form, { Field } from '../../../../../component/form/form/form'\nimport { Dialog } from '../../../../components'\nimport ErrorsCheck from './components'\nimport { check } from '../../../../../state/server'\nimport { checkOpts } from '../../../../../state/options'\nimport { connect } from 'react-redux'\nimport style from './Check.module.less'\nimport { useEffect, useState } from 'react'\nimport { LoadingCircles } from 'src/script/ui/views/components/Spinner'\n\nconst checkSchema = {\n  title: 'Check',\n  type: 'object',\n  properties: {\n    checkOptions: {\n      title: 'Settings',\n      type: 'array',\n      items: {\n        type: 'string',\n        enum: [\n          'valence',\n          'radicals',\n          'pseudoatoms',\n          'stereo',\n          'query',\n          'overlapping_atoms',\n          'overlapping_bonds',\n          'rgroups',\n          'chiral',\n          '3d',\n          'chiral_flag'\n        ],\n        enumNames: [\n          'Valence',\n          'Radical',\n          'Pseudoatom',\n          'Stereochemistry',\n          'Query',\n          'Overlapping Atoms',\n          'Overlapping Bonds',\n          'R-Groups',\n          'Chirality',\n          '3D Structure',\n          'Chiral flag'\n        ]\n      }\n    }\n  }\n}\n\nconst getFormattedDateString = (date) => {\n  const getFixedString = (num) => (num + '').padStart(2, 0)\n  return `${getFixedString(date.getHours())}:${getFixedString(\n    date.getMinutes()\n  )}:${getFixedString(date.getSeconds())}  ${getFixedString(\n    date.getDate()\n  )}.${getFixedString(date.getMonth() + 1)}.${getFixedString(\n    date.getFullYear()\n  )}`\n}\n\nconst FooterContent = ({\n  handleCheck,\n  handleApply,\n  onCancel,\n  isStuctureChecking,\n  isCheckedWithNewSettings\n}) => {\n  return (\n    <div className={style.buttons}>\n      <div>\n        <button\n          className={\n            isCheckedWithNewSettings\n              ? style.buttonSecondary\n              : style.buttonPrimary\n          }\n          onClick={handleCheck}\n          disabled={!isStuctureChecking}\n        >\n          Check\n        </button>\n      </div>\n      <div className={style.buttonsRight}>\n        <button className={style.buttonSecondary} onClick={onCancel}>\n          Cancel\n        </button>\n        <button\n          className={style.buttonPrimary}\n          onClick={handleApply}\n          disabled={!isStuctureChecking}\n        >\n          Apply\n        </button>\n      </div>\n    </div>\n  )\n}\n\nfunction CheckDialog(props) {\n  const { formState, checkState, onCheck, onApply, onCancel, ...restProps } =\n    props\n  const { result = checkState, moleculeErrors } = formState\n  const [isStuctureChecking, setIsStructureChecking] = useState(false)\n  const [lastCheckDate, setLastCheckDate] = useState(null)\n  const [isCheckedWithNewSettings, setIsCheckedWithNewSettings] =\n    useState(false)\n\n  const handleApply = () => onApply(result)\n\n  const handleCheck = () => {\n    setIsStructureChecking(false)\n    onCheck(result.checkOptions).then(() => {\n      setIsStructureChecking(true)\n      setLastCheckDate(new Date())\n      setIsCheckedWithNewSettings(true)\n    })\n  }\n\n  const handleSettingsChange = () => setIsCheckedWithNewSettings(false)\n\n  useEffect(() => {\n    handleCheck()\n  }, [])\n\n  return (\n    <Dialog\n      title=\"Structure Check\"\n      className={style.dialog_body}\n      params={{ ...restProps, onCancel }}\n      buttons={[]}\n      footerContent={\n        <FooterContent\n          handleCheck={handleCheck}\n          handleApply={handleApply}\n          onCancel={onCancel}\n          isStuctureChecking={isStuctureChecking}\n          isCheckedWithNewSettings={isCheckedWithNewSettings}\n        />\n      }\n      withDivider\n    >\n      <Form\n        schema={checkSchema}\n        init={checkState}\n        {...formState}\n        result={result}\n      >\n        <div className={style.wrapper}>\n          <div className={style.settings}>\n            <label>Settings</label>\n            <div\n              className={!isStuctureChecking ? style.checkBoxesDisabled : ''}\n            >\n              <Field\n                name=\"checkOptions\"\n                labelPos={false}\n                multiple\n                type=\"checkbox\"\n                disabled={!isStuctureChecking}\n                onChange={handleSettingsChange}\n              />\n            </div>\n          </div>\n          <div className={style.checkInfo}>\n            <span>\n              Last check:{' '}\n              {lastCheckDate && getFormattedDateString(lastCheckDate)}\n            </span>\n            <div\n              className={\n                !Object.keys(moleculeErrors).length || !isStuctureChecking\n                  ? style.centeredContainer\n                  : style.warnings\n              }\n            >\n              {isStuctureChecking ? (\n                <div\n                  className={\n                    Object.keys(moleculeErrors).length\n                      ? style.warningsContainer\n                      : style.centeredContainer\n                  }\n                >\n                  <ErrorsCheck\n                    moleculeErrors={moleculeErrors}\n                    checkSchema={checkSchema}\n                  />\n                </div>\n              ) : (\n                <LoadingCircles />\n              )}\n            </div>\n          </div>\n        </div>\n      </Form>\n    </Dialog>\n  )\n}\n\nconst mapStateToProps = (state) => ({\n  formState: state.modal.form,\n  checkState: state.options.check\n})\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({\n  onCheck: (opts) => dispatch(check(opts)).catch(ownProps.onCancel),\n  onApply: (res) => {\n    dispatch(checkOpts(res))\n    ownProps.onOk(res)\n  }\n})\n\nconst Check = connect(mapStateToProps, mapDispatchToProps)(CheckDialog)\n\nexport default Check\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport styles from './FormulaInput.module.less'\n\nconst formulaRegexp = /\\b(\\d*)([A-Z][a-z]{0,3}#?)(\\d*)\\s*\\b/g\nconst errorRegexp = /error:.*/g\n\nfunction formulaInputMarkdown(contentData) {\n  const { content, contentEditable } = contentData\n  const onKeyDown = (e) => {\n    if (e.keyCode === 8) {\n      e.preventDefault()\n      return false\n    }\n  }\n  return (\n    <div\n      className={styles.chem_input}\n      onKeyPress={(e) => e.preventDefault()}\n      onPaste={(e) => e.preventDefault()}\n      onKeyDown={onKeyDown}\n      contentEditable={contentEditable}\n      suppressContentEditableWarning={true}\n    >\n      {content}\n    </div>\n  )\n}\n\nfunction FormulaInput({ value, contentEditable }) {\n  if (errorRegexp.test(value)) return formulaInputMarkdown(value)\n\n  const content = []\n  let cnd\n  let pos = 0\n\n  while ((cnd = formulaRegexp.exec(value)) !== null) {\n    if (cnd[1].length > 0)\n      content.push(<sup key={content.length}>{cnd[1]}</sup>)\n    content.push(value.substring(pos, cnd.index) + cnd[2])\n    if (cnd[3].length > 0)\n      content.push(<sub key={content.length}>{cnd[3]}</sub>)\n    pos = cnd.index + cnd[0].length\n  }\n\n  if (pos === 0) content.push(value)\n  else content.push(value.substring(pos, value.length))\n\n  return formulaInputMarkdown({ content, contentEditable })\n}\n\nexport default FormulaInput\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nfunction FrozenInput({ value }) {\n  return (\n    <input\n      type=\"text\"\n      spellCheck={false}\n      value={value}\n      readOnly\n      onChange={(event) => event.preventDefault()}\n    />\n  )\n}\n\nexport default FrozenInput\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { FormulaInput, FrozenInput } from './components'\n\nimport { Component } from 'react'\nimport { Dialog } from '../../../../components'\nimport { ErrorsContext } from '../../../../../../../contexts'\nimport { analyse } from '../../../../../state/server'\nimport { changeRound } from '../../../../../state/options'\nimport classes from './Analyse.module.less'\nimport { connect } from 'react-redux'\nimport { range } from 'lodash/fp'\nimport Select from '../../../../../component/form/Select'\nimport { getSelectOptionsFromSchema } from '../../../../../utils'\n\nfunction roundOff(value, round) {\n  if (typeof value === 'number') return value.toFixed(round)\n  return value.replace(/[0-9]*\\.[0-9]+/g, (str) => (+str).toFixed(round))\n}\n\nconst selectOptions = getSelectOptionsFromSchema({ enum: range(0, 8) })\n\nclass AnalyseDialog extends Component {\n  static contextType = ErrorsContext\n\n  componentDidMount() {\n    this.props.onAnalyse()\n  }\n\n  render() {\n    const { values, round, loading, onAnalyse, onChangeRound, ...props } =\n      this.props\n    return (\n      <Dialog\n        title=\"Calculated Values\"\n        className={classes.analyse}\n        withDivider={true}\n        needMargin={true}\n        valid={() => true}\n        buttons={['OK']}\n        buttonsNameMap={{ OK: 'Close' }}\n        params={props}\n      >\n        <ul>\n          {[\n            {\n              name: 'Chemical Formula',\n              key: 'gross',\n              withSelector: false\n            },\n            {\n              name: 'Molecular Weight',\n              key: 'molecular-weight',\n              round: 'roundWeight',\n              withSelector: true\n            },\n            {\n              name: 'Exact Mass',\n              key: 'monoisotopic-mass',\n              round: 'roundMass',\n              withSelector: true\n            },\n            {\n              name: 'Elemental Analysis',\n              key: 'mass-composition',\n              round: 'roundElAnalysis',\n              withSelector: false\n            }\n          ].map((item) => (\n            <li key={item.key} className={classes.contentWrapper}>\n              <div className={classes.inputWrapper}>\n                <label>{item.name}:</label>\n                {item.key === 'gross' ? (\n                  <FormulaInput\n                    value={values && !loading ? values[item.key] : ''}\n                    contentEditable={false}\n                  />\n                ) : item.key === 'mass-composition' ? (\n                  <textarea\n                    readOnly\n                    value={\n                      values && !loading\n                        ? roundOff(values[item.key], round[item.round])\n                        : 0\n                    }\n                  />\n                ) : (\n                  <FrozenInput\n                    value={\n                      values && !loading\n                        ? roundOff(values[item.key], round[item.round])\n                        : 0\n                    }\n                  />\n                )}\n              </div>\n              {item.withSelector ? (\n                <div className={classes.selectWrapper}>\n                  <span>Decimal places</span>\n                  <Select\n                    options={selectOptions}\n                    value={round[item.round]}\n                    onChange={(val) => onChangeRound(item.round, val)}\n                    className={classes.select}\n                  />\n                </div>\n              ) : null}\n            </li>\n          ))}\n        </ul>\n      </Dialog>\n    )\n  }\n}\n\nconst mapStateToProps = (state) => ({\n  values: state.options.analyse.values,\n  loading: state.options.analyse.loading,\n  round: {\n    roundWeight: state.options.analyse.roundWeight,\n    roundMass: state.options.analyse.roundMass,\n    roundElAnalysis: state.options.analyse.roundElAnalysis\n  }\n})\n\nconst mapDispatchToProps = (dispatch) => ({\n  onAnalyse: () => dispatch(analyse()),\n  onChangeRound: (roundName, val) => dispatch(changeRound(roundName, val))\n})\n\nconst Analyse = connect(mapStateToProps, mapDispatchToProps)(AnalyseDialog)\n\nexport default Analyse\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\ntype Props = {\n  clickHandler: () => void\n  disabled: boolean\n  label: string\n  styles: string\n  title?: string\n}\n\nexport const DialogActionButton = ({\n  clickHandler,\n  label,\n  title,\n  styles,\n  disabled\n}: Props) => (\n  <input\n    key=\"Open\"\n    type=\"button\"\n    className={styles}\n    value={label}\n    title={title || label}\n    disabled={disabled}\n    onClick={clickHandler}\n  />\n)\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { useCallback, useEffect, useState } from 'react'\nimport {\n  changeImage,\n  changeVersion,\n  shouldFragment\n} from '../../../../../state/options'\n\nimport { Dialog } from '../../../../components'\nimport Input from '../../../../../component/form/input'\nimport OpenButton from '../../../../../component/view/openbutton'\nimport { LoadingCircles } from 'src/script/ui/views/components/Spinner'\nimport StructRender from '../../../../../component/structrender'\nimport classes from './Recognize.module.less'\nimport { connect } from 'react-redux'\nimport { load } from '../../../../../state'\nimport { range } from 'lodash/fp'\nimport { recognize } from '../../../../../state/server'\nimport { DialogActionButton } from 'src/script/ui/views/modal/components/document/Open/components/DialogActionButton'\nimport Icon from 'src/script/ui/component/view/icon'\n\nfunction isImage(file) {\n  return file?.type?.includes('image')\n}\n\nfunction FooterContent({ onImage, structStr, openHandler, copyHandler }) {\n  return (\n    <div className={classes.footerContent}>\n      <OpenButton\n        key=\"choose\"\n        onLoad={onImage}\n        type=\"image/*\"\n        className={classes.openButton}\n      >\n        <Icon name=\"open\" />\n        <span>Change image</span>\n      </OpenButton>\n      <div>\n        <DialogActionButton\n          key=\"openButton\"\n          disabled={!structStr}\n          clickHandler={openHandler}\n          styles={classes.secondaryButton}\n          label=\"Open as new Project\"\n        />\n        <DialogActionButton\n          key=\"copyButton\"\n          disabled={!structStr}\n          clickHandler={copyHandler}\n          styles={classes.primaryButton}\n          label=\"Add to Canvas\"\n          title=\"Structure will be loaded as fragment and added to Clipboard\"\n        />\n      </div>\n    </div>\n  )\n}\n\nfunction RecognizeDialog(prop) {\n  const {\n    file,\n    structStr,\n    fragment,\n    version,\n    imagoVersions,\n    onOk,\n    ...partProps\n  } = prop\n  const { onRecognize, isFragment, onImage, onChangeImago, ...props } =\n    partProps\n  const [canPreviewImage, setCanPreviewImage] = useState(true)\n  const result = () =>\n    structStr && !(structStr instanceof Promise)\n      ? { structStr, fragment }\n      : null\n\n  useEffect(() => {\n    onRecognize(file, version)\n  }, [file, version])\n\n  const clearFile = useCallback(() => {\n    onImage(null)\n    return true\n  }, [onImage])\n\n  const copyHandler = () => {\n    onOk({ structStr, fragment: true })\n  }\n\n  const openHandler = () => {\n    onOk({ structStr, fragment: false })\n  }\n\n  return (\n    <Dialog\n      title=\"Import Structure from Image\"\n      className={classes.recognize}\n      params={{ ...props, onOk }}\n      result={() => result(structStr, fragment)}\n      withDivider={true}\n      needMargin={false}\n      footerContent={\n        <FooterContent\n          onImage={onImage}\n          openHandler={openHandler}\n          structStr={structStr}\n          copyHandler={copyHandler}\n        />\n      }\n      buttons={[]}\n    >\n      <div className={classes.topBody}>\n        <label className={classes.imagoVersion}>\n          Imago version\n          <Input\n            schema={{\n              enum: imagoVersions,\n              enumNames: range(1, imagoVersions.length + 1).map(\n                (i) => `Version ${i}`\n              )\n            }}\n            value={version}\n            onChange={onChangeImago}\n          />\n        </label>\n        <span>Original image</span>\n        <span>Recognized structure preview</span>\n      </div>\n      <div className={classes.imagesContainer}>\n        <div className={classes.picture}>\n          {file && isImage(file) && canPreviewImage && (\n            <img\n              alt=\"\"\n              id=\"pic\"\n              src={url(file) || ''}\n              onError={() => {\n                setCanPreviewImage(false)\n              }}\n            />\n          )}\n          <span className={classes.filename}> {file ? file.name : null} </span>\n          {file && isImage(file) && !canPreviewImage && (\n            <div className={classes.messageContainer}>\n              <p>\n                Preview of '{file.type}' MIME type is not supported by current\n                browser\n              </p>\n            </div>\n          )}\n          {(!file || (!isImage(file) && clearFile())) && (\n            <div className={classes.messageContainer}>\n              <p>Please choose image</p>\n            </div>\n          )}\n        </div>\n        <div className={classes.output}>\n          {structStr &&\n            // in Edge 38: instanceof Promise always `false`\n            (structStr instanceof Promise || typeof structStr !== 'string' ? (\n              <div className={classes.messageContainer}>\n                <LoadingCircles />\n              </div>\n            ) : (\n              <StructRender className={classes.struct} struct={structStr} />\n            ))}\n        </div>\n      </div>\n    </Dialog>\n  )\n}\n\nfunction url(file) {\n  if (!file) return null\n  const URL = window.URL || window.webkitURL\n  return URL ? URL.createObjectURL(file) : 'No preview'\n}\n\nconst mapStateToProps = (state) => ({\n  imagoVersions: state.options.app.imagoVersions,\n  file: state.options.recognize.file,\n  structStr: state.options.recognize.structStr,\n  fragment: state.options.recognize.fragment,\n  version: state.options.recognize.version || state.options.app.imagoVersions[1]\n})\n\nconst mapDispatchToProps = (dispatch) => ({\n  isFragment: (v) => dispatch(shouldFragment(v)),\n  onImage: (file) => dispatch(changeImage(file)),\n  onRecognize: (file, ver) => dispatch(recognize(file, ver)),\n  onChangeImago: (ver) => dispatch(changeVersion(ver)),\n  onOk: (res) => {\n    dispatch(\n      load(res.structStr, {\n        rescale: true,\n        fragment: res.fragment\n      })\n      // TODO: Removed ownProps.onOk call. consider refactoring of load function in release 2.4\n      // See PR #731 (https://github.com/epam/ketcher/pull/731)\n    )\n  }\n})\n\nconst Recognize = connect(mapStateToProps, mapDispatchToProps)(RecognizeDialog)\n\nexport default Recognize\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Dialog } from '../../../../components'\nimport {\n  FormatterFactory,\n  Struct,\n  StructService,\n  SupportedFormat\n} from 'ketcher-core'\nimport { MIEW_OPTIONS } from '../../../../../data/schema/options-schema'\nimport classes from './Miew.module.less'\nimport { connect } from 'react-redux'\nimport { load } from '../../../../../state'\nimport { pick } from 'lodash/fp'\nimport Viewer from 'miew-react'\nimport { Miew as MiewAsType } from 'miew'\nimport { useCallback, useRef } from 'react'\n\ntype MiewDialogProps = {\n  miewOpts: any\n  server: StructService\n  struct: Struct\n  onCancel: () => void\n  onOk: (result: any) => void\n  miewTheme: 'dark' | 'light'\n}\ntype MiewDialogCallProps = {\n  onExportCML: (cmlStruct: string) => void\n}\ntype Props = MiewDialogProps & MiewDialogCallProps\n\n/* OPTIONS for MIEW */\nconst BACKGROUND_COLOR = {\n  dark: '0x202020',\n  light: '0xcccccc'\n}\n\nconst MIEW_TX_TYPES = {\n  no: null,\n  bright: {\n    colorer: 'EL'\n  },\n  blackAndWhite: {\n    colorer: ['UN', { color: 0xffffff }],\n    bg: '0x000'\n  },\n  black: {\n    colorer: ['UN', { color: 0x000000 }]\n  }\n}\n\nconst TXoptions = (userOpts) => {\n  const type = userOpts.miewAtomLabel\n  if (MIEW_TX_TYPES[type] === null) return null\n  return {\n    colorer: MIEW_TX_TYPES[type].colorer,\n    selector: 'not elem C',\n    mode: [\n      'TX',\n      {\n        bg: MIEW_TX_TYPES[type].bg || BACKGROUND_COLOR[userOpts.miewTheme],\n        showBg: true,\n        template: '{{elem}}'\n      }\n    ]\n  }\n}\n\nfunction createMiewOptions(userOpts) {\n  const options = {\n    settings: {\n      bg: { color: Number(BACKGROUND_COLOR[userOpts.miewTheme]) },\n      autoPreset: false,\n      editing: true,\n      inversePanning: true\n    },\n    reps: [\n      {\n        mode: userOpts.miewMode\n      }\n    ]\n  }\n\n  const textMode = TXoptions(userOpts)\n  if (textMode) options.reps.push(textMode)\n\n  return options\n}\n/* ---------------- */\nconst CHANGING_WARNING =\n  'Stereocenters can be changed after the strong 3D rotation'\n\nconst FooterContent = () => (\n  <div className={classes.warning}>{CHANGING_WARNING}</div>\n)\n\nconst MiewDialog = ({\n  miewOpts,\n  server,\n  struct,\n  onExportCML,\n  miewTheme = 'light',\n  ...prop\n}: Props) => {\n  const miewRef = useRef<MiewAsType>()\n\n  const onMiewInit = useCallback(\n    (miew: MiewAsType) => {\n      miewRef.current = miew\n      const factory = new FormatterFactory(server)\n      const service = factory.create(SupportedFormat.cml)\n\n      service\n        .getStructureFromStructAsync(struct)\n        .then((res) =>\n          miew.load(res, { sourceType: 'immediate', fileType: 'cml' })\n        )\n        .then(() => miew.setOptions(miewOpts))\n        .catch((ex) => console.error(ex.message))\n    },\n    [miewOpts, server, struct]\n  )\n\n  const exportCML = useCallback(() => {\n    const cmlStruct = miewRef.current?.exportCML()\n    if (!cmlStruct) {\n      return\n    }\n    onExportCML(cmlStruct)\n  }, [onExportCML, miewRef])\n\n  return (\n    <Dialog\n      title=\"Miew\"\n      needMargin={false}\n      params={prop}\n      buttons={[\n        'Cancel',\n        <button key=\"apply\" onClick={exportCML} className={classes.applyButton}>\n          Apply\n        </button>\n      ]}\n      footerContent={<FooterContent />}\n      className={classes.miewDialog}\n    >\n      <div>\n        <div\n          className={`${classes.miewContainer} ${\n            miewTheme === 'dark' ? classes.miewDarkTheme : ''\n          }`}\n        >\n          <Viewer onInit={onMiewInit} />\n        </div>\n      </div>\n    </Dialog>\n  )\n}\n\nconst mapStateToProps = (state) => ({\n  miewOpts: createMiewOptions(pick(MIEW_OPTIONS, state.options.settings)),\n  server: state.options.app.server ? state.server : null,\n  struct: state.editor.struct(),\n  miewTheme: state.options.settings.miewTheme\n})\n\nconst mapDispatchToProps = (dispatch) => ({\n  onExportCML: (cmlStruct) => {\n    dispatch(load(cmlStruct))\n    // TODO: Removed ownProps.onOk call. consider refactoring of load function in release 2.4\n    // See PR #731 (https://github.com/epam/ketcher/pull/731)\n  }\n})\n\nconst Miew = connect(mapStateToProps, mapDispatchToProps)(MiewDialog)\n\nexport default Miew\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Elements } from 'ketcher-core'\nimport { capitalize } from 'lodash/fp'\n\ninterface ElementNumberProps {\n  label: string\n}\n\ntype Props = ElementNumberProps\n\nconst ElementNumber = (props: Props) => {\n  const { label } = props\n  const value = Elements.get(capitalize(label))?.number || ''\n\n  return (\n    <label>\n      <span>Number</span>\n      <input type=\"text\" readOnly value={value} />\n    </label>\n  )\n}\n\nexport default ElementNumber\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { BaseCallProps, BaseProps } from '../../../modal.types'\n\nimport Form, { Field } from '../../../../../component/form/form/form'\nimport { FC, useCallback, useState } from 'react'\n\nimport { Dialog } from '../../../../components'\nimport ElementNumber from './ElementNumber'\nimport { Elements } from 'ketcher-core'\nimport { atom as atomSchema } from '../../../../../data/schema/struct-schema'\nimport { capitalize } from 'lodash/fp'\nimport classes from './Atom.module.less'\nimport Select from '../../../../../component/form/Select'\nimport { getSelectOptionsFromSchema } from '../../../../../utils'\nimport Icon from '../../../../../component/view/icon'\nimport clsx from 'clsx'\n\ninterface AtomProps extends BaseCallProps, BaseProps {\n  alias: string\n  charge: string\n  exactChangeFlag: boolean\n  explicitValence: number\n  hCount: number\n  invRet: number\n  isotope: number\n  label: string\n  radical: number\n  ringBondCount: number\n  stereoParity: number\n  substitutionCount: number\n  unsaturatedAtom: boolean\n}\n\ntype Props = AtomProps & {\n  isMultipleAtoms?: boolean\n}\n\nconst atomProps = atomSchema.properties\n\nconst Atom: FC<Props> = (props: Props) => {\n  const { formState, stereoParity, isMultipleAtoms = false, ...rest } = props\n  const [currentLabel, setCurrentLabel] = useState<string>(rest.label)\n  const [expandedAccordions, setExpandedAccordions] = useState<string[]>([\n    'General'\n  ])\n\n  const handleAccordionChange = (accordion) => () => {\n    const isExpand = !expandedAccordions.includes(accordion)\n    setExpandedAccordions(\n      isExpand\n        ? [...expandedAccordions, accordion]\n        : [...expandedAccordions].filter(\n            (expandedAccordion) => expandedAccordion !== accordion\n          )\n    )\n  }\n\n  const onLabelChangeCallback = useCallback((newValue) => {\n    setCurrentLabel(newValue)\n  }, [])\n\n  const itemGroups = [\n    {\n      groupName: 'General',\n      component: (\n        <div>\n          <Field name=\"label\" onChange={onLabelChangeCallback} autoFocus />\n          <ElementNumber label={currentLabel} />\n\n          <Field name=\"alias\" />\n\n          <Field name=\"charge\" maxLength=\"5\" />\n          <Field name=\"isotope\" />\n\n          <Field\n            name=\"explicitValence\"\n            component={Select}\n            options={getSelectOptionsFromSchema(atomProps.explicitValence)}\n          />\n\n          <Field\n            name=\"radical\"\n            component={Select}\n            options={getSelectOptionsFromSchema(atomProps.radical)}\n          />\n        </div>\n      )\n    },\n    {\n      groupName: 'Query specific',\n      component: (\n        <div className={classes.querySpecific}>\n          <Field\n            name=\"ringBondCount\"\n            component={Select}\n            options={getSelectOptionsFromSchema(atomProps.ringBondCount)}\n          />\n          <Field\n            name=\"hCount\"\n            component={Select}\n            options={getSelectOptionsFromSchema(atomProps.hCount)}\n          />\n          <Field\n            name=\"substitutionCount\"\n            component={Select}\n            options={getSelectOptionsFromSchema(atomProps.substitutionCount)}\n          />\n          <Field\n            name=\"unsaturatedAtom\"\n            labelPos=\"before\"\n            className={classes.checkbox}\n          />\n        </div>\n      )\n    },\n    {\n      groupName: 'Reaction flags',\n      component: (\n        <div className={classes.reactionFlags}>\n          <Field\n            name=\"invRet\"\n            component={Select}\n            options={getSelectOptionsFromSchema(atomProps.invRet)}\n          />\n          <Field\n            name=\"exactChangeFlag\"\n            labelPos=\"before\"\n            className={classes.checkbox}\n          />\n        </div>\n      )\n    }\n  ]\n\n  return (\n    <Dialog\n      title=\"Atom Properties\"\n      className={classes.atomProps}\n      result={() => formState.result}\n      valid={() => formState.valid}\n      params={rest}\n      buttonsNameMap={{ OK: 'Apply' }}\n      buttons={['Cancel', 'OK']}\n      withDivider\n    >\n      <Form\n        schema={atomSchema}\n        customValid={{\n          label: (label) => atomValid(label, isMultipleAtoms),\n          charge: (charge) => chargeValid(charge, isMultipleAtoms)\n        }}\n        init={rest}\n        {...formState}\n      >\n        <div className={classes.accordionWrapper}>\n          {itemGroups.map(({ groupName, component }) => {\n            const shouldGroupBeRended = expandedAccordions.includes(groupName)\n            return (\n              <div key={groupName}>\n                <div\n                  onClick={handleAccordionChange(groupName)}\n                  className={classes.accordionSummaryWrapper}\n                >\n                  <div className={classes.accordionSummary}>\n                    <span>{groupName}</span>\n                    <Icon\n                      className={clsx({\n                        [classes.expandIcon]: true,\n                        [classes.turnedIcon]: !shouldGroupBeRended\n                      })}\n                      name=\"chevron\"\n                    />\n                  </div>\n                </div>\n                <div\n                  className={clsx({\n                    [classes.accordionDetailsWrapper]: true,\n                    [classes.hiddenAccordion]: !shouldGroupBeRended\n                  })}\n                >\n                  <div className={classes.accordionDetails}>{component}</div>\n                </div>\n              </div>\n            )\n          })}\n        </div>\n      </Form>\n    </Dialog>\n  )\n}\n\nfunction atomValid(label: string, isMultipleAtoms: boolean) {\n  const isChemicalElement = !!Elements.get(capitalize(label))\n  if (isMultipleAtoms) {\n    return label === '' || isChemicalElement\n  }\n  return label && isChemicalElement\n}\n\nfunction chargeValid(charge, isMultipleAtoms: boolean) {\n  const regex = new RegExp(atomSchema.properties.charge.pattern)\n  const result = regex.exec(charge)\n  const isValidCharge = result && (result[1] === '' || result[3] === '')\n  if (isMultipleAtoms) {\n    return charge === '0' || charge === 0 || charge === '' || isValidCharge\n  }\n  return isValidCharge\n}\n\nexport type { AtomProps }\nexport default Atom\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport Atom from './Atom'\nimport { BaseProps } from '../../../modal.types'\nimport { connect } from 'react-redux'\n\ntype StateProps = Pick<BaseProps, 'formState'>\n\nconst mapStateToProps = (state: any): StateProps => ({\n  formState: state.modal.form\n})\n\nconst AtomContainer = connect(mapStateToProps)(Atom)\nexport default AtomContainer\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { BaseCallProps, BaseProps } from '../../../modal.types'\nimport Form, { Field } from '../../../../../component/form/form/form'\n\nimport { Dialog } from '../../../../components'\nimport { attachmentPoints as attachmentPointsSchema } from '../../../../../data/schema/struct-schema'\nimport classes from './Attach.module.less'\n\ninterface AttachPointsProps extends BaseProps {\n  primary: boolean\n  secondary: boolean\n}\n\ntype Props = AttachPointsProps & BaseCallProps\n\nconst AttachPoints = (props: Props) => {\n  const { formState, ...rest } = props\n  return (\n    <Dialog\n      title=\"Attachment Points\"\n      className={classes.attachPoints}\n      result={() => formState.result}\n      valid={() => formState.valid}\n      params={rest}\n      buttonsNameMap={{ OK: 'Apply' }}\n      buttons={['Cancel', 'OK']}\n      withDivider\n    >\n      <Form schema={attachmentPointsSchema} init={rest} {...formState}>\n        <Field name=\"primary\" />\n        <Field name=\"secondary\" />\n      </Form>\n    </Dialog>\n  )\n}\n\nexport type { AttachPointsProps }\nexport default AttachPoints\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport AttachPoints from './Attach'\nimport { BaseProps } from '../../../modal.types'\nimport { connect } from 'react-redux'\n\ntype StateProps = Pick<BaseProps, 'formState'>\n\nconst mapStateToProps = (state: any): StateProps => ({\n  formState: state.modal.form\n})\n\nconst AttachPointsContainer = connect(mapStateToProps)(AttachPoints)\nexport default AttachPointsContainer\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { BaseCallProps, BaseProps } from '../../../modal.types'\nimport Form, { Field } from '../../../../../component/form/form/form'\nimport { Dialog } from '../../../../components'\nimport classes from './Automap.module.less'\nimport Select from '../../../../../component/form/Select/Select'\nimport { getSelectOptionsFromSchema } from '../../../../../utils'\n\ntype Props = BaseProps & BaseCallProps\n\nexport const automapSchema = {\n  title: 'Reaction Auto-Mapping',\n  type: 'object',\n  required: ['mode'],\n  properties: {\n    mode: {\n      title: 'Mode',\n      enum: ['discard', 'keep', 'alter', 'clear'],\n      enumNames: ['Discard', 'Keep', 'Alter', 'Clear'],\n      default: 'discard'\n    }\n  }\n}\n\nconst Automap = (props: Props) => {\n  const { formState, ...rest } = props\n  return (\n    <Dialog\n      title=\"Reaction Auto-Mapping\"\n      className={classes.automap}\n      result={() => formState.result}\n      valid={() => formState.valid}\n      params={rest}\n      withDivider\n      buttons={['Cancel', 'OK']}\n      buttonsNameMap={{ OK: 'Apply' }}\n    >\n      <Form schema={automapSchema} {...formState}>\n        <Field\n          name=\"mode\"\n          options={getSelectOptionsFromSchema(automapSchema.properties.mode)}\n          {...props}\n          component={Select}\n        />\n      </Form>\n    </Dialog>\n  )\n}\n\nexport default Automap\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { BaseCallProps, BaseProps } from '../../../modal.types'\n\nimport Automap from './Automap'\nimport { automap } from '../../../../../state/server'\nimport { connect } from 'react-redux'\n\ntype StateProps = Pick<BaseProps, 'formState'>\ntype DispatchProps = Pick<BaseCallProps, 'onOk'>\n\nconst mapStateToProps = (state: any): StateProps => ({\n  formState: state.modal.form\n})\n\nconst mapDispatchToProps = (dispatch: any, ownProps: any): DispatchProps => ({\n  onOk: (result) => {\n    dispatch(automap(result))\n    ownProps.onOk(result)\n  }\n})\n\nconst AutomapContainer = connect(mapStateToProps, mapDispatchToProps)(Automap)\nexport default AutomapContainer\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { BaseCallProps, BaseProps } from '../../../modal.types'\nimport Form, { Field } from '../../../../../component/form/form/form'\n\nimport { Dialog } from '../../../../components'\nimport Select from '../../../../../component/form/Select'\nimport { getSelectOptionsFromSchema } from '../../../../../utils'\nimport { bond as bondSchema } from '../../../../../data/schema/struct-schema'\nimport classes from './Bond.module.less'\n\ninterface BondProps extends BaseProps {\n  center: number\n  topology: number\n  type: string\n}\n\ntype Props = BondProps & BaseCallProps\n\nconst Bond = (props: Props) => {\n  const { formState, ...rest } = props\n  const bondProps = bondSchema.properties\n  return (\n    <Dialog\n      title=\"Bond Properties\"\n      className={classes.bond}\n      result={() => formState.result}\n      valid={() => formState.valid}\n      params={rest}\n      buttonsNameMap={{ OK: 'Apply' }}\n      buttons={['Cancel', 'OK']}\n      withDivider\n    >\n      <Form schema={bondSchema} init={rest} {...formState}>\n        <Field\n          name=\"type\"\n          component={Select}\n          options={getSelectOptionsFromSchema(bondProps.type)}\n        />\n        <Field\n          name=\"topology\"\n          component={Select}\n          options={getSelectOptionsFromSchema(bondProps.topology)}\n        />\n        <Field\n          name=\"center\"\n          component={Select}\n          options={getSelectOptionsFromSchema(bondProps.center)}\n        />\n      </Form>\n    </Dialog>\n  )\n}\n\nexport type { BondProps }\nexport default Bond\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { BaseProps } from '../../../modal.types'\nimport Bond from './Bond'\nimport { connect } from 'react-redux'\n\ntype StateProps = Pick<BaseProps, 'formState'>\n\nconst mapStateToProps = (state: any): StateProps => ({\n  formState: state.modal.form\n})\n\nconst BondContainer = connect(mapStateToProps)(Bond)\nexport default BondContainer\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Field } from '../../../../../../../component/form/form/form'\nimport { RgroupLogicProps } from '../../RgroupLogic'\nimport classes from './IfThenSelect.module.less'\nimport { useFormContext } from '../../../../../../../../../hooks'\nimport Select from '../../../../../../../component/form/Select'\nimport { getSelectOptionsFromSchema } from '../../../../../../../utils'\n\ntype Props = Pick<RgroupLogicProps, 'label' | 'rgroupLabels' | 'name'>\n\nconst IfThenSelect = (props: Props) => {\n  const { rgroupLabels, label, name } = props\n  const { schema } = useFormContext() as any\n  const desc = {\n    title: schema.properties[name!].title,\n    enum: [0],\n    enumNames: ['Always']\n  }\n\n  rgroupLabels.forEach((rgroupLabel) => {\n    if (label !== rgroupLabel) {\n      desc.enum.push(rgroupLabel)\n      desc.enumNames.push(`IF R${label} THEN R${rgroupLabel}`)\n    }\n  })\n\n  return (\n    <Field\n      schema={desc}\n      className={classes.field}\n      {...props}\n      component={Select}\n      options={getSelectOptionsFromSchema(desc)}\n    />\n  )\n}\n\nexport default IfThenSelect\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\nimport { BaseCallProps, BaseProps } from '../../../modal.types'\nimport Form, { Field } from '../../../../../component/form/form/form'\n\nimport { Dialog } from '../../../../components'\nimport IfThenSelect from './components'\nimport classes from './RgroupLogic.module.less'\nimport { rgroupLogic as rgroupSchema } from '../../../../../data/schema/struct-schema'\n\ninterface RgroupLogicProps extends BaseProps {\n  frags: Set<number>\n  ifthen: number\n  label: number\n  range: string\n  resth: boolean\n  rgroupLabels: Array<number>\n  name?: string\n}\n\ntype Props = RgroupLogicProps & BaseCallProps\n\nconst RgroupLogic = (props: Props) => {\n  const { formState, label, rgroupLabels, ...rest } = props\n  return (\n    <Dialog\n      title=\"R-Group Logic Condition\"\n      className={classes.rgroupLogic}\n      result={() => formState.result}\n      valid={() => formState.valid}\n      params={rest}\n      buttonsNameMap={{ OK: 'Apply' }}\n      buttons={['Cancel', 'OK']}\n      withDivider\n    >\n      <Form\n        schema={rgroupSchema}\n        customValid={{ range: (r) => rangeConv(r) }}\n        init={rest}\n        {...formState}\n      >\n        <Field name=\"range\" />\n        <Field name=\"resth\" labelPos=\"after\" className={classes.resth} />\n        <IfThenSelect name=\"ifthen\" label={label} rgroupLabels={rgroupLabels} />\n      </Form>\n    </Dialog>\n  )\n}\n\nfunction rangeConv(range) {\n  // structConv\n  const res = range\n    .replace(/\\s*/g, '')\n    .replace(/,+/g, ',')\n    .replace(/^,/, '')\n    .replace(/,$/, '')\n\n  return res\n    .split(',')\n    .every((s) => s.match(/^[>,<=]?[0-9]+$/g) || s.match(/^[0-9]+-[0-9]+$/g))\n}\n\nexport type { RgroupLogicProps }\nexport default RgroupLogic\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { BaseProps } from '../../../modal.types'\nimport RgroupLogic from './RgroupLogic'\nimport { connect } from 'react-redux'\n\ntype StateProps = Pick<BaseProps, 'formState'>\n\nconst mapStateToProps = (state: any): StateProps => ({\n  formState: state.modal.form\n})\n\nconst RgroupLogicContainer = connect(mapStateToProps)(RgroupLogic)\nexport default RgroupLogicContainer\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport Icon from 'src/script/ui/component/view/icon'\nimport styles from './AnalyzingFile.module.less'\nimport { LoadingCircles } from 'src/script/ui/views/components/Spinner'\n\nexport type AnalyzingFileProps = {\n  fileName?: string\n}\n\nconst ICON_NAME = 'file-thumbnail'\n\nexport const AnalyzingFile = ({ fileName }: AnalyzingFileProps) => (\n  <div className={styles.analyzingFileWrapper}>\n    {fileName && (\n      <div className={styles.fileBox}>\n        <Icon name={ICON_NAME} />\n        <p>{fileName}</p>\n      </div>\n    )}\n    <LoadingCircles />\n  </div>\n)\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { useMemo } from 'react'\nimport { useDropzone, DropzoneOptions } from 'react-dropzone'\n\nimport parentStyles from './OpenOptions.module.less'\nimport styles from './FileDrop.module.less'\nimport Icon from 'src/script/ui/component/view/icon'\n\ntype FileDropProps = {\n  buttonLabel: string\n  textLabel: string\n  iconName: string\n  disabled?: boolean\n  disabledText?: string\n} & DropzoneOptions\n\nconst FileDrop = ({\n  buttonLabel,\n  textLabel,\n  iconName,\n  disabled,\n  disabledText,\n  ...rest\n}: FileDropProps) => {\n  const { getRootProps, getInputProps, isDragActive, open } = useDropzone({\n    multiple: false,\n    disabled,\n    ...rest\n  })\n\n  const getClassesString = useMemo((): string => {\n    const classes = [\n      parentStyles.dropContainer,\n      isDragActive ? styles.isHovered : null,\n      disabled ? styles.isDisabled : null\n    ]\n    return classes.join(' ')\n  }, [isDragActive])\n\n  return (\n    <div\n      onKeyDown={open}\n      {...getRootProps({\n        className: getClassesString\n      })}\n    >\n      <input {...getInputProps()} />\n      <div className={parentStyles.dropIconWrapper}>\n        <Icon name={iconName} />\n      </div>\n      {disabled ? (\n        <p className={parentStyles.textLabel}>{disabledText}</p>\n      ) : (\n        <>\n          <div className={parentStyles.textLabelWrapper}>\n            <p className={parentStyles.textLabel}>{textLabel}</p>\n          </div>\n          <div className={parentStyles.buttonLabelWrapper}>\n            <p className={parentStyles.buttonLabel}>{buttonLabel}</p>\n          </div>\n        </>\n      )}\n    </div>\n  )\n}\n\nexport { FileDrop }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { FC } from 'react'\n\nimport Icon from 'src/script/ui/component/view/icon'\nimport styles from './OpenOptions.module.less'\nimport { FileDrop } from './FileDrop'\n\nconst ICON_NAMES = {\n  PASTE: 'open-window-paste-icon',\n  FILE: 'open-window-upload-icon',\n  IMAGE: 'image-frame'\n}\n\nexport type OpenOptionsProps = {\n  selectClipboard: () => void\n  errorHandler: (err: string) => void\n  fileLoadHandler: (files: File[]) => void\n  imageLoadHandler: (files: File[]) => void\n  isRecognizeDisabled: boolean\n}\n\nexport const OpenOptions: FC<OpenOptionsProps> = ({\n  selectClipboard,\n  fileLoadHandler,\n  imageLoadHandler,\n  isRecognizeDisabled,\n  errorHandler\n}) => {\n  return (\n    <div className={styles.optionsContainer}>\n      <div onClick={selectClipboard} className={styles.dropContainer}>\n        <div className={styles.dropIconWrapper}>\n          <Icon name={ICON_NAMES.PASTE} />\n        </div>\n        <div className={styles.textLabelWrapper}>\n          {/* <p className={styles.textLabel}>or press Ctrl + V</p> */}\n        </div>\n        <div className={styles.buttonLabelWrapper}>\n          <p className={styles.buttonLabel}>Paste from clipboard</p>\n        </div>\n      </div>\n\n      <FileDrop\n        onDropAccepted={fileLoadHandler}\n        onDropRejected={(e) => errorHandler(`Unable to accept file(s). ${e}`)}\n        buttonLabel=\"Open from file\"\n        textLabel=\"or drag file here\"\n        iconName={ICON_NAMES.FILE}\n      />\n\n      <FileDrop\n        accept=\"image/*\"\n        disabled={isRecognizeDisabled}\n        disabledText=\"Image Recognition service is not available\"\n        onDropAccepted={imageLoadHandler}\n        onDropRejected={() =>\n          errorHandler(\n            'Unable to accept file(s). Make sure you upload 1 image.'\n          )\n        }\n        buttonLabel=\"Open from image\"\n        textLabel=\"or drag file here\"\n        iconName={ICON_NAMES.IMAGE}\n      />\n    </div>\n  )\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport classes from '../Open.module.less'\n\nexport type TextEditorProps = {\n  structStr: string\n  inputHandler: (str: string) => void\n  autoFocus?: boolean\n}\n\nexport const TextEditor = ({\n  structStr,\n  inputHandler,\n  autoFocus = false\n}: TextEditorProps) => {\n  return (\n    <>\n      <textarea\n        className={classes.textareaEditor}\n        value={structStr}\n        onChange={(event) => inputHandler(event.target.value)}\n        autoFocus={autoFocus}\n      />\n    </>\n  )\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { FC } from 'react'\nimport { AnalyzingFile, AnalyzingFileProps } from './AnalyzingFile'\n\nimport { OpenOptions, OpenOptionsProps } from './OpenOptions'\nimport { TextEditor, TextEditorProps } from './TextEditor'\n\ntype ViewStates = {\n  idle: string\n  textEditor: string\n  imageRec: string\n}\n\ntype SwitchProps = {\n  currentState: string\n  states: ViewStates\n  isAnalyzingFile: boolean\n} & OpenOptionsProps &\n  TextEditorProps &\n  AnalyzingFileProps\n\nexport const ViewSwitcher: FC<SwitchProps> = (props: SwitchProps) => {\n  if (props.isAnalyzingFile) {\n    return <AnalyzingFile fileName={props.fileName} />\n  } else {\n    switch (props.currentState) {\n      case props.states.idle:\n        return <OpenOptions {...props} />\n      case props.states.textEditor:\n        return <TextEditor {...props} />\n      default:\n        return null\n    }\n  }\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { BaseCallProps, BaseProps } from '../../../modal.types'\nimport { FC, useEffect, useState } from 'react'\nimport { Dialog } from '../../../../components'\nimport classes from './Open.module.less'\nimport Recognize from '../../process/Recognize/Recognize'\nimport { fileOpener } from '../../../../../utils/'\nimport { DialogActionButton } from './components/DialogActionButton'\nimport { ViewSwitcher } from './components/ViewSwitcher'\n\ninterface OpenProps {\n  server: any\n  errorHandler: (err: string) => void\n  isRecognizeDisabled: boolean\n  isAnalyzingFile: boolean\n  ignoreChiralFlag: boolean\n}\n\ntype Props = OpenProps &\n  Pick<BaseProps, 'className'> &\n  BaseCallProps & { onImageUpload: (file: File) => void }\n\nconst MODAL_STATES = {\n  idle: 'idle',\n  textEditor: 'textEditor',\n  imageRec: 'imageRec'\n}\n\nconst FooterContent = ({ structStr, openHandler, copyHandler, onCancel }) => {\n  return (\n    <div className={classes.footerContent}>\n      <button onClick={onCancel} className={classes.cancelButton}>\n        Cancel\n      </button>\n      <div className={classes.buttonsContainer}>\n        <DialogActionButton\n          key=\"openButton\"\n          disabled={!structStr}\n          clickHandler={openHandler}\n          styles={classes.openButton}\n          label=\"Open as New Project\"\n        />\n        <DialogActionButton\n          key=\"copyButton\"\n          disabled={!structStr}\n          clickHandler={copyHandler}\n          styles={classes.copyButton}\n          label=\"Add to Canvas\"\n          title=\"Structure will be loaded as fragment and added to Clipboard\"\n        />\n      </div>\n    </div>\n  )\n}\n\nconst Open: FC<Props> = (props) => {\n  const {\n    server,\n    onImageUpload,\n    errorHandler,\n    isAnalyzingFile,\n    isRecognizeDisabled,\n    ignoreChiralFlag,\n    ...rest\n  } = props\n\n  const [structStr, setStructStr] = useState<string>('')\n  const [fileName, setFileName] = useState<string>('')\n  const [opener, setOpener] = useState<any>()\n  const [currentState, setCurrentState] = useState(MODAL_STATES.idle)\n\n  useEffect(() => {\n    if (server) {\n      fileOpener(server).then((chosenOpener) => {\n        setOpener({ chosenOpener })\n      })\n    }\n  }, [server])\n\n  const onFileLoad = (files) => {\n    const onLoad = (fileContent) => {\n      setStructStr(fileContent)\n      setCurrentState(MODAL_STATES.textEditor)\n    }\n    const onError = () => errorHandler('Error processing file')\n\n    setFileName(files[0].name)\n    opener.chosenOpener(files[0]).then(onLoad, onError)\n  }\n\n  const onImageLoad = (files) => {\n    onImageUpload(files[0])\n    setCurrentState(MODAL_STATES.imageRec)\n  }\n\n  // @TODO after Recognize is refactored this will not be necessary\n  // currently not destructuring onOk with other props so we can pass it with ...rest to Recognize below\n  const { onOk } = rest\n\n  const copyHandler = () => {\n    onOk({ structStr, fragment: true })\n  }\n\n  const openHandler = () => {\n    onOk({ structStr, fragment: false })\n  }\n\n  const withFooterContent =\n    currentState === MODAL_STATES.textEditor && !isAnalyzingFile\n\n  // @TODO after refactoring of Recognize modal\n  // add Recognize rendering logic into ViewSwitcher component here\n  if (currentState === MODAL_STATES.imageRec) {\n    return <Recognize {...rest} />\n  }\n\n  return (\n    <Dialog\n      title=\"Open structure\"\n      className={classes.open}\n      params={rest}\n      result={() => null}\n      footerContent={\n        withFooterContent ? (\n          <FooterContent\n            structStr={structStr}\n            openHandler={openHandler}\n            copyHandler={copyHandler}\n            onCancel={rest.onCancel}\n          />\n        ) : undefined\n      }\n      buttons={[]}\n      withDivider\n    >\n      <ViewSwitcher\n        isAnalyzingFile={isAnalyzingFile}\n        fileName={fileName}\n        currentState={currentState}\n        states={MODAL_STATES}\n        selectClipboard={() => setCurrentState(MODAL_STATES.textEditor)}\n        fileLoadHandler={onFileLoad}\n        imageLoadHandler={onImageLoad}\n        errorHandler={errorHandler}\n        isRecognizeDisabled={isRecognizeDisabled}\n        structStr={structStr}\n        inputHandler={setStructStr}\n        autoFocus\n      />\n    </Dialog>\n  )\n}\n\nexport type { OpenProps }\nexport default Open\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport Open, { OpenProps } from './Open'\n\nimport { BaseCallProps } from '../../../modal.types'\nimport { connect } from 'react-redux'\nimport { exec } from '../../../../../component/cliparea/cliparea'\nimport { load } from '../../../../../state'\nimport { changeImage } from '../../../../../state/options'\n\ntype StateProps = OpenProps\n\ntype DispatchProps = {\n  onOk: BaseCallProps['onOk']\n  onImageUpload: (file: File) => void\n}\n\nconst mapStateToProps = (state): StateProps => ({\n  server: state.server,\n  errorHandler: state.editor.errorHandler,\n  isRecognizeDisabled: state.actionState.recognize?.disabled,\n  isAnalyzingFile: state.requestsStatuses.isAnalyzingFile,\n  ignoreChiralFlag: state.editor.render.options.ignoreChiralFlag\n})\n\nconst mapDispatchToProps = (dispatch): DispatchProps => ({\n  onOk: (result) => {\n    if (result.fragment) exec('copy')\n    dispatch(\n      load(result.structStr, {\n        badHeaderRecover: true,\n        fragment: result.fragment\n      })\n      // TODO: Removed ownProps.onOk call. consider refactoring of load function in release 2.4\n      // See PR #731 (https://github.com/epam/ketcher/pull/731)\n    )\n  },\n  onImageUpload: (file) => {\n    dispatch(changeImage(file))\n  }\n})\n\nconst OpenContainer = connect(mapStateToProps, mapDispatchToProps)(Open)\nexport default OpenContainer\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  RxnArrowMode,\n  StereoFlag,\n  Struct,\n  SupportedFormat,\n  getPropertiesByFormat\n} from 'ketcher-core'\n\nexport function couldBeSaved(\n  struct: Struct,\n  format: SupportedFormat\n): string | null {\n  const warnings: Array<string> = []\n  const formatName: string = getPropertiesByFormat(format).name\n\n  const rxnArrowsSize = struct.rxnArrows.size\n  const hasRxnArrow = struct.hasRxnArrow()\n\n  if (format === 'smiles' || format === 'smarts') {\n    warnings.push(\n      `Structure contains query properties of atoms and bonds that are not supported in the ${format?.toUpperCase()}. Query properties will not be reflected in the file saved.`\n    )\n  }\n\n  if (format === 'smiles') {\n    const arrayOfAtoms: Array<any> = Array.from(struct.atoms.values())\n    const hasGenerics = arrayOfAtoms.some((atom) => atom.pseudo)\n    if (hasGenerics) {\n      warnings.push(\n        `Structure contains generic atoms. They will be saved as any atom (*).`\n      )\n    }\n  }\n\n  if (format !== 'ket') {\n    if (hasRxnArrow) {\n      const arrayOfArrows: Array<any> = Array.from(struct.rxnArrows.values())\n      const rxnArrowMode: RxnArrowMode = arrayOfArrows[0].mode\n      if (rxnArrowMode !== RxnArrowMode.OpenAngle) {\n        warnings.push(\n          `The ${formatName} format does not support drawn elements: the reaction ${rxnArrowMode} arrow will be replaced with the reaction arrow`\n        )\n      }\n    }\n\n    // TODO: find better solution for case when Arrows > 1\n    if (rxnArrowsSize > 1) {\n      warnings.push(\n        `The ${formatName} format does not support drawn elements: reaction arrows will be lost.`\n      )\n    }\n  }\n\n  if (\n    (\n      ['inChI', 'inChIAuxInfo', 'smiles', 'smilesExt'] as SupportedFormat[]\n    ).includes(format)\n  ) {\n    if (struct.rgroups.size !== 0)\n      warnings.push(\n        `In ${formatName} the structure will be saved without R-group fragments`\n      )\n\n    struct = struct.clone() // need this: .getScaffold()\n    const isRg = struct.atoms.find((_ind, atom) => atom.label === 'R#')\n    if (isRg !== null)\n      warnings.push(\n        `In ${formatName} the structure will be saved without R-group members`\n      )\n\n    const isSg = struct.sgroups.find(\n      (_ind, sg) =>\n        sg.type !== 'MUL' && !/^INDIGO_.+_DESC$/i.test(sg.data.fieldName)\n    )\n    if (isSg !== null)\n      warnings.push(\n        `In ${formatName} the structure will be saved without S-groups`\n      )\n  }\n\n  if (\n    (\n      [\n        'smiles',\n        'smilesExt',\n        'smarts',\n        'inChI',\n        'inChIAuxInfo',\n        'cml'\n      ] as SupportedFormat[]\n    ).includes(format)\n  ) {\n    const isVal = struct.atoms.find((_ind, atom) => atom.explicitValence >= 0)\n    if (isVal !== null)\n      warnings.push(`In ${formatName} valence is not supported`)\n  }\n\n  if (\n    (['mol', 'rxn'] as SupportedFormat[]).includes(format) &&\n    Array.from(struct.frags.values()).some((fr) => {\n      if (fr?.enhancedStereoFlag) {\n        return fr.enhancedStereoFlag !== StereoFlag.Abs\n      }\n      return false\n    })\n  ) {\n    warnings.push(\n      `Structure contains enhanced stereochemistry features. Information will be partly lost.`\n    )\n  }\n\n  if (\n    (\n      ['inChI', 'inChIAuxInfo', 'smiles', 'smilesExt'] as SupportedFormat[]\n    ).includes(format)\n  ) {\n    if (struct.functionalGroups.size !== 0)\n      warnings.push(\n        `In ${formatName} the structure will be saved without functional groups.`\n      )\n  }\n\n  if ((['cml'] as SupportedFormat[]).includes(format)) {\n    if (struct.functionalGroups.size !== 0)\n      warnings.push(\n        `Structure contains functional groups. In ${formatName} information will be partly lost.`\n      )\n  }\n\n  if (warnings.length !== 0) return warnings.join('\\n')\n\n  return null\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Component } from 'react'\nimport classes from './Tabs.module.less'\nimport clsx from 'clsx'\n\nclass Tabs extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {}\n    this.state.tabIndex = props.tabIndex || 0\n    this.props.changeTab(this.state.tabIndex)\n  }\n\n  // TODO: refactor the component\n  changeTab(ev, index) {\n    this.setState({ tabIndex: index })\n    if (this.props.changeTab) this.props.changeTab(index)\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.tabIndex !== prevProps.tabIndex) {\n      this.setState({ tabIndex: this.props.tabIndex })\n    }\n  }\n\n  render() {\n    const { tabs, contentClassName, className, tabIndex } = this.props\n    const tabPanel = tabs[this.state.tabIndex]\n    const Component = tabPanel?.component\n    const componentProps = tabPanel?.props\n    return (\n      <div>\n        <ul className={className} tabIndex={tabIndex}>\n          <li className={classes.tabs}>\n            {tabs.map((tabPanel, index) => (\n              <a // eslint-disable-line\n                key={index}\n                className={clsx({\n                  [classes.active]: this.state.tabIndex === index\n                })}\n                onClick={(ev) => this.changeTab(ev, index)}\n              >\n                {tabPanel.caption}\n              </a>\n            ))}\n          </li>\n        </ul>\n        {tabPanel && (\n          <div className={contentClassName}>\n            <Component {...componentProps} />\n          </div>\n        )}\n      </div>\n    )\n  }\n}\n\nexport default Tabs\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport * as structFormat from '../../../../../data/convert/structConverter'\n\nimport { Component, createRef } from 'react'\nimport Form, { Field } from '../../../../../component/form/form/form'\nimport {\n  FormatterFactory,\n  KetSerializer,\n  formatProperties,\n  getPropertiesByFormat,\n  getPropertiesByImgFormat,\n  b64toBlob\n} from 'ketcher-core'\n\nimport { Dialog } from '../../../../components'\nimport Tabs from 'src/script/ui/component/view/Tabs'\nimport { ErrorsContext } from '../../../../../../../contexts'\nimport { SaveButton } from '../../../../../component/view/savebutton'\nimport { check } from '../../../../../state/server'\nimport classes from './Save.module.less'\nimport { connect } from 'react-redux'\nimport { saveUserTmpl } from '../../../../../state/templates'\nimport { updateFormState } from '../../../../../state/modal/form'\nimport Select from '../../../../../component/form/Select'\nimport { getSelectOptionsFromSchema } from '../../../../../utils'\nimport { LoadingCircles } from 'src/script/ui/views/components/Spinner'\n\nconst saveSchema = {\n  title: 'Save',\n  type: 'object',\n  properties: {\n    filename: {\n      title: 'File name:',\n      type: 'string',\n      maxLength: 128,\n      pattern: '^[^.<>:?\"*\\\\\\\\|\\\\/][^<>:?\"*\\\\\\\\|\\\\/]*$',\n      invalidMessage: (res) => {\n        if (!res) return 'Filename should contain at least one character'\n        if (res.length > 128) return 'Filename is too long'\n        return \"A filename cannot contain characters: \\\\ / : * ? \\\" < > | and cannot start with '.'\"\n      }\n    },\n    format: {\n      title: 'File format:',\n      enum: Object.keys(formatProperties),\n      enumNames: Object.keys(formatProperties).map(\n        (format) => formatProperties[format].name\n      )\n    }\n  }\n}\n\nclass SaveDialog extends Component {\n  static contextType = ErrorsContext\n  constructor(props) {\n    super(props)\n    this.state = {\n      disableControls: true,\n      imageFormat: 'svg',\n      tabIndex: 0,\n      isLoading: true\n    }\n    this.isRxn = this.props.struct.hasRxnArrow()\n    this.textAreaRef = createRef()\n    const formats = [this.isRxn ? 'rxn' : 'mol', 'smiles', 'ket']\n    if (this.props.server)\n      formats.push(\n        this.isRxn ? 'rxnV3000' : 'molV3000',\n        'smilesExt',\n        'smarts',\n        'cml',\n        '<----firstDivider--->', // for dividers in select list\n        'inChI',\n        'inChIAuxInfo',\n        '<----secondDivider--->', // for dividers in select list\n        'svg',\n        'png',\n        'cdxml',\n        'cdx',\n        'binaryCdx'\n      )\n    // TODO: pass the necessary divider not like list element\n\n    this.saveSchema = saveSchema\n    this.saveSchema.properties.format = Object.assign(\n      this.saveSchema.properties.format,\n      {\n        enum: formats,\n        enumNames: formats.map((format) => {\n          const formatProps =\n            getPropertiesByFormat(format) || getPropertiesByImgFormat(format)\n          return formatProps?.name\n        })\n      }\n    )\n  }\n\n  componentDidMount() {\n    const { checkOptions } = this.props.checkState\n    this.props.onCheck(checkOptions)\n    this.changeType(this.isRxn ? 'rxn' : 'mol').then(\n      (res) => res instanceof Error && this.setState({ disableControls: true })\n    )\n  }\n\n  isImageFormat = (format) => {\n    return !!getPropertiesByImgFormat(format)\n  }\n\n  isBinaryCdxFormat = (format) => {\n    return format === 'binaryCdx'\n  }\n\n  showStructWarningMessage = (format) => {\n    const { errors } = this.props.formState\n    return format !== 'mol' && Object.keys(errors).length > 0\n  }\n\n  changeType = (type) => {\n    const { struct, server, options, formState, ignoreChiralFlag } = this.props\n\n    const errorHandler = this.context.errorHandler\n    if (this.isImageFormat(type)) {\n      const ketSerialize = new KetSerializer()\n      const structStr = ketSerialize.serialize(struct)\n      this.setState({\n        disableControls: true,\n        tabIndex: 0,\n        imageFormat: type,\n        structStr,\n        isLoading: true\n      })\n      const options = {}\n      options.outputFormat = type\n\n      return server\n        .generateImageAsBase64(structStr, options)\n        .then((base64) => {\n          this.setState({\n            disableControls: false,\n            tabIndex: 0,\n            imageSrc: base64,\n            isLoading: false\n          })\n        })\n        .catch((e) => {\n          errorHandler(e)\n          this.props.onResetForm(formState)\n          return e\n        })\n    } else {\n      this.setState({ disableControls: true, isLoading: true })\n      const factory = new FormatterFactory(server)\n      const service = factory.create(type, { ...options, ignoreChiralFlag })\n\n      return service\n        .getStructureFromStructAsync(struct)\n        .then(\n          (structStr) => {\n            this.setState({\n              tabIndex: 0,\n              structStr\n            })\n          },\n          (e) => {\n            errorHandler(e.message)\n            this.props.onResetForm(formState)\n            return e\n          }\n        )\n        .finally(() => {\n          this.setState({\n            disableControls: false,\n            tabIndex: 0,\n            isLoading: false\n          })\n        })\n    }\n  }\n\n  changeTab = (index) => {\n    this.setState({ tabIndex: index })\n  }\n\n  getWarnings = (format) => {\n    const { struct, moleculeErrors } = this.props\n    const warnings = []\n    const structWarning =\n      'Structure contains errors, please check the data, otherwise you ' +\n      'can lose some properties or the whole structure after saving in this format.'\n    if (!this.isImageFormat(format)) {\n      const saveWarning = structFormat.couldBeSaved(struct, format)\n      const isStructInvalid = this.showStructWarningMessage(format)\n      if (isStructInvalid) {\n        warnings.push(structWarning)\n      }\n      if (saveWarning) {\n        warnings.push(saveWarning)\n      }\n    }\n\n    if (moleculeErrors) {\n      warnings.push(...Object.values(moleculeErrors))\n    }\n    return warnings\n  }\n\n  renderForm = () => {\n    const formState = Object.assign({}, this.props.formState)\n    const { filename, format } = formState.result\n    const warnings = this.getWarnings(format)\n    const tabs =\n      warnings.length === 0\n        ? [\n            {\n              caption: 'Preview',\n              component: this.renderSaveFile,\n              tabIndex: 0\n            }\n          ]\n        : [\n            {\n              caption: 'Preview',\n              component: this.renderSaveFile,\n              tabIndex: 0\n            },\n            {\n              caption: 'Warnings',\n              component: this.renderWarnings,\n              tabIndex: 1\n            }\n          ]\n\n    return (\n      <div className={classes.formContainer}>\n        <Form\n          schema={this.saveSchema}\n          init={{\n            filename,\n            format: this.isRxn ? 'rxn' : 'mol'\n          }}\n          {...formState}\n        >\n          <Field name=\"filename\" />\n          <Field\n            name=\"format\"\n            onChange={this.changeType}\n            options={getSelectOptionsFromSchema(\n              this.saveSchema.properties.format\n            )}\n            component={Select}\n          />\n        </Form>\n        <Tabs\n          className={classes.tabs}\n          captions={tabs}\n          tabIndex={this.state.tabIndex}\n          changeTab={this.changeTab}\n          tabs={tabs}\n        />\n      </div>\n    )\n  }\n\n  renderSaveFile = () => {\n    const formState = Object.assign({}, this.props.formState)\n    delete formState.moleculeErrors\n    const { filename, format } = formState.result\n    const { structStr, imageSrc, isLoading } = this.state\n    const isCleanStruct = this.props.struct.isBlank()\n\n    const LoadingState = () => (\n      <div className={classes.loadingCirclesContainer}>\n        <LoadingCircles />\n      </div>\n    )\n\n    const ImageContent = () => (\n      <div className={classes.imageContainer}>\n        {!isCleanStruct && (\n          <img\n            src={`data:image/${format}+xml;base64,${imageSrc}`}\n            alt={`${format} preview`}\n          />\n        )}\n      </div>\n    )\n\n    const BinaryContent = () => (\n      <div className={classes.previewBackground}>\n        <textarea\n          value=\"Can not display binary content\"\n          className={classes.previewArea}\n          readOnly\n          ref={this.textAreaRef}\n        />\n      </div>\n    )\n\n    const PreviewContent = () => (\n      <div className={classes.previewBackground}>\n        <textarea\n          value={structStr}\n          className={classes.previewArea}\n          readOnly\n          ref={this.textAreaRef}\n        />\n      </div>\n    )\n\n    if (isLoading) {\n      return <LoadingState />\n    } else if (this.isImageFormat(format)) {\n      return <ImageContent />\n    } else if (this.isBinaryCdxFormat(format)) {\n      return <BinaryContent />\n    } else {\n      return <PreviewContent />\n    }\n  }\n\n  renderWarnings = () => {\n    const formState = Object.assign({}, this.props.formState)\n    const { filename, format } = formState.result\n    const warnings = this.getWarnings(format)\n\n    return warnings.length ? (\n      <div className={classes.warnings}>\n        {warnings.map((warning) => (\n          <div className={classes.warningsContainer}>\n            <span className={classes.warningsArr}>{warning}</span>\n          </div>\n        ))}\n      </div>\n    ) : null\n  }\n\n  getButtons = () => {\n    const { disableControls, imageFormat, isLoading, structStr } = this.state\n    const formState = this.props.formState\n    const { filename, format } = formState.result\n    const isCleanStruct = this.props.struct.isBlank()\n\n    const savingStruct =\n      this.isBinaryCdxFormat(format) && !isLoading\n        ? b64toBlob(structStr)\n        : structStr\n\n    const isMoleculeContain =\n      this.props.struct.atoms.size && this.props.struct.bonds.size\n    const buttons = [\n      <button\n        key=\"save-tmpl\"\n        className={classes.saveTmpl}\n        disabled={disableControls || isCleanStruct || !isMoleculeContain}\n        onClick={() => this.props.onTmplSave(this.props.struct)}\n      >\n        Save to Templates\n      </button>\n    ]\n\n    buttons.push(\n      <button\n        key=\"cancel\"\n        mode=\"onCancel\"\n        className={classes.cancel}\n        onClick={() => this.props.onOk({})}\n        type=\"button\"\n      >\n        Cancel\n      </button>\n    )\n\n    if (this.isImageFormat(format)) {\n      buttons.push(\n        <SaveButton\n          mode=\"saveImage\"\n          data={structStr}\n          filename={filename}\n          outputFormat={imageFormat}\n          key=\"save-image-button\"\n          type={`image/${format}+xml`}\n          onSave={this.props.onOk}\n          disabled={\n            disableControls ||\n            !formState.valid ||\n            isCleanStruct ||\n            !this.props.server\n          }\n          className={classes.ok}\n        >\n          Save\n        </SaveButton>\n      )\n    } else {\n      buttons.push(\n        <SaveButton\n          mode=\"saveFile\"\n          data={savingStruct}\n          filename={filename + getPropertiesByFormat(format).extensions[0]}\n          key=\"save-file-button\"\n          type={format.mime}\n          server={this.props.server}\n          onSave={this.props.onOk}\n          disabled={disableControls || !formState.valid || isCleanStruct}\n          className={classes.ok}\n        >\n          Save\n        </SaveButton>\n      )\n    }\n    return buttons\n  }\n\n  render() {\n    return (\n      <Dialog\n        className={classes.dialog}\n        title=\"Save Structure\"\n        params={this.props}\n        buttons={this.getButtons()}\n        needMargin={false}\n        withDivider={true}\n      >\n        {this.renderForm()}\n      </Dialog>\n    )\n  }\n}\n\nconst mapStateToProps = (state) => ({\n  server: state.options.app.server ? state.server : null,\n  struct: state.editor.struct(),\n  options: state.options.getServerSettings(),\n  formState: state.modal.form,\n  moleculeErrors: state.modal.form.moleculeErrors,\n  checkState: state.options.check,\n  ignoreChiralFlag: state.editor.render.options.ignoreChiralFlag\n})\n\nconst mapDispatchToProps = (dispatch) => ({\n  onCheck: (checkOptions) => dispatch(check(checkOptions)),\n  onTmplSave: (struct) => dispatch(saveUserTmpl(struct)),\n  onResetForm: (prevState) => dispatch(updateFormState(prevState))\n})\n\nconst Save = connect(mapStateToProps, mapDispatchToProps)(SaveDialog)\n\nexport default Save\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport Form, { Field } from '../../../component/form/form/form'\nimport { StereoLabel, Struct } from 'ketcher-core'\n\nimport { Dialog } from '../../../views/components'\nimport { FC } from 'react'\nimport classes from './enhancedStereo.module.less'\nimport { connect } from 'react-redux'\nimport { range } from 'lodash'\n\ninterface EnhancedStereoResult {\n  andNumber: number\n  orNumber: number\n  type: StereoLabel\n}\n\ninterface EnhancedStereoFormState {\n  result: EnhancedStereoResult\n  valid: boolean\n  errors: string[]\n}\n\ninterface EnhancedStereoProps {\n  className: string\n  init: EnhancedStereoResult & { init?: true }\n  formState: EnhancedStereoFormState\n  struct: Struct\n}\n\ninterface EnhancedStereoCallProps {\n  onCancel: () => void\n  onOk: (res: any) => void\n}\n\ntype Props = EnhancedStereoProps & EnhancedStereoCallProps\n\nconst EnhancedStereo: FC<Props> = (props) => {\n  const { struct, formState, init, ...rest } = props\n  const { result, valid } = formState\n\n  const stereoLabels: Array<string> = findStereLabels(\n    struct,\n    Array.from(struct.atoms.keys())\n  )\n\n  const maxAnd: number = maxOfAnds(stereoLabels)\n  const maxOr: number = maxOfOrs(stereoLabels)\n\n  const enhancedStereoSchema = {\n    title: 'Enhanced Stereo',\n    type: 'object',\n    properties: {\n      type: {\n        type: 'string'\n      },\n      andNumber: {\n        type: 'integer'\n      },\n      orNumber: {\n        type: 'integer'\n      }\n    }\n  }\n\n  return (\n    <Dialog\n      title=\"Enhanced Stereochemistry\"\n      className={classes.enhancedStereo}\n      params={rest}\n      result={() => result}\n      valid={() => valid}\n      withDivider\n      buttons={['Cancel', 'OK']}\n      buttonsNameMap={{ OK: 'Apply' }}\n    >\n      <Form schema={enhancedStereoSchema} init={init} {...formState}>\n        <fieldset>\n          <label>\n            <Field\n              name=\"type\"\n              labelPos={false}\n              type=\"radio\"\n              value={StereoLabel.Abs}\n              checked={result.type === StereoLabel.Abs}\n            />\n            ABS\n          </label>\n          {maxAnd !== 0 && (\n            <label>\n              <Field\n                name=\"type\"\n                labelPos={false}\n                type=\"radio\"\n                value={StereoLabel.And}\n                checked={result.type === StereoLabel.And}\n              />\n              Add to AND\n              <Field\n                name=\"andNumber\"\n                schema={range(1, maxAnd + 1)}\n                type=\"text\"\n                className={classes.labelGroupSelect}\n              />\n              Group\n            </label>\n          )}\n          {maxOr !== 0 && (\n            <label>\n              <Field\n                name=\"type\"\n                labelPos={false}\n                type=\"radio\"\n                value={StereoLabel.Or}\n                checked={result.type === StereoLabel.Or}\n              />\n              Add to OR\n              <Field\n                name=\"orNumber\"\n                schema={range(1, maxOr + 1)}\n                type=\"text\"\n                className={classes.labelGroupSelect}\n              />\n              Group\n            </label>\n          )}\n          <label>\n            <Field\n              name=\"type\"\n              labelPos={false}\n              type=\"radio\"\n              value={`${StereoLabel.And}${maxAnd + 1}`}\n              checked={result.type === `${StereoLabel.And}${maxAnd + 1}`}\n            />\n            Create new AND Group\n          </label>\n          <label>\n            <Field\n              name=\"type\"\n              labelPos={false}\n              type=\"radio\"\n              value={`${StereoLabel.Or}${maxOr + 1}`}\n              checked={result.type === `${StereoLabel.Or}${maxOr + 1}`}\n            />\n            Create new OR Group\n          </label>\n        </fieldset>\n      </Form>\n    </Dialog>\n  )\n}\n\n// TODO: Move the function below to Struct class\nfunction findStereLabels(struct, aids): Array<string> {\n  const stereoIds = aids.filter(\n    (aid) => struct.atoms.get(aid).stereoLabel !== null\n  )\n  return stereoIds.map((aid) => struct.atoms.get(aid).stereoLabel)\n}\n\nfunction maxOfAnds(stereLabels): number {\n  const numbers = stereLabels.map((label) => {\n    return label.match(/&/) ? +label.match(/\\d+/)?.join() : 0\n  })\n  return Math.max(...numbers)\n}\n\nfunction maxOfOrs(stereLabels): number {\n  const numbers = stereLabels.map((label) => {\n    return label.match(/or/) ? +label.match(/\\d+/)?.join() : 0\n  })\n  return Math.max(...numbers)\n}\n\nexport default connect((state) => ({\n  formState: (state as any).modal.form || { result: {}, valid: false },\n  struct: (state as any).editor.struct()\n}))(EnhancedStereo)\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport Form, { Field } from '../../component/form/form/form'\n\nimport { Dialog } from '../../views/components'\nimport { Elements } from 'ketcher-core'\nimport { capitalize } from 'lodash/fp'\nimport { connect } from 'react-redux'\nimport { labelEdit as labelEditSchema } from '../../data/schema/struct-schema'\nimport styles from './labelEdit.module.less'\n\nfunction serialize(lc) {\n  const charge = Math.abs(lc.charge)\n  const radical = ['', ':', '.', '^^'][lc.radical] || ''\n  let sign = ''\n  if (charge) sign = lc.charge < 0 ? '-' : '+'\n  return (\n    (lc.isotope || '') + lc.label + radical + (charge > 1 ? charge : '') + sign\n  )\n}\n\nfunction deserialize(value) {\n  const match = value.match(/^(\\d+)?([a-z*]{1,3})(\\.|:|\\^\\^)?(\\d+[-+]|[-+])?$/i) // TODO: radical on last place\n  if (match) {\n    const label = match[2] === '*' ? 'A' : capitalize(match[2])\n    let charge = 0\n    let isotope = 0\n    let radical = 0\n\n    if (match[1]) isotope = parseInt(match[1])\n\n    if (match[3]) radical = { ':': 1, '.': 2, '^^': 3 }[match[3]]\n\n    if (match[4]) {\n      charge = parseInt(match[4])\n      if (isNaN(charge))\n        // eslint-disable-line\n        charge = 1\n      if (match[4].endsWith('-')) charge = -charge\n    }\n    // Not consistant\n    if (\n      label === 'A' ||\n      label === 'Q' ||\n      label === 'X' ||\n      label === 'M' ||\n      Elements.get(label)\n    )\n      return { label, charge, isotope, radical }\n  }\n  return null\n}\n\nfunction LabelEdit(props) {\n  const init = { label: props.letter || serialize(props) }\n  const { formState, ...prop } = props\n  const { result, valid } = formState\n\n  return (\n    <Dialog\n      title=\"Label Edit\"\n      valid={() => valid}\n      withDivider={true}\n      needMargin={false}\n      result={() => deserialize(result.label)}\n      className={styles.labelEdit}\n      buttons={['Cancel', 'OK']}\n      buttonsNameMap={{ OK: 'Apply' }}\n      focusable={false}\n      params={prop}\n    >\n      <Form\n        schema={labelEditSchema}\n        customValid={{ label: (l) => deserialize(l) }}\n        init={init}\n        {...formState}\n      >\n        <Field\n          name=\"label\"\n          maxLength=\"20\"\n          size=\"10\"\n          autoFocus\n          className={styles.labelEditInputField}\n        />\n      </Form>\n    </Dialog>\n  )\n}\n\nexport default connect((store) => ({ formState: store.modal.form }))(LabelEdit)\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { ElementColor } from 'ketcher-core'\nimport classes from './AtomInfo.module.less'\nimport clsx from 'clsx'\n\nfunction AtomInfo({ el, isInfo }) {\n  const numberStyle = {\n    color: ElementColor[el.label] || 'black',\n    fontSize: '12px'\n  }\n  const elemStyle = {\n    color: ElementColor[el.label] || 'black',\n    fontWeight: 'bold',\n    fontSize: '18px'\n  }\n  return (\n    <div className={clsx(classes.ket_atom_info, !isInfo && classes.none)}>\n      <div style={numberStyle}>{el.number}</div>\n      <span style={elemStyle}>{el.label}</span>\n      <br />\n      {el.title}\n      <br />\n      {el.mass}\n    </div>\n  )\n}\n\nexport default AtomInfo\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { range } from 'lodash/fp'\n\nconst PERIODIC_TABLE_COLUMNS = 19\n\nfunction Header() {\n  return (\n    <tbody>\n      <tr>\n        {range(0, PERIODIC_TABLE_COLUMNS).map((index) => (\n          <th key={index}>{index || ''}</th>\n        ))}\n      </tr>\n    </tbody>\n  )\n}\n\nexport default Header\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport Atom from '../../../../../../../component/view/Atom'\nimport clsx from 'clsx'\n\nfunction MainRow({\n  row,\n  caption,\n  refer,\n  onAtomSelect,\n  onDoubleClick,\n  currentEvents,\n  atomClassNames,\n  className\n}) {\n  return (\n    <tbody>\n      <tr>\n        <th>{caption}</th>\n        {row.map((element, index) =>\n          typeof element !== 'number' ? ( // eslint-disable-line\n            <td key={index}>\n              <Atom\n                el={element}\n                className={clsx(...atomClassNames(element))}\n                onClick={() => onAtomSelect(element.label)}\n                onDoubleClick={() => onDoubleClick()}\n                {...currentEvents(element)}\n              />\n            </td>\n          ) : refer(element) ? (\n            <td key={index} className={className}>\n              {refer(element)}\n            </td>\n          ) : (\n            <td key={index} colSpan={element} />\n          )\n        )}\n      </tr>\n    </tbody>\n  )\n}\n\nexport default MainRow\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport Atom from '../../../../../../../component/view/Atom'\nimport clsx from 'clsx'\n\nfunction OutinerRow({\n  row,\n  caption,\n  onAtomSelect,\n  onDoubleClick,\n  currentEvents,\n  atomClassNames,\n  className\n}) {\n  return (\n    <tbody>\n      <tr>\n        <th colSpan=\"3\" className={className}>\n          {caption}\n        </th>\n        {row.map((element) => (\n          <td key={element.label}>\n            <Atom\n              el={element}\n              className={clsx(...atomClassNames(element))}\n              onClick={() => onAtomSelect(element.label)}\n              onDoubleClick={() => onDoubleClick()}\n              {...currentEvents(element)}\n            />\n          </td>\n        ))}\n        <td />\n      </tr>\n    </tbody>\n  )\n}\n\nexport default OutinerRow\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Header, MainRow, OutinerRow } from './components'\nimport { Component } from 'react'\n\nimport { Elements } from 'ketcher-core'\nimport styles from './ElementsTable.module.less'\n\nconst metalPrefix = [\n  'alkali',\n  'alkaline-earth',\n  'transition',\n  'post-transition'\n] // 'lanthanide', 'actinide'\nconst atomClassNames = {\n  metal: 'metal',\n  unknownProps: 'unknown-props',\n  unknownState: 'unknown-state',\n  button: 'button',\n  selected: 'selected'\n}\nconst beforeSpan = {\n  He: 16,\n  B: 10,\n  Al: 10,\n  Hf: 1,\n  Rf: 1\n}\nconst ACTINIDE = 'actinide'\nconst LANTHANIDE = 'lanthanide'\nconst main = rowPartition(\n  Elements.filter(\n    (item) =>\n      item &&\n      item.type !== ACTINIDE &&\n      item.type !== LANTHANIDE &&\n      item.number !== 89 &&\n      item.number !== 57\n  )\n)\nconst lanthanides = Elements.filter(\n  (item) => item && (item.type === LANTHANIDE || item.number === 57)\n)\nconst actinides = Elements.filter(\n  (item) => item && (item.type === ACTINIDE || item.number === 89)\n)\n\nfunction rowPartition(elements) {\n  return elements.reduce((result, item) => {\n    const row = result[item.period - 1]\n    if (!row) {\n      result.push([item])\n    } else {\n      if (beforeSpan[item.label]) row.push(beforeSpan[item.label])\n      row.push(item)\n    }\n    return result\n  }, [])\n}\n\nclass ElementsTable extends Component {\n  // eslint-disable-line\n  shouldComponentUpdate(nextProps) {\n    return nextProps.value !== this.props.value\n  }\n\n  getAtomClassNames = (item) => {\n    const { selected } = this.props\n\n    const type = metalPrefix.includes(item.type)\n      ? `${item.type} ${atomClassNames.metal}`\n      : item.type || atomClassNames.unknownProps\n\n    const classes = [\n      ...type.split(' '),\n      item.state || atomClassNames.unknownState,\n      item.origin,\n      atomClassNames.button,\n      selected(item.label) && atomClassNames.selected\n    ]\n\n    return classes.map((className) => {\n      return styles[className]\n    })\n  }\n\n  render() {\n    const { currentEvents, onAtomSelect, onDoubleClick } = this.props\n    const callbacks = { currentEvents, onAtomSelect, onDoubleClick }\n    return (\n      <table\n        className={styles.table}\n        summary=\"Periodic table of the chemical elements\"\n      >\n        <Header />\n        {main.map((row, index) => (\n          <MainRow\n            atomClassNames={this.getAtomClassNames}\n            className={styles.main_row}\n            key={index}\n            row={row}\n            caption={index + 1}\n            refer={(element) => element === 1 && (index === 5 ? '*' : '**')}\n            {...callbacks}\n          />\n        ))}\n        <OutinerRow\n          atomClassNames={this.getAtomClassNames}\n          className={styles.outiner_row}\n          row={lanthanides}\n          caption=\"*\"\n          {...callbacks}\n        />\n        <OutinerRow\n          atomClassNames={this.getAtomClassNames}\n          className={styles.outiner_row}\n          row={actinides}\n          caption=\"**\"\n          {...callbacks}\n        />\n      </table>\n    )\n  }\n}\n\nexport default ElementsTable\n","/****************************************************************************\n * Copyright 2022 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport styles from './BoxWithLines.module.less'\n\nexport const HorizontalBoxWithLines = () => {\n  return (\n    <div className={styles.horizintalNodeLines}>\n      <div className={styles.upperLines} />\n      <div className={styles.lowerLine} />\n    </div>\n  )\n}\n\nexport const VerticalBoxWithLines = () => {\n  return (\n    <div className={styles.verticalNodeLines}>\n      <div className={styles.upperLines} />\n      <div className={styles.lowerLine} />\n    </div>\n  )\n}\n","export const isGenericGroup = (group) => {\n  const cyclicGroups = [\n    'Acyclic',\n    'Cyclic',\n    'Acyclic Carbo',\n    'Cyclic Carbo',\n    'Acyclic Hetero',\n    'Cyclic Hetero'\n  ]\n  return cyclicGroups.includes(group)\n}\n","/****************************************************************************\n * Copyright 2022 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport type { GenItemSet } from 'ketcher-core'\nimport classes from './GenSet.module.less'\nimport clsx from 'clsx'\nimport { isGenericGroup } from '../../helpers'\n\ntype GenSetProps = {\n  labels: GenItemSet[]\n  selected: (label: string) => boolean\n  onAtomSelect: (label: string, activateImmediately: boolean) => void\n  className?: string\n  group: string\n}\n\nconst getGroupClassName = (groupName: string) => groupName.replaceAll(' ', '')\n\nfunction GenSet({\n  labels,\n  selected,\n  onAtomSelect,\n  className,\n  group\n}: GenSetProps) {\n  return (\n    <>\n      {labels.map((item, index) => {\n        const buttons = item.items\n        const caption = item.displayName\n        return (\n          <fieldset className={className} key={index}>\n            <div className={classes[getGroupClassName(group)]}>\n              {buttons.map((button, index) => (\n                <button\n                  key={index}\n                  onClick={() => onAtomSelect(button.label, false)}\n                  onDoubleClick={() => onAtomSelect(button.label, true)}\n                  title={button.description || button.label}\n                  className={clsx(\n                    {\n                      [classes.selected]: selected(button.label)\n                    },\n                    classes.button\n                  )}\n                >\n                  {button.label}\n                </button>\n              ))}\n            </div>\n            {!isGenericGroup(group) && caption && (\n              <div className={classes.legendBox}>\n                <legend>{caption}</legend>\n              </div>\n            )}\n            {isGenericGroup(group) && caption && (\n              <div className={classes.genGroupLegendBox}>\n                <legend className={classes.genGroupLegend}>{caption}</legend>\n              </div>\n            )}\n          </fieldset>\n        )\n      })}\n    </>\n  )\n}\n\nexport { GenSet }\n","/****************************************************************************\n * Copyright 2022 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport type { GenGroup as GenGroupType } from 'ketcher-core'\nimport { GenSet } from './GenSet'\nimport { isGenericGroup } from '../../helpers'\nimport styles from './GenGroup.module.less'\n\ntype GenProps = {\n  selected: (label: string) => boolean\n  onAtomSelect: (label: string, activateImmediately: boolean) => void\n  group: GenGroupType\n}\n\nconst getLegendClassname = (title: string) => {\n  const mainTitles = [\n    'Atom Generics',\n    'Special Nodes',\n    'Group Generics',\n    'Acyclic',\n    'Cyclic'\n  ]\n  if (mainTitles.includes(title)) return 'legendMain'\n  return 'legend'\n}\n\nconst GenGroup = ({ group, onAtomSelect, selected }: GenProps) => {\n  return (\n    <div className={styles.fieldFlexWrapper}>\n      <fieldset className={styles.fieldset}>\n        <legend className={styles[getLegendClassname(group.title)]}>\n          {group.title}\n        </legend>\n        <div\n          className={\n            isGenericGroup(group.title)\n              ? styles.genButtonContainer\n              : styles.buttonContainer\n          }\n        >\n          {group.itemSets && (\n            <GenSet\n              labels={group.itemSets}\n              selected={selected}\n              onAtomSelect={onAtomSelect}\n              className={styles.subGroup}\n              group={group.title}\n            />\n          )}\n        </div>\n      </fieldset>\n    </div>\n  )\n}\n\nexport { GenGroup }\n","/****************************************************************************\n * Copyright 2022 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { HorizontalBoxWithLines, VerticalBoxWithLines } from './BoxWithLines'\n\nimport { GenGroup } from './GenGroup'\nimport { Generics } from 'ketcher-core'\nimport classes from './GenericGroups.module.less'\nimport { groupNames } from './'\n\ntype GenericGroupsProps = {\n  selected: (label: string) => boolean\n  onAtomSelect: (label: string, activateImmediately: boolean) => void\n}\n\nconst getGenericsGroupsMap = (tree) => {\n  let newGroups = {}\n  for (const groupName of Object.keys(tree)) {\n    newGroups[groupName] = { ...tree[groupName] }\n    if (newGroups[groupName]?.subGroups) {\n      newGroups = {\n        ...newGroups,\n        ...getGenericsGroupsMap(newGroups[groupName].subGroups)\n      }\n    }\n  }\n  return newGroups\n}\n\nconst renderGenGroupComponent = (group, selected, onAtomSelect) => (\n  <GenGroup\n    group={groupsMap[group]}\n    selected={selected}\n    onAtomSelect={onAtomSelect}\n  />\n)\n\nconst groupsMap = getGenericsGroupsMap(Generics)\n\nfunction GenericGroups({ selected, onAtomSelect }: GenericGroupsProps) {\n  return (\n    <div className={classes.genericGroups}>\n      <div className={classes.topGroupsContainer}>\n        {renderGenGroupComponent(groupNames.atomsGen, selected, onAtomSelect)}\n        {renderGenGroupComponent(\n          groupNames.specialNodes,\n          selected,\n          onAtomSelect\n        )}\n      </div>\n      {renderGenGroupComponent(groupNames.groupGen, selected, onAtomSelect)}\n      <HorizontalBoxWithLines />\n      <div className={classes.groupGenerics}>\n        <div>\n          {renderGenGroupComponent(\n            groupNames.groupAcyclic,\n            selected,\n            onAtomSelect\n          )}\n          <div className={classes.subgroupContainer}>\n            <VerticalBoxWithLines />\n            <div>\n              {renderGenGroupComponent(\n                groupNames.acyclicCarbo,\n                selected,\n                onAtomSelect\n              )}\n              {renderGenGroupComponent(\n                groupNames.acyclicHetero,\n                selected,\n                onAtomSelect\n              )}\n            </div>\n          </div>\n        </div>\n        <div>\n          {renderGenGroupComponent(\n            groupNames.groupCyclic,\n            selected,\n            onAtomSelect\n          )}\n          <div className={classes.subgroupContainer}>\n            <VerticalBoxWithLines />\n            <div>\n              {renderGenGroupComponent(\n                groupNames.cyclicCarbo,\n                selected,\n                onAtomSelect\n              )}\n              {renderGenGroupComponent(\n                groupNames.cyclicHetero,\n                selected,\n                onAtomSelect\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default GenericGroups\n","/****************************************************************************\n * Copyright 2022 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nexport { default } from './GenericGroups'\n\nexport enum groupNames {\n  atomsGen = 'atoms-gen',\n  specialNodes = 'special-nodes',\n  groupGen = 'group-gen',\n  groupAcyclic = 'group-acyclic',\n  acyclicCarbo = 'acyclic-carbo',\n  acyclicHetero = 'acyclic-hetero',\n  groupCyclic = 'group-cyclic',\n  cyclicHetero = 'cyclic-hetero',\n  cyclicCarbo = 'cyclic-carbo'\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport classes from './TypeChoice.module.less'\nimport { GenericInput } from 'src/script/ui/component/form/input'\n\nconst typeSchema = [\n  { title: 'Single', value: 'atom' },\n  { title: 'List', value: 'list' },\n  { title: 'Not List', value: 'not-list' }\n]\n\nfunction TypeChoice({ value, onChange, ...props }) {\n  return (\n    <fieldset className={classes.fieldset}>\n      {typeSchema.map((type) => (\n        <label key={type.title}>\n          <GenericInput\n            type=\"radio\"\n            value={type.value}\n            checked={type.value === value}\n            onChange={() => onChange(type.value)}\n            {...props}\n          />\n          {type.title}\n        </label>\n      ))}\n    </fieldset>\n  )\n}\n\nexport default TypeChoice\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { AtomInfo, ElementsTable, TypeChoice } from './components'\nimport { fromElement, toElement } from '../../../../data/convert/structconv'\n\nimport { Component } from 'react'\nimport { Dialog } from '../../../components'\nimport { Elements } from 'ketcher-core'\nimport Icon from '../../../../component/view/icon'\nimport Tabs from '../../../../component/view/Tabs'\nimport { addAtoms } from '../../../../state/toolbar'\nimport classes from './PeriodTable.module.less'\nimport { connect } from 'react-redux'\nimport { onAction } from '../../../../state'\nimport { xor } from 'lodash/fp'\n\nclass Table extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      type: props.type || 'atom',\n      value: props.values || (!props.pseudo ? props.label : null) || null,\n      current: Elements.get(2),\n      isInfo: false\n    }\n  }\n\n  changeType = (type) => {\n    const prevChoice =\n      this.state.type === 'list' || this.state.type === 'not-list'\n    const currentChoice = type === 'list' || type === 'not-list'\n    if (prevChoice && currentChoice) {\n      this.setState({ type })\n    } else {\n      this.setState({\n        type,\n        value: type === 'atom' || type === 'gen' ? null : []\n      })\n    }\n  }\n\n  headerContent = () => (\n    <div className={classes.dialogHeader}>\n      <Icon name=\"period-table\" />\n      <span>Periodic Table</span>\n    </div>\n  )\n\n  selected = (label) => {\n    const { type, value } = this.state\n    return type === 'atom' || type === 'gen'\n      ? value === label\n      : value.includes(label)\n  }\n\n  onAtomSelect = (label, activateImmediately = false) => {\n    if (activateImmediately) {\n      const result = this.result()\n      const { type } = this.state\n      if (result && type === 'atom') {\n        this.props.onOk(this.result())\n      }\n    } else {\n      const { type, value } = this.state\n      this.setState({\n        value: type === 'atom' || type === 'gen' ? label : xor([label], value)\n      })\n    }\n  }\n\n  result = () => {\n    const { type, value } = this.state\n    if (!value || !value.length) {\n      return null\n    }\n    if (type === 'atom') {\n      return { label: value, pseudo: null }\n    } else if (type === 'gen') {\n      return { type, label: value, pseudo: value }\n    }\n    return { type, values: value }\n  }\n\n  currentEvents = (element) => {\n    return {\n      onMouseEnter: () => this.setState({ current: element, isInfo: true }),\n      onMouseLeave: () => this.setState({ isInfo: false })\n    }\n  }\n\n  render() {\n    const { type, value } = this.state\n    const HeaderContent = this.headerContent\n\n    return (\n      <Dialog\n        headerContent={<HeaderContent />}\n        className={classes.elementsTable}\n        params={this.props}\n        result={this.result}\n        buttons={['Cancel', 'OK']}\n        buttonsNameMap={{ OK: 'Add' }}\n        needMargin={false}\n        footerContent={\n          <TypeChoice value={this.state.type} onChange={this.changeType} />\n        }\n      >\n        <div className={classes.periodTable}>\n          <AtomInfo el={this.state.current} isInfo={this.state.isInfo} />\n          <ElementsTable\n            value={value}\n            currentEvents={this.currentEvents}\n            selected={this.selected}\n            onAtomSelect={(label) => this.onAtomSelect(label)}\n            onDoubleClick={(label) => this.onAtomSelect(label, true)}\n          />\n        </div>\n      </Dialog>\n    )\n  }\n}\n\nfunction mapSelectionToProps(editor) {\n  const selection = editor.selection()\n\n  if (\n    selection &&\n    Object.keys(selection).length === 1 &&\n    selection.atoms &&\n    Object.keys(selection.atoms).length === 1\n  ) {\n    const struct = editor.struct()\n    const atom = struct.atoms.get(selection.atoms[0])\n    return { ...fromElement(atom) }\n  }\n\n  return {}\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  if (ownProps.values || ownProps.label) {\n    return {}\n  }\n  return mapSelectionToProps(state.editor)\n}\n\nconst mapDispatchToProps = (dispatch, ownProps) => {\n  return {\n    onOk: (result) => {\n      if (!result.type || result.type === 'atom') {\n        dispatch(addAtoms(result.label))\n      }\n      dispatch(onAction({ tool: 'atom', opts: toElement(result) }))\n      ownProps.onOk(result)\n    }\n  }\n}\n\nconst PeriodTable = connect(mapStateToProps, mapDispatchToProps)(Table)\n\nexport default PeriodTable\n","/****************************************************************************\n * Copyright 2022 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { fromElement, toElement } from '../../../../data/convert/structconv'\n\nimport { Dialog } from '../../../components'\nimport GenericGroups from './components/GenericGroups'\nimport classes from './ExtendedTable.module.less'\nimport { connect } from 'react-redux'\nimport { onAction } from '../../../../state'\nimport { useState } from 'react'\n\nconst Table = (props) => {\n  const [value, setValue] = useState(props.pseudo ? props.label : null)\n\n  const selected = (label) => value === label\n\n  const result = () => {\n    if (!value || !value.length) {\n      return null\n    }\n    return { type: 'gen', label: value, pseudo: value }\n  }\n\n  const onAtomSelect = (label, activateImmediately = false) => {\n    setValue(label)\n\n    if (activateImmediately) {\n      props.onOk(result())\n    }\n  }\n\n  return (\n    <Dialog\n      title=\"Extended Table\"\n      withDivider\n      className={classes.extendedTable}\n      params={props}\n      result={result}\n      buttons={['Cancel', 'OK']}\n      buttonsNameMap={{ OK: 'Add' }}\n      needMargin={false}\n    >\n      <GenericGroups\n        selected={selected}\n        onAtomSelect={onAtomSelect}\n      ></GenericGroups>\n    </Dialog>\n  )\n}\n\nfunction mapSelectionToProps(editor) {\n  const selection = editor.selection()\n  if (selection?.atoms?.length === 1) {\n    const struct = editor.struct()\n    const atom = struct.atoms.get(selection.atoms[0])\n    return { ...fromElement(atom) }\n  }\n\n  return {}\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  if (ownProps.values || ownProps.label) {\n    return {}\n  }\n  return mapSelectionToProps(state.editor)\n}\n\nconst mapDispatchToProps = (dispatch, ownProps) => {\n  return {\n    onOk: (result) => {\n      dispatch(onAction({ tool: 'atom', opts: toElement(result) }))\n      ownProps.onOk(result)\n    }\n  }\n}\n\nconst ExtendedTable = connect(mapStateToProps, mapDispatchToProps)(Table)\n\nexport default ExtendedTable\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { BaseCallProps, BaseProps } from '../../../modal.types'\nimport classes from './RemoveFG.module.less'\nimport { useAppContext } from '../../../../../../../hooks'\nimport { fromSgroupDeletion } from 'ketcher-core'\n\ninterface RemoveFGProps extends BaseProps {\n  fgIds: any\n}\n\ntype Props = RemoveFGProps & BaseCallProps\n\nconst RemoveFG = (props: Props) => {\n  const { getKetcherInstance } = useAppContext()\n  const editor = getKetcherInstance().editor as any\n  const { fgIds } = props\n\n  const remove = function () {\n    if (fgIds.length > 0)\n      for (const id of fgIds) {\n        editor.update(fromSgroupDeletion(editor.render.ctab, id))\n      }\n    return true\n  }\n\n  const exit = (key, res) => {\n    props[key](res)\n  }\n\n  return (\n    <div\n      onSubmit={(event) => event.preventDefault()}\n      tabIndex={-1}\n      className={classes.window}\n    >\n      <header className={classes.header}>Edit Abbreviation</header>\n      <div className={classes.question}>\n        A change was detected for the abbreviation. Do you want to remove the\n        abbreviation information from the structure and continue work with\n        separate atoms and bonds?\n      </div>\n      <footer className={classes.footer}>\n        <input\n          type=\"button\"\n          value={'Cancel'}\n          className={classes.buttonCancel}\n          onClick={() => exit('onOk', false)}\n        />\n        <input\n          type=\"button\"\n          value={'Remove Abbreviation'}\n          className={classes.buttonOk}\n          onClick={() => exit('onOk', remove())}\n        />\n      </footer>\n    </div>\n  )\n}\n\nexport type { RemoveFGProps }\nexport { RemoveFG }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { xor } from 'lodash/fp'\n\nfunction oneOrMore(multipl, values, item) {\n  if (multipl) return xor(values, [item])\n  return xor(values, values.concat([item]))\n}\n\nfunction ButtonList({\n  value,\n  onChange,\n  schema,\n  disabledIds,\n  multiple,\n  classes\n}) {\n  let className\n  const selected = classes.selected || 'selected'\n  return (\n    <ul>\n      {schema.items.enum.map((item, i) => {\n        className = value.includes(item) ? selected : ''\n        return (\n          <li key={item}>\n            <button\n              disabled={disabledIds.includes(item)}\n              type=\"button\"\n              className={className}\n              onClick={() => onChange(oneOrMore(multiple, value, item))}\n            >\n              {schema.items.enumNames[i]}\n            </button>\n          </li>\n        )\n      })}\n    </ul>\n  )\n}\n\nexport default ButtonList\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport Form, { Field } from '../../../component/form/form/form'\n\nimport ButtonList from '../../../component/form/buttonlist'\nimport { Dialog } from '../../../views/components'\nimport classes from './rgroup.module.less'\nimport { connect } from 'react-redux'\nimport { rgroupSchema } from '../../../data/schema/struct-schema'\n\nfunction RGroup({ disabledIds, values, formState, type, ...props }) {\n  return (\n    <Dialog\n      title=\"R-Group\"\n      className={classes.rgroup}\n      params={props}\n      result={() => formState.result}\n      buttonsNameMap={{ OK: 'Apply' }}\n      buttons={['Cancel', 'OK']}\n      withDivider\n    >\n      <Form schema={rgroupSchema} init={{ values }} {...formState}>\n        <Field\n          name=\"values\"\n          multiple={type === 'atom'}\n          labelPos={false}\n          component={ButtonList}\n          disabledIds={disabledIds}\n          classes={classes}\n        />\n      </Form>\n    </Dialog>\n  )\n}\n\nexport default connect((store) => ({ formState: store.modal.form }))(RGroup)\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Field } from '../../component/form/form/form'\nimport { getSelectOptionsFromSchema } from '../../utils'\nimport Select from '../../component/form/Select'\nimport { sdataCustomSchema } from '../../data/schema/sdata-schema'\n\nfunction SDataFieldset({ formState }) {\n  const { result } = formState\n  const formSchema = sdataCustomSchema\n\n  return (\n    <fieldset className=\"sdata\">\n      <Field\n        name=\"context\"\n        options={getSelectOptionsFromSchema(formSchema.properties.context)}\n        component={Select}\n      />\n      <Field name=\"fieldName\" placeholder=\"Enter name\" />\n      {content(\n        formSchema,\n        result.context,\n        result.fieldName,\n        result.fieldValue,\n        result.radiobuttons\n      )}\n    </fieldset>\n  )\n}\n\nconst content = (schema, context, fieldName, fieldValue, checked) =>\n  Object.keys(schema.properties)\n    .filter(\n      (prop) => prop !== 'type' && prop !== 'context' && prop !== 'fieldName'\n    )\n    .map((prop) => {\n      if (prop === 'radiobuttons') {\n        return (\n          <Field\n            name={prop}\n            checked={checked}\n            type=\"radio\"\n            key={`${context}-${fieldName}-${prop}-radio`}\n            labelPos={false}\n          />\n        )\n      } else if (prop === 'fieldValue') {\n        return (\n          <Field\n            name={prop}\n            key={`${context}-${fieldName}-${prop}-select`}\n            placeholder=\"Enter value\"\n          />\n        )\n      } else {\n        return (\n          <Field\n            name={prop}\n            type=\"textarea\"\n            key={`${context}-${fieldName}-${prop}-select`}\n          />\n        )\n      }\n    })\n\nexport default SDataFieldset\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Field } from '../../component/form/form/form'\nimport Select from '../../component/form/Select'\nimport { sgroupMap as schemes } from '../../data/schema/struct-schema'\nimport { getSelectOptionsFromSchema } from '../../utils'\nimport classes from './sgroup.module.less'\n\nfunction SGroupFieldset({ formState }) {\n  const { result } = formState\n\n  const type = result.type\n\n  return (\n    <fieldset className={type === 'DAT' ? classes.data : 'base'}>\n      {content(type)}\n    </fieldset>\n  )\n}\n\nconst propMapping = {\n  name: { maxLength: 15 },\n  fieldName: { maxLength: 30 },\n  fieldValue: { type: 'textarea' },\n  radiobuttons: { type: 'radio' }\n}\n\nconst content = (type) =>\n  Object.keys(schemes[type].properties)\n    .filter((prop) => prop !== 'type')\n    .map((prop) => {\n      if (prop === 'connectivity') {\n        return (\n          <Field\n            name={prop}\n            key={`${type}-${prop}`}\n            component={Select}\n            options={getSelectOptionsFromSchema(schemes[type].properties[prop])}\n          />\n        )\n      }\n\n      const props = propMapping[prop] || {}\n      return <Field name={prop} key={`${type}-${prop}`} {...props} />\n    })\n\nexport default SGroupFieldset\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport Form, { SelectOneOf } from '../../component/form/form/form'\nimport { connect } from 'react-redux'\nimport { sgroupMap as schemes } from '../../data/schema/struct-schema'\nimport { Dialog } from '../../views/components'\nimport SDataFieldset from './SDataFieldset'\nimport classes from './sgroup.module.less'\nimport SGroupFieldset from './SGroupFieldset'\nimport { useMemo } from 'react'\n\nfunction Sgroup({ formState, ...props }) {\n  const { result, valid } = formState\n\n  const type = result.type\n\n  const serialize = useMemo(\n    () =>\n      type === 'DAT' && result.context && result.fieldName && result.fieldValue\n        ? {\n            context: result.context.trim(),\n            fieldName: result.fieldName.trim(),\n            fieldValue:\n              typeof result.fieldValue === 'string'\n                ? result.fieldValue.trim()\n                : result.fieldValue\n          }\n        : {},\n    [result.context, result.fieldName, result.fieldValue, type]\n  )\n\n  return (\n    <Dialog\n      title=\"S-Group Properties\"\n      className={classes.sgroup}\n      result={() => result}\n      valid={() => valid}\n      buttons={['Cancel', 'OK']}\n      buttonsNameMap={{ OK: 'Apply' }}\n      withDivider={true}\n      params={props}\n    >\n      <Form\n        serialize={serialize}\n        schema={schemes[type]}\n        init={props}\n        {...formState}\n      >\n        <SelectOneOf title=\"Type\" name=\"type\" schema={schemes} />\n\n        {type === 'DAT' ? (\n          <SDataFieldset formState={formState} />\n        ) : (\n          <SGroupFieldset formState={formState} />\n        )}\n      </Form>\n    </Dialog>\n  )\n}\n\nexport default connect((store) => ({ formState: store.modal.form }))(Sgroup)\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Dialog, StructEditor } from '../../views/components'\nimport { Component } from 'react'\nimport { initAttach, setAttachPoints, setTmplName } from '../../state/templates'\n\nimport { connect } from 'react-redux'\nimport { storage } from '../../storage-ext'\nimport Form, { Field } from '../../component/form/form/form'\nimport { attachSchema } from '../../data/schema/struct-schema'\nimport styled from '@emotion/styled'\nimport classes from './template-lib.module.less'\nimport { css } from '@emotion/react'\nimport { Button } from '@mui/material'\n\n// @TODO When theming is implemented, use theme wherever possible\nconst TemplateEditDialog = styled(Dialog)`\n  background-color: #fff;\n\n  & header {\n    text-transform: none;\n    border-bottom: 1px solid #e1e5ea;\n    margin: 0;\n    padding: 12px;\n  }\n\n  & form {\n    display: flex;\n\n    & label::after {\n      top: 92px;\n      margin-right: 12px;\n    }\n  }\n`\n\nconst Editor = styled('div')`\n  border: 1px solid #b4b9d6;\n  background-color: #ffff;\n  border-radius: 5px;\n  position: relative;\n  height: 300px;\n  width: 330px;\n  overflow: hidden;\n\n  & .structEditor {\n    height: 100%;\n    width: 100%;\n    border: none;\n  }\n`\n\nconst Warning = styled('div')`\n  padding: 0 5px;\n`\n\nconst LeftColumn = styled('div')`\n  padding: 12px;\n  border-radius: 0 0 0 8px;\n  background-color: #eff2f5;\n`\n\nconst RightColumn = styled('div')`\n  width: 40%;\n  min-width: 200px;\n  box-sizing: border-box;\n  padding: 12px;\n  display: flex;\n  flex-direction: column;\n`\n\nconst NameInput = styled(Field)`\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 12px;\n\n  & > input[type='text'] {\n    display: block;\n    width: 100%;\n    box-sizing: border-box;\n    padding: 4px 16px 4px 8px;\n    border: 1px solid #cad3dd;\n    border-radius: 4px;\n    line-height: 16px;\n    font-size: 14px;\n    margin-top: 2px;\n\n    &:hover {\n      border-color: #43b5c0;\n    }\n\n    &:hover,\n    :focus {\n      box-shadow: none;\n    }\n  }\n\n  & span {\n    display: block;\n    width: 100%;\n  }\n`\n\nconst AttachmentOutput = styled('span')`\n  display: block;\n  width: 100%;\n  height: 24px;\n  box-sizing: border-box;\n  padding: 4px 8px;\n  border: 1px solid #cad3dd;\n  border-radius: 4px;\n  line-height: 14px;\n  font-size: 14px;\n  background-color: #eff2f5;\n  margin-top: 2px;\n`\n\nconst Buttons = styled('div')`\n  display: flex;\n  flex-direction: row;\n  margin-top: auto;\n  justify-content: flex-end;\n  gap: 8px;\n`\n\nconst buttonCommonStyles = css`\n  width: fit-content;\n  padding: 5px 8px;\n  text-transform: none;\n  font-size: 12px;\n  line-height: 14px;\n  box-shadow: none;\n`\n\nconst SaveButton = styled(Button)`\n  ${buttonCommonStyles}\n  background-color: #167782;\n\n  &:hover {\n    background-color: #43b5c0;\n    box-shadow: none;\n  }\n\n  &:disabled {\n    background-color: #e1e5ea;\n    color: #333333;\n  }\n`\n\nconst CancelButton = styled(Button)`\n  ${buttonCommonStyles}\n  border-color: #585858;\n  color: #585858;\n\n  &:hover {\n    border-color: #333333;\n    color: #333333;\n    box-shadow: none;\n  }\n`\n\nconst editorStyles = {\n  selectionStyle: {\n    fill: '#167782',\n    'fill-opacity': '0.28',\n    stroke: '#167782'\n  },\n  hoverStyle: { stroke: '#1a7090', 'stroke-width': 1.2 },\n  hoverStyleSimpleObject: { 'stroke-opacity': 0.3 }\n}\n\nclass Attach extends Component {\n  constructor({ onInit, ...props }) {\n    super()\n    this.tmpl = initTmpl(props.tmpl)\n    onInit(this.tmpl.struct.name, this.tmpl.props)\n    this.onResult = this.onResult.bind(this)\n  }\n\n  onResult() {\n    const { name, atomid, bondid } = this.props\n    return name &&\n      (name !== this.tmpl.struct.name ||\n        atomid !== this.tmpl.props.atomid ||\n        bondid !== this.tmpl.props.bondid) &&\n      name.trim().length\n      ? { name, attach: { atomid, bondid } }\n      : null\n  }\n\n  checkIsValidName(name) {\n    return (\n      !!name &&\n      !this.props.templateLib.some(\n        (tmpl) =>\n          tmpl.struct.name === name && tmpl.props.group === 'User Templates'\n      ) &&\n      name.length <= 128\n    )\n  }\n\n  render() {\n    const { name, onNameEdit, onAttachEdit, ...prop } = this.props\n    const struct = this.tmpl.struct\n    const { atomid, bondid } =\n      struct.atoms.get(this.props.atomid) && struct.bonds.get(this.props.bondid)\n        ? this.props\n        : this.tmpl.props\n    const options = Object.assign(editorStyles, this.props.globalSettings, {\n      scale: getScale(struct)\n    })\n\n    return (\n      <TemplateEditDialog\n        title=\"Template edit\"\n        result={this.onResult}\n        valid={() => this.props.formState.valid && name}\n        params={prop}\n        buttons={[]}\n        needMargin={false}\n      >\n        <Form\n          schema={attachSchema}\n          customValid={{\n            name: (name) => this.checkIsValidName(name)\n          }}\n          {...this.props.formState}\n        >\n          <LeftColumn>\n            <Editor>\n              <StructEditor\n                className=\"structEditor\"\n                struct={struct}\n                onAttachEdit={onAttachEdit}\n                tool=\"attach\"\n                toolOpts={{ atomid, bondid }}\n                options={options}\n                showAttachmentPoints={false}\n              />\n            </Editor>\n            {!storage.isAvailable() ? (\n              <Warning>{storage.warningMessage}</Warning>\n            ) : null}\n          </LeftColumn>\n          <RightColumn>\n            <NameInput\n              name=\"name\"\n              value={name}\n              onChange={this.props.onNameEdit}\n              placeholder=\"template\"\n            />\n            <span>Selected attachment points</span>\n            <AttachmentOutput>\n              Atom ID: <strong>{atomid}</strong> Bond ID:{' '}\n              <strong>{bondid}</strong>\n            </AttachmentOutput>\n            <Buttons>\n              <CancelButton\n                variant=\"outlined\"\n                onClick={this.props.onCancel}\n                className={classes.button}\n              >\n                Cancel\n              </CancelButton>\n              <SaveButton\n                variant=\"contained\"\n                onClick={() => this.props.onOk(this.onResult())}\n                className={classes.button}\n                disabled={!this.checkIsValidName(name)}\n              >\n                Apply\n              </SaveButton>\n            </Buttons>\n          </RightColumn>\n        </Form>\n      </TemplateEditDialog>\n    )\n  }\n}\n\nexport default connect(\n  (store) => ({\n    ...store.templates.attach,\n    templateLib: store.templates.lib,\n    formState: store.modal.form,\n    globalSettings: store.options.settings\n  }),\n  (dispatch) => ({\n    onInit: (name, ap) => dispatch(initAttach(name, ap)),\n    onAttachEdit: (ap) => dispatch(setAttachPoints(ap)),\n    onNameEdit: (name) => dispatch(setTmplName(name))\n  })\n)(Attach)\n\nfunction initTmpl(tmpl) {\n  const normTmpl = {\n    struct: structNormalization(tmpl.struct),\n    props: {\n      atomid: +tmpl.props.atomid || 0,\n      bondid: +tmpl.props.bondid || 0\n    }\n  }\n  normTmpl.struct.name = tmpl.struct.name\n  return normTmpl\n}\n\nfunction structNormalization(struct) {\n  const normStruct = struct.clone()\n  const cbb = normStruct.getCoordBoundingBox()\n\n  normStruct.atoms.forEach((atom) => {\n    atom.pp = atom.pp.sub(cbb.min)\n  })\n\n  normStruct.sgroups.forEach((sg) => {\n    sg.pp = sg.pp ? sg.pp.sub(cbb.min) : cbb.min\n  })\n\n  normStruct.rxnArrows.forEach((rxnArrow) => {\n    rxnArrow.pos = rxnArrow.pos.map((p) => p.sub(cbb.min))\n  })\n\n  normStruct.rxnPluses.forEach((rxnPlus) => {\n    rxnPlus.pp = rxnPlus.pp.sub(cbb.min)\n  })\n\n  normStruct.simpleObjects.forEach((simpleObject) => {\n    simpleObject.pos = simpleObject.pos.map((p) => p.sub(cbb.min))\n  })\n\n  normStruct.texts.forEach((text) => {\n    text.position = text.position.sub(cbb.min)\n  })\n\n  return normStruct\n}\n\nfunction getScale(struct) {\n  const cbb = struct.getCoordBoundingBox()\n  const VIEW_SIZE = 220\n  const scale =\n    VIEW_SIZE / Math.max(cbb.max.y - cbb.min.y, cbb.max.x - cbb.min.x)\n  if (scale < 35) return 35\n  if (scale > 50) return 50\n  return 40\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { FC } from 'react'\nimport { Struct } from 'ketcher-core'\nimport StructRender from '../../component/structrender'\nimport classes from './TemplateTable.module.less'\nimport { greekify } from '../../utils'\nimport Icon from 'src/script/ui/component/view/icon'\n\nexport interface Template {\n  struct: Struct\n  props: {\n    atomid: number\n    bondid: number\n    group: string\n    prerender?: string\n    abbreviation: string\n    name: string\n  }\n}\n\ninterface TemplateTableProps {\n  templates: Array<Template>\n  selected: Template | null\n  onSelect: (tmpl: Template) => void\n  onDelete?: (tmpl: Template) => void\n  onAttach?: (tmpl: Template) => void\n  titleRows?: 1 | 2\n  renderOptions?: any\n}\n\nconst isSaltOrSolventTemplate = (template) =>\n  template.props.group === 'Salts and Solvents'\nconst isFunctionalGroupTemplate = (template) =>\n  template.props.group === 'Functional Groups'\n\nfunction getTemplateTitle(template: Template, index: number): string {\n  if (isSaltOrSolventTemplate(template)) {\n    return template.props.name\n  }\n  return template.struct.name || `${template.props.group} template ${index + 1}`\n}\n\nfunction tmplName(tmpl: Template, i: number): string {\n  if (isSaltOrSolventTemplate(tmpl)) {\n    return tmpl.props.abbreviation\n  }\n  return tmpl.struct.name || `${tmpl.props.group} template ${i + 1}`\n}\n\nconst RenderTmpl: FC<{\n  tmpl: Template\n  options: any\n  className: string\n}> = ({ tmpl, options, ...props }) => {\n  return (\n    <StructRender\n      struct={tmpl.struct}\n      {...props}\n      options={{\n        ...options,\n        autoScaleMargin: 10,\n        cachePrefix: 'templates',\n        downScale: true\n      }}\n    />\n  )\n}\n\nconst TemplateTable: FC<TemplateTableProps> = (props) => {\n  const {\n    templates,\n    selected,\n    onSelect,\n    onDelete,\n    onAttach,\n    titleRows = 2,\n    renderOptions\n  } = props\n\n  return (\n    <div\n      className={`${classes.tableContent} ${\n        titleRows === 1 ? classes.oneRowTitleTable : classes.twoRowsTitleTable\n      }`}\n    >\n      {templates.map((tmpl, i) => {\n        return (\n          <div\n            className={\n              tmpl.struct !== selected?.struct\n                ? classes.td\n                : `${classes.td} ${classes.selected}`\n            }\n            title={greekify(getTemplateTitle(tmpl, i))}\n            key={\n              tmpl.struct.name !== selected?.struct.name\n                ? `${tmpl.struct.name}_${i}`\n                : `${tmpl.struct.name}_${i}_selected`\n            }\n            onClick={() => onSelect(tmpl)}\n          >\n            <RenderTmpl\n              tmpl={tmpl}\n              options={renderOptions}\n              className={classes.struct}\n            />\n            <div\n              className={`${classes.structTitle} ${\n                selected?.struct === tmpl.struct ? classes.selectedTitle : ''\n              }`}\n            >\n              {greekify(tmplName(tmpl, i))}\n            </div>\n            {tmpl.props.group === 'User Templates' && (\n              <button\n                className={`${classes.button} ${classes.deleteButton}`}\n                onClick={() => onDelete!(tmpl)}\n              >\n                <Icon name=\"delete\" />\n              </button>\n            )}\n            {!isFunctionalGroupTemplate(tmpl) &&\n              !isSaltOrSolventTemplate(tmpl) && (\n                <button\n                  className={`${classes.button} ${classes.editButton}`}\n                  onClick={(e) => {\n                    e.stopPropagation()\n                    onAttach!(tmpl)\n                  }}\n                >\n                  <Icon name=\"edit\" />\n                </button>\n              )}\n          </div>\n        )\n      })}\n    </div>\n  )\n}\n\nexport default TemplateTable\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nexport const saltsAndSolventsSelector = (state) => {\n  return state.saltsAndSolvents.lib\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport classes from './emptySearchResult.module.less'\nimport Icon from '../../component/view/icon'\n\nconst EmptySearchResult = ({ textInfo }) => {\n  return (\n    <div className={classes.emptySearch}>\n      <p>{textInfo}</p>\n      <Icon name=\"not-found\" />\n    </div>\n  )\n}\n\nexport default EmptySearchResult\n","import { useCallback, useEffect, useRef, useState } from 'react'\nimport { filterFGLib } from '../../utils'\nimport { Template } from './TemplateTable'\n\nconst SALTS_AND_SOLVENTS = 'Salts and Solvents'\nconst batchDelay = 300\n\nexport default function useSaltsAndSolvents(\n  saltsAndSolvents: Template[],\n  filter: string\n) {\n  const [isFirstRender, setIsFirstRender] = useState(true)\n  const timerId = useRef<null | ReturnType<typeof setTimeout>>(null)\n  const [filteredSaltsAndSolvents, setFilteredSaltsAndSolvents] = useState(\n    saltsAndSolvents[SALTS_AND_SOLVENTS]\n  )\n\n  const addToSaSWithBatches = useCallback((fullFilteredArray) => {\n    const batchSize = 16\n    setFilteredSaltsAndSolvents((filteredSaltsAndSolvents) => [\n      ...(filteredSaltsAndSolvents ?? []),\n      ...fullFilteredArray.splice(0, batchSize)\n    ])\n    if (fullFilteredArray.length > 0) {\n      timerId.current = setTimeout(\n        () => addToSaSWithBatches(fullFilteredArray),\n        batchDelay\n      )\n    }\n  }, [])\n\n  useEffect(() => {\n    const filteredSaS =\n      filterFGLib(saltsAndSolvents, filter)[SALTS_AND_SOLVENTS] ?? []\n    addToSaSWithBatches(filteredSaS)\n  }, [saltsAndSolvents, addToSaSWithBatches])\n\n  useEffect(() => {\n    if (isFirstRender) {\n      setIsFirstRender(false)\n      return\n    }\n    clearTimeout(timerId.current as unknown as number)\n    const filteredSaS = filterFGLib(saltsAndSolvents, filter)[\n      SALTS_AND_SOLVENTS\n    ]\n    setFilteredSaltsAndSolvents(filteredSaS)\n  }, [saltsAndSolvents, filter])\n\n  return filteredSaltsAndSolvents\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Dispatch, FC, useState, useEffect, useRef } from 'react'\nimport TemplateTable, { Template } from './TemplateTable'\nimport {\n  changeFilter,\n  changeGroup,\n  deleteTmpl,\n  editTmpl,\n  selectTmpl,\n  changeTab\n} from '../../state/templates'\nimport { filterLib, filterFGLib, greekify } from '../../utils'\nimport Accordion from '@mui/material/Accordion'\nimport AccordionSummary from '@mui/material/AccordionSummary'\nimport AccordionDetails from '@mui/material/AccordionDetails'\nimport Icon from '../../component/view/icon'\n\nimport { Dialog } from '../../views/components'\nimport Input from '../../component/form/input'\nimport { SaveButton } from '../../component/view/savebutton'\nimport { SdfSerializer } from 'ketcher-core'\nimport classes from './template-lib.module.less'\nimport { connect } from 'react-redux'\nimport { createSelector } from 'reselect'\nimport { omit } from 'lodash/fp'\nimport { onAction } from '../../state'\nimport { functionalGroupsSelector } from '../../state/functionalGroups/selectors'\nimport { saltsAndSolventsSelector } from '../../state/saltsAndSolvents/selectors'\nimport EmptySearchResult from '../../../ui/dialog/template/EmptySearchResult'\n\nimport Tabs from '@mui/material/Tabs'\nimport Tab from '@mui/material/Tab'\nimport useSaltsAndSolvents from './useSaltsAndSolvets'\n\nfunction TabPanel(props) {\n  const { children, value, index, ...other } = props\n  return (\n    <div\n      className={classes.tabPanel}\n      component=\"div\"\n      role=\"tabpanel\"\n      id={`scrollable-auto-tabpanel-${index}`}\n      aria-labelledby={`scrollable-auto-tab-${index}`}\n      {...other}\n    >\n      {value === index && children}\n    </div>\n  )\n}\n\nfunction a11yProps(index) {\n  return {\n    id: `scrollable-auto-tab-${index}`,\n    'aria-controls': `scrollable-auto-tabpanel-${index}`\n  }\n}\n\ninterface TemplateLibProps {\n  filter: string\n  group: string\n  lib: Array<Template>\n  selected: Template | null\n  mode: string\n  tab: number\n  initialTab: number\n  saltsAndSolvents: Template[]\n  renderOptions?: any\n}\n\ninterface TemplateLibCallProps {\n  onAttach: (tmpl: Template) => void\n  onCancel: () => void\n  onChangeGroup: (group: string) => void\n  onDelete: (tmpl: Template) => void\n  onFilter: (filter: string) => void\n  onOk: (res: any) => void\n  onSelect: (res: any) => void\n  onTabChange: (tab: number) => void\n  functionalGroups: Template[]\n}\n\ntype Props = TemplateLibProps & TemplateLibCallProps\n\nenum TemplateTabs {\n  TemplateLibrary = 0,\n  FunctionalGroupLibrary = 1,\n  SaltsAndSolvents = 2\n}\n\nconst filterLibSelector = createSelector(\n  (props: Props) => props.lib,\n  (props: Props) => props.filter,\n  filterLib\n)\n\nconst FUNCTIONAL_GROUPS = 'Functional Groups'\n\nconst HeaderContent = () => (\n  <div className={classes.dialogHeader}>\n    <Icon name=\"template-dialog\" />\n    <span>Templates</span>\n  </div>\n)\n\nconst FooterContent = ({ data, tab }) => {\n  const clickToAddToCanvas = <span>Click to add to canvas</span>\n  if (tab === TemplateTabs.SaltsAndSolvents) {\n    return clickToAddToCanvas\n  }\n  return (\n    <div\n      style={{\n        flexGrow: 1,\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center'\n      }}\n    >\n      <SaveButton\n        key=\"save-to-SDF\"\n        data={data}\n        className={classes.saveButton}\n        filename={\n          tab === TemplateTabs.TemplateLibrary\n            ? 'ketcher-tmpls.sdf'\n            : 'ketcher-fg-tmpls.sdf'\n        }\n      >\n        Save to SDF\n      </SaveButton>\n      {clickToAddToCanvas}\n    </div>\n  )\n}\n\nconst TemplateDialog: FC<Props> = (props) => {\n  const {\n    filter,\n    onFilter,\n    onTabChange,\n    onChangeGroup,\n    mode,\n    tab,\n    initialTab = null,\n    functionalGroups,\n    lib: templateLib,\n    saltsAndSolvents,\n    onSelect,\n    ...rest\n  } = props\n\n  const searchInputRef = useRef<HTMLInputElement>(null)\n\n  const [expandedAccordions, setExpandedAccordions] = useState<string[]>([\n    props.group\n  ])\n  const filteredSaltsAndSolvents = useSaltsAndSolvents(saltsAndSolvents, filter)\n  const [filteredFG, setFilteredFG] = useState(\n    functionalGroups[FUNCTIONAL_GROUPS]\n  )\n\n  const filteredTemplateLib = filterLibSelector(props)\n\n  useEffect(() => {\n    setFilteredFG(filterFGLib(functionalGroups, filter)[FUNCTIONAL_GROUPS])\n  }, [functionalGroups, filter])\n\n  useEffect(() => {\n    searchInputRef.current?.focus()\n    onSelect(null)\n  }, [tab, onSelect])\n\n  useEffect(() => {\n    if (initialTab !== null) {\n      onTabChange(initialTab)\n    }\n  }, [initialTab, onTabChange])\n\n  const handleAccordionChange = (accordion) => (_, isExpanded) => {\n    setExpandedAccordions(\n      isExpanded\n        ? [...expandedAccordions, accordion]\n        : [...expandedAccordions].filter(\n            (expandedAccordion) => expandedAccordion !== accordion\n          )\n    )\n  }\n\n  const handleTabChange = (value) => {\n    onTabChange(value)\n  }\n\n  const sdfSerializer = new SdfSerializer()\n  const serializerMapper = {\n    [TemplateTabs.TemplateLibrary]: templateLib,\n    [TemplateTabs.FunctionalGroupLibrary]: functionalGroups,\n    [TemplateTabs.SaltsAndSolvents]: saltsAndSolvents\n  }\n  const data = sdfSerializer.serialize(serializerMapper[tab])\n\n  const select = (tmpl: Template): void => {\n    onChangeGroup(tmpl.props.group)\n    props.onSelect(tmpl)\n  }\n\n  return (\n    <Dialog\n      headerContent={<HeaderContent />}\n      footerContent={<FooterContent tab={tab} data={data} />}\n      className={`${classes.dialog_body}`}\n      params={omit(['group'], rest)}\n      buttons={[]}\n      needMargin={false}\n    >\n      <div className={classes.inputContainer}>\n        <Input\n          ref={searchInputRef}\n          className={classes.input}\n          type=\"search\"\n          value={filter}\n          onChange={(value) => onFilter(value)}\n          placeholder=\"Search by elements...\"\n          isFocused={true}\n        />\n        <Icon name=\"search\" className={classes.searchIcon} />\n      </div>\n      <Tabs\n        value={tab}\n        onChange={(_, value) => handleTabChange(value)}\n        className={classes.tabs}\n      >\n        <Tab\n          label=\"Template Library\"\n          {...a11yProps(TemplateTabs.TemplateLibrary)}\n        />\n        <Tab\n          label=\"Functional Groups\"\n          {...a11yProps(TemplateTabs.FunctionalGroupLibrary)}\n        />\n        <Tab\n          label=\"Salts and Solvents\"\n          {...a11yProps(TemplateTabs.SaltsAndSolvents)}\n        />\n      </Tabs>\n      <div className={classes.tabsContent}>\n        <TabPanel value={tab} index={TemplateTabs.TemplateLibrary}>\n          <div>\n            {Object.keys(filteredTemplateLib).length ? (\n              Object.keys(filteredTemplateLib).map((groupName) => {\n                const shouldGroupBeRended =\n                  expandedAccordions.includes(groupName)\n                return (\n                  <Accordion\n                    square={true}\n                    key={groupName}\n                    onChange={handleAccordionChange(groupName)}\n                    expanded={shouldGroupBeRended}\n                  >\n                    <AccordionSummary\n                      className={classes.accordionSummary}\n                      expandIcon={\n                        <Icon className={classes.expandIcon} name=\"chevron\" />\n                      }\n                    >\n                      <Icon\n                        name=\"elements-group\"\n                        className={classes.groupIcon}\n                      />\n                      {`${greekify(groupName)} (${\n                        filteredTemplateLib[groupName].length\n                      })`}\n                    </AccordionSummary>\n                    <AccordionDetails>\n                      <TemplateTable\n                        templates={\n                          shouldGroupBeRended\n                            ? filteredTemplateLib[groupName]\n                            : []\n                        }\n                        onSelect={(templ) => select(templ)}\n                        selected={props.selected}\n                        onDelete={props.onDelete}\n                        onAttach={props.onAttach}\n                        renderOptions={props.renderOptions}\n                      />\n                    </AccordionDetails>\n                  </Accordion>\n                )\n              })\n            ) : (\n              <div className={classes.resultsContainer}>\n                <EmptySearchResult textInfo=\"No items found\" />\n              </div>\n            )}\n          </div>\n        </TabPanel>\n        <TabPanel value={tab} index={TemplateTabs.FunctionalGroupLibrary}>\n          {filteredFG?.length ? (\n            <div className={classes.resultsContainer}>\n              <TemplateTable\n                titleRows={1}\n                templates={filteredFG}\n                onSelect={(templ) => select(templ)}\n                selected={props.selected}\n                renderOptions={props.renderOptions}\n              />\n            </div>\n          ) : (\n            <div className={classes.resultsContainer}>\n              <EmptySearchResult textInfo=\"No items found\" />\n            </div>\n          )}\n        </TabPanel>\n        <TabPanel value={tab} index={TemplateTabs.SaltsAndSolvents}>\n          {filteredSaltsAndSolvents?.length ? (\n            <div className={classes.resultsContainer}>\n              <TemplateTable\n                titleRows={1}\n                templates={filteredSaltsAndSolvents}\n                onSelect={(templ) => select(templ)}\n                selected={props.selected}\n                renderOptions={props.renderOptions}\n              />\n            </div>\n          ) : (\n            <div className={classes.resultsContainer}>\n              <EmptySearchResult textInfo=\"No items found\" />\n            </div>\n          )}\n        </TabPanel>\n      </div>\n    </Dialog>\n  )\n}\n\nconst selectTemplate = (template, props, dispatch) => {\n  dispatch(selectTmpl(null))\n  if (!template) return\n  dispatch(changeFilter(''))\n  dispatch(selectTmpl(template))\n  dispatch(onAction({ tool: 'template', opts: template }))\n  props.onOk(template)\n}\n\nconst onModalClose = (props, dispatch) => {\n  dispatch(changeFilter(''))\n  props.onCancel()\n}\n\nexport default connect(\n  (store) => ({\n    ...omit(['attach'], (store as any).templates),\n    initialTab: (store as any).modal?.prop?.tab,\n    renderOptions: (store as any).editor?.render?.options,\n    functionalGroups: functionalGroupsSelector(store),\n    saltsAndSolvents: saltsAndSolventsSelector(store)\n  }),\n  (dispatch: Dispatch<any>, props: Props) => ({\n    onFilter: (filter) => dispatch(changeFilter(filter)),\n    onTabChange: (tab) => dispatch(changeTab(tab)),\n    onSelect: (tmpl) => selectTemplate(tmpl, props, dispatch),\n    onChangeGroup: (group) => dispatch(changeGroup(group)),\n    onAttach: (tmpl) => dispatch(editTmpl(tmpl)),\n    onCancel: () => onModalClose(props, dispatch),\n    onDelete: (tmpl) => dispatch(deleteTmpl(tmpl))\n  })\n)(TemplateDialog)\n","import { useEffect, RefObject } from 'react'\n\nexport const useClickOutside = (\n  targetRef: RefObject<Node>,\n  callback: () => void\n): void => {\n  useEffect(() => {\n    document.addEventListener('click', onClickOutside)\n    return () => {\n      document.removeEventListener('click', onClickOutside)\n    }\n  }, [])\n\n  const onClickOutside = (e: Event) => {\n    if (!targetRef.current?.contains(e.target as Node)) {\n      callback()\n    }\n  }\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { useEffect, useMemo, useState, useRef } from 'react'\nimport { useClickOutside } from '../../../../../../../hooks/useClickOutside'\n\nimport classes from './FontControl.module.less'\n\nimport { range } from 'lodash/fp'\n\nexport const FontControl = ({ editorState, setEditorState, styles }) => {\n  const defaultFontSize = '13px'\n  const [isShowingFontSizeMenu, setIsShowingFontSizeMenu] = useState(false)\n  const [currentFontSize, setCurrentFontSize] = useState(defaultFontSize)\n  const wrapperRef = useRef<HTMLDivElement>(null)\n  const onClickOutsideCloseDrowndown = (): void =>\n    setIsShowingFontSizeMenu(false)\n  useClickOutside(wrapperRef, onClickOutsideCloseDrowndown)\n\n  const setFontSize = (e, value) => {\n    e.preventDefault()\n    setCurrentFontSize(value)\n    const newEditorState = styles.fontSize.remove(editorState)\n    setEditorState(styles.fontSize.add(newEditorState, value))\n    setIsShowingFontSizeMenu(false)\n  }\n\n  const currentStyle = styles.fontSize.current(editorState)\n\n  useEffect(() => {\n    setCurrentFontSize(currentStyle || defaultFontSize)\n  }, [currentStyle])\n\n  const MIN_FONT_SIZE = 4\n  const MAX_FONT_SIZE = 144\n  const fontSizes = range(MIN_FONT_SIZE, MAX_FONT_SIZE + 1)\n\n  const fontSizeOptions = useMemo(\n    () =>\n      fontSizes.map((fontSize) => (\n        <div\n          key={fontSize}\n          className={classes.fontSizeOption}\n          onMouseDown={(e) => setFontSize(e, `${fontSize}px`)}\n        >\n          {fontSize}\n        </div>\n      )),\n    [isShowingFontSizeMenu]\n  )\n\n  return (\n    <div ref={wrapperRef}>\n      <button\n        className={classes.fontBtn}\n        onMouseDown={(e) => {\n          e.preventDefault()\n          setIsShowingFontSizeMenu(!isShowingFontSizeMenu)\n        }}\n      >\n        {parseFloat(currentFontSize)}\n      </button>\n      {isShowingFontSizeMenu ? (\n        <div className={classes.fontSizeMenu}>{fontSizeOptions}</div>\n      ) : null}\n    </div>\n  )\n}\n\nexport default FontControl\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport classes from './SpecialSymbolsList.module.less'\nimport Icon from 'src/script/ui/component/view/icon'\n\nconst SpecialSymbolsList = ({ select }) => {\n  const symbols = [\n    'α',\n    'β',\n    'γ',\n    'δ',\n    'ε',\n    'ζ',\n    'η',\n    'θ',\n    'ι',\n    'κ',\n    'λ',\n    'μ',\n    'ν',\n    'ξ',\n    'ο',\n    'π',\n    'ρ',\n    'σ',\n    'τ',\n    'υ',\n    'φ',\n    'χ',\n    'ψ',\n    'ω',\n    '℃',\n    '℉',\n    'Å',\n    '°',\n    'ħ',\n    '±',\n    '‰',\n    '√',\n    '←',\n    '→',\n    '←/',\n    '/→',\n    '↔',\n    '∏',\n    '∑',\n    '∞',\n    '∂',\n    '∆',\n    '∫',\n    '≈',\n    '=/',\n    '≤',\n    '≥'\n  ]\n  return (\n    <div className={classes.window}>\n      {symbols.map((symbol, id) => {\n        return (\n          <button\n            className={classes.button}\n            key={`symbol-${id}`}\n            value={symbol}\n            onMouseDown={(event) => {\n              select(event, symbol)\n            }}\n          >\n            <Icon name={symbol} />\n          </button>\n        )\n      })}\n    </div>\n  )\n}\nexport { SpecialSymbolsList }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { EditorState, Modifier } from 'draft-js'\n\nimport Icon from '../../../../../component/view/icon'\nimport { SpecialSymbolsList } from '../SpecialSymbolsList/SpecialSymbolsList'\nimport classes from './SpecialSymbolsButton.module.less'\nimport { useState } from 'react'\n\nconst SpecialSymbolsButton = ({ editorState, setEditorState, styles }) => {\n  const [showSpecialSymbols, setShowSpecialSymbols] = useState(false)\n\n  const handleClose = (event) => {\n    event.stopPropagation()\n    event.preventDefault()\n    setShowSpecialSymbols(false)\n  }\n\n  const closeSymbolsList = (event) => {\n    if (!event.currentTarget.contains(event.relatedTarget)) {\n      handleClose(event)\n    }\n  }\n\n  const addSymbol = (e, value) => {\n    e.preventDefault()\n    const selection = editorState.getSelection()\n    const contentState = editorState.getCurrentContent()\n    const nextContentState = Modifier.replaceText(\n      contentState,\n      selection,\n      value,\n      styles\n    )\n    const nextEditorState = EditorState.push(\n      editorState,\n      nextContentState,\n      'insert-characters'\n    )\n    setEditorState(nextEditorState)\n    setShowSpecialSymbols(false)\n  }\n\n  return (\n    <div onBlur={closeSymbolsList}>\n      <button\n        title=\"symbols\"\n        onMouseDown={(e) => {\n          e.preventDefault()\n          setShowSpecialSymbols(!showSpecialSymbols)\n        }}\n        className={\n          showSpecialSymbols ? classes.activeTextButton : classes.textButton\n        }\n      >\n        <Icon name=\"text-special-symbols\" />\n      </button>\n      {showSpecialSymbols && <SpecialSymbolsList select={addSymbol} />}\n    </div>\n  )\n}\n\nexport { SpecialSymbolsButton }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport Icon from '../../../../../component/view/icon'\nimport React from 'react'\nimport { TextCommand } from 'ketcher-core'\nimport clsx from 'clsx'\nimport styles from './TextButton.module.less'\n\ninterface TextButtonProps {\n  button: { command: TextCommand; name: string }\n  active: boolean\n}\n\ninterface TextButtonPropsCallProps {\n  toggleStyle: (command: TextCommand) => void\n}\n\ntype Props = TextButtonProps & TextButtonPropsCallProps\n\nexport const TextButton = (props: Props) => {\n  const toggleStyle = (\n    event: React.MouseEvent<HTMLButtonElement, MouseEvent>,\n    command: TextCommand\n  ) => {\n    event.preventDefault()\n    props.toggleStyle(command)\n  }\n\n  return (\n    <button\n      className={clsx(styles.textButton, { [styles.isActive]: props.active })}\n      title={props.button.command.toLowerCase()}\n      onMouseDown={(event) => {\n        toggleStyle(event, props.button.command)\n      }}\n    >\n      <Icon name={props.button.name} />\n    </button>\n  )\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport 'draft-js/dist/Draft.css'\n\nimport {\n  DraftStyleMap,\n  Editor,\n  EditorState,\n  RawDraftContentState,\n  RichUtils,\n  convertFromRaw,\n  convertToRaw,\n  getDefaultKeyBinding\n} from 'draft-js'\nimport React, {\n  useCallback,\n  useState,\n  useRef,\n  MutableRefObject,\n  useEffect\n} from 'react'\n\nimport { Dialog } from '../../../components'\nimport { DialogParams } from '../../../components/Dialog/Dialog'\nimport { FontControl } from './FontControl'\nimport { SpecialSymbolsButton } from './SpecialSymbols/SpecialSymbolsButton'\nimport { TextButton } from './TextButton'\nimport { TextCommand } from 'ketcher-core'\nimport classes from './Text.module.less'\nimport { connect } from 'react-redux'\nimport createStyles from 'draft-js-custom-styles'\n\nconst { styles, customStyleFn } = createStyles(['font-size'])\n\ninterface TextProps extends DialogParams {\n  formState: any\n  id?: any\n  content: string\n  position?: string\n}\n\nconst buttons: Array<{ command: TextCommand; name: string }> = [\n  {\n    command: TextCommand.Bold,\n    name: 'text-bold'\n  },\n  {\n    command: TextCommand.Italic,\n    name: 'text-italic'\n  },\n  {\n    command: TextCommand.Superscript,\n    name: 'text-superscript'\n  },\n  {\n    command: TextCommand.Subscript,\n    name: 'text-subscript'\n  }\n]\n\nconst Text = (props: TextProps) => {\n  const { formState, position, id } = props\n  const rawContentState: RawDraftContentState | null = props.content\n    ? (JSON.parse(props.content) as RawDraftContentState)\n    : null\n  const [editorState, setEditorState] = useState<EditorState>(\n    EditorState.moveFocusToEnd(\n      EditorState.createWithContent(\n        convertFromRaw(rawContentState || { blocks: [], entityMap: {} })\n      )\n    )\n  )\n\n  const result = () => {\n    const content = editorState.getCurrentContent()\n    return {\n      content: content.hasText() ? JSON.stringify(convertToRaw(content)) : '',\n      position,\n      id\n    }\n  }\n\n  const keyBindingFn = (e: React.KeyboardEvent): string | null => {\n    if (e.key === 'Enter') {\n      e.stopPropagation()\n    }\n\n    return getDefaultKeyBinding(e)\n  }\n\n  const onContentChange = (state: EditorState): void => {\n    setEditorState(state)\n  }\n\n  const currentStyle = editorState.getCurrentInlineStyle()\n\n  const toggleStyle = useCallback(\n    (command: TextCommand): void => {\n      let newEditorState: EditorState = editorState\n      switch (command) {\n        case TextCommand.Subscript: {\n          if (currentStyle.has(TextCommand.Superscript)) {\n            newEditorState = RichUtils.toggleInlineStyle(\n              newEditorState,\n              TextCommand.Superscript\n            )\n          }\n          break\n        }\n        case TextCommand.Superscript: {\n          if (currentStyle.has(TextCommand.Subscript)) {\n            newEditorState = RichUtils.toggleInlineStyle(\n              newEditorState,\n              TextCommand.Subscript\n            )\n          }\n          break\n        }\n      }\n      newEditorState = RichUtils.toggleInlineStyle(newEditorState, command)\n\n      setEditorState(newEditorState)\n    },\n    [currentStyle, editorState]\n  )\n\n  const customStyleMap: DraftStyleMap = {\n    SUBSCRIPT: {\n      verticalAlign: 'sub',\n      transform: 'scale(0.7)',\n      transformOrigin: 'left'\n    },\n    SUPERSCRIPT: {\n      verticalAlign: 'super',\n      transform: 'scale(0.7)',\n      transformOrigin: 'left',\n      lineHeight: 0\n    }\n  }\n\n  const refEditor = useRef() as MutableRefObject<Editor>\n  const setFocusInEditor = useCallback(() => {\n    refEditor.current.focus()\n  }, [refEditor])\n\n  // set focut on component mount\n  useEffect(() => {\n    setFocusInEditor()\n  }, [setFocusInEditor])\n\n  return (\n    <Dialog\n      className={classes.textEditor}\n      title=\"Text Editor\"\n      params={props}\n      result={result}\n      valid={() => formState.form.valid}\n      buttonsNameMap={{ OK: 'Apply' }}\n      buttons={['Cancel', 'OK']}\n      withDivider\n    >\n      <div className={classes.controlPanel} onClick={setFocusInEditor}>\n        {buttons.map((button) => {\n          return (\n            <TextButton\n              button={button}\n              key={button.name}\n              active={currentStyle.has(button.command)}\n              toggleStyle={toggleStyle}\n            />\n          )\n        })}\n        <SpecialSymbolsButton\n          editorState={editorState}\n          setEditorState={setEditorState}\n          styles={currentStyle}\n        />\n        <span>Font Size</span>\n        <FontControl\n          editorState={editorState}\n          setEditorState={setEditorState}\n          styles={styles}\n        />\n      </div>\n      <span>Text:</span>\n      <Editor\n        keyBindingFn={keyBindingFn}\n        editorState={editorState}\n        onChange={onContentChange}\n        customStyleMap={customStyleMap}\n        customStyleFn={customStyleFn}\n        ref={refEditor}\n      />\n    </Dialog>\n  )\n}\n\nexport default connect((store) => ({ formState: (store as any).modal }))(Text)\n","import classes from '../toolbox/FG/RemoveFG.module.less'\n\ntype ConfirmProps = {\n  onOk: () => void\n  onCancel: () => void\n}\n\nexport const Confirm = ({ onOk, onCancel }: ConfirmProps) => {\n  return (\n    <div className={classes.window}>\n      <header className={classes.header}>Warning!</header>\n      <div className={classes.question}>\n        Unsupported S-group type found. Would you like to import structure\n        without it?\n      </div>\n      <footer className={classes.footer}>\n        <input\n          type=\"button\"\n          value={'Cancel'}\n          className={classes.buttonCancel}\n          onClick={() => onCancel()}\n        />\n        <input\n          type=\"button\"\n          value={'OK'}\n          className={classes.buttonOk}\n          onClick={() => onOk()}\n        />\n      </footer>\n    </div>\n  )\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { About, Settings } from '../views/modal/components/meta'\nimport {\n  Analyse,\n  Check,\n  Miew,\n  Recognize\n} from '../views/modal/components/process'\n// schemify dialogs\nimport {\n  Atom,\n  AttachPoints,\n  Automap,\n  Bond,\n  RgroupLogic\n} from '../views/modal/components/toolbox'\nimport { Open, Save } from '../views/modal/components/document'\n\nimport EnhancedStereo from './toolbox/enhancedStereo/enhancedStereo'\nimport LabelEdit from './toolbox/labeledit'\nimport PeriodTable from '../views/modal/components/PeriodTable'\nimport ExtendedTable from '../views/modal/components/ExtendedTable'\nimport { RemoveFG } from '../views/modal/components/toolbox/FG/RemoveFG'\nimport Rgroup from './toolbox/rgroup/rgroup'\nimport SGroup from './toolbox/sgroup'\nimport TemplateAttach from './template/template-attach'\nimport TemplatesDialog from './template/TemplateDialog'\nimport Text from '../views/modal/components/Text'\nimport { Confirm } from '../views/modal/components/Confirm'\n\nexport default {\n  open: Open,\n  analyse: Analyse,\n  recognize: Recognize,\n  'period-table': PeriodTable,\n  'extended-table': ExtendedTable,\n  rgroup: Rgroup,\n  attach: TemplateAttach,\n  templates: TemplatesDialog,\n  about: About,\n  miew: Miew,\n  atomProps: Atom,\n  attachmentPoints: AttachPoints,\n  automap: Automap,\n  bondProps: Bond,\n  check: Check,\n  enhancedStereo: EnhancedStereo,\n  labelEdit: LabelEdit,\n  rgroupLogic: RgroupLogic,\n  removeFG: RemoveFG,\n  save: Save,\n  settings: Settings,\n  sgroup: SGroup,\n  text: Text,\n  confirm: Confirm\n} as any\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { useRef } from 'react'\n\nimport { BaseCallProps } from './modal.types'\nimport classes from './Modal.module.less'\nimport selectClasses from '../../component/form/Select/Select.module.less'\nimport clsx from 'clsx'\nimport mediaSizes from './mediaSizes'\nimport modals from '../../dialog'\nimport useResizeObserver from 'use-resize-observer/polyfilled'\n\ninterface ModalProps extends BaseCallProps {\n  modal: {\n    name: string\n    form: any\n    prop: any\n  }\n}\n\ntype Props = ModalProps & BaseCallProps\n\nfunction Modal(props: Props) {\n  const { modal, ...rest } = props\n  const containerRef = useRef<HTMLDivElement>(null)\n  const { height, width } = useResizeObserver<HTMLDivElement>({\n    ref: containerRef\n  })\n\n  if (!modal) return null\n\n  const Component = modals[modal.name]\n\n  if (!Component)\n    throw new Error(`There is no modal window named ${modal.name}`)\n\n  return (\n    <div\n      className={clsx(classes.modalOverlay, selectClasses.selectContainer)}\n      ref={containerRef}\n    >\n      <Component\n        className={clsx({\n          [classes.smallScreen]:\n            (height && height <= mediaSizes.smallHeight) ||\n            (width && width <= mediaSizes.smallWidth)\n        })}\n        {...rest}\n      />\n    </div>\n  )\n}\n\nexport type { ModalProps }\nexport { Modal }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { Modal, ModalProps } from './Modal'\n\nimport { BaseCallProps } from './modal.types'\nimport { Dispatch } from 'redux'\nimport { connect } from 'react-redux'\nimport { omit } from 'lodash/fp'\n\ntype StateProps = Pick<ModalProps, 'modal'>\n\nconst mapStateToProps = (state): StateProps => ({\n  modal: state.modal\n})\n\nconst mapDispatchToProps = (dispatch: Dispatch): BaseCallProps => ({\n  onOk: (_result) => {\n    dispatch({ type: 'MODAL_CLOSE' })\n  },\n  onCancel: () => {\n    dispatch({ type: 'MODAL_CLOSE' })\n  }\n})\n\nconst mergeProps = (\n  stateProps: StateProps,\n  dispatchProps: BaseCallProps\n): ModalProps => {\n  const prop = stateProps.modal && stateProps.modal.prop\n  const initProps = prop ? omit(['onResult', 'onCancel'], prop) : {}\n  return {\n    modal: stateProps.modal,\n    ...initProps,\n    onOk: (result) => {\n      if (prop && prop.onResult) prop.onResult(result)\n      dispatchProps.onOk(result)\n    },\n    onCancel: () => {\n      if (prop && prop.onCancel) prop.onCancel()\n      dispatchProps.onCancel()\n    }\n  }\n}\n\nconst ModalContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps,\n  mergeProps\n)(Modal)\n\nexport default ModalContainer\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  fromBond,\n  fromElement,\n  fromSgroup,\n  fromStereoLabel,\n  toBond,\n  toElement,\n  toSgroup,\n  toStereoLabel\n} from '../../data/convert/structconv'\n\nimport { Elements } from 'ketcher-core'\nimport acts from '../../action'\nimport { debounce } from 'lodash/fp'\nimport { openDialog } from '../modal'\nimport { highlightFG } from '../functionalGroups'\nimport { serverCall } from '../server'\nimport { generateCommonProperties, isAtomsArray } from '../modal/atoms'\nimport { saveSettings } from '../options'\n\nexport default function initEditor(dispatch, getState) {\n  const updateAction = debounce(100, () => dispatch({ type: 'UPDATE' }))\n  const sleep = (time) => new Promise((resolve) => setTimeout(resolve, time))\n\n  function resetToSelect(dispatch) {\n    // eslint-disable-line no-shadow\n    const state = global.currentState\n    const activeTool = state.actionState.activeTool.tool\n    if (activeTool === 'select') return\n    const selectMode = state.toolbar.visibleTools.select\n    const resetOption = state.options.settings.resetToSelect\n    if (resetOption === true || resetOption === activeTool)\n      // example: 'paste'\n      dispatch({ type: 'ACTION', action: acts[selectMode].action })\n    else updateAction()\n  }\n\n  return {\n    onInit: (editor) => {\n      dispatch({ type: 'INIT', editor })\n    },\n    onChange: (action) => {\n      if (action === undefined) sleep(0).then(() => dispatch(resetToSelect))\n      // new tool in reducer\n      else dispatch(resetToSelect)\n    },\n    onSelectionChange: () => {\n      updateAction()\n    },\n    onElementEdit: (selem) => {\n      if (isAtomsArray(selem)) {\n        const atomAttributes = generateCommonProperties(selem)\n        return openDialog(dispatch, 'atomProps', {\n          ...atomAttributes,\n          isMultipleAtoms: true\n        }).then(toElement)\n      }\n      const elem = selem.type === 'text' ? selem : fromElement(selem)\n      let dlg = null\n      if (elem.type === 'text') {\n        // TODO: move textdialog opening logic to another place\n        return openDialog(dispatch, 'text', elem)\n      } else if (Elements.get(elem.label)) {\n        dlg = openDialog(dispatch, 'atomProps', elem)\n      } else if (Object.keys(elem).length === 1 && 'ap' in elem) {\n        dlg = openDialog(dispatch, 'attachmentPoints', elem.ap).then((res) => ({\n          ap: res\n        }))\n      } else if (elem.type === 'list' || elem.type === 'not-list') {\n        dlg = openDialog(\n          dispatch,\n          !elem.pseudo ? 'period-table' : 'extended-table',\n          { ...elem, pseudo: elem.pseudo }\n        )\n      } else if (elem.type === 'rlabel') {\n        const rgroups = getState().editor.struct().rgroups\n        const params = {\n          type: 'atom',\n          values: elem.values,\n          disabledIds: Array.from(rgroups.entries()).reduce(\n            (acc, [rgid, rg]) => {\n              if (rg.frags.has(elem.fragId)) acc.push(rgid)\n\n              return acc\n            },\n            []\n          )\n        }\n        dlg = openDialog(dispatch, 'rgroup', params).then((res) => ({\n          values: res.values,\n          type: 'rlabel'\n        }))\n      } else {\n        dlg = openDialog(\n          dispatch,\n          !elem.pseudo ? 'period-table' : 'extended-table',\n          { ...elem, pseudo: elem.pseudo }\n        )\n      }\n      return dlg.then(toElement)\n    },\n\n    // TODO: correct\n    onEnhancedStereoEdit: ({ ...init }) =>\n      sleep(0).then(() => {\n        init = fromStereoLabel(init.stereoLabel)\n        return openDialog(dispatch, 'enhancedStereo', {\n          init\n        }).then(\n          (res) => toStereoLabel(res),\n          () => null\n        )\n      }),\n\n    onQuickEdit: (atom) => openDialog(dispatch, 'labelEdit', atom),\n    onBondEdit: (bond) =>\n      openDialog(dispatch, 'bondProps', fromBond(bond)).then(toBond),\n    onRgroupEdit: (rgroup) => {\n      const struct = getState().editor.struct()\n\n      if (Object.keys(rgroup).length > 2) {\n        const rgroupLabels = Array.from(struct.rgroups.keys())\n        if (!rgroup.range) rgroup.range = '>0'\n\n        return openDialog(\n          dispatch,\n          'rgroupLogic',\n          Object.assign({ rgroupLabels }, rgroup)\n        )\n      }\n\n      const disabledIds = Array.from(struct.atoms.values()).reduce(\n        (acc, atom) => {\n          if (atom.fragment === rgroup.fragId && atom.rglabel !== null)\n            return acc.concat(fromElement(atom).values)\n\n          return acc\n        },\n        []\n      )\n      const params = {\n        type: 'fragment',\n        values: [rgroup.label],\n        disabledIds\n      }\n      return openDialog(dispatch, 'rgroup', params).then((res) => ({\n        label: res.values[0]\n      }))\n    },\n    onSgroupEdit: (sgroup) =>\n      sleep(0) // huck to open dialog after dispatch sgroup tool action\n        .then(() => openDialog(dispatch, 'sgroup', fromSgroup(sgroup)))\n        .then(toSgroup),\n    onRemoveFG: (result) =>\n      sleep(0).then(() => openDialog(dispatch, 'removeFG', result)),\n    onMessage: (msg) => {\n      if (msg.error) {\n        // TODO: add error handler call\n      }\n    },\n    onAromatizeStruct: (struct) => {\n      const state = getState()\n      const serverOpts = state.options.getServerSettings()\n      return serverCall(\n        state.editor,\n        state.server,\n        'aromatize',\n        serverOpts,\n        struct\n      ).catch((e) => state.editor.errorHandler(e))\n    },\n    onDearomatizeStruct: (struct) => {\n      const state = getState()\n      const serverOpts = state.options.getServerSettings()\n      return serverCall(\n        state.editor,\n        state.server,\n        'dearomatize',\n        serverOpts,\n        struct\n      ).catch((e) => state.editor.errorHandler(e))\n    },\n    onMouseDown: () => {\n      updateAction()\n    },\n    onConfirm: () => openDialog(dispatch, 'confirm'),\n    onShowInfo: (payload) => {\n      if (payload) {\n        const { groupStruct, event, sGroup } = payload\n        highlightFG(dispatch, { groupStruct, event, sGroup })\n      } else {\n        highlightFG(dispatch, { groupStruct: null, sGroup: null })\n      }\n    },\n    onApiSettings: (payload) => dispatch(saveSettings(payload))\n  }\n}\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { StructEditor } from './components'\nimport { connect } from 'react-redux'\nimport initEditor from '../state/editor'\n\nconst Editor = connect(\n  (state) => ({\n    options: state.options.settings,\n    indigoVerification: state.requestsStatuses.indigoVerification\n  }),\n  (dispatch) => dispatch(initEditor)\n)(StructEditor)\n\nexport default Editor\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  BottomToolbarContainer,\n  LeftToolbarContainer,\n  RightToolbarContainer,\n  TopToolbarContainer\n} from '../views/toolbars'\nimport { useEffect } from 'react'\nimport { useDispatch } from 'react-redux'\nimport { createTheme, ThemeProvider } from '@mui/material'\nimport AppClipArea from '../views/AppClipArea'\nimport { AppHiddenContainer } from './AppHidden'\nimport AppModalContainer from '../views/modal'\nimport Editor from '../views/Editor'\nimport classes from './App.module.less'\nimport { initFGTemplates } from '../state/functionalGroups'\nimport { initSaltsAndSolventsTemplates } from '../state/saltsAndSolvents'\nimport { useSubscriptionOnEvents } from '../../../hooks'\n\ninterface AppCallProps {\n  checkServer: () => void\n}\n\nconst muiTheme = createTheme({\n  components: {\n    MuiButtonBase: {\n      defaultProps: {\n        disableRipple: true\n      }\n    }\n  }\n})\n\ntype Props = AppCallProps\n\nconst App = (props: Props) => {\n  const dispatch = useDispatch()\n  const { checkServer } = props\n\n  useSubscriptionOnEvents()\n\n  useEffect(() => {\n    checkServer()\n    dispatch(initFGTemplates())\n    dispatch(initSaltsAndSolventsTemplates())\n    window.scrollTo(0, 0)\n  }, [])\n\n  return (\n    <ThemeProvider theme={muiTheme}>\n      <div className={classes.app}>\n        <AppHiddenContainer />\n        <Editor className={classes.canvas} />\n\n        <TopToolbarContainer className={classes.top} />\n        <LeftToolbarContainer className={classes.left} />\n        <BottomToolbarContainer className={classes.bottom} />\n        <RightToolbarContainer className={classes.right} />\n\n        <AppClipArea />\n        <AppModalContainer />\n      </div>\n    </ThemeProvider>\n  )\n}\n\nexport type { AppCallProps }\nexport { App }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { App, AppCallProps } from './App'\n\nimport { checkServer } from '../state/server'\nimport { connect } from 'react-redux'\n\nconst mapDispatchToProps: AppCallProps = {\n  checkServer\n}\n\nconst AppContainer = connect(null, mapDispatchToProps)(App)\n\nexport { AppContainer }\nexport default AppContainer\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { AppContext, ErrorsContext, SettingsContext } from './../../../contexts'\nimport { Ketcher, StructService } from 'ketcher-core'\n\nimport App from './App.container'\nimport { Provider } from 'react-redux'\nimport { createRoot } from 'react-dom/client'\nimport createStore from '../state'\nimport { initKeydownListener } from '../state/hotkeys'\nimport { initResize } from '../state/toolbar'\n\nfunction initApp(\n  element: HTMLDivElement | null,\n  staticResourcesUrl: string,\n  options: any,\n  server: StructService,\n  setEditor: (editor: any) => void\n) {\n  const store = createStore(options, server, setEditor)\n  store.dispatch(initKeydownListener(element))\n  store.dispatch(initResize())\n\n  const root = createRoot(element!)\n  root.render(\n    <Provider store={store}>\n      <SettingsContext.Provider value={{ staticResourcesUrl }}>\n        <ErrorsContext.Provider value={{ errorHandler: options.errorHandler }}>\n          <AppContext.Provider\n            value={{\n              getKetcherInstance: () => (window as any).ketcher as Ketcher\n            }}\n          >\n            <App />\n          </AppContext.Provider>\n        </ErrorsContext.Provider>\n      </SettingsContext.Provider>\n    </Provider>\n  )\n}\n\nexport { initApp }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport {\n  DefaultStructServiceOptions,\n  FormatterFactory,\n  Ketcher,\n  ServiceMode,\n  StructService,\n  StructServiceProvider\n} from 'ketcher-core'\n\nimport { ButtonsConfig } from './ButtonsConfig'\nimport { Editor } from '../../editor'\nimport createApi from '../../api'\nimport { initApp } from '../../ui'\n\nclass KetcherBuilder {\n  private structService: StructService | null\n  private editor: Editor | null\n  private serviceMode: ServiceMode | null\n  private formatterFactory: FormatterFactory | null\n\n  constructor() {\n    this.structService = null\n    this.editor = null\n    this.serviceMode = null\n    this.formatterFactory = null\n  }\n\n  async appendApiAsync(structServiceProvider: StructServiceProvider) {\n    this.structService = createApi(\n      structServiceProvider,\n      DefaultStructServiceOptions\n    )\n  }\n\n  appendServiceMode(mode: ServiceMode) {\n    this.serviceMode = mode\n  }\n\n  async appendUiAsync(\n    element: HTMLDivElement | null,\n    staticResourcesUrl: string,\n    errorHandler: (message: string) => void,\n    buttons?: ButtonsConfig\n  ): Promise<void> {\n    const { structService } = this\n\n    const editor = await new Promise<Editor>((resolve) => {\n      initApp(\n        element,\n        staticResourcesUrl,\n        {\n          buttons: buttons || {},\n          errorHandler: errorHandler || null,\n          version: process.env.VERSION || '',\n          buildDate: process.env.BUILD_DATE || '',\n          buildNumber: process.env.BUILD_NUMBER || ''\n        },\n        structService!,\n        resolve\n      )\n    })\n\n    this.editor = editor\n    this.editor.errorHandler =\n      errorHandler && typeof errorHandler === 'function'\n        ? errorHandler\n        : // eslint-disable-next-line @typescript-eslint/no-empty-function\n          () => {}\n    this.formatterFactory = new FormatterFactory(structService!)\n  }\n\n  build() {\n    if (!this.serviceMode) {\n      throw new Error('You should append ServiceMode before building')\n    }\n\n    if (!this.structService) {\n      throw new Error('You should append Api before building')\n    }\n\n    if (!this.formatterFactory) {\n      throw new Error(\n        'You should append StructureServiceFactory before building'\n      )\n    }\n\n    const ketcher = new Ketcher(\n      this.editor!,\n      this.structService,\n      this.formatterFactory\n    )\n    ketcher[this.serviceMode] = true\n\n    const params = new URLSearchParams(document.location.search)\n    const initialMol = params.get('moll')\n    if (initialMol) {\n      ketcher.setMolecule(initialMol)\n    }\n\n    return ketcher\n  }\n}\n\nexport { KetcherBuilder }\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport { ButtonsConfig, KetcherBuilder } from './builders'\n\nimport { StructServiceProvider } from 'ketcher-core'\n\ninterface Config {\n  element: HTMLDivElement | null\n  staticResourcesUrl: string\n  structServiceProvider: StructServiceProvider\n  buttons?: ButtonsConfig\n  errorHandler: (message: string) => void\n}\n\nasync function buildKetcherAsync({\n  element,\n  staticResourcesUrl,\n  structServiceProvider,\n  buttons,\n  errorHandler\n}: Config) {\n  const builder = new KetcherBuilder()\n\n  await builder.appendApiAsync(structServiceProvider)\n  builder.appendServiceMode(structServiceProvider.mode)\n  await builder.appendUiAsync(\n    element,\n    staticResourcesUrl,\n    errorHandler,\n    buttons\n  )\n\n  return builder.build()\n}\n\nexport type { Config, ButtonsConfig }\nexport default buildKetcherAsync\n","/****************************************************************************\n * Copyright 2021 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n ***************************************************************************/\n\nimport 'intersection-observer'\nimport 'element-closest-polyfill'\nimport 'regenerator-runtime/runtime'\nimport 'url-search-params-polyfill'\nimport 'whatwg-fetch'\nimport './index.less'\n\nimport init, { Config } from './script'\nimport { useEffect, useRef } from 'react'\n\nimport { Ketcher } from 'ketcher-core'\nimport classes from './Editor.module.less'\nimport clsx from 'clsx'\nimport { useResizeObserver } from './hooks'\nimport { KETCHER_INIT_EVENT_NAME } from './constants'\n\nconst mediaSizes = {\n  smallWidth: 1040,\n  smallHeight: 600\n}\n\ninterface EditorProps extends Omit<Config, 'element'> {\n  onInit?: (ketcher: Ketcher) => void\n}\n\nfunction Editor(props: EditorProps) {\n  const rootElRef = useRef<HTMLDivElement>(null)\n  const { onInit } = props\n  const { height, width } = useResizeObserver<HTMLDivElement>({\n    ref: rootElRef\n  })\n\n  const ketcherInitEvent = new Event(KETCHER_INIT_EVENT_NAME)\n\n  useEffect(() => {\n    init({\n      ...props,\n      element: rootElRef.current\n    }).then((ketcher: Ketcher) => {\n      if (typeof onInit === 'function') {\n        onInit(ketcher)\n        window.dispatchEvent(ketcherInitEvent)\n      }\n    })\n    // TODO: provide the list of dependencies after implementing unsubscribe function\n  }, [])\n\n  return (\n    <div\n      ref={rootElRef}\n      className={clsx('Ketcher-root', classes.editor, {\n        [classes.small]:\n          (height && height <= mediaSizes.smallHeight) ||\n          (width && width <= mediaSizes.smallWidth)\n      })}\n    />\n  )\n}\n\nexport { Editor }\n"],"names":["createApi","structServiceProvider","defaultOptions","structService","createStructService","info","Object","assign","bind","convert","layout","clean","aromatize","dearomatize","calculateCip","automap","check","calculate","recognize","generateImageAsBase64","generateInchIKey","appContext","React","createContext","errorsContext","settingsContext","formContext","basicAtoms","atomCuts","H","C","N","O","S","P","F","Cl","Br","I","A","Q","R","K","M","Si","Na","X","D","B","keys","reduce","res","label","toLowerCase","title","shortcut","action","tool","opts","copyAs","type","state","global","currentState","editor","struct","structSelected","errorHandler","serializer","MolSerializer","KetSerializer","simpleObjectOrText","Boolean","simpleObjects","size","texts","structData","serialize","window","clipboardData","setData","navigator","clipboard","writeText","copyImageToClipboard","server","options","factory","FormatterFactory","service","create","getStructureFromStructAsync","structStr","ketcher","Ketcher","generateImage","outputFormat","backgroundColor","image","item","ClipboardItem","write","isHidden","buttonName","buttons","hidden","debugObj","update","molSerializer","molStr","molQs","encodeURIComponent","replace","qs","document","location","search","ieCb","ClipArea","props","textAreaRef","createRef","el","current","target","parentNode","listeners","mouseup","event","isActiveElement","focused","autoselect","mousedown","shiftKey","preventDefault","copy","onCopy","data","cut","onCut","paste","onPaste","formats","forEach","en","addEventListener","removeEventListener","_jsx","clsx","classes","cliparea","Component","tagName","includes","value","select","cb","curFmt","fmt","ex","getData","d","actions","exec","enabled","queryCommandSupported","execCommand","ClipboardEvent","resetToSelect","enumNames","rotationStep","minimum","maximum","render","showValenceWarnings","description","atomColoring","showStereoFlags","stereoLabelStyle","StereLabelStyleType","IUPAC","Classic","On","Off","colorOfAbsoluteCenters","colorOfAndCenters","colorOfOrCenters","colorStereogenicCenters","StereoColoringType","LabelsOnly","BondsOnly","LabelsAndBonds","autoFadeOfStereoLabels","absFlagLabel","andFlagLabel","mixedFlagLabel","ignoreChiralFlag","orFlagLabel","font","fontsz","fontszsub","carbonExplicitly","showCharge","showValence","showHydrogenLabels","aromaticCircle","doubleBondWidth","bondThickness","stereoBondWidth","SERVER_OPTIONS","debug","showAtomIds","showBondIds","showHalfBondIds","showLoopIds","miew","miewMode","miewTheme","miewAtomLabel","MIEW_OPTIONS","optionsSchema","required","properties","getDefaultOptions","prop","validation","settings","ajv","Ajv","allErrors","keywords","keyword","schemaType","validate","compile","errors","errorsProps","map","instancePath","slice","indexOf","storage","warningMessage","isAvailable","localStorage","getItem","key","JSON","parse","setItem","isSet","stringify","initOptionsState","app","templates","functionalGroups","saltsAndSolvents","analyse","values","roundWeight","roundMass","roundElAnalysis","checkOptions","file","fragment","version","getServerSettings","pick","appUpdate","dispatch","saveSettings","newSettings","changeRound","roundName","recognizeActions","setStruct","str","changeVersion","changeImage","shouldFragment","isFrag","checkOpts","optionsReducer","loading","_objectSpread","constant","schema","desc","mapOf","oneOf","radioButtonsSchema","contextSchema","sData","Fragment","fieldName","fieldValue","radiobuttons","minLength","invalidMessage","Multifragment","Bond","Atom","Group","sdataCustomSchema","context","sdataSchema","acc","firstKeyOf","obj","getSdataDefault","initSdata","isCustomShema","valid","result","sdataReducer","init","correctErrors","actionContext","actionFieldName","newstate","onContextChange","onFieldNameChange","payload","fValue","formsState","atomProps","charge","explicitValence","hCount","invRet","isotope","radical","ringBondCount","substitutionCount","attachmentPoints","primary","secondary","mode","bondProps","topology","center","moleculeErrors","labelEdit","rgroup","rgroupLogic","ifthen","range","resth","save","filename","format","text","attach","sgroup","updateFormState","checkErrors","setDefaultSettings","formReducer","newType","INDIGO_VERIFICATION","ANALYZING_FILE","indigoVerification","setAnalyzingFile","initialState","isAnalyzingFile","supportedSGroupTypes","MUL","SRU","SUP","DAT","atom","maxLength","alias","pattern","unsaturatedAtom","exactChangeFlag","rgroupSchema","items","bond","mul","subscript","connectivity","name","sgroupMap","minium","attachSchema","DefaultStereoGroupNumber","fromElement","selem","fromRlabel","rglabel","fromAtomList","Elements","get","fromAtom","ap","fromApoint","attpnt","toElement","elem","length","toRlabel","toAtomList","toApoint","capitalize","toAtom","pseudo","satom","toString","stereoParity","chargeRegexp","RegExp","atomSchema","pch","parseInt","conv","undefined","atomList","notList","ids","i","AtomList","number","fromStereoLabel","stereoLabel","match","StereoLabel","Abs","orNumber","andNumber","And","Or","toStereoLabel","sap","rg","rgi","val","push","fromBond","sbond","stereo","fromBondType","reactingCenterStatus","toBond","toBondType","caption","bondCaptionMap","Error","single","PATTERN","TYPE","SINGLE","STEREO","NONE","up","UP","down","DOWN","updown","EITHER","DOUBLE","crossed","CIS_TRANS","triple","TRIPLE","aromatic","AROMATIC","singledouble","SINGLE_OR_DOUBLE","singlearomatic","SINGLE_OR_AROMATIC","doublearomatic","DOUBLE_OR_AROMATIC","any","ANY","hydrogen","HYDROGEN","dative","DATIVE","fromSgroup","ssgroup","attrs","absolute","attached","split","sDataInitValue","toSgroup","_excluded","trim","isFlipDisabled","selection","restruct","ctab","bonds","atoms","getBondIdsForAtom","atomId","_createForOfIteratorHelper","entries","bondId","b","begin","end","getBondIdsForAttachmentAtoms","atomBondIds","atomBondId","isAttachmentBond","getAmountOfAttachmentBonds","amountOfAttachmentBonds","totalBondIds","Set","toolActions","hand","erase","chain","disabled","findStereoAtoms","Array","from","transforms","arrows","RxnArrowMode","OpenAngle","FilledTriangle","FilledBow","DashedOpenAngle","Failed","BothEndsFilledTriangle","EquilibriumFilledHalfBow","EquilibriumFilledTriangle","EquilibriumOpenAngle","UnbalancedEquilibriumFilledHalfBow","UnbalancedEquilibriumOpenHalfAngle","UnbalancedEquilibriumLargeFilledHalfBow","UnbalancedEquilibriumFilledHalfTriangle","EllipticalArcFilledBow","EllipticalArcFilledTriangle","EllipticalArcOpenAngle","EllipticalArcOpenHalfAngle","shapes","SimpleObjectMode","ellipse","rectangle","line","bondCuts","typeSchema","bondSchema","KETCHER_INIT_EVENT_NAME","KETCHER_SAVED_SETTINGS_KEY","SettingsManager","e","getSettings","selectionTool","onAction","dialog","thunk","parseStruct","rescale","formatterOptions","identifyStructFormat","SupportedFormat","cdx","getStructureFromStringAsync","Promise","resolve","load","getState","parsedStruct","hasUnsupportedGroups","sgroups","some","sGroup","confirm","filter","_key","oldStruct","clone","sg","sgId","offset","SGroup","getOffset","atomSet","Pile","crossBonds","getCrossBonds","bracketPos","updateOffset","findConnectedComponents","setImplicitHydrogen","stereAtomsMap","getStereoAtomsMap","id","atomGetNeighbors","stereoProp","markFragments","isBlank","savedSelectedTool","tools","message","checkServer","then","indigoVersion","imagoVersions","rec","process","ketcherCheck","checkParams","isAbs","frags","fr","enhancedStereoFlag","chiral_flag","badVal","badConn","valence","optsTypes","ketcherErrors","types","without","serverCall","serverTransform","serverSettings","method","loadedStruct","deserialize","reactionRelayout","selectedAtoms","aidMap","Map","currentStruct","explicitSelected","aid","ketSerializer","output_format","ChemicalMimeType","KET","selected","omit","config","arom","dearom","cip","templateLib","tab","_tool","zoomList","zoom","findLastIndex","z","findIndex","openHelpLink","open","focus","help","functionalGroupsLib","_","__","requestFullscreen","element","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","getIfFullScreen","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement","toggleFullscreen","querySelector","documentElement","fullscreen","clear","undo","historySize","redo","dontClipMessage","hasSelection","copies","active","about","hasRxnArrow","toolbar","visibleTools","alignDescriptors","icons","α","β","γ","δ","ε","ζ","η","θ","ι","κ","λ","μ","ν","ξ","ο","π","ρ","σ","τ","υ","φ","χ","ψ","ω","Å","AngstromIcon","DegreeIcon","ħ","PlanckDiracConstantIcon","PlusMinusIcon","PromilleIcon","RootIcon","LeftArrowIcon","RightArrowIcon","LeftArrowCrossedOutIcon","RightArrowCrossedOutIcon","LeftAndRightArrowIcon","CapitalPiIcon","SumIcon","InfinityIcon","PartialDerivativeIcon","DeltaIcon","IntegralIcon","ApproximatelyEqualIcon","NotEqualIcon","LessOrEqualIcon","MoreOrEqualIcon","DegreeFahreinheitIcon","DegreeCelseusIcon","AboutIcon","AnalyseIcon","AnyAtomIcon","AromIcon","ArrowUpwardIcon","BondAnyIcon","BondAromaticIcon","BondCrossedIcon","BondHydrogenIcon","BondDative","BondDoubleIcon","BondDoubleAromaticIcon","BondDownIcon","BondSingleIcon","BondSingleAromaticIcon","BondSingleDoubleIcon","BondTripleIcon","BondUpIcon","BondUpdownIcon","CapitalTIcon","ChainIcon","ChargeMinusIcon","ChargePlusIcon","CheckIcon","ChiralFlagIcon","CipIcon","CleanIcon","CopyIcon","CopyImageIcon","CopyMolIcon","CopyKetIcon","CutIcon","DearomIcon","DeleteIcon","dropdown","DropdownIcon","EnhancedStereoIcon","edit","EditIcon","ElementsGroupIcon","ExtendedTableIcon","EraseIcon","FileThumbnailIcon","FullscreenEnterIcon","FullscreenExitIcon","GenericGroupsIcon","HandIcon","compressedhand","CompressedHandIcon","HelpIcon","history","HistoryIcon","ImageFrameIcon","LayoutIcon","logo","LogoIcon","MiewIcon","ClearIcon","OpenIcon","PasteIcon","PeriodTableIcon","ReactionArrowEllipticalArcArrowFilledBow","ReactionArrowEllipticalArcArrowFilledTriangle","ReactionArrowEllipticalArcArrowOpenAngle","ReactionArrowEllipticalArcArrowOpenHalfAngle","ReactionArrowOpenAngleIcon","ReactionArrowFilledTriangle","ReactionArrowFilledBow","ReactionArrowDashedOpenAngle","ReactionArrowFailed","ReactionArrowBothEndsFilledTriangle","ReactionArrowEquilibriumFilledHalfBow","ReactionArrowEquilibriumFilledTriangle","ReactionArrowEquilibriumOpenAngle","ReactionArrowUnbalancedEquilibriumFilledHalfBow","ReactionArrowUnbalancedEquilibriumOpenHalfAngle","ReactionArrowUnbalancedEquilibriumLargeFilledHalfBow","ReactionArrowUnbalancedEquilibriumFilledHalfTriangle","ReactionAutomapIcon","ReactionMapIcon","ReactionPlusIcon","ReactionUnmapIcon","RecognizeIcon","RedoIcon","RgroupAttpointsIcon","RgroupFragmentIcon","RgroupLabelIcon","SaveIcon","SearchIcon","SelectFragmentIcon","SelectLassoIcon","SelectRectangleIcon","SettingsIcon","SgroupIcon","Template0Icon","Template1Icon","Template2Icon","Template3Icon","Template4Icon","Template5Icon","Template6Icon","Template7Icon","TemplateDialogIcon","TemplateLibIcon","TextIcon","TextBold","TextItalic","TextSubscript","TextSuperscript","TransformFlipHIcon","TransformFlipVIcon","TransformRotateIcon","UndoIcon","ZoomInIcon","ZoomOutIcon","ShapeEllipseIcon","ShapeRectangleIcon","ShapePolylineIcon","ShapeLineIcon","NotFoundIcon","Save1Icon","Open1Icon","reset","ResetIcon","close","CloseIcon","general","GeneralIcon","GeneralWhiteIcon","StereoIcon","StereoWhiteIcon","AtomsIcon","AtomsWhiteIcon","BondsIcon","BondsWhiteIcon","ServerIcon","ServerWhiteIcon","ThreeDViewerIcon","ThreeDViewerWhiteIcon","debugging","DebuggingIcon","DebuggingWhiteIcon","DropdownIndicatorIcon","TextSpecialSymbolsIcon","chevron","ChevronIcon","OpenWindowPasteIcon","OpenWindowUploadIcon","emptyIcon","findIconByName","hasOwnProperty","component","Icon","shortcutAliasMap","Escape","Delete","Mod","isMacOs","shortcutStr","shortcutKey","isArray","toUpperCase","ActionButton","status","disableableButtons","className","handleClick","_jsxs","onClick","button","children","CLASSNAME_SEPARATOR","Portal","createElement","isElementInDom","isOpen","addElementInDOM","style","addClassName","updateStyle","removeElementFromDOM","prevProps","removeClassNames","appendChild","removeChild","classNames","classList","remove","add","prevStyle","property","ReactDOM","createPortal","DefaultMultiTool","toolbarItem","currentStatus","GroupedMultiTool","groups","_Fragment","descriptor","group","start","chooseMultiTool","variant","defaultClasses","usePortalOpening","opened","useState","setIsOpen","useEffect","currentId","newState","usePortalStyle","ref","portalStyle","setPortalStyle","editorRect","getBoundingClientRect","top","left","menuItemRect","spaceBetween","width","ToolbarMultiToolItem","vertical","onOpen","useRef","selectedTool","find","allInnerItemsHidden","every","option","displayMultiToolItem","savedSelectionTool","savedSelectionToolId","actionButtonProps","onOpenOptions","portalClassName","root","icon","iconSelected","portal","ToolbarGroupItem","TemplatesList","isTemplate","makeAction","index","BottomToolbar","rest","initLib","lib","initTmplLib","baseUrl","cacheEl","deserializeSdfTemplates","concat","userTmpls","fileName","sdfSerializer","SdfSerializer","tmpls","templatesRawData","prefetch","prefetchRender","cachedFiles","tmpl","pr","prefetchSplit","prerender","userLib","prefetchStatic","url","fetch","credentials","resp","ok","files","all","fn","svgs","svgContent","innerHTML","openDialog","dialogName","reject","onResult","onCancel","modalReducer","formState","form","selectTmpl","changeGroup","changeFilter","changeTab","initAttach","atomid","bondid","setAttachPoints","setTmplName","editTmpl","formData","updateLocalStore","deleteUserTmpl","deleteTmpl","saveUserTmpl","initTmplsState","tmplActions","attachActions","templatesReducer","execute","activeTool","actObj","isEqual","actionName","params","pickBy","x","isEmpty","renderCache","RenderStruct","newStruct","cachePrefix","cacheKey","has","preparedStruct","prepareStruct","initHalfBonds","initNeighbors","rnd","Render","autoScale","setMolecule","viewSz","set","clientArea","fileOpener","FileReader","throughFileReader","ActiveXObject","fso","throughFileSystemObject","isCDX","endsWith","rd","onload","content","msClose","onerror","readAsDataURL","readAsText","fd","OpenTextFile","ReadAll","Close","GREEK_SIMBOLS","Alpha","alpha","Beta","beta","Gamma","gamma","greekRe","join","greekify","sym","filterLib","trimmedFilter","re","escapeRegExp","flow","_filter","test","filterFGLib","searchFunction","fields","abbreviation","field","getSelectOptionsFromSchema","memoizedDebounce","func","delay","skipArguments","lastArgs","debouncedFunction","debounce","getArgumentsToCompare","args","lastArgsToCompare","argsToCompare","showTooltipTimer","TOOLTIP_DELAY","showTooltip","infoPanelData","showInfo","clearTimeout","setTimeout","showFunctionalGroupsTooltip","checkFunctionGroupTypes","closestCollapsibleStructures","findItem","expanded","groupName","groupStruct","FunctionalGroup","getFunctionalGroupByName","functionalGroupInfo","functionalGroupsReducer","initFGroups","highlightFGroup","notDebouncedHighlightFG","highlightFG","initFGTemplates","provider","FunctionalGroupsProvider","getInstance","setFunctionalGroupsList","saltsAndSolventsReducer","initSaltsAndSolvents","prerenderPartOfStructures","part","div","height","display","body","autoScaleMargin","downScale","initSaltsAndSolventsTemplates","saltsAndSolventsProvider","SaltsAndSolventsProvider","functionalGroupsProvider","String","setSaltsAndSolventsList","addToFunctionalGroupsList","initial","freqAtoms","currentAtom","MAX_ATOMS","updateVisibleTools","visibleTool","regExp","menuHeight","innerHeight","initResize","onResize","throttle","actionState","toolInMenu","addFreqAtom","correctTools","isSelected","menuName","addAtoms","atomLabel","toolName","sel","getElementById","hiddenAncestor","base","findEl","getComputedStyle","overflow","contains","shared","combineReducers","actionStateReducer","toolbarReducer","modal","store","requestsStatuses","requestReducer","getRootReducer","setEditor","sh","finalState","restOptions","_excluded2","initState","middleware","rootReducer","createStore","applyMiddleware","mapStateToProps","mapDispatchToProps","BottomToolbarContainer","connect","makeItems","bondCommon","bondStereo","bondQuery","bondSpecial","groupOptions","flat","groupDescriptors","accum","rGroupOptions","shapeOptions","transformOptions","selectOptions","arrowsOptions","mappingOptions","useSettingsContext","useContext","SettingsContext","throttleMilliseconds","useThrottleResizeObserver","setSize","useMemo","useResizeObserver","useFormContext","FormContext","useAppContext","AppContext","useInterval","callback","savedCallback","setInterval","clearInterval","useSubscriptionOnEvents","useDispatch","getKetcherInstance","loadingHandler","actionResultHandler","subscribe","eventBus","addListener","KetcherAsyncEvents","LOADING","SUCCESS","FAILURE","unsubscribe","removeListener","subscribeOnInit","unsubscribeOnUnMount","ArrowScroll","startInView","endInView","scrollUp","scrollDown","isScrollDown","setScrollDown","isScrollUp","setScrollUp","scroll","onMouseUp","onMouseDown","mediaSizes","topSeparatorsShowingWidth","bondCollapsableHeight","rGroupCollapsableHeight","shapeCollapsableHeight","transformCollapsableHeight","RGroup","Shape","Transform","LeftToolbar","scrollRef","useInView","threshold","startRef","endRef","sizeRef","Item","scrollTop","offsetHeight","visibleItems","visible","_createElement","listener","groupItem","LeftToolbarContainer","names","StyledAtom","styled","atomColor","ElementColor","AtomsList","forwardRef","isAtom","RightToolbar","atomsList","RightToolbarContainer","Button","MuiButton","_templateObject","IconButton","iconName","combinedTitle","FileControls","onFileOpen","onSave","shortcuts","hiddenButtons","ElementAndDropdown","DropDownContent","_templateObject2","DropDownButton","_templateObject3","DropDownArrow","_templateObject4","MenuItemWithDropdown","topElement","dropDownElements","onToolOpen","isExpanded","setIsExpanded","collapse","expand","Collapse","timeout","unmountOnExit","ClickAwayListener","onClickAway","ElementWithDropdown","ClipboardControls","onCopyMol","onCopyKet","onCopyImage","disabledButtons","copyButtons","handler","getButtonElement","firstButtonObj","collapsibleElements","VerticalDivider","Divider","UndoRedo","onUndo","onRedo","StyledInput","onFocusHandler","updateInputString","inputElement","ZoomInput","onZoomSubmit","currentZoom","inputRef","inputEl","activeElement","onKeyDown","useCallback","zoomShortcuts","nativeEvent","stopImmediatePropagation","onFocus","ZoomLabel","Dropdown","Popover","_templateObject5","ZoomControlButton","_templateObject6","ShortcutLabel","_templateObject7","getIntegerFromString","zoomInput","zoomNumber","isNaN","getValidZoom","minAllowed","Math","min","maxAllowed","max","ZoomControls","onZoom","onZoomIn","onZoomOut","containerRef","userInput","zoomToSet","onClose","reason","onExpand","resetZoom","round","anchorEl","container","anchorOrigin","horizontal","ControlsPanel","SystemControls","onSettingsOpen","onFullscreen","onHelp","onAboutOpen","ExternalFuncControls","isCollapsed","onLayout","onClean","onAromatize","onDearomatize","onCalculate","onCheck","onAnalyse","onMiew","externalFuncButtons","collapseLimit","TopToolbar","onClear","onAbout","resizeRef","onHistoryClick","processedShortcut","dispatchAction","zoomValue","TopToolbarContainer","mac","platform","normalizeKeyName","parts","alt","ctrl","shift","meta","mod","normalizeKeyMap","modifiers","altKey","ctrlKey","metaKey","rusToEng","KN","keyCode","normalizeKeyEvent","keyName","isChar","keyNorm","KeyboardEvent","arguments","lookup","baseName","APointTool","molecule","closestItem","hover","ci","atomResult","atomsInFunctionalGroup","fgId","findFunctionalGroupByAtom","removeFG","fgIds","elementEdit","newatom","fromAtomsAttrs","calcAngle","pos0","pos1","v","Vec2","diff","atan2","y","calcNewAtomPos","rotate","fracAngle","add_","degrees","angle","degree","PI","BONDS_MERGE_ANGLE","BONDS_MERGE_SCALE","mergeBondsParams","struct1","bond1","struct2","bond2","begin1","begin2","end1","end2","pp","mergeAngle","abs","scale","dist","merged","inRange","cross","getOnlyNonGroupItems","getGroupIdFromAtomId","getGroupIdFromBondId","getNonGroupItemsAndAttachmentPoints","isAttachmentPointAtom","AtomTool","_classPrivateFieldInitSpec","hoverIcon","show","attr","updateHoverIconPosition","isNotActiveTool","isContractedFunctionalGroup","Action","selectedSgroup","sGroupAtoms","getAtoms","firstAtom","atomNeighbours","extraNeighbour","mergeWith","fromSgroupDeletion","fromFragmentDeletion","firstAtomPp","a","getBonds","fromAtomAddition","dragCtx","hide","layerX","layerY","getBBox","utils","page2obj","newAtomPos","perform","fromBondAddition","atomLongtapEvent","fgs","quickEdit","xy0","stopTapping","AttachTool","attachPoints","bondResult","bondsInFunctionalGroup","findFunctionalGroupByBond","attachEdit","BondTool","fromBondsAttrs","pos","beginAtom","endAtom","beginPos","endPos","closestSGroup","fGroupId","fGroup","fGroupAtoms","nei","Number","MAX_VALUE","xy1","get_xy0","getExistingBond","existingBondId","existedBond","fromOneBondDeletion","restoreBondWhenHoveringOnCanvas","xy","bondAddition","sum","bondChangingAction","isHoveringOverAtom","bondEnd","alreadyHasBondInOtherDirection","ChainTool","sectCount","ceil","fromChain","newItems","mergeItems","getItemsToFuse","getHoverToFuse","next","fromItemsFuse","ChargeTool","EnhancedStereoTool","stereoAtoms","changeAtomsStereoAction","stereoLabels","stereoAtom","hasAnotherLabel","enhancedStereoEdit","fromStereoFlagUpdate","operations","reverse","getElementsInRectangle","p0","p1","bondList","sGroups","x0","x1","y0","y1","bid","centre","lc2","isBondInContractedFunctionalGroup","relatedFGId","isAtomInContractedFunctionalGroup","rxnArrowsList","rxnPlusesList","simpleObjectsList","rxnArrows","rxnPluses","referencePoints","getReferencePoints","referencePointInRectangle","point","enhancedFlagList","enhancedFlags","sgroupDataList","sgroupData","textsList","getElementsInPolygon","rr","r","isPointInPolygon","referencePointInPolygon","p","n","v0","n0","dot","d0","w0","counter","eps","flag1","flag0","v1","w1","n1","d1","inRectangle","inPolygon","LassoHelper","locate","points","getSelection","dp","Scale","obj2scaled","selectionPolygon","selectionRectangle","ret","searchMaps","SGroupTool","lassoHelper","checkSelection","newSelected","actualSgroupId","atomsResult","extraAtoms","atomFromStruct","sgs","sgroupAtoms","sgroupBonds","sgroupDialog","bondFromStruct","isFunctionalGroup","running","addPoint","bondsResult","extraBonds","cancel","selMerge","isAtomsOrBondsSelected","getAttrs","getContextBySgroup","getContextBySelection","sgroupEdit","newSg","checkOverlapping","error","isDataSg","fromSeveralSgroupAddition","fromContextType","sgAtoms","SgContexts","manyComponentsSelected","singleComponentSelected","sgBonds","anyChainedBonds","allBondsSelected","currSelection","sourceAtoms","fromSgroupAction","fixedBond","j","countOfSelectedComponents","connectedComponents","isSuperset","getGroupIdsFromItemArrays","groupsIds","groupId","getGroupIdsFromItemMaps","mergeMaps","mergeMapOfItemsToSet","dropAndMerge","isMerging","dropItemAction","expandGroupsAction","getExpandGroupsInMergeAction","groupsInMerge","setExpandSGroup","getMergeItems","nonGroupItemsAndAttachPoints","isAtomsArray","selectedElements","generateCommonProperties","normalizedAtom","getOwnPropertyNames","resultAtomAttributes","uniqueValues","allAtomsHaveTheSameValue","castAtomPropToType","typesMapping","updateOnlyChangedProperties","userChangedAtom","unchangedAtom","updatedKeys","updatedAtom","isPropertyChanged","updateSelectedAtoms","changeAtomPromise","atomWithChangedProperties","edgeOffset","isCloseToEdgeOfScreen","clientX","clientY","isCloseToLeftEdgeOfScreen","isCloseToTopEdgeOfScreen","isCloseToRightEdgeOfScreen","clientWidth","isCloseToBottomEdgeOfScreen","clientHeight","isCloseToEdgeOfCanvas","canvasSize","isCloseToLeftEdgeOfCanvas","isCloseToTopEdgeOfCanvas","isCloseToRightEdgeOfCanvas","isCloseToBottomEdgeOfCanvas","calculateCanvasExtension","currentCanvasSize","extensionVector","newHorizontalScrollPosition","scrollLeft","newVerticalScrollPosition","horizontalExtension","verticalExtension","shiftAndExtendCanvasByVector","vector","sz","scaled","setPaperSize","setOffset","translate","scrollByVector","SelectTool","getMapsForClosestItem","selectedSgroups","getNewSelectedItems","closestToSel","frag","fragGetAtoms","fragGetBonds","rgroups","shouldDisplayDegree","neighbors","getResizingProps","fromSimpleObjectResizing","fromArrowResizing","expSel","fromMultipleMove","sub","extendCanvas","maps","possibleSaltOrSolvent","isDraggingSaltOrSolventOnStructure","isSaltOrSolvent","isDraggingStructureOnSaltOrSolvent","preventSaltAndSolventsMerge","selectElementsOnCanvas","getSelectedAtoms","rb","bondEdit","bondsSelection","newbond","fromTextDeletion","fromTextUpdating","elements","isDraggingOnSaltOrSolventAtom","isDraggingOnSaltOrSolventBond","mergeAtoms","mergeBonds","sgroupsOnCanvas","isAtomInSaltOrSolvent","isBondInSaltOrSolvent","isCloseToSomeEdgeOfCanvas","isCloseToEdge","reversible","uniqArray","mapAtomIdsToAtoms","atomsIds","atomOrReAtom","dest","xor","selectFragment","EraserTool","preResult","fromOneAtomDeletion","fromArrowDeletion","fromPlusDeletion","fromSimpleObjectDeletion","HandTool","lastEvent","cursor","cursorPosition","begPos","PasteTool","isSingleContractedGroup","isSingleGroup","pageX","pageY","fromPaste","pasteItems","findItems","closestGroupItem","closestGroup","extraBond","targetGroup","getAttAtomId","fromTemplateOnAtom","prepareTemplateFromSingleGroup","idsOfItemsMerged","groupsIdsInvolvedInMerge","template","angle0","RGroupAtomTool","propsDialog","fragId","attrlist","aam","RGroupFragmentTool","ce","findRGroupByFragment","rgroupEdit","newRg","rgidOld","fromRGroupFragment","fromUpdateIfThen","fromRGroupAttrs","ReactionArrowTool","isNew","previous","fromArrowAddition","addOperation","itemId","getDefaultLengthPos","getArrowParams","x2","y2","sqrt","pos2","defaultLength","arrowParams","newPos","cos","sin","ReactionMapTool","rcs","getComponents","updateLine","p2","selectionLine","atom1","atom2","aam1","aam2","ReactionPlusTool","fromPlusAddition","ReactionUnmapTool","RotateTool","dir","singleBond","fromFlip","fromBondAlign","rotId","rotAll","hb","halfBonds","loop","neiAtom","neiNei","neiHb","angle1","fromRotate","SimpleObjectTool","fromSimpleObjectAddition","TemplateTool","getTemplateMode","sign","getSign","followAction","targetGroupsIds","dragCtxItem","getDragCtxItem","frid","frIds","getFragmentIds","count","hb1","hb2","loopHbs","loops","hbs","halfBondBegin","hbbAtom","atomById","sign1","sign2","skip","getIgnoredGroupItem","targetPos","eventPos","fromTemplateOnBondAction","getTargetAtomId","extra_bond","isAddingFunctionalGroup","fromTemplateOnCanvas","promise","functionalGroupRemoveAction","addSaltsAndSolventsOnCanvasWithoutMerge","functionalGroupToReplace","attachmentAtomId","atomsWithoutAttachmentAtom","neiId","completeAction","isDummy","TextTool","position","origilContent","fromTextCreation","rgroupatom","eraser","rgroupfragment","apoint","reactionarrow","reactionplus","reactionmap","reactionunmap","enhancedStereo","simpleobject","handleHotkeyOverItem","newAction","handleEraser","handleDialog","handleTool","hoveredItem","mapItemsToArrays","dialogType","dialogHandler","getDialogHandler","hoveredItemId","itemType","dialogs","handleAtomPropsDialog","handleBondPropsDialog","atomsSelected","convertedAtomForModal","convertedBondForModal","updatedBond","toolHandler","getToolHandler","isChangeStructureTool","isFunctionalGroupChange","isChangingFunctionalGroup","handleAtomTool","handleBondTool","handleChargeTool","handleRGroupAtomTool","Tools","_default","updatedAtoms","newBond","existingAtom","mappedItems","initKeydownListener","hotKeys","initHotKeys","keyHandle","removeNotRenderedStruct","actionTool","code","letter","hotkeyDialogTypes","getHoveredItem","hasOwn","checkGroupOnTool","groupLength","newIndex","actName","clipArea","getCurrentAction","isIE","prevActName","ctabItem","setHotKey","act","rxnTextPlain","initClipboard","formatProperties","mime","debAction","loadStruct","clipData","Mol","Rxn","ket","isReaction","AppClipArea","AppHidden","onInitTmpls","staticResourcesUrl","AppHiddenContainer","smallWidth","smallHeight","Dialog","headerContent","footerContent","buttonsNameMap","needMargin","withDivider","focusable","dialogRef","useLayoutEffect","closest","getElementsByClassName","isButtonOk","exit","keyDown","activeTextarea","stopPropagation","role","onSubmit","tabIndex","styles","header","btnContainer","buttonTop","closeButton","withMargin","footer","LoadingCircles","SELECTION_DISTANCE_COEFFICIENT","SELECTION_WITHIN_TEXT","findMaps","findClosestAtom","findClosestBond","findClosestEnhancedFlag","findClosestDataSGroupData","findClosestSGroup","findClosestFG","findClosestRxnArrow","findClosestRxnPlus","findClosestFrag","findClosestRGroup","findClosestSimpleObject","findClosestText","rectangleContainsPoint","startX","startY","minDist","topX","topY","bottomX","bottomY","distances","refPoint","simpleObject","calcDistance","closestAtom","maxMinDist","skipId","closestBond","closestBondCenter","minCDist","a1","a2","mid","cdist","norm","inStripe","_minDist","stereoFlagPosition","getDefaultStereoFlagPosition","box","dataArea","inBox","xDist","rgid","labelBox","rxnArrow","plus","sgid","functionalGroup","firstSgroupAtom","bracketDir","rotateSC","pg","areas","reSGroupId","reSGroup","getTextHighlightDimensions","centerX","centerY","rectangleCenter","findClosestItem","mp","other","findCloseMerge","srcId","merge","customOnChangeHandler","operation","op","_inverted","OperationType","ATOM_ADD","ATOM_DELETE","toFixed","ATOM_ATTR","attribute","to","data2","ATOM_MOVE","BOND_ADD","BOND_DELETE","FRAGMENT_ADD","FRAGMENT_DELETE","FRAGMENT_ADD_STEREO_ATOM","FRAGMENT_DELETE_STEREO_ATOM","S_GROUP_ATOM_ADD","S_GROUP_ATOM_REMOVE","sGroupId","S_GROUP_CREATE","S_GROUP_DELETE","RXN_ARROW_ADD","RXN_ARROW_DELETE","RXN_ARROW_RESIZE","RXN_ARROW_MOVE","R_GROUP_FRAGMENT","SIMPLE_OBJECT_ADD","SIMPLE_OBJECT_DELETE","SIMPLE_OBJECT_RESIZE","SIMPLE_OBJECT_MOVE","Highlighter","highlightsMap","highlights","highlightsArray","highlight","createdHighlights","arg","color","getValidInputOnly","validAtoms","validBonds","fromHighlightCreate","fromHighlightClear","structAtoms","structBonds","SCALE","HISTORY_SIZE","HOVER_ICON_OPACITY","structObjects","highlightTargets","selectStereoFlagsIfNecessary","expAtoms","atomsOfFragments","stereoFlags","shouldSelSFlag","Editor","_selection","historyStack","historyPtr","renderAndRecoordinateStruct","setOptions","lastCursorPosition","createHoverIcon","contextMenu","Subscription","PipelineSubscription","sdataEdit","change","selectionChange","aromatizeStruct","dearomatizeStruct","apiSettings","domEventSetup","toolMap","isAtomToolChosen","paper","fromNewCanvas","structCenter","getStructCenter","recoordinate","Struct","superStruct","mergeInto","updateOptions","setZoom","ReStruct","setSelection","newTool","setHover","ignoreHistory","splice","stack","eventName","subscriber","subscribeFuncWrapper","srcItems","dst","isRxn","fromDescriptorsAlign","isMouseMainButtonPressed","resetSelectionOnCanvasClick","updateLastCursorPosition","events","isContextMenuClosed","useToolIfNeeded","EditorTool","conditions","isSelectionRunning","condition","toolEventName","DOMSubscription","subs","nodeName","isToolUsed","rp","setScrollOffset","bb","getVBoxObj","dstId","item1","item2","Cursor","PressedIcon","enableHandTool","setPosition","setMouseDown","updatePosition","handleMouseDown","handleMouseUp","bottom","right","zIndex","pointerEvents","CONTEXT_MENU_ID","useAtomEdit","atomIds","newAtom","formatTitle","getBondNames","startsWith","queryBondNames","getNonQueryBondNames","allBondNames","difference","onlyHasProperty","checkedObject","numberOfProps","useAtomStereo","stereoAtomIdsRef","stereoAtomIds","useDelete","itemsToDelete","bondIds","AtomMenuItems","handleEdit","handleStereo","stereoDisabled","handleDelete","useBondEdit","selectedBondIds","useBondSGroupAttach","attachedSGroups","getAttachedSGroups","useBondSGroupEdit","sGroupsRef","useBondTypeChange","nonQueryBondNames","BondMenuItems","handleTypeChange","handleSGroupAttach","sGroupAttachHidden","handleSGroupEdit","sGroupEditDisabled","sGroupEditHidden","Submenu","subMenu","useFunctionalGroupEoc","toExpand","selectedFunctionalGroups","relatedSGroupId","useFunctionalGroupRemove","FunctionalGroupMenuItems","handleExpandOrContract","ExpandOrContractHidden","handleRemove","bondNames","SelectionMenuItems","handleBondEdit","bondEditDisabled","handleAtomEdit","atomEditDisabled","bondTypeChangeDisabled","handleAtomStereo","atomStereoDisabled","animation","ContextMenu","trackVisibility","Menu","FOR_BONDS","onVisibilityChange","FOR_ATOMS","FOR_SELECTION","FOR_FUNCTIONAL_GROUPS","ContextMenuTrigger","useContextMenu","getSelectedFunctionalGroups","selectedAtomIds","handleDisplay","functionalGroupsInSelection","showProps","findFunctionalGroupBySGroup","onContextMenu","StructRender","tagRef","previousProps","molSerialzer","childNodes","node","Tag","X_COORD_INDEX","Y_COORD_INDEX","calculateMiddleCoordsForRect","rectCoords","middleCoordForRectangleSides","previousPoint","middleX","middleY","calculateScrollOffsetX","calculateScrollOffsetY","BAR_PANEL_SIZE","LEFT_PADDING_MULTIPLIER","getPanelPositionRelativeToRect","viewportLeftLimit","viewportBottomLimit","viewportRightLimit","hovering","path","middleLeftSide","middleBottomSide","middleRightSide","middleTopSide","SGroupDataRender","sGroupData","wrapperHeight","setWrapperHeight","wrapperWidth","setWrapperWidth","wrapperRef","panelCoordinate","infoPanel","functionalGroupsSelector","functionGroupInfoSelector","HOVER_PANEL_PADDING","getSGroupFirstAtom","firstAtomId","getPanelPosition","groupBoundingBox","firstAtomPosition","panelPosition","InfoPanel","setSGroupData","childRef","CIP_FIELD_NAME","rescaleAmount","setupEditor","oldProps","toolOpts","upperFirst","removeEditorHandlers","StructEditor","enableCursor","editorRef","logRef","nextProps","nextState","onInit","msg","showAttachmentPoints","parsedInfo","csr","handShouldBeShown","setState","onSelectionChange","onElementEdit","onEnhancedStereoEdit","onQuickEdit","onBondEdit","onRgroupEdit","onSgroupEdit","onRemoveFG","onMessage","onAromatizeStruct","onDearomatizeStruct","onAttachEdit","onCipChange","onConfirm","onShowInfo","onApiSettings","canvas","intermediateCanvas","handIcon","compressedHandIcon","measureLog","spinnerOverlay","AboutDialog","indigoInfo","dialog_body","onOk","okButton","overviewLink","Logo","verionsInfo","ketcherVersionInfo","date","infoLinks","feedbackLink","lifeScienciesLink","indigoMachine","buildDate","_result","About","ErrorMessage","ErrorPopover","handleClose","GenericInput","onChange","innerRef","isFocused","onInput","input","genericInput","checkbox","radioButton","ev","isNumber","TextArea","CheckBox","_excluded3","fieldSetItem","checked","Select","onSelect","multiple","enumSchema","selectedIndex","o","FieldSet","_excluded4","fieldSetLabel","defaultChecked","fieldset","inputCollection","querySelectorAll","inp","Slider","_excluded5","slider","cbOrIndex","isTypeValue","inputCtrl","singleSelectCtrl","testVal","multipleSelectCtrl","ctrlMap","componentMap","AnyComponentWithRef","_excluded6","Input","restProps","PureComponent","chevronIcon","currentValue","setCurrentValue","handleChange","MuiSelect","selectContainer","MenuProps","dropdownList","IconComponent","isDivider","listDivider","MenuItem","disableRipple","Form","onUpdate","propSchema","errs","getErrorsObj","customValid","updateState","instance","dataError","stateStore","Label","labelPos","tooltip","Field","setAnchorEl","handlePopoverOpen","currentTarget","handlePopoverClose","fieldOpts","formField","inputWrapper","SelectOneOf","selectDesc","verbose","strictSchema","schemaCopy","cloneDeep","formatName","formatValidator","addFormat","inst","serializeRewrite","deserializeRewrite","serializeMap","deserializeMap","getInvalidMessage","parentSchema","presetColors","ColorPicker","isPaletteOpen","setIsPaletteOpen","limit","inThrottle","prev","handlePaletteOpen","handleColorChange","handleBlur","relatedTarget","colorPickerWrapper","colorPickerInput","selectedInput","colorPickerPreview","expandIcon","turnedIcon","colorPickerWrap","withPalette","onBlur","chooseColor","clicked","autoFocus","presetColor","colorPicker","HexColorPicker","colorContainer","hex","HexColorInput","MeasureInput","measure","setMeasure","cust","setCust","convValue","convertValue","handleMeasChange","m","calcValue","newValue","measureInput","measureMap","px","cm","pt","inch","measureFrom","measureTo","OpenButton","opener","noop","onLoad","onError","btn","click","openButton","SaveButton","saveImage","saveFile","fileSaver","saver","ketcherInstance","blob","saveAs","Blob","Accordion","tabs","changedGroups","expandedAccordions","setExpandedAccordions","handleAccordionChange","accordion","isExpand","expandedAccordion","accordionWrapper","shouldGroupBeRended","accordionSummaryWrapper","accordionSummary","groupLabel","groupIcon","changeMarker","accordionDetailsWrapper","hiddenAccordion","accordionDetails","commonFonts","checkInSystem","availableFontsPromises","fontName","observer","FontFaceObserver","SystemFonts","availableFonts","setAvailableFonts","onChangeCallback","mounted","results","fonts","fieldGroups","defaultSettings","HeaderContent","onOpenFile","onReset","getIsResetDisabled","settingsProps","settingsSchema","SettingsDialog","appOpts","setChangedGroups","changed","generalTab","stereoTab","atomsTab","bondsTab","serverTab","threeDViewerTab","viewer","debuggingTab","OK","ownProps","newOpts","Settings","ErrorsCheck","checkSchema","moleculeErrorsTypes","getOptionName","nameIndex","getFormattedDateString","getFixedString","num","padStart","getHours","getMinutes","getSeconds","getDate","getMonth","getFullYear","FooterContent","handleCheck","handleApply","isStuctureChecking","isCheckedWithNewSettings","buttonSecondary","buttonPrimary","buttonsRight","CheckDialog","checkState","onApply","setIsStructureChecking","lastCheckDate","setLastCheckDate","setIsCheckedWithNewSettings","Date","handleSettingsChange","wrapper","checkBoxesDisabled","checkInfo","centeredContainer","warnings","warningsContainer","Check","formulaRegexp","errorRegexp","formulaInputMarkdown","contentData","contentEditable","chem_input","FormulaInput","cnd","substring","FrozenInput","roundOff","AnalyseDialog","onChangeRound","withSelector","contentWrapper","selectWrapper","ErrorsContext","Analyse","DialogActionButton","clickHandler","isImage","onImage","openHandler","copyHandler","secondaryButton","primaryButton","RecognizeDialog","partProps","onRecognize","isFragment","onChangeImago","canPreviewImage","setCanPreviewImage","clearFile","topBody","imagoVersion","imagesContainer","picture","messageContainer","output","URL","webkitURL","createObjectURL","ver","Recognize","BACKGROUND_COLOR","dark","light","MIEW_TX_TYPES","no","bright","colorer","blackAndWhite","bg","black","TXoptions","userOpts","selector","showBg","createMiewOptions","autoPreset","editing","inversePanning","reps","textMode","CHANGING_WARNING","warning","MiewDialog","miewOpts","onExportCML","miewRef","onMiewInit","cml","sourceType","fileType","exportCML","cmlStruct","applyButton","miewDialog","miewContainer","miewDarkTheme","Viewer","Miew","ElementNumber","readOnly","isMultipleAtoms","currentLabel","setCurrentLabel","onLabelChangeCallback","itemGroups","querySpecific","reactionFlags","atomValid","chargeValid","isChemicalElement","regex","isValidCharge","AtomContainer","AttachPoints","attachmentPointsSchema","AttachPointsContainer","automapSchema","Automap","AutomapContainer","BondContainer","IfThenSelect","rgroupLabels","rgroupLabel","RgroupLogic","rangeConv","s","RgroupLogicContainer","ICON_NAME","AnalyzingFile","analyzingFileWrapper","fileBox","FileDrop","buttonLabel","textLabel","disabledText","useDropzone","getRootProps","getInputProps","isDragActive","getClassesString","parentStyles","dropContainer","isHovered","isDisabled","dropIconWrapper","textLabelWrapper","buttonLabelWrapper","ICON_NAMES","PASTE","FILE","IMAGE","OpenOptions","selectClipboard","fileLoadHandler","imageLoadHandler","isRecognizeDisabled","optionsContainer","onDropAccepted","onDropRejected","accept","TextEditor","inputHandler","textareaEditor","ViewSwitcher","states","idle","textEditor","MODAL_STATES","imageRec","cancelButton","buttonsContainer","copyButton","Open","onImageUpload","setStructStr","setFileName","setOpener","setCurrentState","chosenOpener","onFileLoad","fileContent","onImageLoad","withFooterContent","badHeaderRecover","OpenContainer","couldBeSaved","getPropertiesByFormat","rxnArrowsSize","arrayOfAtoms","hasGenerics","arrayOfArrows","rxnArrowMode","isRg","_ind","isSg","isVal","StereoFlag","Tabs","contentClassName","tabPanel","componentProps","saveSchema","SaveDialog","getPropertiesByImgFormat","isImageFormat","ketSerialize","disableControls","imageFormat","isLoading","base64","imageSrc","onResetForm","structWarning","saveWarning","structFormat","isStructInvalid","showStructWarningMessage","getWarnings","renderSaveFile","renderWarnings","formContainer","changeType","isCleanStruct","LoadingState","loadingCirclesContainer","ImageContent","imageContainer","BinaryContent","previewBackground","previewArea","PreviewContent","isBinaryCdxFormat","warningsArr","savingStruct","b64toBlob","isMoleculeContain","saveTmpl","onTmplSave","extensions","formatProps","getButtons","renderForm","prevState","Save","EnhancedStereo","findStereLabels","maxAnd","maxOfAnds","maxOr","maxOfOrs","enhancedStereoSchema","labelGroupSelect","aids","stereoIds","stereLabels","numbers","lc","LabelEdit","labelEditSchema","l","labelEditInputField","AtomInfo","isInfo","numberStyle","fontSize","elemStyle","fontWeight","ket_atom_info","none","mass","PERIODIC_TABLE_COLUMNS","Header","MainRow","row","refer","onAtomSelect","onDoubleClick","currentEvents","atomClassNames","OutinerRow","metalPrefix","metal","unknownProps","unknownState","beforeSpan","He","Al","Hf","Rf","ACTINIDE","LANTHANIDE","main","rowPartition","lanthanides","actinides","period","ElementsTable","origin","callbacks","table","getAtomClassNames","main_row","outiner_row","HorizontalBoxWithLines","horizintalNodeLines","upperLines","lowerLine","VerticalBoxWithLines","verticalNodeLines","isGenericGroup","cyclicGroups","getGroupClassName","replaceAll","GenSet","labels","displayName","legendBox","genGroupLegendBox","genGroupLegend","getLegendClassname","mainTitles","GenGroup","fieldFlexWrapper","genButtonContainer","buttonContainer","itemSets","subGroup","getGenericsGroupsMap","tree","newGroups","subGroups","renderGenGroupComponent","groupsMap","Generics","GenericGroups","genericGroups","topGroupsContainer","groupNames","atomsGen","specialNodes","groupGen","groupGenerics","groupAcyclic","subgroupContainer","acyclicCarbo","acyclicHetero","groupCyclic","cyclicCarbo","cyclicHetero","TypeChoice","Table","prevChoice","currentChoice","dialogHeader","activateImmediately","onMouseEnter","onMouseLeave","elementsTable","periodTable","mapSelectionToProps","PeriodTable","setValue","extendedTable","ExtendedTable","RemoveFG","question","buttonCancel","buttonOk","oneOrMore","multipl","ButtonList","disabledIds","SDataFieldset","formSchema","SGroupFieldset","propMapping","schemes","Sgroup","TemplateEditDialog","Warning","LeftColumn","RightColumn","NameInput","AttachmentOutput","Buttons","buttonCommonStyles","css","CancelButton","editorStyles","selectionStyle","fill","stroke","hoverStyle","hoverStyleSimpleObject","Attach","initTmpl","onNameEdit","globalSettings","getScale","checkIsValidName","normTmpl","structNormalization","normStruct","cbb","getCoordBoundingBox","rxnPlus","VIEW_SIZE","isSaltOrSolventTemplate","isFunctionalGroupTemplate","getTemplateTitle","tmplName","RenderTmpl","TemplateTable","onDelete","onAttach","titleRows","renderOptions","tableContent","oneRowTitleTable","twoRowsTitleTable","td","structTitle","selectedTitle","deleteButton","editButton","saltsAndSolventsSelector","EmptySearchResult","textInfo","emptySearch","SALTS_AND_SOLVENTS","batchDelay","useSaltsAndSolvents","isFirstRender","setIsFirstRender","timerId","filteredSaltsAndSolvents","setFilteredSaltsAndSolvents","addToSaSWithBatches","fullFilteredArray","batchSize","filteredSaS","TabPanel","a11yProps","TemplateTabs","filterLibSelector","createSelector","FUNCTIONAL_GROUPS","clickToAddToCanvas","SaltsAndSolvents","flexGrow","justifyContent","alignItems","saveButton","TemplateLibrary","TemplateDialog","onFilter","onTabChange","onChangeGroup","initialTab","searchInputRef","filteredFG","setFilteredFG","filteredTemplateLib","handleTabChange","serializerMapper","FunctionalGroupLibrary","inputContainer","placeholder","searchIcon","Tab","tabsContent","square","AccordionSummary","AccordionDetails","templ","resultsContainer","selectTemplate","onModalClose","useClickOutside","targetRef","onClickOutside","FontControl","editorState","setEditorState","defaultFontSize","isShowingFontSizeMenu","setIsShowingFontSizeMenu","currentFontSize","setCurrentFontSize","onClickOutsideCloseDrowndown","setFontSize","newEditorState","currentStyle","MIN_FONT_SIZE","MAX_FONT_SIZE","fontSizes","fontSizeOptions","fontSizeOption","fontBtn","parseFloat","fontSizeMenu","SpecialSymbolsList","symbols","symbol","SpecialSymbolsButton","showSpecialSymbols","setShowSpecialSymbols","closeSymbolsList","addSymbol","contentState","getCurrentContent","nextContentState","Modifier","replaceText","nextEditorState","EditorState","activeTextButton","textButton","TextButton","toggleStyle","command","isActive","createStyles","customStyleFn","TextCommand","Bold","Italic","Superscript","Subscript","Text","rawContentState","moveFocusToEnd","createWithContent","convertFromRaw","blocks","entityMap","hasText","convertToRaw","keyBindingFn","getDefaultKeyBinding","onContentChange","getCurrentInlineStyle","RichUtils","toggleInlineStyle","customStyleMap","SUBSCRIPT","verticalAlign","transform","transformOrigin","SUPERSCRIPT","lineHeight","refEditor","setFocusInEditor","controlPanel","Confirm","Rgroup","TemplateAttach","TemplatesDialog","Modal","modals","modalOverlay","selectClasses","smallScreen","mergeProps","stateProps","dispatchProps","initProps","ModalContainer","initEditor","updateAction","sleep","time","selectMode","resetOption","acts","atomAttributes","dlg","_extends","serverOpts","muiTheme","createTheme","components","MuiButtonBase","defaultProps","App","scrollTo","ThemeProvider","theme","AppModalContainer","AppContainer","initApp","createRoot","Provider","KetcherBuilder","serviceMode","formatterFactory","DefaultStructServiceOptions","buildNumber","URLSearchParams","initialMol","buildKetcherAsync","builder","appendApiAsync","appendServiceMode","appendUiAsync","build","rootElRef","ketcherInitEvent","Event","dispatchEvent","small"],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}